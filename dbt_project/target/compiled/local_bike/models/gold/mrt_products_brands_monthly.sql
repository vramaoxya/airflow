------------------------------------------

------------------------------------------


------------------------------------------
SELECT *
FROM (

  SELECT
    yearmonth AS month,
    brand_name as Brand,    
    ROUND(SUM(total_item_discount_sold), 2 ) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily`
  GROUP BY month, brand

)
PIVOT (

  SUM(total_sales) AS sales
  FOR month IN ( '2016-01','2016-02','2016-03','2016-04','2016-05','2016-06','2016-07','2016-08','2016-09','2016-10','2016-11','2016-12','2017-01','2017-02','2017-03','2017-04','2017-05','2017-06','2017-07','2017-08','2017-09','2017-10','2017-11','2017-12','2018-01','2018-02','2018-03','2018-04','2018-06','2018-07','2018-08','2018-09','2018-10','2018-11','2018-12' )

)
ORDER BY Brand
------------------------------------------