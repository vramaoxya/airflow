[0m20:45:29.768122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70eb29ce7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70eb2a333230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70eb2a44c890>]}


============================== 20:45:29.781718 | a97a473c-3e85-400a-928e-58fa3928fc6b ==============================
[0m20:45:29.781718 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:45:29.782787 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'log_format': 'default', 'write_json': 'True', 'debug': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'partial_parse': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/root/.dbt', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'version_check': 'True', 'no_print': 'None'}
[0m20:45:29.783666 [info ] [MainThread]: dbt version: 1.5.0
[0m20:45:29.784285 [info ] [MainThread]: python version: 3.12.12
[0m20:45:29.784884 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m20:45:29.785486 [info ] [MainThread]: os info: Linux-6.17.0-1003-gcp-x86_64-with-glibc2.41
[0m20:45:29.786120 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m20:45:29.786701 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m20:45:29.787322 [info ] [MainThread]: Configuration:
[0m20:45:31.752466 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:45:31.791951 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m20:45:31.792713 [info ] [MainThread]: Required dependencies:
[0m20:45:31.793505 [debug] [MainThread]: Executing "git --help"
[0m20:45:31.797540 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:45:31.798371 [debug] [MainThread]: STDERR: "b''"
[0m20:45:31.798776 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:45:31.799329 [info ] [MainThread]: Connection:
[0m20:45:31.800013 [info ] [MainThread]:   method: service-account
[0m20:45:31.800618 [info ] [MainThread]:   database: databird-473015
[0m20:45:31.801269 [info ] [MainThread]:   schema: dbt_bike
[0m20:45:31.801880 [info ] [MainThread]:   location: US
[0m20:45:31.802501 [info ] [MainThread]:   priority: interactive
[0m20:45:31.803117 [info ] [MainThread]:   timeout_seconds: None
[0m20:45:31.803724 [info ] [MainThread]:   maximum_bytes_billed: None
[0m20:45:31.804332 [info ] [MainThread]:   execution_project: databird-473015
[0m20:45:31.805078 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m20:45:31.805644 [info ] [MainThread]:   job_retries: 1
[0m20:45:31.806277 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m20:45:31.806846 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m20:45:31.807412 [info ] [MainThread]:   gcs_bucket: None
[0m20:45:31.808605 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m20:45:31.809054 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:45:31.811531 [debug] [MainThread]: On debug: select 1 as id
[0m20:45:32.464023 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:d68e8e33-5a9d-4631-8fd9-3fc2e0ee5785&page=queryresults
[0m20:45:32.464633 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:45:32.465240 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:45:32.465909 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path []: Additional properties are not allowed ('flags' was unexpected)

Error encountered in /usr/app/dbt/dbt_project.yml


[0m20:45:32.467011 [debug] [MainThread]: Command `dbt debug` failed at 20:45:32.466671 after 2.74 seconds
[0m20:45:32.467595 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:45:32.468237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70eb29cbca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70eb11fde1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70eb2a333230>]}
[0m20:45:32.469153 [debug] [MainThread]: Flushing usage events
[0m20:49:22.816694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ed3be3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ed3b01e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ed3be3470>]}


============================== 20:49:22.822546 | f9c69efd-9711-4d22-9c71-5572f1448c07 ==============================
[0m20:49:22.822546 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:49:22.823683 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'profiles_dir': '/root/.dbt', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'log_path': '/usr/app/dbt/logs', 'partial_parse': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'write_json': 'True'}
[0m20:49:22.824319 [info ] [MainThread]: dbt version: 1.5.0
[0m20:49:22.824844 [info ] [MainThread]: python version: 3.12.12
[0m20:49:22.825561 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m20:49:22.826294 [info ] [MainThread]: os info: Linux-6.17.0-1003-gcp-x86_64-with-glibc2.41
[0m20:49:22.827027 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m20:49:22.827628 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m20:49:22.828287 [info ] [MainThread]: Configuration:
[0m20:49:24.421216 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:49:24.471552 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:49:24.472346 [info ] [MainThread]: Required dependencies:
[0m20:49:24.473496 [debug] [MainThread]: Executing "git --help"
[0m20:49:24.477580 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:49:24.478339 [debug] [MainThread]: STDERR: "b''"
[0m20:49:24.478968 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:49:24.479740 [info ] [MainThread]: Connection:
[0m20:49:24.480601 [info ] [MainThread]:   method: service-account
[0m20:49:24.481585 [info ] [MainThread]:   database: databird-473015
[0m20:49:24.482300 [info ] [MainThread]:   schema: dbt_bike
[0m20:49:24.483134 [info ] [MainThread]:   location: US
[0m20:49:24.483730 [info ] [MainThread]:   priority: interactive
[0m20:49:24.484354 [info ] [MainThread]:   timeout_seconds: None
[0m20:49:24.484977 [info ] [MainThread]:   maximum_bytes_billed: None
[0m20:49:24.485598 [info ] [MainThread]:   execution_project: databird-473015
[0m20:49:24.486264 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m20:49:24.486926 [info ] [MainThread]:   job_retries: 1
[0m20:49:24.487675 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m20:49:24.488474 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m20:49:24.489168 [info ] [MainThread]:   gcs_bucket: None
[0m20:49:24.490314 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m20:49:24.490737 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:24.493203 [debug] [MainThread]: On debug: select 1 as id
[0m20:49:25.086124 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:0765ead8-f730-49c2-b608-223e7a73b7a2&page=queryresults
[0m20:49:25.086836 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:49:25.087406 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:49:25.088511 [debug] [MainThread]: Command `dbt debug` succeeded at 20:49:25.088231 after 2.28 seconds
[0m20:49:25.089392 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:49:25.090169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ed785a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ed3b01e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ed42f0cb0>]}
[0m20:49:25.091086 [debug] [MainThread]: Flushing usage events
[0m20:50:13.645729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a2fc6b7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a2fc84cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a2fd31ffb0>]}


============================== 20:50:13.652548 | 5bae9ffd-204b-4f48-b629-79e33379c3ab ==============================
[0m20:50:13.652548 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:50:13.653779 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'printer_width': '80', 'debug': 'False', 'no_print': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'log_format': 'default', 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'quiet': 'False', 'static_parser': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'target_path': 'None'}
[0m20:50:13.713637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bae9ffd-204b-4f48-b629-79e33379c3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a2fd423020>]}
[0m20:50:13.718014 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hw94rfma'
[0m20:50:13.719310 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:50:13.810558 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:50:13.813632 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m20:50:13.870677 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m20:50:13.878592 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:50:13.933977 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:50:13.942928 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m20:50:14.068191 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m20:50:14.072047 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m20:50:14.073230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5bae9ffd-204b-4f48-b629-79e33379c3ab', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a2fd3b5160>]}
[0m20:50:14.091778 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m20:50:15.012949 [info ] [MainThread]: Installed from version 0.10.5
[0m20:50:15.013924 [info ] [MainThread]: Up to date!
[0m20:50:15.015281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5bae9ffd-204b-4f48-b629-79e33379c3ab', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a2fc532bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a2fc9e8440>]}
[0m20:50:15.016238 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:50:15.233457 [info ] [MainThread]: Installed from version 1.3.2
[0m20:50:15.234539 [info ] [MainThread]: Up to date!
[0m20:50:15.235558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5bae9ffd-204b-4f48-b629-79e33379c3ab', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a2fc9e8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a2fc609160>]}
[0m20:50:15.236365 [info ] [MainThread]: Installing calogica/dbt_date
[0m20:50:15.390748 [info ] [MainThread]: Installed from version 0.10.1
[0m20:50:15.391471 [info ] [MainThread]: Up to date!
[0m20:50:15.392252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5bae9ffd-204b-4f48-b629-79e33379c3ab', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a2fc609160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a2fc6b69f0>]}
[0m20:50:15.394185 [debug] [MainThread]: Command `dbt deps` succeeded at 20:50:15.393960 after 1.76 seconds
[0m20:50:15.394626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a2fd2d4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a2fcd65af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a2fc8c5be0>]}
[0m20:50:15.395094 [debug] [MainThread]: Flushing usage events
[0m20:53:54.075534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c23539bba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2353ad8fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2353f1ec30>]}


============================== 20:53:54.095094 | 7b3535c5-f029-4c80-898a-235a611c458a ==============================
[0m20:53:54.095094 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:53:54.096369 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'quiet': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'no_print': 'None', 'write_json': 'True', 'log_path': '/usr/app/dbt/logs', 'introspect': 'True', 'log_cache_events': 'False', 'profiles_dir': '/root/.dbt', 'indirect_selection': 'eager'}
[0m20:53:57.733815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b3535c5-f029-4c80-898a-235a611c458a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c23539f4e90>]}
[0m20:53:57.758226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b3535c5-f029-4c80-898a-235a611c458a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c233bb9e900>]}
[0m20:53:57.818334 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m20:53:57.819467 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:53:57.820278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7b3535c5-f029-4c80-898a-235a611c458a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c23414f8170>]}
[0m20:53:59.871055 [debug] [MainThread]: 1699: static parser successfully parsed silver/int_src_local_bike_store_daily.sql
[0m20:53:59.893951 [debug] [MainThread]: 1699: static parser successfully parsed silver/int_src_local_bike_staff_daily.sql
[0m20:53:59.900041 [debug] [MainThread]: 1699: static parser successfully parsed silver/int_src_local_bike_store_shipped_order.sql
[0m20:53:59.906092 [debug] [MainThread]: 1699: static parser successfully parsed silver/int_src_local_bike_staff_hierarchy.sql
[0m20:53:59.912405 [debug] [MainThread]: 1699: static parser successfully parsed silver/int_src_local_bike_product_daily.sql
[0m20:53:59.919018 [debug] [MainThread]: 1699: static parser successfully parsed gold/mrt_stores_ranking_yearly.sql
[0m20:53:59.924635 [debug] [MainThread]: 1603: static parser failed on gold/mrt_stores_sales_monthly.sql
[0m20:53:59.935710 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/mrt_stores_sales_monthly.sql
[0m20:53:59.939076 [debug] [MainThread]: 1699: static parser successfully parsed gold/mrt_order_shipped_aborted_montly.sql
[0m20:53:59.945180 [debug] [MainThread]: 1603: static parser failed on gold/mrt_stores_items_monthly.sql
[0m20:53:59.955097 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/mrt_stores_items_monthly.sql
[0m20:53:59.958322 [debug] [MainThread]: 1699: static parser successfully parsed gold/mrt_order_shipped_montly.sql
[0m20:53:59.963826 [debug] [MainThread]: 1603: static parser failed on gold/mrt_products_brands_monthly.sql
[0m20:53:59.990683 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/mrt_products_brands_monthly.sql
[0m20:53:59.995070 [debug] [MainThread]: 1699: static parser successfully parsed gold/mrt_sales_seasons_yearly.sql
[0m20:54:00.002429 [debug] [MainThread]: 1699: static parser successfully parsed gold/mrt_staff_ranking_yearly.sql
[0m20:54:00.009858 [debug] [MainThread]: 1603: static parser failed on gold/mrt_staff_sales_monthly.sql
[0m20:54:00.022032 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/mrt_staff_sales_monthly.sql
[0m20:54:00.025362 [debug] [MainThread]: 1699: static parser successfully parsed gold/mrt_products_ranking_yearly_top3.sql
[0m20:54:00.031078 [debug] [MainThread]: 1603: static parser failed on bronze/stg_src_local_bike_orders.sql
[0m20:54:00.189364 [debug] [MainThread]: 1602: parser fallback to jinja rendering on bronze/stg_src_local_bike_orders.sql
[0m20:54:00.192340 [debug] [MainThread]: 1699: static parser successfully parsed bronze/stg_src_local_bike_stocks.sql
[0m20:54:00.197961 [debug] [MainThread]: 1603: static parser failed on bronze/stg_src_local_bike_order_items.sql
[0m20:54:00.207509 [debug] [MainThread]: 1602: parser fallback to jinja rendering on bronze/stg_src_local_bike_order_items.sql
[0m20:54:00.210584 [debug] [MainThread]: 1699: static parser successfully parsed bronze/stg_src_local_bike_customers.sql
[0m20:54:00.215767 [debug] [MainThread]: 1699: static parser successfully parsed bronze/stg_src_local_bike_staffs.sql
[0m20:54:00.221291 [debug] [MainThread]: 1699: static parser successfully parsed bronze/stg_src_local_bike_categories.sql
[0m20:54:00.226423 [debug] [MainThread]: 1699: static parser successfully parsed bronze/stg_src_local_bike_products.sql
[0m20:54:00.231312 [debug] [MainThread]: 1699: static parser successfully parsed bronze/stg_src_local_bike_stores.sql
[0m20:54:00.237116 [debug] [MainThread]: 1699: static parser successfully parsed bronze/stg_src_local_bike_brands.sql
[0m20:54:00.634203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b3535c5-f029-4c80-898a-235a611c458a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c233ba8a780>]}
[0m20:54:00.658108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b3535c5-f029-4c80-898a-235a611c458a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c233b961eb0>]}
[0m20:54:00.659186 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m20:54:00.659923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b3535c5-f029-4c80-898a-235a611c458a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c233b48e210>]}
[0m20:54:00.663148 [info ] [MainThread]: 
[0m20:54:00.664743 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:54:00.667728 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m20:54:00.668599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:01.181771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now create_databird-473015_dbt_bike_bronze)
[0m20:54:01.183163 [debug] [ThreadPool]: Creating schema "database: "databird-473015"
schema: "dbt_bike_bronze"
"
[0m20:54:01.190548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:01.192853 [debug] [ThreadPool]: On create_databird-473015_dbt_bike_bronze: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "create_databird-473015_dbt_bike_bronze"} */
create schema if not exists `databird-473015`.`dbt_bike_bronze`
  
[0m20:54:02.314991 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:80308c30-6350-4f18-b0db-f708808a2fa7&page=queryresults
[0m20:54:02.320259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_databird-473015_dbt_bike_bronze, now list_databird-473015_dbt_bike_seeds)
[0m20:54:02.321418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:02.322711 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m20:54:02.323727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:02.366136 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m20:54:02.368267 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m20:54:02.407925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:02.411345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:02.759748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b3535c5-f029-4c80-898a-235a611c458a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c233b45f800>]}
[0m20:54:02.761708 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:54:02.762583 [info ] [MainThread]: 
[0m20:54:02.809681 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_brands
[0m20:54:02.810632 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_bike_bronze.stg_src_local_bike_brands .......... [RUN]
[0m20:54:02.812623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.stg_src_local_bike_brands)
[0m20:54:02.813416 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_brands
[0m20:54:02.819322 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_brands"
[0m20:54:02.820772 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (compile): 20:54:02.813886 => 20:54:02.820376
[0m20:54:02.821261 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_brands
[0m20:54:02.874392 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_brands"
[0m20:54:02.875752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:02.878090 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_brands: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_brands"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
  OPTIONS(
      description="""Bike brands sold by Local Bike."""
    )
  as select
        brand_id as brand_id,
        INITCAP(brand_name) as brand_name
from `databird-473015`.`src_local_bike`.`brands`;


[0m20:54:03.743680 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:f35dd0b5-33f1-455f-a482-065da857b68b&page=queryresults
[0m20:54:04.141194 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (execute): 20:54:02.821553 => 20:54:04.140789
[0m20:54:04.142601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b3535c5-f029-4c80-898a-235a611c458a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c233b367cb0>]}
[0m20:54:04.143631 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_bike_bronze.stg_src_local_bike_brands ..... [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m20:54:04.145070 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_brands
[0m20:54:04.149039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:04.149615 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_seeds' was properly closed.
[0m20:54:04.150030 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_gold' was properly closed.
[0m20:54:04.150326 [debug] [MainThread]: Connection 'model.local_bike.stg_src_local_bike_brands' was properly closed.
[0m20:54:04.150665 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_silver' was properly closed.
[0m20:54:04.151292 [info ] [MainThread]: 
[0m20:54:04.152051 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.49 seconds (3.49s).
[0m20:54:04.153984 [debug] [MainThread]: Command end result
[0m20:54:04.181660 [info ] [MainThread]: 
[0m20:54:04.182949 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:54:04.183617 [info ] [MainThread]: 
[0m20:54:04.184641 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:54:04.186077 [debug] [MainThread]: Command `dbt run` succeeded at 20:54:04.185791 after 10.12 seconds
[0m20:54:04.186733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2353ad8fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c23539514f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c23539bba10>]}
[0m20:54:04.187697 [debug] [MainThread]: Flushing usage events
[0m20:54:35.993466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff521eda60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff5259aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff51fe37d0>]}


============================== 20:54:36.000426 | fce36b97-367d-4768-a72e-7b09c9c15b4d ==============================
[0m20:54:36.000426 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:54:36.002006 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'introspect': 'True', 'log_format': 'default', 'printer_width': '80', 'use_experimental_parser': 'False', 'use_colors': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'partial_parse': 'True', 'log_path': '/usr/app/dbt/logs', 'cache_selected_only': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'no_print': 'None', 'profiles_dir': '/root/.dbt', 'warn_error': 'None', 'quiet': 'False', 'debug': 'False'}
[0m20:54:37.603356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fce36b97-367d-4768-a72e-7b09c9c15b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff51e244a0>]}
[0m20:54:37.627523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fce36b97-367d-4768-a72e-7b09c9c15b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff3a2e8b00>]}
[0m20:54:37.681647 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m20:54:37.784223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:54:37.784920 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:54:37.796687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fce36b97-367d-4768-a72e-7b09c9c15b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff3a4ca3c0>]}
[0m20:54:37.821470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fce36b97-367d-4768-a72e-7b09c9c15b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff3a148b00>]}
[0m20:54:37.822383 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m20:54:37.823121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fce36b97-367d-4768-a72e-7b09c9c15b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff3a42fbf0>]}
[0m20:54:37.827464 [info ] [MainThread]: 
[0m20:54:37.829313 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:54:37.831785 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m20:54:37.832492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:38.400792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_seeds)
[0m20:54:38.402019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:38.403350 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m20:54:38.404377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:38.408861 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m20:54:38.453444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:38.458342 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m20:54:38.465187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:38.873274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fce36b97-367d-4768-a72e-7b09c9c15b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff3abd2930>]}
[0m20:54:38.874825 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:54:38.875854 [info ] [MainThread]: 
[0m20:54:38.885404 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_brands
[0m20:54:38.886501 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_categories
[0m20:54:38.887292 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_customers
[0m20:54:38.888897 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_order_items
[0m20:54:38.888147 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_bike_bronze.stg_src_local_bike_brands .......... [RUN]
[0m20:54:38.889946 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_bike_bronze.stg_src_local_bike_categories ...... [RUN]
[0m20:54:38.897134 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.stg_src_local_bike_categories)
[0m20:54:38.895487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.stg_src_local_bike_brands)
[0m20:54:38.893167 [info ] [Thread-4 (]: 4 of 9 START sql view model dbt_bike_bronze.stg_src_local_bike_order_items ..... [RUN]
[0m20:54:38.891111 [info ] [Thread-3 (]: 3 of 9 START sql view model dbt_bike_bronze.stg_src_local_bike_customers ....... [RUN]
[0m20:54:38.898072 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_categories
[0m20:54:38.898708 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_brands
[0m20:54:38.900012 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.stg_src_local_bike_order_items)
[0m20:54:38.901111 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.stg_src_local_bike_customers)
[0m20:54:38.907732 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_categories"
[0m20:54:38.914161 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_brands"
[0m20:54:38.914984 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_order_items
[0m20:54:38.915718 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_customers
[0m20:54:38.928190 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_order_items"
[0m20:54:38.938924 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (compile): 20:54:38.908344 => 20:54:38.938251
[0m20:54:38.939997 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (compile): 20:54:38.916566 => 20:54:38.939517
[0m20:54:38.940780 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_brands
[0m20:54:38.943235 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (compile): 20:54:38.901569 => 20:54:38.942714
[0m20:54:38.946017 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_order_items
[0m20:54:38.969918 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_customers"
[0m20:54:38.991992 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_categories
[0m20:54:39.029450 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_brands"
[0m20:54:39.031062 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_order_items"
[0m20:54:39.037078 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_categories"
[0m20:54:39.038652 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (compile): 20:54:38.921938 => 20:54:39.038198
[0m20:54:39.040781 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_customers
[0m20:54:39.040042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:39.041477 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:54:39.042027 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:54:39.047980 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_customers"
[0m20:54:39.050756 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_brands: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_brands"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
  OPTIONS(
      description="""Bike brands sold by Local Bike."""
    )
  as select
        brand_id as brand_id,
        INITCAP(brand_name) as brand_name
from `databird-473015`.`src_local_bike`.`brands`;


[0m20:54:39.053022 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_order_items: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_order_items"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
  OPTIONS(
      description="""Detailed order line items with pricing and discounts."""
    )
  as SELECT
  order_id as order_id,
  item_id AS item_id,
  product_id as product_id,
  quantity as quantity,
  list_price as list_price,
  discount as discount,
  
    list_price * quantity * ( 1 - discount )
 AS total_item_discount_sold
FROM `databird-473015`.`src_local_bike`.`order_items`;


[0m20:54:39.136046 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_categories: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_categories"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_categories`
  OPTIONS(
      description="""Product categories such as road, mountain, and electric bikes."""
    )
  as select
        category_id as category_id,
        INITCAP(category_name) as category_name
from `databird-473015`.`src_local_bike`.`categories`;


[0m20:54:39.137953 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:54:39.188628 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_customers: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_customers"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_customers`
  OPTIONS(
      description="""Customer informations."""
    )
  as select
    customer_id as customer_id,
    INITCAP(first_name) as customer_first_name,
    INITCAP(last_name) as customer_last_name,
    phone as customer_phone,
    email as customer_email,
    INITCAP(street) as customer_street,
    INITCAP(city) as customer_city,
    UPPER(state) as customer_state,
    zip_code as customer_zip_code
from `databird-473015`.`src_local_bike`.`customers`;


[0m20:54:39.849712 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:2bb1e742-64ab-4e79-8421-b47461eae11c&page=queryresults
[0m20:54:39.881860 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:8ef2e799-fa3f-4e2c-a649-a504a8c47475&page=queryresults
[0m20:54:39.888281 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:5f7a4ff1-1a84-4f91-84c4-1902c0a4a1a4&page=queryresults
[0m20:54:39.919624 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:81c82d8c-61fc-4034-ac24-14d1022af812&page=queryresults
[0m20:54:40.201197 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (execute): 20:54:38.953539 => 20:54:40.200821
[0m20:54:40.203300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce36b97-367d-4768-a72e-7b09c9c15b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff3a0f2960>]}
[0m20:54:40.204429 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dbt_bike_bronze.stg_src_local_bike_brands ..... [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m20:54:40.206083 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_brands
[0m20:54:40.207703 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (execute): 20:54:39.042369 => 20:54:40.207399
[0m20:54:40.208394 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_orders
[0m20:54:40.209880 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce36b97-367d-4768-a72e-7b09c9c15b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff39edb590>]}
[0m20:54:40.210617 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_bike_bronze.stg_src_local_bike_orders .......... [RUN]
[0m20:54:40.211980 [info ] [Thread-3 (]: 3 of 9 OK created sql view model dbt_bike_bronze.stg_src_local_bike_customers .. [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m20:54:40.214316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_brands, now model.local_bike.stg_src_local_bike_orders)
[0m20:54:40.215680 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_customers
[0m20:54:40.216420 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_orders
[0m20:54:40.217293 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_products
[0m20:54:40.225574 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (execute): 20:54:39.007224 => 20:54:40.225250
[0m20:54:40.226357 [info ] [Thread-3 (]: 6 of 9 START sql view model dbt_bike_bronze.stg_src_local_bike_products ........ [RUN]
[0m20:54:40.238961 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce36b97-367d-4768-a72e-7b09c9c15b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff39ed8320>]}
[0m20:54:40.239915 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_orders"
[0m20:54:40.241202 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_customers, now model.local_bike.stg_src_local_bike_products)
[0m20:54:40.242365 [info ] [Thread-4 (]: 4 of 9 OK created sql view model dbt_bike_bronze.stg_src_local_bike_order_items  [[32mCREATE VIEW (0 processed)[0m in 1.34s]
[0m20:54:40.244118 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (compile): 20:54:40.217782 => 20:54:40.243652
[0m20:54:40.244747 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_products
[0m20:54:40.245675 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_order_items
[0m20:54:40.246276 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_orders
[0m20:54:40.252110 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_products"
[0m20:54:40.253686 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_staffs
[0m20:54:40.260254 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_orders"
[0m20:54:40.262274 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (execute): 20:54:39.031740 => 20:54:40.261936
[0m20:54:40.263174 [info ] [Thread-4 (]: 7 of 9 START sql view model dbt_bike_bronze.stg_src_local_bike_staffs .......... [RUN]
[0m20:54:40.265006 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_products (compile): 20:54:40.246655 => 20:54:40.264325
[0m20:54:40.267286 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce36b97-367d-4768-a72e-7b09c9c15b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff3a0f21e0>]}
[0m20:54:40.269055 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_order_items, now model.local_bike.stg_src_local_bike_staffs)
[0m20:54:40.270069 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_products
[0m20:54:40.272155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:40.271208 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_bike_bronze.stg_src_local_bike_categories . [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m20:54:40.273015 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_staffs
[0m20:54:40.279575 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_products"
[0m20:54:40.281013 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_categories
[0m20:54:40.287430 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_staffs"
[0m20:54:40.290036 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_orders: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_orders"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`
  OPTIONS(
      description="""Order headers with key dates and statuses"""
    )
  as select
    order_id as order_id,
    customer_id as customer_id,
    order_status as order_status,
    CAST(order_date as date) as order_date,
    CAST(required_date as date) as required_date,
    CAST(shipped_date as date) as shipped_date,
    store_id as store_id,
    staff_id as staff_id,
    
    CASE
        WHEN EXTRACT(MONTH FROM order_date) IN (12, 1, 2) THEN 'Winter'
        WHEN EXTRACT(MONTH FROM order_date) IN (3, 4, 5) THEN 'Spring'
        WHEN EXTRACT(MONTH FROM order_date) IN (6, 7, 8) THEN 'Summer'
        WHEN EXTRACT(MONTH FROM order_date) IN (9, 10, 11) THEN 'Autumn'
    END
 AS season_name
from `databird-473015`.`src_local_bike`.`orders`;


[0m20:54:40.291126 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_stocks
[0m20:54:40.333623 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (compile): 20:54:40.281607 => 20:54:40.332059
[0m20:54:40.336326 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_staffs
[0m20:54:40.334942 [info ] [Thread-2 (]: 8 of 9 START sql view model dbt_bike_bronze.stg_src_local_bike_stocks .......... [RUN]
[0m20:54:40.342543 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:54:40.345939 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_staffs"
[0m20:54:40.352056 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:54:40.347514 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_categories, now model.local_bike.stg_src_local_bike_stocks)
[0m20:54:40.353298 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_stocks
[0m20:54:40.360537 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_products"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_products`
  OPTIONS(
      description="""Products sold, linked to brands and categories."""
    )
  as select
        product_id as product_id,
        INITCAP(product_name) as product_name,
        brand_id as brand_id,
        category_id as category_id,
        model_year as model_year,
        coalesce(list_price,0) as list_price
from `databird-473015`.`src_local_bike`.`products`;


[0m20:54:40.366918 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stocks"
[0m20:54:40.367947 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_staffs: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_staffs"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs`
  OPTIONS(
      description="""Sales and management staff working in Local Bike stores."""
    )
  as select
    CAST(staff_id AS int) as staff_id,
    INITCAP(first_name) as staff_first_name,
    INITCAP(last_name) as staff_last_name,
    phone as staff_phone,
    email as staff_email,
    active as staff_active,
    store_id as store_id,
    CAST(manager_id AS int)  as manager_id
from `databird-473015`.`src_local_bike`.`staffs`;


[0m20:54:40.410341 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (compile): 20:54:40.353779 => 20:54:40.408853
[0m20:54:40.450095 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_stocks
[0m20:54:40.466142 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_stocks"
[0m20:54:40.468615 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:54:40.478219 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_stocks: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_stocks"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stocks`
  OPTIONS(
      description="""Stock of products and availability."""
    )
  as select
    store_id   as store_id,
    product_id as product_id,
    quantity   as stock_quantity
from `databird-473015`.`src_local_bike`.`stocks`;


[0m20:54:41.192177 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:866ec56b-32f6-40c0-8e50-87b26ea2f3f4&page=queryresults
[0m20:54:41.207848 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:ef357718-85a8-4a8e-83a1-7a557f87b296&page=queryresults
[0m20:54:41.267949 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:cd45c04c-a72f-40b1-b2b3-6d1e834196b7&page=queryresults
[0m20:54:41.503686 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_products (execute): 20:54:40.273465 => 20:54:41.503329
[0m20:54:41.505377 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce36b97-367d-4768-a72e-7b09c9c15b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff38517d70>]}
[0m20:54:41.506300 [info ] [Thread-3 (]: 6 of 9 OK created sql view model dbt_bike_bronze.stg_src_local_bike_products ... [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m20:54:41.507604 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_products
[0m20:54:41.508274 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_stores
[0m20:54:41.509176 [info ] [Thread-3 (]: 9 of 9 START sql view model dbt_bike_bronze.stg_src_local_bike_stores .......... [RUN]
[0m20:54:41.510883 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_products, now model.local_bike.stg_src_local_bike_stores)
[0m20:54:41.511854 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_stores
[0m20:54:41.519118 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stores"
[0m20:54:41.520552 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_stores (compile): 20:54:41.512320 => 20:54:41.519998
[0m20:54:41.521213 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_stores
[0m20:54:41.526839 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_stores"
[0m20:54:41.529843 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:bd5e7685-c985-439c-915d-2033efebd0b5&page=queryresults
[0m20:54:41.534188 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:54:41.536692 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_stores: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_stores"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`
  OPTIONS(
      description="""Store locations in California, New York, and Texas."""
    )
  as select
    store_id as store_id,
    INITCAP(store_name) as store_name,
    phone as store_phone,
    email as store_email,
    street as store_street,
    INITCAP(city) as store_city,
    UPPER(state) as store_state,
    zip_code as store_zip_code
from `databird-473015`.`src_local_bike`.`stores`;


[0m20:54:41.578863 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (execute): 20:54:40.336957 => 20:54:41.578291
[0m20:54:41.583124 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce36b97-367d-4768-a72e-7b09c9c15b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff39ed83b0>]}
[0m20:54:41.585067 [info ] [Thread-4 (]: 7 of 9 OK created sql view model dbt_bike_bronze.stg_src_local_bike_staffs ..... [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m20:54:41.589065 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_staffs
[0m20:54:41.609096 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (execute): 20:54:40.254706 => 20:54:41.608490
[0m20:54:41.613097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce36b97-367d-4768-a72e-7b09c9c15b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff39ecd730>]}
[0m20:54:41.615341 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_bike_bronze.stg_src_local_bike_orders ..... [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m20:54:41.622762 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_orders
[0m20:54:41.820217 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (execute): 20:54:40.452766 => 20:54:41.819901
[0m20:54:41.821399 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce36b97-367d-4768-a72e-7b09c9c15b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff3856cda0>]}
[0m20:54:41.822254 [info ] [Thread-2 (]: 8 of 9 OK created sql view model dbt_bike_bronze.stg_src_local_bike_stocks ..... [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m20:54:41.823491 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_stocks
[0m20:54:42.226703 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:478f096d-1e44-4dd3-9e16-442c51682ff8&page=queryresults
[0m20:54:42.497996 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_stores (execute): 20:54:41.521726 => 20:54:42.497623
[0m20:54:42.499552 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce36b97-367d-4768-a72e-7b09c9c15b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff3856cda0>]}
[0m20:54:42.500555 [info ] [Thread-3 (]: 9 of 9 OK created sql view model dbt_bike_bronze.stg_src_local_bike_stores ..... [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m20:54:42.502020 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_stores
[0m20:54:42.505948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:42.506411 [debug] [MainThread]: Connection 'model.local_bike.stg_src_local_bike_staffs' was properly closed.
[0m20:54:42.506696 [debug] [MainThread]: Connection 'model.local_bike.stg_src_local_bike_stores' was properly closed.
[0m20:54:42.507065 [debug] [MainThread]: Connection 'model.local_bike.stg_src_local_bike_orders' was properly closed.
[0m20:54:42.507331 [debug] [MainThread]: Connection 'model.local_bike.stg_src_local_bike_stocks' was properly closed.
[0m20:54:42.507742 [info ] [MainThread]: 
[0m20:54:42.508576 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 4.68 seconds (4.68s).
[0m20:54:42.513825 [debug] [MainThread]: Command end result
[0m20:54:42.551058 [info ] [MainThread]: 
[0m20:54:42.552191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:54:42.552956 [info ] [MainThread]: 
[0m20:54:42.553673 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m20:54:42.554781 [debug] [MainThread]: Command `dbt run` succeeded at 20:54:42.554534 after 6.57 seconds
[0m20:54:42.555436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff521eda60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff51fa86b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cff55c6ea20>]}
[0m20:54:42.556136 [debug] [MainThread]: Flushing usage events
[0m20:55:12.453875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777bab2f5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777bab2763c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777babb6cb60>]}


============================== 20:55:12.460512 | 2b6549fb-f234-4c80-b4e0-bbd7b96f5830 ==============================
[0m20:55:12.460512 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:55:12.461773 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'printer_width': '80', 'static_parser': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'no_print': 'None', 'use_colors': 'True'}
[0m20:55:14.031336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b6549fb-f234-4c80-b4e0-bbd7b96f5830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b936bbc20>]}
[0m20:55:14.055733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b6549fb-f234-4c80-b4e0-bbd7b96f5830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b936da780>]}
[0m20:55:14.107471 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m20:55:14.189603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:55:14.190209 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:55:14.200529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b6549fb-f234-4c80-b4e0-bbd7b96f5830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b98183800>]}
[0m20:55:14.224040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b6549fb-f234-4c80-b4e0-bbd7b96f5830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b9320be90>]}
[0m20:55:14.224841 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m20:55:14.228164 [info ] [MainThread]: 
[0m20:55:14.229781 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:55:14.232990 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m20:55:14.233872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:14.726519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_seeds)
[0m20:55:14.727445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:14.728575 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m20:55:14.729467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:14.776049 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m20:55:14.776961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:14.825238 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m20:55:14.865008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:15.219312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b6549fb-f234-4c80-b4e0-bbd7b96f5830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b937bf380>]}
[0m20:55:15.220912 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:55:15.221611 [info ] [MainThread]: 
[0m20:55:15.230235 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_brands
[0m20:55:15.231060 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_categories
[0m20:55:15.231671 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_customers
[0m20:55:15.232268 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_order_items
[0m20:55:15.233301 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_bike_bronze.stg_src_local_bike_brands ......... [RUN]
[0m20:55:15.234329 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_bike_bronze.stg_src_local_bike_categories ..... [RUN]
[0m20:55:15.235355 [info ] [Thread-3 (]: 3 of 10 START sql view model dbt_bike_bronze.stg_src_local_bike_customers ...... [RUN]
[0m20:55:15.238879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.stg_src_local_bike_brands)
[0m20:55:15.240573 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.stg_src_local_bike_categories)
[0m20:55:15.236909 [info ] [Thread-4 (]: 4 of 10 START sql view model dbt_bike_bronze.stg_src_local_bike_order_items .... [RUN]
[0m20:55:15.242069 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.stg_src_local_bike_customers)
[0m20:55:15.242737 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_brands
[0m20:55:15.243597 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_categories
[0m20:55:15.244623 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.stg_src_local_bike_order_items)
[0m20:55:15.245230 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_customers
[0m20:55:15.255361 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_categories"
[0m20:55:15.250662 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_brands"
[0m20:55:15.256566 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_order_items
[0m20:55:15.261264 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_customers"
[0m20:55:15.267617 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (compile): 20:55:15.250952 => 20:55:15.267111
[0m20:55:15.268232 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_categories
[0m20:55:15.296155 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (compile): 20:55:15.245632 => 20:55:15.295578
[0m20:55:15.302104 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_brands
[0m20:55:15.303003 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (compile): 20:55:15.256994 => 20:55:15.302602
[0m20:55:15.330820 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_customers
[0m20:55:15.354125 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_brands"
[0m20:55:15.357317 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_categories"
[0m20:55:15.367172 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_customers"
[0m20:55:15.374409 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_order_items"
[0m20:55:15.375766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:15.376764 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:55:15.377449 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:55:15.378727 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (compile): 20:55:15.262121 => 20:55:15.378321
[0m20:55:15.385125 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_order_items
[0m20:55:15.384316 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_customers: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_customers"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_customers`
  OPTIONS(
      description="""Customer informations."""
    )
  as select
    customer_id as customer_id,
    INITCAP(first_name) as customer_first_name,
    INITCAP(last_name) as customer_last_name,
    phone as customer_phone,
    email as customer_email,
    INITCAP(street) as customer_street,
    INITCAP(city) as customer_city,
    UPPER(state) as customer_state,
    zip_code as customer_zip_code
from `databird-473015`.`src_local_bike`.`customers`;


[0m20:55:15.382155 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_brands: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_brands"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
  OPTIONS(
      description="""Bike brands sold by Local Bike."""
    )
  as select
        brand_id as brand_id,
        INITCAP(brand_name) as brand_name
from `databird-473015`.`src_local_bike`.`brands`;


[0m20:55:15.390042 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_order_items"
[0m20:55:15.431134 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_categories: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_categories"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_categories`
  OPTIONS(
      description="""Product categories such as road, mountain, and electric bikes."""
    )
  as select
        category_id as category_id,
        INITCAP(category_name) as category_name
from `databird-473015`.`src_local_bike`.`categories`;


[0m20:55:15.510482 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:55:15.513938 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_order_items: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_order_items"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
  OPTIONS(
      description="""Detailed order line items with pricing and discounts."""
    )
  as SELECT
  order_id as order_id,
  item_id AS item_id,
  product_id as product_id,
  quantity as quantity,
  list_price as list_price,
  discount as discount,
  
    list_price * quantity * ( 1 - discount )
 AS total_item_discount_sold
FROM `databird-473015`.`src_local_bike`.`order_items`;


[0m20:55:16.160455 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:18d184c9-1a9d-40eb-a627-f7a71be85794&page=queryresults
[0m20:55:16.194993 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:dcdee614-3fde-4e95-9ec8-fc7d227efb3c&page=queryresults
[0m20:55:16.197063 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:b20f4ff4-3ff4-44df-972f-390f56b4e880&page=queryresults
[0m20:55:16.219008 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:d966b00b-702f-4f58-8eea-a90a6129ffdd&page=queryresults
[0m20:55:16.499078 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (execute): 20:55:15.385501 => 20:55:16.498739
[0m20:55:16.500239 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b6549fb-f234-4c80-b4e0-bbd7b96f5830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b933117f0>]}
[0m20:55:16.501092 [info ] [Thread-4 (]: 4 of 10 OK created sql view model dbt_bike_bronze.stg_src_local_bike_order_items  [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m20:55:16.502366 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_order_items
[0m20:55:16.503014 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_orders
[0m20:55:16.503660 [info ] [Thread-4 (]: 5 of 10 START sql view model dbt_bike_bronze.stg_src_local_bike_orders ......... [RUN]
[0m20:55:16.505377 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_order_items, now model.local_bike.stg_src_local_bike_orders)
[0m20:55:16.505904 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_orders
[0m20:55:16.513431 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_orders"
[0m20:55:16.515391 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_orders (compile): 20:55:16.506167 => 20:55:16.514974
[0m20:55:16.516021 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_orders
[0m20:55:16.522945 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (execute): 20:55:15.336551 => 20:55:16.522580
[0m20:55:16.523376 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_orders"
[0m20:55:16.524551 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b6549fb-f234-4c80-b4e0-bbd7b96f5830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b93311640>]}
[0m20:55:16.525716 [info ] [Thread-3 (]: 3 of 10 OK created sql view model dbt_bike_bronze.stg_src_local_bike_customers . [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m20:55:16.527097 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_customers
[0m20:55:16.527741 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_products
[0m20:55:16.528408 [info ] [Thread-3 (]: 6 of 10 START sql view model dbt_bike_bronze.stg_src_local_bike_products ....... [RUN]
[0m20:55:16.529754 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_customers, now model.local_bike.stg_src_local_bike_products)
[0m20:55:16.530548 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_products
[0m20:55:16.535505 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_products"
[0m20:55:16.536128 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:55:16.538480 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_orders: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_orders"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`
  OPTIONS(
      description="""Order headers with key dates and statuses"""
    )
  as select
    order_id as order_id,
    customer_id as customer_id,
    order_status as order_status,
    CAST(order_date as date) as order_date,
    CAST(required_date as date) as required_date,
    CAST(shipped_date as date) as shipped_date,
    store_id as store_id,
    staff_id as staff_id,
    
    CASE
        WHEN EXTRACT(MONTH FROM order_date) IN (12, 1, 2) THEN 'Winter'
        WHEN EXTRACT(MONTH FROM order_date) IN (3, 4, 5) THEN 'Spring'
        WHEN EXTRACT(MONTH FROM order_date) IN (6, 7, 8) THEN 'Summer'
        WHEN EXTRACT(MONTH FROM order_date) IN (9, 10, 11) THEN 'Autumn'
    END
 AS season_name
from `databird-473015`.`src_local_bike`.`orders`;


[0m20:55:16.578699 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_products (compile): 20:55:16.531132 => 20:55:16.578245
[0m20:55:16.580489 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (execute): 20:55:15.268590 => 20:55:16.580208
[0m20:55:16.583056 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b6549fb-f234-4c80-b4e0-bbd7b96f5830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b934efc80>]}
[0m20:55:16.581088 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_products
[0m20:55:16.584200 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_bike_bronze.stg_src_local_bike_categories  [[32mCREATE VIEW (0 processed)[0m in 1.34s]
[0m20:55:16.595087 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_categories
[0m20:55:16.596126 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_staffs
[0m20:55:16.597202 [info ] [Thread-2 (]: 7 of 10 START sql view model dbt_bike_bronze.stg_src_local_bike_staffs ......... [RUN]
[0m20:55:16.605887 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_categories, now model.local_bike.stg_src_local_bike_staffs)
[0m20:55:16.615413 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_products"
[0m20:55:16.619259 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:55:16.618147 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_staffs
[0m20:55:16.617560 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (execute): 20:55:15.318669 => 20:55:16.617187
[0m20:55:16.622049 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_products"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_products`
  OPTIONS(
      description="""Products sold, linked to brands and categories."""
    )
  as select
        product_id as product_id,
        INITCAP(product_name) as product_name,
        brand_id as brand_id,
        category_id as category_id,
        model_year as model_year,
        coalesce(list_price,0) as list_price
from `databird-473015`.`src_local_bike`.`products`;


[0m20:55:16.627045 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_staffs"
[0m20:55:16.628638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b6549fb-f234-4c80-b4e0-bbd7b96f5830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b932ffef0>]}
[0m20:55:16.670350 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (compile): 20:55:16.622566 => 20:55:16.669656
[0m20:55:16.671611 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_bike_bronze.stg_src_local_bike_brands .... [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m20:55:16.672837 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_staffs
[0m20:55:16.675288 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_brands
[0m20:55:16.682359 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_stocks
[0m20:55:16.683174 [info ] [Thread-1 (]: 8 of 10 START sql view model dbt_bike_bronze.stg_src_local_bike_stocks ......... [RUN]
[0m20:55:16.685503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_brands, now model.local_bike.stg_src_local_bike_stocks)
[0m20:55:16.689309 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_stocks
[0m20:55:16.688435 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_staffs"
[0m20:55:16.696869 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:55:16.698431 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stocks"
[0m20:55:16.706558 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (compile): 20:55:16.689747 => 20:55:16.705861
[0m20:55:16.708522 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_stocks
[0m20:55:16.707589 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_staffs: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_staffs"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs`
  OPTIONS(
      description="""Sales and management staff working in Local Bike stores."""
    )
  as select
    CAST(staff_id AS int) as staff_id,
    INITCAP(first_name) as staff_first_name,
    INITCAP(last_name) as staff_last_name,
    phone as staff_phone,
    email as staff_email,
    active as staff_active,
    store_id as store_id,
    CAST(manager_id AS int)  as manager_id
from `databird-473015`.`src_local_bike`.`staffs`;


[0m20:55:16.756326 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_stocks"
[0m20:55:16.760727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:16.766470 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_stocks: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_stocks"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stocks`
  OPTIONS(
      description="""Stock of products and availability."""
    )
  as select
    store_id   as store_id,
    product_id as product_id,
    quantity   as stock_quantity
from `databird-473015`.`src_local_bike`.`stocks`;


[0m20:55:17.247386 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:b7180eb3-f9d9-400d-b644-4256bb7bd3c8&page=queryresults
[0m20:55:17.322377 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:ea8fd25f-5ae6-4562-9e25-3297fb2ef5bc&page=queryresults
[0m20:55:17.595965 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_orders (execute): 20:55:16.516354 => 20:55:17.595552
[0m20:55:17.597345 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b6549fb-f234-4c80-b4e0-bbd7b96f5830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b932d72f0>]}
[0m20:55:17.598408 [info ] [Thread-4 (]: 5 of 10 OK created sql view model dbt_bike_bronze.stg_src_local_bike_orders .... [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m20:55:17.599698 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_orders
[0m20:55:17.600474 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_stores
[0m20:55:17.601257 [info ] [Thread-4 (]: 9 of 10 START sql view model dbt_bike_bronze.stg_src_local_bike_stores ......... [RUN]
[0m20:55:17.603282 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_orders, now model.local_bike.stg_src_local_bike_stores)
[0m20:55:17.604484 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_stores
[0m20:55:17.611714 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stores"
[0m20:55:17.615070 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_stores (compile): 20:55:17.605163 => 20:55:17.614459
[0m20:55:17.616939 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_products (execute): 20:55:16.585327 => 20:55:17.616612
[0m20:55:17.617532 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_stores
[0m20:55:17.619656 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:7c157af1-dfd3-433a-8f70-438f98aced01&page=queryresults
[0m20:55:17.621058 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b6549fb-f234-4c80-b4e0-bbd7b96f5830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b9356d490>]}
[0m20:55:17.626938 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_stores"
[0m20:55:17.631169 [info ] [Thread-3 (]: 6 of 10 OK created sql view model dbt_bike_bronze.stg_src_local_bike_products .. [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m20:55:17.633242 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_products
[0m20:55:17.634380 [debug] [Thread-3 (]: Began running node test.local_bike.assert_total_order_amount_is_positive
[0m20:55:17.635248 [info ] [Thread-3 (]: 10 of 10 START test assert_total_order_amount_is_positive ...................... [RUN]
[0m20:55:17.636990 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_products, now test.local_bike.assert_total_order_amount_is_positive)
[0m20:55:17.639409 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:55:17.640043 [debug] [Thread-3 (]: Began compiling node test.local_bike.assert_total_order_amount_is_positive
[0m20:55:17.649052 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_stores: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_stores"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`
  OPTIONS(
      description="""Store locations in California, New York, and Texas."""
    )
  as select
    store_id as store_id,
    INITCAP(store_name) as store_name,
    phone as store_phone,
    email as store_email,
    street as store_street,
    INITCAP(city) as store_city,
    UPPER(state) as store_state,
    zip_code as store_zip_code
from `databird-473015`.`src_local_bike`.`stores`;


[0m20:55:17.702157 [debug] [Thread-3 (]: Writing injected SQL for node "test.local_bike.assert_total_order_amount_is_positive"
[0m20:55:17.706702 [debug] [Thread-3 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (compile): 20:55:17.640736 => 20:55:17.705531
[0m20:55:17.707420 [debug] [Thread-3 (]: Began executing node test.local_bike.assert_total_order_amount_is_positive
[0m20:55:17.735065 [debug] [Thread-3 (]: Writing runtime sql for node "test.local_bike.assert_total_order_amount_is_positive"
[0m20:55:17.736645 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:55:17.740871 [debug] [Thread-3 (]: On test.local_bike.assert_total_order_amount_is_positive: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "test.local_bike.assert_total_order_amount_is_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Refunds have a negative amount, so the total amount should always be >= 0.
-- Therefore return records where total_amount < 0 to make the test fail
select
    order_id,
    sum(total_item_discount_sold) as total_amount  
from `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
group by 1
having total_amount < 0
      
    ) dbt_internal_test
[0m20:55:17.830136 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:ddb2f881-8032-4720-8d08-1b927191066a&page=queryresults
[0m20:55:17.965918 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (execute): 20:55:16.709060 => 20:55:17.965532
[0m20:55:17.967191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b6549fb-f234-4c80-b4e0-bbd7b96f5830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b934ee900>]}
[0m20:55:17.968175 [info ] [Thread-1 (]: 8 of 10 OK created sql view model dbt_bike_bronze.stg_src_local_bike_stocks .... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m20:55:17.969633 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_stocks
[0m20:55:18.137173 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (execute): 20:55:16.676727 => 20:55:18.136726
[0m20:55:18.138582 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b6549fb-f234-4c80-b4e0-bbd7b96f5830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b9356eed0>]}
[0m20:55:18.139541 [info ] [Thread-2 (]: 7 of 10 OK created sql view model dbt_bike_bronze.stg_src_local_bike_staffs .... [[32mCREATE VIEW (0 processed)[0m in 1.53s]
[0m20:55:18.141076 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_staffs
[0m20:55:18.425571 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:d6f370bd-5f1c-4939-b05d-0965501c1d8e&page=queryresults
[0m20:55:18.745324 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_stores (execute): 20:55:17.621523 => 20:55:18.744909
[0m20:55:18.746638 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b6549fb-f234-4c80-b4e0-bbd7b96f5830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b93217ce0>]}
[0m20:55:18.747500 [info ] [Thread-4 (]: 9 of 10 OK created sql view model dbt_bike_bronze.stg_src_local_bike_stores .... [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m20:55:18.748830 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_stores
[0m20:55:18.762366 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:d1fe2c80-f467-4f5c-829a-07d833728d8b&page=queryresults
[0m20:55:18.764824 [debug] [Thread-3 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (execute): 20:55:17.707713 => 20:55:18.764351
[0m20:55:18.766191 [info ] [Thread-3 (]: 10 of 10 PASS assert_total_order_amount_is_positive ............................ [[32mPASS[0m in 1.13s]
[0m20:55:18.768106 [debug] [Thread-3 (]: Finished running node test.local_bike.assert_total_order_amount_is_positive
[0m20:55:18.772676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:18.773270 [debug] [MainThread]: Connection 'model.local_bike.stg_src_local_bike_stores' was properly closed.
[0m20:55:18.773651 [debug] [MainThread]: Connection 'model.local_bike.stg_src_local_bike_staffs' was properly closed.
[0m20:55:18.774035 [debug] [MainThread]: Connection 'test.local_bike.assert_total_order_amount_is_positive' was properly closed.
[0m20:55:18.774306 [debug] [MainThread]: Connection 'model.local_bike.stg_src_local_bike_stocks' was properly closed.
[0m20:55:18.774705 [info ] [MainThread]: 
[0m20:55:18.775407 [info ] [MainThread]: Finished running 9 view models, 1 test in 0 hours 0 minutes and 4.55 seconds (4.55s).
[0m20:55:18.778860 [debug] [MainThread]: Command end result
[0m20:55:18.798006 [info ] [MainThread]: 
[0m20:55:18.799126 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:55:18.799980 [info ] [MainThread]: 
[0m20:55:18.800945 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m20:55:18.802321 [debug] [MainThread]: Command `dbt build` succeeded at 20:55:18.802057 after 6.36 seconds
[0m20:55:18.802985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777bab6cbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777bab6c8fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b938539b0>]}
[0m20:55:18.803643 [debug] [MainThread]: Flushing usage events
[0m20:57:38.010636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718c8b2b7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718c8bed7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718c8b9b0bf0>]}


============================== 20:57:38.017398 | 1c6a7199-8ee4-4b84-931b-865a84ea8c93 ==============================
[0m20:57:38.017398 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:57:38.018468 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'printer_width': '80', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'quiet': 'False', 'log_format': 'default', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'target_path': 'None', 'write_json': 'True', 'static_parser': 'True', 'use_colors': 'True', 'no_print': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'introspect': 'True'}
[0m20:57:39.643076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c6a7199-8ee4-4b84-931b-865a84ea8c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718c8eb16cf0>]}
[0m20:57:39.666342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c6a7199-8ee4-4b84-931b-865a84ea8c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718c7354ee40>]}
[0m20:57:39.715137 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m20:57:39.792358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:57:39.792953 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:57:39.803278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c6a7199-8ee4-4b84-931b-865a84ea8c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718c73bd20f0>]}
[0m20:57:39.825504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c6a7199-8ee4-4b84-931b-865a84ea8c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718c732a2300>]}
[0m20:57:39.826301 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m20:57:39.827117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c6a7199-8ee4-4b84-931b-865a84ea8c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718c7368a6f0>]}
[0m20:57:39.831863 [info ] [MainThread]: 
[0m20:57:39.833858 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:57:39.837650 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m20:57:39.838577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:39.839781 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m20:57:39.840984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:39.920259 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m20:57:39.921311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:39.923211 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m20:57:39.924162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:40.296642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c6a7199-8ee4-4b84-931b-865a84ea8c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718c732a1ca0>]}
[0m20:57:40.298006 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:57:40.298660 [info ] [MainThread]: 
[0m20:57:40.305391 [debug] [Thread-1 (]: Began running node test.local_bike.assert_total_order_amount_is_positive
[0m20:57:40.306105 [info ] [Thread-1 (]: 1 of 1 START test assert_total_order_amount_is_positive ........................ [RUN]
[0m20:57:40.307599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now test.local_bike.assert_total_order_amount_is_positive)
[0m20:57:40.308265 [debug] [Thread-1 (]: Began compiling node test.local_bike.assert_total_order_amount_is_positive
[0m20:57:40.313708 [debug] [Thread-1 (]: Writing injected SQL for node "test.local_bike.assert_total_order_amount_is_positive"
[0m20:57:40.314753 [debug] [Thread-1 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (compile): 20:57:40.308649 => 20:57:40.314383
[0m20:57:40.315303 [debug] [Thread-1 (]: Began executing node test.local_bike.assert_total_order_amount_is_positive
[0m20:57:40.345429 [debug] [Thread-1 (]: Writing runtime sql for node "test.local_bike.assert_total_order_amount_is_positive"
[0m20:57:40.346584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:40.348831 [debug] [Thread-1 (]: On test.local_bike.assert_total_order_amount_is_positive: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "test.local_bike.assert_total_order_amount_is_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Refunds have a negative amount, so the total amount should always be >= 0.
-- Therefore return records where total_amount < 0 to make the test fail
select
    order_id,
    sum(total_item_discount_sold) as total_amount  
from `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
group by 1
having total_amount < 0
      
    ) dbt_internal_test
[0m20:57:41.228751 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:7faaef8b-1d09-4779-b39f-d9895d1b5c58&page=queryresults
[0m20:57:41.231064 [debug] [Thread-1 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (execute): 20:57:40.315588 => 20:57:41.230631
[0m20:57:41.232389 [info ] [Thread-1 (]: 1 of 1 PASS assert_total_order_amount_is_positive .............................. [[32mPASS[0m in 0.93s]
[0m20:57:41.233782 [debug] [Thread-1 (]: Finished running node test.local_bike.assert_total_order_amount_is_positive
[0m20:57:41.236920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:41.237347 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_seeds' was properly closed.
[0m20:57:41.237638 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_gold' was properly closed.
[0m20:57:41.237974 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_silver' was properly closed.
[0m20:57:41.238247 [debug] [MainThread]: Connection 'test.local_bike.assert_total_order_amount_is_positive' was properly closed.
[0m20:57:41.238578 [info ] [MainThread]: 
[0m20:57:41.239398 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m20:57:41.240759 [debug] [MainThread]: Command end result
[0m20:57:41.274029 [info ] [MainThread]: 
[0m20:57:41.274875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:57:41.275616 [info ] [MainThread]: 
[0m20:57:41.276371 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:57:41.277587 [debug] [MainThread]: Command `dbt test` succeeded at 20:57:41.277303 after 3.28 seconds
[0m20:57:41.278328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718c8b24a8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718c8b20bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718c8ef42990>]}
[0m20:57:41.278988 [debug] [MainThread]: Flushing usage events
[0m20:58:14.567154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370ccefacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370cd434500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370cce29220>]}


============================== 20:58:14.574049 | d6380b40-daa9-48f4-b8ae-bff831c355db ==============================
[0m20:58:14.574049 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:58:14.575194 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'no_print': 'None', 'log_format': 'default', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'debug': 'False', 'fail_fast': 'False', 'printer_width': '80', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'static_parser': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'use_colors': 'True'}
[0m20:58:16.134348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6380b40-daa9-48f4-b8ae-bff831c355db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370b93cd280>]}
[0m20:58:16.157359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6380b40-daa9-48f4-b8ae-bff831c355db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370b9151a00>]}
[0m20:58:16.220394 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m20:58:16.301215 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:58:16.301821 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:58:16.312107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6380b40-daa9-48f4-b8ae-bff831c355db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370ba1336b0>]}
[0m20:58:16.333915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6380b40-daa9-48f4-b8ae-bff831c355db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370b8c93e60>]}
[0m20:58:16.334709 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m20:58:16.335348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6380b40-daa9-48f4-b8ae-bff831c355db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370b9332540>]}
[0m20:58:16.338209 [info ] [MainThread]: 
[0m20:58:16.339791 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:58:16.342425 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m20:58:16.343190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:16.849321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now create_databird-473015_dbt_bike_silver)
[0m20:58:16.850495 [debug] [ThreadPool]: Creating schema "database: "databird-473015"
schema: "dbt_bike_silver"
"
[0m20:58:16.865137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:16.867429 [debug] [ThreadPool]: On create_databird-473015_dbt_bike_silver: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "create_databird-473015_dbt_bike_silver"} */
create schema if not exists `databird-473015`.`dbt_bike_silver`
  
[0m20:58:17.870512 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:0a196da3-f4cd-4623-9ae6-a303dd00d10f&page=queryresults
[0m20:58:17.875059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_databird-473015_dbt_bike_silver, now list_databird-473015_dbt_bike_seeds)
[0m20:58:17.875934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:17.877087 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m20:58:17.877941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:17.917895 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m20:58:17.924840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:18.005857 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m20:58:18.006448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:18.296213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6380b40-daa9-48f4-b8ae-bff831c355db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370b8ca5340>]}
[0m20:58:18.297444 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:58:18.298208 [info ] [MainThread]: 
[0m20:58:18.305866 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_product_daily
[0m20:58:18.306618 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m20:58:18.310050 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_bike_silver.int_src_local_bike_staff_hierarchy . [RUN]
[0m20:58:18.307275 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_store_daily
[0m20:58:18.313090 [info ] [Thread-3 (]: 3 of 5 START sql view model dbt_bike_silver.int_src_local_bike_store_daily ..... [RUN]
[0m20:58:18.307846 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_store_shipped_order
[0m20:58:18.311751 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.int_src_local_bike_staff_hierarchy)
[0m20:58:18.308561 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_bike_silver.int_src_local_bike_product_daily ... [RUN]
[0m20:58:18.315048 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.int_src_local_bike_store_daily)
[0m20:58:18.316071 [info ] [Thread-4 (]: 4 of 5 START sql view model dbt_bike_silver.int_src_local_bike_store_shipped_order  [RUN]
[0m20:58:18.317098 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_staff_hierarchy
[0m20:58:18.318159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.int_src_local_bike_product_daily)
[0m20:58:18.318976 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_store_daily
[0m20:58:18.320031 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.int_src_local_bike_store_shipped_order)
[0m20:58:18.326903 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m20:58:18.327681 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_product_daily
[0m20:58:18.335561 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_daily"
[0m20:58:18.336336 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_store_shipped_order
[0m20:58:18.348754 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m20:58:18.352700 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (compile): 20:58:18.328228 => 20:58:18.352156
[0m20:58:18.358386 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_store_daily
[0m20:58:18.356147 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (compile): 20:58:18.340446 => 20:58:18.355632
[0m20:58:18.373587 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_store_shipped_order
[0m20:58:18.360696 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (compile): 20:58:18.320471 => 20:58:18.360220
[0m20:58:18.395142 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_staff_hierarchy
[0m20:58:18.455044 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_product_daily"
[0m20:58:18.474776 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_store_daily"
[0m20:58:18.478137 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m20:58:18.482012 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m20:58:18.483224 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (compile): 20:58:18.336997 => 20:58:18.482744
[0m20:58:18.484185 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:58:18.484926 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_product_daily
[0m20:58:18.485498 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:58:18.490496 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_product_daily"
[0m20:58:18.491183 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:18.493609 [debug] [Thread-4 (]: On model.local_bike.int_src_local_bike_store_shipped_order: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_shipped_order"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_shipped_order`
  OPTIONS(
      description="""This model provides the list of order required, shipped and aborted per month over 3 years.\r\n\r\nIt provides a comprehensive view of each order, allowing for easy analysis of order performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_shipped_date AS (

  SELECT 
        order_id, 
        order_date,
        required_date,
        shipped_date, 
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    required_date,
    shipped_date,
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_shipped_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.order_id,
    ls.shipped_date ,
    ls.required_date ,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date, ls.shipped_date, ls.required_date,ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m20:58:18.535334 [debug] [Thread-3 (]: On model.local_bike.int_src_local_bike_store_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  OPTIONS(
      description="""This model provides an aggregated view of stores. It enriches the store data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each store.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Total Distinct Items**: The count of distinct product types in the order.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_date AS (

  SELECT 
        order_id, 
        order_date,
        shipped_date,
        required_date,
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    o.shipped_date,
    o.required_date,    
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.shipped_date,
    ls.required_date,     
    ls.order_id,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date,ls.shipped_date,ls.required_date, ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m20:58:18.573677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:18.578664 [debug] [Thread-1 (]: On model.local_bike.int_src_local_bike_product_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_product_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily`
  OPTIONS(
      description="""This model provides an aggregated view of product items. It enriches the products data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each product.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Product Informations**: Enriches the product with user-specific data, such as brand and category.\r\n\r\nIt provides a comprehensive view of each product, allowing for easy analysis of product performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH order_items AS (
  SELECT 
        order_id as order_id,
        item_id as item_id,
        product_id as product_id,
        quantity as quantity,
        list_price as list_price,
        discount as discount,
        ROUND((discount * 100),2) as discount_percent,
        ROUND(total_item_discount_sold, 2) as total_item_discount_sold 
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
),
------------------------------------------
orders_date AS (
  SELECT 
        order_id, 
        CAST(order_date as date) as order_date,
        store_id,
        season_name,
        EXTRACT(YEAR FROM order_date) as yeardate,
        EXTRACT(YEAR FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`
),
------------------------------------------
products AS (
  SELECT 
        product_id as product_id,
        product_name as product_name,
        brand_id as brand_id,
        category_id as category_id,
        model_year as product_model_year,
        ROUND(list_price,2) as list_price
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_products`
),
------------------------------------------
brands AS (
  SELECT 
        brand_id as brand_id,
        brand_name as brand_name
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
),
------------------------------------------
categories AS (
  SELECT 
        category_id as category_id,
        category_name as category_name
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_categories`
)
------------------------------------------
SELECT
  o.order_id,
  o.store_id,
  o.order_date,
  o.yeardate,
  o.monthday,
  o.yearmonth,
  o.month_2digits,
  o.month_name,
  o.month_abbrev,
  o.week_number,
  o.season_name,
  p.product_id,
  p.product_name,
  b.brand_name,
  c.category_name,
  oi.quantity,
  oi.list_price,
  oi.discount,
  oi.discount_percent,
  SUM(oi.total_item_discount_sold) as total_item_discount_sold,
  COUNT(*) as total_items
FROM orders_date as o
LEFT JOIN order_items as oi ON o.order_id = oi.order_id
LEFT JOIN products as p ON oi.product_id = p.product_id
LEFT JOIN brands as b ON p.brand_id = b.brand_id
LEFT JOIN categories as c ON p.category_id = c.category_id
GROUP BY 
  o.order_id,
  o.store_id,
  o.order_date,
  o.yeardate,
  o.monthday,
  o.yearmonth,
  o.month_2digits,
  o.month_name,
  o.month_abbrev,
  o.week_number,
  o.season_name, 
  p.product_id,
  p.product_name,
  b.brand_name,
  c.category_name,
  oi.quantity,
  oi.list_price,
  oi.discount,
  oi.discount_percent
ORDER BY o.yeardate, o.week_number, o.order_id;


[0m20:58:18.581576 [debug] [Thread-2 (]: On model.local_bike.int_src_local_bike_staff_hierarchy: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_hierarchy"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy`
  OPTIONS(
      description="""This model provides an hirarchical view of employees. It enriches the store data with the following data:\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each employe.."""
    )
  as ------------------------------------------
  WITH RECURSIVE staff_hierarchy AS (

  -- Niveau 0 : managers racine
  SELECT
    m.staff_id,
    m.staff_first_name,
    m.staff_last_name,
    m.manager_id,
    m.store_id,
    m.staff_first_name || ' ' || m.staff_last_name AS path,
    0 AS level
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs` m
  WHERE m.manager_id IS NULL

  UNION ALL

  -- Niveaux suivants : rattacher les subordonnés
  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,    
    CONCAT(h.path, ' → ', s.staff_first_name, ' ', s.staff_last_name) AS path,
    h.level + 1 AS level
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs` s
  JOIN staff_hierarchy as h ON s.manager_id = h.staff_id
  
)
------------------------------------------
SELECT 
     * 
FROM staff_hierarchy
ORDER BY path, level;


[0m20:58:19.109608 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_shipped_order"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_shipped_order`
  OPTIONS(
      description="""This model provides the list of order required, shipped and aborted per month over 3 years.\r\n\r\nIt provides a comprehensive view of each order, allowing for easy analysis of order performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_shipped_date AS (

  SELECT 
        order_id, 
        order_date,
        required_date,
        shipped_date, 
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    required_date,
    shipped_date,
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_shipped_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.order_id,
    ls.shipped_date ,
    ls.required_date ,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date, ls.shipped_date, ls.required_date,ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m20:58:19.110511 [debug] [Thread-4 (]: BigQuery adapter: 404 Not found: Dataset databird-473015:dbt_bike_seeds was not found in location US; reason: notFound, message: Not found: Dataset databird-473015:dbt_bike_seeds was not found in location US

Location: US
Job ID: 5ba8325f-b5e2-4644-b884-0757080e2fa3

[0m20:58:19.111312 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (execute): 20:58:18.380958 => 20:58:19.110978
[0m20:58:19.136403 [debug] [Thread-4 (]: Runtime Error in model int_src_local_bike_store_shipped_order (models/silver/int_src_local_bike_store_shipped_order.sql)
  404 Not found: Dataset databird-473015:dbt_bike_seeds was not found in location US; reason: notFound, message: Not found: Dataset databird-473015:dbt_bike_seeds was not found in location US
  
  Location: US
  Job ID: 5ba8325f-b5e2-4644-b884-0757080e2fa3
  
[0m20:58:19.137200 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6380b40-daa9-48f4-b8ae-bff831c355db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370b9151520>]}
[0m20:58:19.138024 [error] [Thread-4 (]: 4 of 5 ERROR creating sql view model dbt_bike_silver.int_src_local_bike_store_shipped_order  [[31mERROR[0m in 0.82s]
[0m20:58:19.139124 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_store_shipped_order
[0m20:58:19.240466 [debug] [Thread-3 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  OPTIONS(
      description="""This model provides an aggregated view of stores. It enriches the store data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each store.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Total Distinct Items**: The count of distinct product types in the order.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_date AS (

  SELECT 
        order_id, 
        order_date,
        shipped_date,
        required_date,
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    o.shipped_date,
    o.required_date,    
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.shipped_date,
    ls.required_date,     
    ls.order_id,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date,ls.shipped_date,ls.required_date, ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m20:58:19.241397 [debug] [Thread-3 (]: BigQuery adapter: 404 Not found: Dataset databird-473015:dbt_bike_seeds was not found in location US; reason: notFound, message: Not found: Dataset databird-473015:dbt_bike_seeds was not found in location US

Location: US
Job ID: 9677a070-fb45-44a4-9aab-d84f37476c60

[0m20:58:19.242125 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (execute): 20:58:18.361172 => 20:58:19.241822
[0m20:58:19.246725 [debug] [Thread-3 (]: Runtime Error in model int_src_local_bike_store_daily (models/silver/int_src_local_bike_store_daily.sql)
  404 Not found: Dataset databird-473015:dbt_bike_seeds was not found in location US; reason: notFound, message: Not found: Dataset databird-473015:dbt_bike_seeds was not found in location US
  
  Location: US
  Job ID: 9677a070-fb45-44a4-9aab-d84f37476c60
  
[0m20:58:19.247364 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6380b40-daa9-48f4-b8ae-bff831c355db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370b8ca7b00>]}
[0m20:58:19.248157 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model dbt_bike_silver.int_src_local_bike_store_daily  [[31mERROR[0m in 0.93s]
[0m20:58:19.249329 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_store_daily
[0m20:58:19.336201 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:1e5c5a4a-70eb-42bf-ad19-262f2c6d9bcd&page=queryresults
[0m20:58:19.374277 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:5a3be0b9-d254-420d-8b29-a475562b8a5b&page=queryresults
[0m20:58:19.630921 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (execute): 20:58:18.486076 => 20:58:19.630581
[0m20:58:19.632132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6380b40-daa9-48f4-b8ae-bff831c355db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370b9151c70>]}
[0m20:58:19.633146 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_bike_silver.int_src_local_bike_product_daily  [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m20:58:19.634439 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_product_daily
[0m20:58:19.712568 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (execute): 20:58:18.405985 => 20:58:19.712253
[0m20:58:19.713611 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6380b40-daa9-48f4-b8ae-bff831c355db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370b8cd0770>]}
[0m20:58:19.714401 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_bike_silver.int_src_local_bike_staff_hierarchy  [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m20:58:19.716019 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m20:58:19.717607 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_staff_daily
[0m20:58:19.718857 [info ] [Thread-4 (]: 5 of 5 START sql view model dbt_bike_silver.int_src_local_bike_staff_daily ..... [RUN]
[0m20:58:19.720301 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_shipped_order, now model.local_bike.int_src_local_bike_staff_daily)
[0m20:58:19.720952 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_staff_daily
[0m20:58:19.728990 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_daily"
[0m20:58:19.730141 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (compile): 20:58:19.721323 => 20:58:19.729720
[0m20:58:19.730609 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_staff_daily
[0m20:58:19.735549 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_staff_daily"
[0m20:58:19.736534 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:58:19.738966 [debug] [Thread-4 (]: On model.local_bike.int_src_local_bike_staff_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  OPTIONS(
      description="""This model provides an aggregated view of staffs and stores. It enriches the store and staff data with the following metrics:\r\n- **Total item Amount**: The sum of all order items for each employe.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each store and staffs, allowing for easy analysis of store performance, employee performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH staff_list AS (

  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,
    s.path,
    s.level
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy` s

),
------------------------------------------
sales_by_employee AS (

  SELECT
    o.order_date as order_date,
    o.season_name,
    EXTRACT(YEAR FROM o.order_date) as yeardate,
    EXTRACT(YEAR FROM o.order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') AS yearmonth,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM o.order_date) AS STRING), 2, '0') AS monthday,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') as month_2digits,
    FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_name,
    FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_abbrev,
    LPAD(CAST(EXTRACT(ISOWEEK FROM o.order_date) AS STRING), 2, '0') AS week_number,
    o.staff_id,
    oi.total_item_discount_sold as total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders` as o
  LEFT JOIN `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items` as oi ON o.order_id = oi.order_id

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

)
------------------------------------------
SELECT 
    em.order_date,
    em.yeardate,
    em.monthday,
    em.yearmonth,
    em.month_2digits,
    em.month_name,
    em.month_abbrev,
    em.week_number,
    em.season_name,
    st.store_name,
    m.store_latitude,
    m.store_longitude,    
    st.store_city,
    st.store_state,    
    ROUND(em.total_item_discount_sold, 2) as total_item_sold_staff,
    s.*
FROM sales_by_employee as em 
JOIN staff_list as s ON em.staff_id = s.staff_id
LEFT JOIN map as m on s.store_id = m.store_id
LEFT JOIN stores as st on m.store_id = st.store_id
ORDER BY em.order_date;


[0m20:58:20.104774 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  OPTIONS(
      description="""This model provides an aggregated view of staffs and stores. It enriches the store and staff data with the following metrics:\r\n- **Total item Amount**: The sum of all order items for each employe.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each store and staffs, allowing for easy analysis of store performance, employee performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH staff_list AS (

  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,
    s.path,
    s.level
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy` s

),
------------------------------------------
sales_by_employee AS (

  SELECT
    o.order_date as order_date,
    o.season_name,
    EXTRACT(YEAR FROM o.order_date) as yeardate,
    EXTRACT(YEAR FROM o.order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') AS yearmonth,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM o.order_date) AS STRING), 2, '0') AS monthday,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') as month_2digits,
    FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_name,
    FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_abbrev,
    LPAD(CAST(EXTRACT(ISOWEEK FROM o.order_date) AS STRING), 2, '0') AS week_number,
    o.staff_id,
    oi.total_item_discount_sold as total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders` as o
  LEFT JOIN `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items` as oi ON o.order_id = oi.order_id

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

)
------------------------------------------
SELECT 
    em.order_date,
    em.yeardate,
    em.monthday,
    em.yearmonth,
    em.month_2digits,
    em.month_name,
    em.month_abbrev,
    em.week_number,
    em.season_name,
    st.store_name,
    m.store_latitude,
    m.store_longitude,    
    st.store_city,
    st.store_state,    
    ROUND(em.total_item_discount_sold, 2) as total_item_sold_staff,
    s.*
FROM sales_by_employee as em 
JOIN staff_list as s ON em.staff_id = s.staff_id
LEFT JOIN map as m on s.store_id = m.store_id
LEFT JOIN stores as st on m.store_id = st.store_id
ORDER BY em.order_date;


[0m20:58:20.105600 [debug] [Thread-4 (]: BigQuery adapter: 404 Not found: Dataset databird-473015:dbt_bike_seeds was not found in location US; reason: notFound, message: Not found: Dataset databird-473015:dbt_bike_seeds was not found in location US

Location: US
Job ID: 611bc537-d3a3-4a54-8b35-ebe0e6a8517d

[0m20:58:20.106394 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (execute): 20:58:19.730898 => 20:58:20.106079
[0m20:58:20.111100 [debug] [Thread-4 (]: Runtime Error in model int_src_local_bike_staff_daily (models/silver/int_src_local_bike_staff_daily.sql)
  404 Not found: Dataset databird-473015:dbt_bike_seeds was not found in location US; reason: notFound, message: Not found: Dataset databird-473015:dbt_bike_seeds was not found in location US
  
  Location: US
  Job ID: 611bc537-d3a3-4a54-8b35-ebe0e6a8517d
  
[0m20:58:20.111719 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6380b40-daa9-48f4-b8ae-bff831c355db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370b8cd0890>]}
[0m20:58:20.112470 [error] [Thread-4 (]: 5 of 5 ERROR creating sql view model dbt_bike_silver.int_src_local_bike_staff_daily  [[31mERROR[0m in 0.39s]
[0m20:58:20.113287 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_staff_daily
[0m20:58:20.116380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:20.116858 [debug] [MainThread]: Connection 'model.local_bike.int_src_local_bike_staff_hierarchy' was properly closed.
[0m20:58:20.117182 [debug] [MainThread]: Connection 'model.local_bike.int_src_local_bike_store_daily' was properly closed.
[0m20:58:20.117437 [debug] [MainThread]: Connection 'model.local_bike.int_src_local_bike_staff_daily' was properly closed.
[0m20:58:20.117695 [debug] [MainThread]: Connection 'model.local_bike.int_src_local_bike_product_daily' was properly closed.
[0m20:58:20.118135 [info ] [MainThread]: 
[0m20:58:20.118928 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.78 seconds (3.78s).
[0m20:58:20.121121 [debug] [MainThread]: Command end result
[0m20:58:20.156812 [info ] [MainThread]: 
[0m20:58:20.157629 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:58:20.158352 [info ] [MainThread]: 
[0m20:58:20.159096 [error] [MainThread]: [33mRuntime Error in model int_src_local_bike_store_shipped_order (models/silver/int_src_local_bike_store_shipped_order.sql)[0m
[0m20:58:20.159756 [error] [MainThread]:   404 Not found: Dataset databird-473015:dbt_bike_seeds was not found in location US; reason: notFound, message: Not found: Dataset databird-473015:dbt_bike_seeds was not found in location US
[0m20:58:20.160470 [error] [MainThread]:   
[0m20:58:20.161129 [error] [MainThread]:   Location: US
[0m20:58:20.161748 [error] [MainThread]:   Job ID: 5ba8325f-b5e2-4644-b884-0757080e2fa3
[0m20:58:20.162415 [error] [MainThread]:   
[0m20:58:20.163078 [info ] [MainThread]: 
[0m20:58:20.163726 [error] [MainThread]: [33mRuntime Error in model int_src_local_bike_store_daily (models/silver/int_src_local_bike_store_daily.sql)[0m
[0m20:58:20.164393 [error] [MainThread]:   404 Not found: Dataset databird-473015:dbt_bike_seeds was not found in location US; reason: notFound, message: Not found: Dataset databird-473015:dbt_bike_seeds was not found in location US
[0m20:58:20.164993 [error] [MainThread]:   
[0m20:58:20.165592 [error] [MainThread]:   Location: US
[0m20:58:20.166201 [error] [MainThread]:   Job ID: 9677a070-fb45-44a4-9aab-d84f37476c60
[0m20:58:20.166788 [error] [MainThread]:   
[0m20:58:20.167423 [info ] [MainThread]: 
[0m20:58:20.168038 [error] [MainThread]: [33mRuntime Error in model int_src_local_bike_staff_daily (models/silver/int_src_local_bike_staff_daily.sql)[0m
[0m20:58:20.168624 [error] [MainThread]:   404 Not found: Dataset databird-473015:dbt_bike_seeds was not found in location US; reason: notFound, message: Not found: Dataset databird-473015:dbt_bike_seeds was not found in location US
[0m20:58:20.169263 [error] [MainThread]:   
[0m20:58:20.169872 [error] [MainThread]:   Location: US
[0m20:58:20.170455 [error] [MainThread]:   Job ID: 611bc537-d3a3-4a54-8b35-ebe0e6a8517d
[0m20:58:20.171044 [error] [MainThread]:   
[0m20:58:20.171813 [info ] [MainThread]: 
[0m20:58:20.172526 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 TOTAL=5
[0m20:58:20.173578 [debug] [MainThread]: Command `dbt run` failed at 20:58:20.173325 after 5.62 seconds
[0m20:58:20.174085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370cd3d3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370cce29220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370cce28470>]}
[0m20:58:20.174535 [debug] [MainThread]: Flushing usage events
[0m20:58:50.486593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75df41ea3b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75df41f7bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75df42617f80>]}


============================== 20:58:50.492511 | abbe6759-7e9d-498e-af32-af6e73963a6c ==============================
[0m20:58:50.492511 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:58:50.493498 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'profiles_dir': '/root/.dbt', 'quiet': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'log_format': 'default'}
[0m20:58:52.064314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abbe6759-7e9d-498e-af32-af6e73963a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75df2a2bb1a0>]}
[0m20:58:52.088123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abbe6759-7e9d-498e-af32-af6e73963a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75df2a203ec0>]}
[0m20:58:52.141182 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m20:58:52.222879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:58:52.223546 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:58:52.235267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abbe6759-7e9d-498e-af32-af6e73963a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75df2a44a0f0>]}
[0m20:58:52.260048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abbe6759-7e9d-498e-af32-af6e73963a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75df29f43e90>]}
[0m20:58:52.260988 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m20:58:52.261770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abbe6759-7e9d-498e-af32-af6e73963a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75df2a500200>]}
[0m20:58:52.267535 [info ] [MainThread]: 
[0m20:58:52.269513 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:58:52.271590 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m20:58:52.272271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:52.704941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now create_databird-473015_dbt_bike_seeds)
[0m20:58:52.706303 [debug] [ThreadPool]: Creating schema "database: "databird-473015"
schema: "dbt_bike_seeds"
"
[0m20:58:52.721258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:52.723590 [debug] [ThreadPool]: On create_databird-473015_dbt_bike_seeds: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "create_databird-473015_dbt_bike_seeds"} */
create schema if not exists `databird-473015`.`dbt_bike_seeds`
  
[0m20:58:53.713713 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:8e8d1ef1-f249-46f6-bb93-d04bde5109fa&page=queryresults
[0m20:58:53.718197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_databird-473015_dbt_bike_seeds, now list_databird-473015_dbt_bike_gold)
[0m20:58:53.719028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:53.720163 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m20:58:53.721588 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m20:58:53.722648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:53.722102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:53.763028 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m20:58:53.765396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:54.137331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abbe6759-7e9d-498e-af32-af6e73963a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75df2a2db380>]}
[0m20:58:54.138605 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:58:54.139257 [info ] [MainThread]: 
[0m20:58:54.146855 [debug] [Thread-1 (]: Began running node seed.local_bike.map
[0m20:58:54.147611 [debug] [Thread-2 (]: Began running node seed.local_bike.seasons
[0m20:58:54.148412 [info ] [Thread-1 (]: 1 of 2 START seed file dbt_bike_seeds.map ...................................... [RUN]
[0m20:58:54.150930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now seed.local_bike.map)
[0m20:58:54.149456 [info ] [Thread-2 (]: 2 of 2 START seed file dbt_bike_seeds.seasons .................................. [RUN]
[0m20:58:54.152171 [debug] [Thread-1 (]: Began compiling node seed.local_bike.map
[0m20:58:54.153571 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now seed.local_bike.seasons)
[0m20:58:54.154640 [debug] [Thread-1 (]: Timing info for seed.local_bike.map (compile): 20:58:54.154122 => 20:58:54.154137
[0m20:58:54.155655 [debug] [Thread-2 (]: Began compiling node seed.local_bike.seasons
[0m20:58:54.156316 [debug] [Thread-1 (]: Began executing node seed.local_bike.map
[0m20:58:54.157088 [debug] [Thread-2 (]: Timing info for seed.local_bike.seasons (compile): 20:58:54.156703 => 20:58:54.156716
[0m20:58:54.168256 [debug] [Thread-2 (]: Began executing node seed.local_bike.seasons
[0m20:58:54.240076 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:54.247485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:57.156869 [debug] [Thread-1 (]: On seed.local_bike.map: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "seed.local_bike.map"} */

    alter table `databird-473015`.`dbt_bike_seeds`.`map` set OPTIONS()
  
[0m20:58:57.160988 [debug] [Thread-2 (]: On seed.local_bike.seasons: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "seed.local_bike.seasons"} */

    alter table `databird-473015`.`dbt_bike_seeds`.`seasons` set OPTIONS()
  
[0m20:58:57.606637 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:bf4b90e8-af2d-402d-a8b3-f03c8febb758&page=queryresults
[0m20:58:57.615769 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.local_bike.map"
[0m20:58:57.643269 [debug] [Thread-1 (]: Timing info for seed.local_bike.map (execute): 20:58:54.157431 => 20:58:57.642952
[0m20:58:57.644334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abbe6759-7e9d-498e-af32-af6e73963a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75df29d8c500>]}
[0m20:58:57.645099 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file dbt_bike_seeds.map .................................. [[32mINSERT 3[0m in 3.49s]
[0m20:58:57.646291 [debug] [Thread-1 (]: Finished running node seed.local_bike.map
[0m20:58:57.649058 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:045c5a36-a25e-40d7-af2e-1e37663d112f&page=queryresults
[0m20:58:57.650190 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.local_bike.seasons"
[0m20:58:57.653771 [debug] [Thread-2 (]: Timing info for seed.local_bike.seasons (execute): 20:58:54.173934 => 20:58:57.653487
[0m20:58:57.654743 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abbe6759-7e9d-498e-af32-af6e73963a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75df29d8c860>]}
[0m20:58:57.655413 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file dbt_bike_seeds.seasons .............................. [[32mINSERT 12[0m in 3.50s]
[0m20:58:57.656512 [debug] [Thread-2 (]: Finished running node seed.local_bike.seasons
[0m20:58:57.661540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:57.662272 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_gold' was properly closed.
[0m20:58:57.662858 [debug] [MainThread]: Connection 'seed.local_bike.seasons' was properly closed.
[0m20:58:57.663333 [debug] [MainThread]: Connection 'seed.local_bike.map' was properly closed.
[0m20:58:57.663784 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_silver' was properly closed.
[0m20:58:57.664421 [info ] [MainThread]: 
[0m20:58:57.665152 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 5.40 seconds (5.40s).
[0m20:58:57.666899 [debug] [MainThread]: Command end result
[0m20:58:57.696607 [info ] [MainThread]: 
[0m20:58:57.697664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:58:57.698401 [info ] [MainThread]: 
[0m20:58:57.699190 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:58:57.700315 [debug] [MainThread]: Command `dbt seed` succeeded at 20:58:57.700072 after 7.22 seconds
[0m20:58:57.701071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75df425fe9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75df425fdb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75df425c92b0>]}
[0m20:58:57.701731 [debug] [MainThread]: Flushing usage events
[0m20:59:24.080771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9481cb65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9481e84fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9481f68f80>]}


============================== 20:59:24.086657 | f1fb6d04-064a-47eb-ae82-2e686b0e9e45 ==============================
[0m20:59:24.086657 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:59:24.087640 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/root/.dbt', 'indirect_selection': 'eager', 'log_path': '/usr/app/dbt/logs', 'target_path': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'partial_parse': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'version_check': 'True'}
[0m20:59:25.631245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1fb6d04-064a-47eb-ae82-2e686b0e9e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f946a01dd30>]}
[0m20:59:25.655057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1fb6d04-064a-47eb-ae82-2e686b0e9e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9469faacc0>]}
[0m20:59:25.707541 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m20:59:25.814845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:59:25.815550 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:59:25.826962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1fb6d04-064a-47eb-ae82-2e686b0e9e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f946a2572f0>]}
[0m20:59:25.851907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1fb6d04-064a-47eb-ae82-2e686b0e9e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9469cfa5a0>]}
[0m20:59:25.852885 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m20:59:25.853595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1fb6d04-064a-47eb-ae82-2e686b0e9e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9470b84140>]}
[0m20:59:25.856751 [info ] [MainThread]: 
[0m20:59:25.858471 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:59:25.861792 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m20:59:25.862742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:26.417316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_seeds)
[0m20:59:26.418416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:26.419724 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m20:59:26.421441 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m20:59:26.421978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:26.423504 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m20:59:26.463664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:26.507712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:26.959153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1fb6d04-064a-47eb-ae82-2e686b0e9e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f946a76e1b0>]}
[0m20:59:26.960531 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:59:26.961350 [info ] [MainThread]: 
[0m20:59:26.969095 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_product_daily
[0m20:59:26.969952 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m20:59:26.970583 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_store_daily
[0m20:59:26.971395 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_bike_silver.int_src_local_bike_product_daily ... [RUN]
[0m20:59:26.972626 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_bike_silver.int_src_local_bike_staff_hierarchy . [RUN]
[0m20:59:26.974232 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_store_shipped_order
[0m20:59:26.977170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.int_src_local_bike_product_daily)
[0m20:59:26.980246 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_product_daily
[0m20:59:26.978579 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.int_src_local_bike_staff_hierarchy)
[0m20:59:26.979366 [info ] [Thread-4 (]: 4 of 5 START sql view model dbt_bike_silver.int_src_local_bike_store_shipped_order  [RUN]
[0m20:59:26.975193 [info ] [Thread-3 (]: 3 of 5 START sql view model dbt_bike_silver.int_src_local_bike_store_daily ..... [RUN]
[0m20:59:26.989388 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_product_daily"
[0m20:59:26.990266 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_staff_hierarchy
[0m20:59:26.991465 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.int_src_local_bike_store_shipped_order)
[0m20:59:26.992546 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.int_src_local_bike_store_daily)
[0m20:59:27.000682 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_store_daily
[0m20:59:26.999605 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_store_shipped_order
[0m20:59:26.998743 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m20:59:27.001610 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (compile): 20:59:26.980580 => 20:59:27.001194
[0m20:59:27.009543 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_daily"
[0m20:59:27.021133 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_product_daily
[0m20:59:27.042618 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m20:59:27.043734 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (compile): 20:59:26.993177 => 20:59:27.043215
[0m20:59:27.057015 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (compile): 20:59:27.001976 => 20:59:27.056367
[0m20:59:27.063214 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_staff_hierarchy
[0m20:59:27.069558 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_store_daily
[0m20:59:27.082492 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (compile): 20:59:27.010165 => 20:59:27.081938
[0m20:59:27.136849 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_product_daily"
[0m20:59:27.141023 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_store_daily"
[0m20:59:27.141874 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_store_shipped_order
[0m20:59:27.142563 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m20:59:27.148888 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m20:59:27.149967 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:59:27.151295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:27.152336 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:59:27.154778 [debug] [Thread-1 (]: On model.local_bike.int_src_local_bike_product_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_product_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily`
  OPTIONS(
      description="""This model provides an aggregated view of product items. It enriches the products data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each product.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Product Informations**: Enriches the product with user-specific data, such as brand and category.\r\n\r\nIt provides a comprehensive view of each product, allowing for easy analysis of product performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH order_items AS (
  SELECT 
        order_id as order_id,
        item_id as item_id,
        product_id as product_id,
        quantity as quantity,
        list_price as list_price,
        discount as discount,
        ROUND((discount * 100),2) as discount_percent,
        ROUND(total_item_discount_sold, 2) as total_item_discount_sold 
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
),
------------------------------------------
orders_date AS (
  SELECT 
        order_id, 
        CAST(order_date as date) as order_date,
        store_id,
        season_name,
        EXTRACT(YEAR FROM order_date) as yeardate,
        EXTRACT(YEAR FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`
),
------------------------------------------
products AS (
  SELECT 
        product_id as product_id,
        product_name as product_name,
        brand_id as brand_id,
        category_id as category_id,
        model_year as product_model_year,
        ROUND(list_price,2) as list_price
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_products`
),
------------------------------------------
brands AS (
  SELECT 
        brand_id as brand_id,
        brand_name as brand_name
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
),
------------------------------------------
categories AS (
  SELECT 
        category_id as category_id,
        category_name as category_name
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_categories`
)
------------------------------------------
SELECT
  o.order_id,
  o.store_id,
  o.order_date,
  o.yeardate,
  o.monthday,
  o.yearmonth,
  o.month_2digits,
  o.month_name,
  o.month_abbrev,
  o.week_number,
  o.season_name,
  p.product_id,
  p.product_name,
  b.brand_name,
  c.category_name,
  oi.quantity,
  oi.list_price,
  oi.discount,
  oi.discount_percent,
  SUM(oi.total_item_discount_sold) as total_item_discount_sold,
  COUNT(*) as total_items
FROM orders_date as o
LEFT JOIN order_items as oi ON o.order_id = oi.order_id
LEFT JOIN products as p ON oi.product_id = p.product_id
LEFT JOIN brands as b ON p.brand_id = b.brand_id
LEFT JOIN categories as c ON p.category_id = c.category_id
GROUP BY 
  o.order_id,
  o.store_id,
  o.order_date,
  o.yeardate,
  o.monthday,
  o.yearmonth,
  o.month_2digits,
  o.month_name,
  o.month_abbrev,
  o.week_number,
  o.season_name, 
  p.product_id,
  p.product_name,
  b.brand_name,
  c.category_name,
  oi.quantity,
  oi.list_price,
  oi.discount,
  oi.discount_percent
ORDER BY o.yeardate, o.week_number, o.order_id;


[0m20:59:27.157207 [debug] [Thread-3 (]: On model.local_bike.int_src_local_bike_store_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  OPTIONS(
      description="""This model provides an aggregated view of stores. It enriches the store data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each store.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Total Distinct Items**: The count of distinct product types in the order.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_date AS (

  SELECT 
        order_id, 
        order_date,
        shipped_date,
        required_date,
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    o.shipped_date,
    o.required_date,    
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.shipped_date,
    ls.required_date,     
    ls.order_id,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date,ls.shipped_date,ls.required_date, ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m20:59:27.158288 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:59:27.238077 [debug] [Thread-4 (]: On model.local_bike.int_src_local_bike_store_shipped_order: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_shipped_order"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_shipped_order`
  OPTIONS(
      description="""This model provides the list of order required, shipped and aborted per month over 3 years.\r\n\r\nIt provides a comprehensive view of each order, allowing for easy analysis of order performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_shipped_date AS (

  SELECT 
        order_id, 
        order_date,
        required_date,
        shipped_date, 
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    required_date,
    shipped_date,
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_shipped_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.order_id,
    ls.shipped_date ,
    ls.required_date ,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date, ls.shipped_date, ls.required_date,ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m20:59:27.283553 [debug] [Thread-2 (]: On model.local_bike.int_src_local_bike_staff_hierarchy: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_hierarchy"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy`
  OPTIONS(
      description="""This model provides an hirarchical view of employees. It enriches the store data with the following data:\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each employe.."""
    )
  as ------------------------------------------
  WITH RECURSIVE staff_hierarchy AS (

  -- Niveau 0 : managers racine
  SELECT
    m.staff_id,
    m.staff_first_name,
    m.staff_last_name,
    m.manager_id,
    m.store_id,
    m.staff_first_name || ' ' || m.staff_last_name AS path,
    0 AS level
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs` m
  WHERE m.manager_id IS NULL

  UNION ALL

  -- Niveaux suivants : rattacher les subordonnés
  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,    
    CONCAT(h.path, ' → ', s.staff_first_name, ' ', s.staff_last_name) AS path,
    h.level + 1 AS level
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs` s
  JOIN staff_hierarchy as h ON s.manager_id = h.staff_id
  
)
------------------------------------------
SELECT 
     * 
FROM staff_hierarchy
ORDER BY path, level;


[0m20:59:28.038964 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:3958a99b-c241-415b-bd37-e02cd96a8fce&page=queryresults
[0m20:59:28.073297 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:d017716b-c09d-4ad5-9af4-a728f76fc9df&page=queryresults
[0m20:59:28.081923 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:c607f0de-4abd-41e0-a084-8877ce69243a&page=queryresults
[0m20:59:28.084019 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:d8199d9d-bb3e-4dac-afda-2a2898a30997&page=queryresults
[0m20:59:28.340824 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (execute): 20:59:27.044297 => 20:59:28.340450
[0m20:59:28.342148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1fb6d04-064a-47eb-ae82-2e686b0e9e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9469cfa570>]}
[0m20:59:28.343081 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_bike_silver.int_src_local_bike_product_daily  [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m20:59:28.344511 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_product_daily
[0m20:59:28.375015 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (execute): 20:59:27.143497 => 20:59:28.374642
[0m20:59:28.376786 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1fb6d04-064a-47eb-ae82-2e686b0e9e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94848403e0>]}
[0m20:59:28.377820 [info ] [Thread-4 (]: 4 of 5 OK created sql view model dbt_bike_silver.int_src_local_bike_store_shipped_order  [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m20:59:28.379958 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_store_shipped_order
[0m20:59:28.382840 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (execute): 20:59:27.119870 => 20:59:28.382146
[0m20:59:28.384209 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1fb6d04-064a-47eb-ae82-2e686b0e9e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9469d4a060>]}
[0m20:59:28.385250 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dbt_bike_silver.int_src_local_bike_store_daily  [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m20:59:28.386584 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_store_daily
[0m20:59:28.434957 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (execute): 20:59:27.082968 => 20:59:28.434611
[0m20:59:28.435998 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1fb6d04-064a-47eb-ae82-2e686b0e9e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9469d4ae70>]}
[0m20:59:28.436826 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_bike_silver.int_src_local_bike_staff_hierarchy  [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m20:59:28.438008 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m20:59:28.439422 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_staff_daily
[0m20:59:28.440076 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_bike_silver.int_src_local_bike_staff_daily ..... [RUN]
[0m20:59:28.441519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_product_daily, now model.local_bike.int_src_local_bike_staff_daily)
[0m20:59:28.442220 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_staff_daily
[0m20:59:28.450944 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_daily"
[0m20:59:28.452042 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (compile): 20:59:28.442630 => 20:59:28.451663
[0m20:59:28.452549 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_staff_daily
[0m20:59:28.457426 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_staff_daily"
[0m20:59:28.458302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:28.460660 [debug] [Thread-1 (]: On model.local_bike.int_src_local_bike_staff_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  OPTIONS(
      description="""This model provides an aggregated view of staffs and stores. It enriches the store and staff data with the following metrics:\r\n- **Total item Amount**: The sum of all order items for each employe.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each store and staffs, allowing for easy analysis of store performance, employee performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH staff_list AS (

  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,
    s.path,
    s.level
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy` s

),
------------------------------------------
sales_by_employee AS (

  SELECT
    o.order_date as order_date,
    o.season_name,
    EXTRACT(YEAR FROM o.order_date) as yeardate,
    EXTRACT(YEAR FROM o.order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') AS yearmonth,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM o.order_date) AS STRING), 2, '0') AS monthday,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') as month_2digits,
    FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_name,
    FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_abbrev,
    LPAD(CAST(EXTRACT(ISOWEEK FROM o.order_date) AS STRING), 2, '0') AS week_number,
    o.staff_id,
    oi.total_item_discount_sold as total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders` as o
  LEFT JOIN `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items` as oi ON o.order_id = oi.order_id

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

)
------------------------------------------
SELECT 
    em.order_date,
    em.yeardate,
    em.monthday,
    em.yearmonth,
    em.month_2digits,
    em.month_name,
    em.month_abbrev,
    em.week_number,
    em.season_name,
    st.store_name,
    m.store_latitude,
    m.store_longitude,    
    st.store_city,
    st.store_state,    
    ROUND(em.total_item_discount_sold, 2) as total_item_sold_staff,
    s.*
FROM sales_by_employee as em 
JOIN staff_list as s ON em.staff_id = s.staff_id
LEFT JOIN map as m on s.store_id = m.store_id
LEFT JOIN stores as st on m.store_id = st.store_id
ORDER BY em.order_date;


[0m20:59:29.230099 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:8a7e3908-f533-41c8-bf95-eaffdefab91b&page=queryresults
[0m20:59:29.548659 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (execute): 20:59:28.452849 => 20:59:29.548297
[0m20:59:29.550216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1fb6d04-064a-47eb-ae82-2e686b0e9e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9469d4b5c0>]}
[0m20:59:29.551240 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt_bike_silver.int_src_local_bike_staff_daily  [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m20:59:29.552576 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_staff_daily
[0m20:59:29.556518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:29.557090 [debug] [MainThread]: Connection 'model.local_bike.int_src_local_bike_staff_hierarchy' was properly closed.
[0m20:59:29.557388 [debug] [MainThread]: Connection 'model.local_bike.int_src_local_bike_staff_daily' was properly closed.
[0m20:59:29.557653 [debug] [MainThread]: Connection 'model.local_bike.int_src_local_bike_store_shipped_order' was properly closed.
[0m20:59:29.557985 [debug] [MainThread]: Connection 'model.local_bike.int_src_local_bike_store_daily' was properly closed.
[0m20:59:29.558406 [info ] [MainThread]: 
[0m20:59:29.559042 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.70 seconds (3.70s).
[0m20:59:29.561916 [debug] [MainThread]: Command end result
[0m20:59:29.588134 [info ] [MainThread]: 
[0m20:59:29.589152 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:59:29.589978 [info ] [MainThread]: 
[0m20:59:29.590710 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:59:29.592321 [debug] [MainThread]: Command `dbt run` succeeded at 20:59:29.591911 after 5.52 seconds
[0m20:59:29.593189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9481f1ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9481d8fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9485551bb0>]}
[0m20:59:29.593898 [debug] [MainThread]: Flushing usage events
[0m21:00:06.560085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70feaaee7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70feab8479e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70feab435b80>]}


============================== 21:00:06.566512 | 48b36bd1-7fc7-4b57-a278-ad48ebad1d3b ==============================
[0m21:00:06.566512 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:00:06.568183 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/root/.dbt', 'printer_width': '80', 'log_format': 'default', 'quiet': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_path': '/usr/app/dbt/logs', 'indirect_selection': 'eager', 'fail_fast': 'False', 'write_json': 'True', 'use_colors': 'True', 'target_path': 'None', 'introspect': 'True', 'debug': 'False', 'warn_error': 'None', 'partial_parse': 'True'}
[0m21:00:08.056040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48b36bd1-7fc7-4b57-a278-ad48ebad1d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70feabecd1c0>]}
[0m21:00:08.079168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48b36bd1-7fc7-4b57-a278-ad48ebad1d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe9301aa80>]}
[0m21:00:08.127059 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m21:00:08.203255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:00:08.203818 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:00:08.214050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48b36bd1-7fc7-4b57-a278-ad48ebad1d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe931f7170>]}
[0m21:00:08.235562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48b36bd1-7fc7-4b57-a278-ad48ebad1d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe92d57dd0>]}
[0m21:00:08.236297 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m21:00:08.236970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48b36bd1-7fc7-4b57-a278-ad48ebad1d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe92d57e90>]}
[0m21:00:08.240507 [info ] [MainThread]: 
[0m21:00:08.242019 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:00:08.246191 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m21:00:08.247509 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m21:00:08.247987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:08.249187 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m21:00:08.251310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:08.249594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:08.250859 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m21:00:08.330484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:08.708514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48b36bd1-7fc7-4b57-a278-ad48ebad1d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe981a5a60>]}
[0m21:00:08.709757 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:00:08.710510 [info ] [MainThread]: 
[0m21:00:08.718448 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_brands
[0m21:00:08.719184 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_categories
[0m21:00:08.719756 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_customers
[0m21:00:08.720314 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_order_items
[0m21:00:08.721346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.stg_src_local_bike_brands)
[0m21:00:08.722397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.stg_src_local_bike_categories)
[0m21:00:08.723333 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.stg_src_local_bike_customers)
[0m21:00:08.724291 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.stg_src_local_bike_order_items)
[0m21:00:08.724909 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_brands
[0m21:00:08.725447 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_categories
[0m21:00:08.726140 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_customers
[0m21:00:08.726779 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_order_items
[0m21:00:08.736580 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_categories"
[0m21:00:08.732071 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_brands"
[0m21:00:08.741404 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_customers"
[0m21:00:08.754583 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (compile): 21:00:08.732438 => 21:00:08.754101
[0m21:00:08.761855 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_categories
[0m21:00:08.762705 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (compile): 21:00:08.727185 => 21:00:08.762333
[0m21:00:08.767012 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_order_items"
[0m21:00:08.767894 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (execute): 21:00:08.767456 => 21:00:08.767499
[0m21:00:08.768555 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (compile): 21:00:08.737239 => 21:00:08.768231
[0m21:00:08.769106 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_brands
[0m21:00:08.770633 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_categories
[0m21:00:08.771250 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_customers
[0m21:00:08.772035 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (execute): 21:00:08.771674 => 21:00:08.771695
[0m21:00:08.772692 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_orders
[0m21:00:08.773334 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (compile): 21:00:08.741931 => 21:00:08.773035
[0m21:00:08.774169 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (execute): 21:00:08.773863 => 21:00:08.773880
[0m21:00:08.775485 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_brands
[0m21:00:08.776368 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_categories, now model.local_bike.stg_src_local_bike_orders)
[0m21:00:08.776941 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_order_items
[0m21:00:08.778334 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_customers
[0m21:00:08.779009 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_products
[0m21:00:08.779681 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_orders
[0m21:00:08.780362 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (execute): 21:00:08.780060 => 21:00:08.780079
[0m21:00:08.780991 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_staffs
[0m21:00:08.782010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_brands, now model.local_bike.stg_src_local_bike_products)
[0m21:00:08.788793 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_orders"
[0m21:00:08.790241 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_order_items
[0m21:00:08.791229 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_customers, now model.local_bike.stg_src_local_bike_staffs)
[0m21:00:08.793618 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_staffs
[0m21:00:08.792634 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_stocks
[0m21:00:08.791838 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_products
[0m21:00:08.794305 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_orders (compile): 21:00:08.782364 => 21:00:08.793964
[0m21:00:08.798977 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_staffs"
[0m21:00:08.800081 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_order_items, now model.local_bike.stg_src_local_bike_stocks)
[0m21:00:08.804792 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_products"
[0m21:00:08.805466 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_orders
[0m21:00:08.806189 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_stocks
[0m21:00:08.807177 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_orders (execute): 21:00:08.806829 => 21:00:08.806854
[0m21:00:08.807969 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (compile): 21:00:08.794613 => 21:00:08.807585
[0m21:00:08.808526 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_products (compile): 21:00:08.800516 => 21:00:08.808239
[0m21:00:08.812890 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stocks"
[0m21:00:08.814344 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_orders
[0m21:00:08.814930 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_staffs
[0m21:00:08.815467 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_products
[0m21:00:08.818035 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_products (execute): 21:00:08.817638 => 21:00:08.817687
[0m21:00:08.817053 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (execute): 21:00:08.816676 => 21:00:08.816694
[0m21:00:08.816260 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_stores
[0m21:00:08.818647 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (compile): 21:00:08.808885 => 21:00:08.818343
[0m21:00:08.820032 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_products
[0m21:00:08.821436 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_staffs
[0m21:00:08.822371 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_orders, now model.local_bike.stg_src_local_bike_stores)
[0m21:00:08.822955 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_stocks
[0m21:00:08.823585 [debug] [Thread-1 (]: Began running node seed.local_bike.map
[0m21:00:08.824526 [debug] [Thread-3 (]: Began running node seed.local_bike.seasons
[0m21:00:08.825307 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_stores
[0m21:00:08.826018 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (execute): 21:00:08.825656 => 21:00:08.825676
[0m21:00:08.826945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_products, now seed.local_bike.map)
[0m21:00:08.827889 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_staffs, now seed.local_bike.seasons)
[0m21:00:08.832650 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stores"
[0m21:00:08.834478 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_stocks
[0m21:00:08.835256 [debug] [Thread-1 (]: Began compiling node seed.local_bike.map
[0m21:00:08.836062 [debug] [Thread-3 (]: Began compiling node seed.local_bike.seasons
[0m21:00:08.837014 [debug] [Thread-4 (]: Began running node test.local_bike.assert_total_order_amount_is_positive
[0m21:00:08.840476 [debug] [Thread-1 (]: Timing info for seed.local_bike.map (compile): 21:00:08.837475 => 21:00:08.840124
[0m21:00:08.845126 [debug] [Thread-3 (]: Timing info for seed.local_bike.seasons (compile): 21:00:08.841124 => 21:00:08.844547
[0m21:00:08.847595 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stocks, now test.local_bike.assert_total_order_amount_is_positive)
[0m21:00:08.846073 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_stores (compile): 21:00:08.828252 => 21:00:08.845597
[0m21:00:08.848540 [debug] [Thread-1 (]: Began executing node seed.local_bike.map
[0m21:00:08.849133 [debug] [Thread-3 (]: Began executing node seed.local_bike.seasons
[0m21:00:08.849682 [debug] [Thread-4 (]: Began compiling node test.local_bike.assert_total_order_amount_is_positive
[0m21:00:08.850242 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_stores
[0m21:00:08.850947 [debug] [Thread-1 (]: Timing info for seed.local_bike.map (execute): 21:00:08.850600 => 21:00:08.850629
[0m21:00:08.851574 [debug] [Thread-3 (]: Timing info for seed.local_bike.seasons (execute): 21:00:08.851271 => 21:00:08.851291
[0m21:00:08.856195 [debug] [Thread-4 (]: Writing injected SQL for node "test.local_bike.assert_total_order_amount_is_positive"
[0m21:00:08.856947 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_stores (execute): 21:00:08.856589 => 21:00:08.856609
[0m21:00:08.858256 [debug] [Thread-1 (]: Finished running node seed.local_bike.map
[0m21:00:08.859556 [debug] [Thread-3 (]: Finished running node seed.local_bike.seasons
[0m21:00:08.861034 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_stores
[0m21:00:08.861777 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_product_daily
[0m21:00:08.862644 [debug] [Thread-4 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (compile): 21:00:08.851895 => 21:00:08.862340
[0m21:00:08.863246 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:00:08.864593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.local_bike.map, now model.local_bike.int_src_local_bike_product_daily)
[0m21:00:08.865336 [debug] [Thread-4 (]: Began executing node test.local_bike.assert_total_order_amount_is_positive
[0m21:00:08.866083 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_store_daily
[0m21:00:08.866932 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.local_bike.seasons, now model.local_bike.int_src_local_bike_staff_hierarchy)
[0m21:00:08.867490 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_product_daily
[0m21:00:08.868158 [debug] [Thread-4 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (execute): 21:00:08.867857 => 21:00:08.867876
[0m21:00:08.869362 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stores, now model.local_bike.int_src_local_bike_store_daily)
[0m21:00:08.869949 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:00:08.876556 [debug] [Thread-4 (]: Finished running node test.local_bike.assert_total_order_amount_is_positive
[0m21:00:08.880521 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_product_daily"
[0m21:00:08.881228 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_store_daily
[0m21:00:08.886068 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m21:00:08.886907 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:00:08.893741 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.local_bike.assert_total_order_amount_is_positive, now model.local_bike.int_src_local_bike_store_shipped_order)
[0m21:00:08.894483 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:00:08.895717 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_daily"
[0m21:00:08.902972 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m21:00:08.904108 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (compile): 21:00:08.881640 => 21:00:08.903690
[0m21:00:08.904979 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:00:08.905918 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (compile): 21:00:08.870291 => 21:00:08.905385
[0m21:00:08.906748 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (execute): 21:00:08.906394 => 21:00:08.906417
[0m21:00:08.907563 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_product_daily
[0m21:00:08.908232 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (compile): 21:00:08.887565 => 21:00:08.907929
[0m21:00:08.908908 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (compile): 21:00:08.896134 => 21:00:08.908581
[0m21:00:08.910323 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:00:08.911016 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (execute): 21:00:08.910674 => 21:00:08.910695
[0m21:00:08.911522 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_store_daily
[0m21:00:08.912057 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:00:08.913746 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_product_daily
[0m21:00:08.914482 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (execute): 21:00:08.914153 => 21:00:08.914171
[0m21:00:08.914984 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_staff_daily
[0m21:00:08.915653 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (execute): 21:00:08.915333 => 21:00:08.915356
[0m21:00:08.917222 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_store_daily
[0m21:00:08.918182 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_hierarchy, now model.local_bike.int_src_local_bike_staff_daily)
[0m21:00:08.919556 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:00:08.920609 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_staff_daily
[0m21:00:08.921201 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:00:08.921767 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_order_shipped_montly
[0m21:00:08.922386 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:00:08.929620 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_daily"
[0m21:00:08.930707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_product_daily, now model.local_bike.mrt_order_shipped_aborted_montly)
[0m21:00:08.931741 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_daily, now model.local_bike.mrt_order_shipped_montly)
[0m21:00:08.934198 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_order_shipped_montly
[0m21:00:08.932744 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_shipped_order, now model.local_bike.mrt_products_ranking_yearly_top3)
[0m21:00:08.933514 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:00:08.940133 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (compile): 21:00:08.922867 => 21:00:08.939700
[0m21:00:08.939464 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_montly"
[0m21:00:08.941159 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:00:08.946202 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m21:00:08.946979 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_staff_daily
[0m21:00:08.952272 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m21:00:08.953718 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (execute): 21:00:08.953319 => 21:00:08.953342
[0m21:00:08.956558 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_staff_daily
[0m21:00:08.957218 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_sales_seasons_yearly
[0m21:00:08.954447 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (compile): 21:00:08.941710 => 21:00:08.954123
[0m21:00:08.955129 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_montly (compile): 21:00:08.934519 => 21:00:08.954812
[0m21:00:08.959701 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_order_shipped_montly
[0m21:00:08.958893 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:00:08.958130 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_daily, now model.local_bike.mrt_sales_seasons_yearly)
[0m21:00:08.960381 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (compile): 21:00:08.947520 => 21:00:08.960084
[0m21:00:08.961044 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_montly (execute): 21:00:08.960686 => 21:00:08.960705
[0m21:00:08.961751 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (execute): 21:00:08.961454 => 21:00:08.961474
[0m21:00:08.962271 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_sales_seasons_yearly
[0m21:00:08.962771 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:00:08.964135 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_order_shipped_montly
[0m21:00:08.965410 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:00:08.970355 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_sales_seasons_yearly"
[0m21:00:08.971255 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (execute): 21:00:08.970924 => 21:00:08.970944
[0m21:00:08.972041 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_stores_items_monthly
[0m21:00:08.975443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_montly, now model.local_bike.mrt_stores_items_monthly)
[0m21:00:08.972838 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_stores_ranking_yearly
[0m21:00:08.976875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_aborted_montly, now model.local_bike.mrt_stores_ranking_yearly)
[0m21:00:08.974468 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:00:08.980407 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_stores_sales_monthly
[0m21:00:08.975953 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_stores_items_monthly
[0m21:00:08.977456 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_stores_ranking_yearly
[0m21:00:08.981574 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (compile): 21:00:08.965748 => 21:00:08.981038
[0m21:00:08.982960 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_products_ranking_yearly_top3, now model.local_bike.mrt_stores_sales_monthly)
[0m21:00:09.001215 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_stores_items_monthly"
[0m21:00:09.002605 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_stores_ranking_yearly"
[0m21:00:09.003318 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_sales_seasons_yearly
[0m21:00:09.003936 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_stores_sales_monthly
[0m21:00:09.005160 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_items_monthly (compile): 21:00:08.983424 => 21:00:09.004712
[0m21:00:09.005853 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (execute): 21:00:09.005494 => 21:00:09.005517
[0m21:00:09.006698 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (compile): 21:00:08.990064 => 21:00:09.006388
[0m21:00:09.012543 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_stores_items_monthly
[0m21:00:09.013075 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_stores_sales_monthly"
[0m21:00:09.014496 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_sales_seasons_yearly
[0m21:00:09.015072 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_stores_ranking_yearly
[0m21:00:09.017460 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (execute): 21:00:09.017151 => 21:00:09.017166
[0m21:00:09.015767 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_items_monthly (execute): 21:00:09.015433 => 21:00:09.015456
[0m21:00:09.016626 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_products_brands_monthly
[0m21:00:09.018738 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_stores_ranking_yearly
[0m21:00:09.020095 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_stores_items_monthly
[0m21:00:09.020828 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (compile): 21:00:09.007092 => 21:00:09.020486
[0m21:00:09.021700 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_sales_seasons_yearly, now model.local_bike.mrt_products_brands_monthly)
[0m21:00:09.022378 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_staff_ranking_yearly
[0m21:00:09.023123 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_staff_sales_monthly
[0m21:00:09.023745 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_stores_sales_monthly
[0m21:00:09.024303 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_products_brands_monthly
[0m21:00:09.025226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_ranking_yearly, now model.local_bike.mrt_staff_ranking_yearly)
[0m21:00:09.026144 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_items_monthly, now model.local_bike.mrt_staff_sales_monthly)
[0m21:00:09.049226 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_staff_sales_monthly
[0m21:00:09.033225 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_staff_ranking_yearly
[0m21:00:09.026861 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (execute): 21:00:09.026507 => 21:00:09.026528
[0m21:00:09.050224 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:09.057029 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:09.061948 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_staff_ranking_yearly"
[0m21:00:09.063569 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_stores_sales_monthly
[0m21:00:09.066076 [debug] [Thread-2 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m21:00:09.068175 [debug] [Thread-3 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m21:00:09.112405 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (compile): 21:00:09.057461 => 21:00:09.111676
[0m21:00:09.113823 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_staff_ranking_yearly
[0m21:00:09.114615 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (execute): 21:00:09.114243 => 21:00:09.114270
[0m21:00:09.116011 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_staff_ranking_yearly
[0m21:00:11.989733 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:6199858b-1432-49b6-bc9e-3099ffc0358e&page=queryresults
[0m21:00:11.991328 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_staff_sales_monthly"
[0m21:00:11.992623 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (compile): 21:00:09.050649 => 21:00:11.992154
[0m21:00:11.993205 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_staff_sales_monthly
[0m21:00:11.993758 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (execute): 21:00:11.993476 => 21:00:11.993498
[0m21:00:11.995160 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_staff_sales_monthly
[0m21:00:12.181693 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:69e10652-4b0e-443e-a00e-300343bef58d&page=queryresults
[0m21:00:12.183035 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_products_brands_monthly"
[0m21:00:12.184046 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_products_brands_monthly (compile): 21:00:09.027207 => 21:00:12.183629
[0m21:00:12.184537 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_products_brands_monthly
[0m21:00:12.185112 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_products_brands_monthly (execute): 21:00:12.184825 => 21:00:12.184847
[0m21:00:12.186409 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_products_brands_monthly
[0m21:00:12.188635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:12.189059 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_sales_monthly' was properly closed.
[0m21:00:12.189329 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_ranking_yearly' was properly closed.
[0m21:00:12.189576 [debug] [MainThread]: Connection 'model.local_bike.mrt_products_brands_monthly' was properly closed.
[0m21:00:12.189898 [debug] [MainThread]: Connection 'model.local_bike.mrt_stores_sales_monthly' was properly closed.
[0m21:00:12.195514 [debug] [MainThread]: Command end result
[0m21:00:12.328923 [debug] [MainThread]: Command `dbt compile` succeeded at 21:00:12.328586 after 5.78 seconds
[0m21:00:12.329512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70feab8479e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70feab8478c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70feab493560>]}
[0m21:00:12.330018 [debug] [MainThread]: Flushing usage events
[0m21:00:45.607307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792cbf7e3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792cbff92630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792cbfd00d40>]}


============================== 21:00:45.613573 | 25035264-494a-42fa-b901-104b73213dc4 ==============================
[0m21:00:45.613573 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:00:45.614775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'write_json': 'True', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'quiet': 'False', 'target_path': 'None', 'static_parser': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None'}
[0m21:00:47.023115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792cbff92630>]}
[0m21:00:47.046426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca79bfc20>]}
[0m21:00:47.095866 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m21:00:47.173398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:00:47.173981 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:00:47.184509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca7bd30e0>]}
[0m21:00:47.206066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca7765130>]}
[0m21:00:47.206836 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m21:00:47.207495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca7cec470>]}
[0m21:00:47.212572 [info ] [MainThread]: 
[0m21:00:47.214176 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:00:47.217122 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m21:00:47.217888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:47.218960 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m21:00:47.220833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:47.220315 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m21:00:47.224256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:47.872540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now create_databird-473015_dbt_bike_gold)
[0m21:00:47.873756 [debug] [ThreadPool]: Creating schema "database: "databird-473015"
schema: "dbt_bike_gold"
"
[0m21:00:47.888480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:47.890673 [debug] [ThreadPool]: On create_databird-473015_dbt_bike_gold: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "create_databird-473015_dbt_bike_gold"} */
create schema if not exists `databird-473015`.`dbt_bike_gold`
  
[0m21:00:48.941431 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:a846de39-8d0b-437c-8bce-e71d7f4de62f&page=queryresults
[0m21:00:48.946323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_databird-473015_dbt_bike_gold, now list_databird-473015_dbt_bike_seeds)
[0m21:00:48.947122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:48.948166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_gold)
[0m21:00:48.949550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_silver)
[0m21:00:48.990008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:48.991228 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m21:00:48.993724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:48.992324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:49.375482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca79be5d0>]}
[0m21:00:49.377090 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:00:49.377866 [info ] [MainThread]: 
[0m21:00:49.387128 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_brands
[0m21:00:49.387999 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_categories
[0m21:00:49.388638 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_customers
[0m21:00:49.390167 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_order_items
[0m21:00:49.389478 [info ] [Thread-1 (]: 1 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_brands ......... [RUN]
[0m21:00:49.391190 [info ] [Thread-2 (]: 2 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_categories ..... [RUN]
[0m21:00:49.395242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.stg_src_local_bike_brands)
[0m21:00:49.396695 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.stg_src_local_bike_categories)
[0m21:00:49.392317 [info ] [Thread-3 (]: 3 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_customers ...... [RUN]
[0m21:00:49.397879 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_brands
[0m21:00:49.393636 [info ] [Thread-4 (]: 4 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_order_items .... [RUN]
[0m21:00:49.398952 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_categories
[0m21:00:49.400095 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.stg_src_local_bike_customers)
[0m21:00:49.406172 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_brands"
[0m21:00:49.407316 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.stg_src_local_bike_order_items)
[0m21:00:49.411152 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_customers
[0m21:00:49.419563 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_order_items
[0m21:00:49.431158 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (compile): 21:00:49.400556 => 21:00:49.430584
[0m21:00:49.433072 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_customers"
[0m21:00:49.445653 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_order_items"
[0m21:00:49.448716 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_brands
[0m21:00:49.466365 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_categories"
[0m21:00:49.496032 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (compile): 21:00:49.424472 => 21:00:49.495359
[0m21:00:49.510122 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_customers
[0m21:00:49.497680 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (compile): 21:00:49.407831 => 21:00:49.497087
[0m21:00:49.524573 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_categories
[0m21:00:49.509196 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (compile): 21:00:49.436293 => 21:00:49.508325
[0m21:00:49.559487 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_customers"
[0m21:00:49.560296 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_categories"
[0m21:00:49.561013 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_order_items
[0m21:00:49.563638 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_brands"
[0m21:00:49.569751 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_order_items"
[0m21:00:49.571078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:49.573635 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_brands: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_brands"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
  OPTIONS(
      description="""Bike brands sold by Local Bike."""
    )
  as select
        brand_id as brand_id,
        INITCAP(brand_name) as brand_name
from `databird-473015`.`src_local_bike`.`brands`;


[0m21:00:49.574268 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:49.574750 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:49.613380 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:00:49.618779 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_categories: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_categories"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_categories`
  OPTIONS(
      description="""Product categories such as road, mountain, and electric bikes."""
    )
  as select
        category_id as category_id,
        INITCAP(category_name) as category_name
from `databird-473015`.`src_local_bike`.`categories`;


[0m21:00:49.621248 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_customers: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_customers"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_customers`
  OPTIONS(
      description="""Customer informations."""
    )
  as select
    customer_id as customer_id,
    INITCAP(first_name) as customer_first_name,
    INITCAP(last_name) as customer_last_name,
    phone as customer_phone,
    email as customer_email,
    INITCAP(street) as customer_street,
    INITCAP(city) as customer_city,
    UPPER(state) as customer_state,
    zip_code as customer_zip_code
from `databird-473015`.`src_local_bike`.`customers`;


[0m21:00:49.665029 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_order_items: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_order_items"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
  OPTIONS(
      description="""Detailed order line items with pricing and discounts."""
    )
  as SELECT
  order_id as order_id,
  item_id AS item_id,
  product_id as product_id,
  quantity as quantity,
  list_price as list_price,
  discount as discount,
  
    list_price * quantity * ( 1 - discount )
 AS total_item_discount_sold
FROM `databird-473015`.`src_local_bike`.`order_items`;


[0m21:00:50.344278 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:782838bf-059a-4b77-a6c1-3d685b084ace&page=queryresults
[0m21:00:50.371648 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:f04cae8b-af10-4db4-a514-2db77b83222c&page=queryresults
[0m21:00:50.383223 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:53dd02f3-01ec-4488-a590-00684b3dd9f1&page=queryresults
[0m21:00:50.385734 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:2ea5d838-5a15-445b-bf3a-58c3548b7efa&page=queryresults
[0m21:00:50.637078 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (execute): 21:00:49.467038 => 21:00:50.636725
[0m21:00:50.638569 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (execute): 21:00:49.510634 => 21:00:50.638287
[0m21:00:50.639716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca75a0710>]}
[0m21:00:50.640903 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca7578830>]}
[0m21:00:50.641886 [info ] [Thread-1 (]: 1 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_brands .... [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m21:00:50.643312 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_brands
[0m21:00:50.644110 [info ] [Thread-3 (]: 3 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_customers . [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m21:00:50.645206 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_orders
[0m21:00:50.646589 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_customers
[0m21:00:50.648985 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_products
[0m21:00:50.647544 [info ] [Thread-1 (]: 5 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_orders ......... [RUN]
[0m21:00:50.651578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_brands, now model.local_bike.stg_src_local_bike_orders)
[0m21:00:50.649899 [info ] [Thread-3 (]: 6 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_products ....... [RUN]
[0m21:00:50.652273 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_orders
[0m21:00:50.653278 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_customers, now model.local_bike.stg_src_local_bike_products)
[0m21:00:50.658658 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_products
[0m21:00:50.665573 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_products"
[0m21:00:50.677412 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_orders"
[0m21:00:50.678637 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_products (compile): 21:00:50.660659 => 21:00:50.678251
[0m21:00:50.679447 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (compile): 21:00:50.653661 => 21:00:50.679109
[0m21:00:50.680024 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_products
[0m21:00:50.680578 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_orders
[0m21:00:50.690322 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_orders"
[0m21:00:50.685864 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_products"
[0m21:00:50.691666 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:50.692305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:50.694719 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_products"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_products`
  OPTIONS(
      description="""Products sold, linked to brands and categories."""
    )
  as select
        product_id as product_id,
        INITCAP(product_name) as product_name,
        brand_id as brand_id,
        category_id as category_id,
        model_year as model_year,
        coalesce(list_price,0) as list_price
from `databird-473015`.`src_local_bike`.`products`;


[0m21:00:50.736641 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_orders: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_orders"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`
  OPTIONS(
      description="""Order headers with key dates and statuses"""
    )
  as select
    order_id as order_id,
    customer_id as customer_id,
    order_status as order_status,
    CAST(order_date as date) as order_date,
    CAST(required_date as date) as required_date,
    CAST(shipped_date as date) as shipped_date,
    store_id as store_id,
    staff_id as staff_id,
    
    CASE
        WHEN EXTRACT(MONTH FROM order_date) IN (12, 1, 2) THEN 'Winter'
        WHEN EXTRACT(MONTH FROM order_date) IN (3, 4, 5) THEN 'Spring'
        WHEN EXTRACT(MONTH FROM order_date) IN (6, 7, 8) THEN 'Summer'
        WHEN EXTRACT(MONTH FROM order_date) IN (9, 10, 11) THEN 'Autumn'
    END
 AS season_name
from `databird-473015`.`src_local_bike`.`orders`;


[0m21:00:50.779084 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (execute): 21:00:49.564488 => 21:00:50.778747
[0m21:00:50.780228 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca7579280>]}
[0m21:00:50.781250 [info ] [Thread-4 (]: 4 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_order_items  [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m21:00:50.785782 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_order_items
[0m21:00:50.784080 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (execute): 21:00:49.525342 => 21:00:50.783495
[0m21:00:50.788711 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca75a0ef0>]}
[0m21:00:50.786983 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_staffs
[0m21:00:50.789644 [info ] [Thread-2 (]: 2 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_categories  [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m21:00:50.791822 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_categories
[0m21:00:50.792625 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_stocks
[0m21:00:50.790431 [info ] [Thread-4 (]: 7 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_staffs ......... [RUN]
[0m21:00:50.796912 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_order_items, now model.local_bike.stg_src_local_bike_staffs)
[0m21:00:50.797631 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_staffs
[0m21:00:50.794572 [info ] [Thread-2 (]: 8 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_stocks ......... [RUN]
[0m21:00:50.808262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_categories, now model.local_bike.stg_src_local_bike_stocks)
[0m21:00:50.810167 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_stocks
[0m21:00:50.822820 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_staffs"
[0m21:00:50.824016 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stocks"
[0m21:00:50.825403 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (compile): 21:00:50.800203 => 21:00:50.824902
[0m21:00:50.828768 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_staffs
[0m21:00:50.827658 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (compile): 21:00:50.812950 => 21:00:50.827170
[0m21:00:50.834650 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_staffs"
[0m21:00:50.835917 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_stocks
[0m21:00:50.841067 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_stocks"
[0m21:00:50.842068 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:00:50.842658 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:50.845357 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_staffs: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_staffs"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs`
  OPTIONS(
      description="""Sales and management staff working in Local Bike stores."""
    )
  as select
    CAST(staff_id AS int) as staff_id,
    INITCAP(first_name) as staff_first_name,
    INITCAP(last_name) as staff_last_name,
    phone as staff_phone,
    email as staff_email,
    active as staff_active,
    store_id as store_id,
    CAST(manager_id AS int)  as manager_id
from `databird-473015`.`src_local_bike`.`staffs`;


[0m21:00:50.849289 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_stocks: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_stocks"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stocks`
  OPTIONS(
      description="""Stock of products and availability."""
    )
  as select
    store_id   as store_id,
    product_id as product_id,
    quantity   as stock_quantity
from `databird-473015`.`src_local_bike`.`stocks`;


[0m21:00:51.470897 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:c888e24a-59a8-45f8-9ef8-f69251ac5189&page=queryresults
[0m21:00:51.583272 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:857380d1-2eac-4bb8-a672-7266692dea1a&page=queryresults
[0m21:00:51.622435 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:7a65184c-0b09-4e5e-bba2-71617e47f840&page=queryresults
[0m21:00:51.772282 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:b1736bd9-aed2-40cc-95ec-35584d511059&page=queryresults
[0m21:00:51.872040 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (execute): 21:00:50.686225 => 21:00:51.871668
[0m21:00:51.873462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca7a318b0>]}
[0m21:00:51.875087 [info ] [Thread-1 (]: 5 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_orders .... [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m21:00:51.876782 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_orders
[0m21:00:51.878344 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_products (execute): 21:00:50.680966 => 21:00:51.878068
[0m21:00:51.879186 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_stores
[0m21:00:51.880836 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca440d760>]}
[0m21:00:51.881613 [info ] [Thread-1 (]: 9 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_stores ......... [RUN]
[0m21:00:51.883247 [info ] [Thread-3 (]: 6 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_products .. [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m21:00:51.884938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_orders, now model.local_bike.stg_src_local_bike_stores)
[0m21:00:51.886158 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_products
[0m21:00:51.886886 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_stores
[0m21:00:51.893430 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stores"
[0m21:00:51.894203 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_product_daily
[0m21:00:51.895243 [info ] [Thread-3 (]: 10 of 24 START sql view model dbt_bike_silver.int_src_local_bike_product_daily . [RUN]
[0m21:00:51.897617 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_products, now model.local_bike.int_src_local_bike_product_daily)
[0m21:00:51.898312 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_product_daily
[0m21:00:51.906943 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_product_daily"
[0m21:00:51.909167 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_stores (compile): 21:00:51.887491 => 21:00:51.908654
[0m21:00:51.909894 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_stores
[0m21:00:51.915443 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_stores"
[0m21:00:51.920197 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (execute): 21:00:50.829174 => 21:00:51.919842
[0m21:00:51.921131 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (compile): 21:00:51.898708 => 21:00:51.920651
[0m21:00:51.923661 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_product_daily
[0m21:00:51.922833 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca7578bc0>]}
[0m21:00:51.924364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:51.930543 [info ] [Thread-4 (]: 7 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_staffs .... [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m21:00:51.931395 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_product_daily"
[0m21:00:51.932681 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_staffs
[0m21:00:51.935070 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_stores: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_stores"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`
  OPTIONS(
      description="""Store locations in California, New York, and Texas."""
    )
  as select
    store_id as store_id,
    INITCAP(store_name) as store_name,
    phone as store_phone,
    email as store_email,
    street as store_street,
    INITCAP(city) as store_city,
    UPPER(state) as store_state,
    zip_code as store_zip_code
from `databird-473015`.`src_local_bike`.`stores`;


[0m21:00:51.936446 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:00:51.978856 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:51.979902 [info ] [Thread-4 (]: 11 of 24 START sql view model dbt_bike_silver.int_src_local_bike_staff_hierarchy  [RUN]
[0m21:00:51.982542 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_staffs, now model.local_bike.int_src_local_bike_staff_hierarchy)
[0m21:00:51.983502 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:00:51.990994 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m21:00:51.995634 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (compile): 21:00:51.984016 => 21:00:51.994867
[0m21:00:51.996556 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:00:51.997732 [debug] [Thread-3 (]: On model.local_bike.int_src_local_bike_product_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_product_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily`
  OPTIONS(
      description="""This model provides an aggregated view of product items. It enriches the products data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each product.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Product Informations**: Enriches the product with user-specific data, such as brand and category.\r\n\r\nIt provides a comprehensive view of each product, allowing for easy analysis of product performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH order_items AS (
  SELECT 
        order_id as order_id,
        item_id as item_id,
        product_id as product_id,
        quantity as quantity,
        list_price as list_price,
        discount as discount,
        ROUND((discount * 100),2) as discount_percent,
        ROUND(total_item_discount_sold, 2) as total_item_discount_sold 
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
),
------------------------------------------
orders_date AS (
  SELECT 
        order_id, 
        CAST(order_date as date) as order_date,
        store_id,
        season_name,
        EXTRACT(YEAR FROM order_date) as yeardate,
        EXTRACT(YEAR FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`
),
------------------------------------------
products AS (
  SELECT 
        product_id as product_id,
        product_name as product_name,
        brand_id as brand_id,
        category_id as category_id,
        model_year as product_model_year,
        ROUND(list_price,2) as list_price
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_products`
),
------------------------------------------
brands AS (
  SELECT 
        brand_id as brand_id,
        brand_name as brand_name
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
),
------------------------------------------
categories AS (
  SELECT 
        category_id as category_id,
        category_name as category_name
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_categories`
)
------------------------------------------
SELECT
  o.order_id,
  o.store_id,
  o.order_date,
  o.yeardate,
  o.monthday,
  o.yearmonth,
  o.month_2digits,
  o.month_name,
  o.month_abbrev,
  o.week_number,
  o.season_name,
  p.product_id,
  p.product_name,
  b.brand_name,
  c.category_name,
  oi.quantity,
  oi.list_price,
  oi.discount,
  oi.discount_percent,
  SUM(oi.total_item_discount_sold) as total_item_discount_sold,
  COUNT(*) as total_items
FROM orders_date as o
LEFT JOIN order_items as oi ON o.order_id = oi.order_id
LEFT JOIN products as p ON oi.product_id = p.product_id
LEFT JOIN brands as b ON p.brand_id = b.brand_id
LEFT JOIN categories as c ON p.category_id = c.category_id
GROUP BY 
  o.order_id,
  o.store_id,
  o.order_date,
  o.yeardate,
  o.monthday,
  o.yearmonth,
  o.month_2digits,
  o.month_name,
  o.month_abbrev,
  o.week_number,
  o.season_name, 
  p.product_id,
  p.product_name,
  b.brand_name,
  c.category_name,
  oi.quantity,
  oi.list_price,
  oi.discount,
  oi.discount_percent
ORDER BY o.yeardate, o.week_number, o.order_id;


[0m21:00:52.046577 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m21:00:52.050369 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:00:52.056792 [debug] [Thread-4 (]: On model.local_bike.int_src_local_bike_staff_hierarchy: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_hierarchy"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy`
  OPTIONS(
      description="""This model provides an hirarchical view of employees. It enriches the store data with the following data:\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each employe.."""
    )
  as ------------------------------------------
  WITH RECURSIVE staff_hierarchy AS (

  -- Niveau 0 : managers racine
  SELECT
    m.staff_id,
    m.staff_first_name,
    m.staff_last_name,
    m.manager_id,
    m.store_id,
    m.staff_first_name || ' ' || m.staff_last_name AS path,
    0 AS level
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs` m
  WHERE m.manager_id IS NULL

  UNION ALL

  -- Niveaux suivants : rattacher les subordonnés
  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,    
    CONCAT(h.path, ' → ', s.staff_first_name, ' ', s.staff_last_name) AS path,
    h.level + 1 AS level
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs` s
  JOIN staff_hierarchy as h ON s.manager_id = h.staff_id
  
)
------------------------------------------
SELECT 
     * 
FROM staff_hierarchy
ORDER BY path, level;


[0m21:00:52.107474 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (execute): 21:00:50.836580 => 21:00:52.106897
[0m21:00:52.109496 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca4433ad0>]}
[0m21:00:52.111523 [info ] [Thread-2 (]: 8 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_stocks .... [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m21:00:52.115880 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_stocks
[0m21:00:52.605339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:2f50cef5-2e46-4701-89dc-0f6ab11ae4bf&page=queryresults
[0m21:00:52.898563 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:e5feb45d-bad3-4e41-a491-3344f1068b3d&page=queryresults
[0m21:00:52.923399 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_stores (execute): 21:00:51.910364 => 21:00:52.923099
[0m21:00:52.924515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca4421910>]}
[0m21:00:52.925384 [info ] [Thread-1 (]: 9 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_stores .... [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m21:00:52.926963 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_stores
[0m21:00:52.928348 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_store_daily
[0m21:00:52.929140 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:00:52.930245 [info ] [Thread-2 (]: 12 of 24 START sql view model dbt_bike_silver.int_src_local_bike_store_daily ... [RUN]
[0m21:00:52.931648 [info ] [Thread-1 (]: 13 of 24 START sql view model dbt_bike_silver.int_src_local_bike_store_shipped_order  [RUN]
[0m21:00:52.935335 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:964ecf74-0055-4868-811c-6e13519a5c9d&page=queryresults
[0m21:00:52.936441 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stocks, now model.local_bike.int_src_local_bike_store_daily)
[0m21:00:52.940714 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_store_daily
[0m21:00:52.937479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stores, now model.local_bike.int_src_local_bike_store_shipped_order)
[0m21:00:52.947277 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:00:52.950912 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_daily"
[0m21:00:53.070277 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (compile): 21:00:52.941136 => 21:00:53.069711
[0m21:00:53.071002 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_store_daily
[0m21:00:53.077228 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_store_daily"
[0m21:00:53.084532 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:53.100525 [debug] [Thread-2 (]: On model.local_bike.int_src_local_bike_store_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  OPTIONS(
      description="""This model provides an aggregated view of stores. It enriches the store data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each store.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Total Distinct Items**: The count of distinct product types in the order.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_date AS (

  SELECT 
        order_id, 
        order_date,
        shipped_date,
        required_date,
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    o.shipped_date,
    o.required_date,    
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.shipped_date,
    ls.required_date,     
    ls.order_id,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date,ls.shipped_date,ls.required_date, ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m21:00:53.152247 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m21:00:53.155778 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (compile): 21:00:52.951360 => 21:00:53.155093
[0m21:00:53.157763 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:00:53.165849 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m21:00:53.167405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:53.171439 [debug] [Thread-1 (]: On model.local_bike.int_src_local_bike_store_shipped_order: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_shipped_order"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_shipped_order`
  OPTIONS(
      description="""This model provides the list of order required, shipped and aborted per month over 3 years.\r\n\r\nIt provides a comprehensive view of each order, allowing for easy analysis of order performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_shipped_date AS (

  SELECT 
        order_id, 
        order_date,
        required_date,
        shipped_date, 
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    required_date,
    shipped_date,
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_shipped_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.order_id,
    ls.shipped_date ,
    ls.required_date ,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date, ls.shipped_date, ls.required_date,ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m21:00:53.258198 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (execute): 21:00:51.998666 => 21:00:53.257602
[0m21:00:53.260076 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca4423fe0>]}
[0m21:00:53.261470 [info ] [Thread-4 (]: 11 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_staff_hierarchy  [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m21:00:53.263831 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:00:53.265198 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_staff_daily
[0m21:00:53.266196 [info ] [Thread-4 (]: 14 of 24 START sql view model dbt_bike_silver.int_src_local_bike_staff_daily ... [RUN]
[0m21:00:53.268602 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_hierarchy, now model.local_bike.int_src_local_bike_staff_daily)
[0m21:00:53.269320 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_staff_daily
[0m21:00:53.279474 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_daily"
[0m21:00:53.281070 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (compile): 21:00:53.269721 => 21:00:53.280462
[0m21:00:53.281663 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_staff_daily
[0m21:00:53.287734 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_staff_daily"
[0m21:00:53.289744 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:00:53.292574 [debug] [Thread-4 (]: On model.local_bike.int_src_local_bike_staff_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  OPTIONS(
      description="""This model provides an aggregated view of staffs and stores. It enriches the store and staff data with the following metrics:\r\n- **Total item Amount**: The sum of all order items for each employe.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each store and staffs, allowing for easy analysis of store performance, employee performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH staff_list AS (

  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,
    s.path,
    s.level
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy` s

),
------------------------------------------
sales_by_employee AS (

  SELECT
    o.order_date as order_date,
    o.season_name,
    EXTRACT(YEAR FROM o.order_date) as yeardate,
    EXTRACT(YEAR FROM o.order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') AS yearmonth,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM o.order_date) AS STRING), 2, '0') AS monthday,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') as month_2digits,
    FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_name,
    FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_abbrev,
    LPAD(CAST(EXTRACT(ISOWEEK FROM o.order_date) AS STRING), 2, '0') AS week_number,
    o.staff_id,
    oi.total_item_discount_sold as total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders` as o
  LEFT JOIN `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items` as oi ON o.order_id = oi.order_id

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

)
------------------------------------------
SELECT 
    em.order_date,
    em.yeardate,
    em.monthday,
    em.yearmonth,
    em.month_2digits,
    em.month_name,
    em.month_abbrev,
    em.week_number,
    em.season_name,
    st.store_name,
    m.store_latitude,
    m.store_longitude,    
    st.store_city,
    st.store_state,    
    ROUND(em.total_item_discount_sold, 2) as total_item_sold_staff,
    s.*
FROM sales_by_employee as em 
JOIN staff_list as s ON em.staff_id = s.staff_id
LEFT JOIN map as m on s.store_id = m.store_id
LEFT JOIN stores as st on m.store_id = st.store_id
ORDER BY em.order_date;


[0m21:00:53.448470 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (execute): 21:00:51.924712 => 21:00:53.448128
[0m21:00:53.449720 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792cc155bbf0>]}
[0m21:00:53.450591 [info ] [Thread-3 (]: 10 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_product_daily  [[32mCREATE VIEW (0 processed)[0m in 1.55s]
[0m21:00:53.451920 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_product_daily
[0m21:00:53.813761 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:badb4b64-2255-4ed0-af74-9d17335295c0&page=queryresults
[0m21:00:53.882242 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:23eb504d-5a90-461b-aa6d-45d49c9f73b1&page=queryresults
[0m21:00:54.054410 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:3e4b5b88-0950-4932-8abd-aeb7ea591aec&page=queryresults
[0m21:00:54.105822 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (execute): 21:00:53.072639 => 21:00:54.105439
[0m21:00:54.107110 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca7571cd0>]}
[0m21:00:54.108030 [info ] [Thread-2 (]: 12 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_store_daily  [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m21:00:54.109535 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_store_daily
[0m21:00:54.111371 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:00:54.112149 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_order_shipped_montly
[0m21:00:54.113074 [info ] [Thread-3 (]: 15 of 24 START sql table model dbt_bike_gold.orders_shipped_aborted_monthly_report  [RUN]
[0m21:00:54.114585 [info ] [Thread-2 (]: 16 of 24 START sql table model dbt_bike_gold.orders_shipped_monthly_report ..... [RUN]
[0m21:00:54.116291 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_product_daily, now model.local_bike.mrt_order_shipped_aborted_montly)
[0m21:00:54.117399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_daily, now model.local_bike.mrt_order_shipped_montly)
[0m21:00:54.117993 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:00:54.118497 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_order_shipped_montly
[0m21:00:54.125298 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m21:00:54.130767 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_montly"
[0m21:00:54.132471 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_montly (compile): 21:00:54.125861 => 21:00:54.132049
[0m21:00:54.133085 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_order_shipped_montly
[0m21:00:54.139081 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (compile): 21:00:54.118857 => 21:00:54.138561
[0m21:00:54.145036 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:00:54.204273 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_order_shipped_montly"
[0m21:00:54.206235 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m21:00:54.210241 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (execute): 21:00:53.158405 => 21:00:54.209883
[0m21:00:54.211591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca4453710>]}
[0m21:00:54.212647 [info ] [Thread-1 (]: 13 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_store_shipped_order  [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m21:00:54.214433 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:00:54.215366 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:00:54.219851 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:54.216738 [info ] [Thread-1 (]: 17 of 24 START sql table model dbt_bike_gold.products_stores_ranking_yearly_report  [RUN]
[0m21:00:54.221049 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:54.222185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_shipped_order, now model.local_bike.mrt_products_ranking_yearly_top3)
[0m21:00:54.224721 [debug] [Thread-3 (]: On model.local_bike.mrt_order_shipped_aborted_montly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_order_shipped_aborted_montly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`orders_shipped_aborted_monthly_report`
    
    

    OPTIONS(
      description="""This model provides an aggregated view of the canceled orders. It enriches the order data with the following metrics:\r\n- **nb_shipped_aborted**: The quantity of order aborted.\r\n- **total_aborted_sales**: The cost of aborted orders.\r\n- **Order Informations**: Enriches the product with user-specific data, such as store name.\r\n\r\nIt provides a comprehensive view the aborted order, allowing for easy analysis of order performance."""
    )
    as (
      ------------------------------------------

------------------------------------------

WITH total_aborted_orders AS (

  SELECT
    yearmonth AS month,
    COUNTIF(shipped_date IS NULL) AS nb_shipped_aborted,
    ROUND(SUM(total_sales_amount),2) as total_aborted_sales,
    store_name
  FROM  `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  WHERE shipped_date is null
  GROUP BY month,store_name

)
------------------------------------------
SELECT *
FROM total_aborted_orders
------------------------------------------
    );
  
[0m21:00:54.225458 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:00:54.227709 [debug] [Thread-2 (]: On model.local_bike.mrt_order_shipped_montly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_order_shipped_montly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`orders_shipped_monthly_report`
    
    

    OPTIONS(
      description="""This model provides an aggregated view of the orders sent. It enriches the order data with the following metrics:\r\n- **nb_order_shipped**: The quantity of orders shipped.\r\n- **total_sales**: The cost of orders shipped.\r\n- **Order Informations**: Enriches the product with user-specific data, such as store name.\r\n\r\nIt provides a comprehensive view the aborted order, allowing for easy analysis of order performance."""
    )
    as (
      ------------------------------------------

------------------------------------------

WITH total_orders AS (

  SELECT
    yearmonth AS month,
    COUNT(order_date) AS nb_order_shipped,
    ROUND(SUM(total_sales_amount),2) as total_sales,
    store_name
  FROM  `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  WHERE shipped_date is not null
  GROUP BY month,store_name

)
------------------------------------------
SELECT *
FROM total_orders
------------------------------------------
    );
  
[0m21:00:54.275654 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m21:00:54.320750 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (compile): 21:00:54.266847 => 21:00:54.318345
[0m21:00:54.322360 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:00:54.340537 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m21:00:54.342181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:54.347246 [debug] [Thread-1 (]: On model.local_bike.mrt_products_ranking_yearly_top3: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_ranking_yearly_top3"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`products_stores_ranking_yearly_report`
    
    

    OPTIONS(
      description="""This model provides the top 3 **best-selling products** per year over 3 years.\r\n\r\nIt provides a comprehensive view of each product, allowing for easy analysis of products performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH product_sales AS (
  SELECT
    p.yeardate AS year,
    s.store_name AS store,
    p.product_name,
    p.brand_name,
    ROUND(SUM(total_item_discount_sold), 2) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily` AS p
  LEFT JOIN `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`AS s
    ON p.order_id = s.order_id 
   AND p.store_id = s.store_id
  GROUP BY year,store,product_name,brand_name
)
------------------------------------------
SELECT
  year,
  store,
  product_name,
  brand_name,
  total_sales
FROM (
  SELECT
    *,
    RANK() OVER ( PARTITION BY year, store ORDER BY total_sales DESC ) AS rank_product
  FROM product_sales
)
WHERE rank_product <= 3
ORDER BY year, store
------------------------------------------
    );
  
[0m21:00:54.439529 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (execute): 21:00:53.281956 => 21:00:54.438729
[0m21:00:54.449242 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca446a930>]}
[0m21:00:54.450474 [info ] [Thread-4 (]: 14 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_staff_daily  [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m21:00:54.453119 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_staff_daily
[0m21:00:54.454158 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_sales_seasons_yearly
[0m21:00:54.455064 [info ] [Thread-4 (]: 18 of 24 START sql table model dbt_bike_gold.sales_seasons_yearly_report ....... [RUN]
[0m21:00:54.458206 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_daily, now model.local_bike.mrt_sales_seasons_yearly)
[0m21:00:54.459183 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_sales_seasons_yearly
[0m21:00:54.470043 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_sales_seasons_yearly"
[0m21:00:54.471967 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (compile): 21:00:54.459606 => 21:00:54.471269
[0m21:00:54.472741 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_sales_seasons_yearly
[0m21:00:54.479823 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.mrt_sales_seasons_yearly"
[0m21:00:54.481352 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:00:54.484447 [debug] [Thread-4 (]: On model.local_bike.mrt_sales_seasons_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_sales_seasons_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`sales_seasons_yearly_report`
    
    

    OPTIONS(
      description="""This model provides the **top-performing store by season** and per year over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH sales_stores_seasons AS (

  SELECT
    yeardate AS year,
    store_name AS store,
    season_name,
    ROUND(SUM(total_sales_amount), 2) AS sales_amount
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year,store,season_name

)

SELECT *
FROM sales_stores_seasons
PIVOT (
  SUM(sales_amount) AS sales
  FOR season_name IN ('Winter','Spring','Summer','Autumn')
)
ORDER BY year, store
------------------------------------------
    );
  
[0m21:00:57.053243 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:79777625-9d08-465a-89e5-de5d5c0f883f&page=queryresults
[0m21:00:57.286092 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:56cbca28-f7a8-4eb2-9c6b-4a7da704ce53&page=queryresults
[0m21:00:57.321508 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (execute): 21:00:54.151409 => 21:00:57.321161
[0m21:00:57.322620 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca79fa270>]}
[0m21:00:57.323450 [info ] [Thread-3 (]: 15 of 24 OK created sql table model dbt_bike_gold.orders_shipped_aborted_monthly_report  [[32mCREATE TABLE (38.0 rows, 215.1 KiB processed)[0m in 3.21s]
[0m21:00:57.324693 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:00:57.325397 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_stores_items_monthly
[0m21:00:57.326039 [info ] [Thread-3 (]: 19 of 24 START sql table model dbt_bike_gold.items_stores_monthly_report ....... [RUN]
[0m21:00:57.327640 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_aborted_montly, now model.local_bike.mrt_stores_items_monthly)
[0m21:00:57.328345 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_stores_items_monthly
[0m21:00:57.335993 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_stores_items_monthly"
[0m21:00:57.337088 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_stores_items_monthly (compile): 21:00:57.328738 => 21:00:57.336667
[0m21:00:57.337613 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_stores_items_monthly
[0m21:00:57.342127 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.mrt_stores_items_monthly"
[0m21:00:57.342877 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:57.345046 [debug] [Thread-3 (]: On model.local_bike.mrt_stores_items_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_items_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`items_stores_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **total number of items sold** per store over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT *
FROM (

  SELECT
    yeardate AS year,
    month_2digits as month,
    store_name,
    COUNT(total_items) AS nb_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year, month, store_name

)
PIVOT (

  SUM(nb_items) AS total_items
  FOR store_name IN ('Santa Cruz Bikes','Baldwin Bikes','Rowlett Bikes')

)
ORDER BY year, month
------------------------------------------
    );
  
[0m21:00:57.551347 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:65ed9632-316b-4c84-ae46-394447099ee1&page=queryresults
[0m21:00:57.619329 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_montly (execute): 21:00:54.133402 => 21:00:57.619026
[0m21:00:57.620395 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca7586a80>]}
[0m21:00:57.621176 [info ] [Thread-2 (]: 16 of 24 OK created sql table model dbt_bike_gold.orders_shipped_monthly_report  [[32mCREATE TABLE (81.0 rows, 215.1 KiB processed)[0m in 3.50s]
[0m21:00:57.622308 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_order_shipped_montly
[0m21:00:57.622940 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_stores_ranking_yearly
[0m21:00:57.623526 [info ] [Thread-2 (]: 20 of 24 START sql table model dbt_bike_gold.stores_ranking_yearly_report ...... [RUN]
[0m21:00:57.624768 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_montly, now model.local_bike.mrt_stores_ranking_yearly)
[0m21:00:57.625593 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_stores_ranking_yearly
[0m21:00:57.632127 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_stores_ranking_yearly"
[0m21:00:57.633149 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (compile): 21:00:57.626178 => 21:00:57.632779
[0m21:00:57.633902 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_stores_ranking_yearly
[0m21:00:57.638679 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_stores_ranking_yearly"
[0m21:00:57.639488 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:57.641510 [debug] [Thread-2 (]: On model.local_bike.mrt_stores_ranking_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_ranking_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`stores_ranking_yearly_report`
    
    

    OPTIONS(
      description="""This model provides **the ranking of best stores** over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT
  yeardate AS year_date,
  store_name,
  store_latitude,
  store_longitude,
  ROUND(SUM(total_sales_amount), 2) AS total_sales,
  RANK() OVER (PARTITION BY yeardate ORDER BY SUM(total_sales_amount) DESC) AS store_rank
FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
GROUP BY yeardate, store_name,store_latitude,store_longitude
ORDER BY yeardate, store_rank
------------------------------------------
    );
  
[0m21:00:57.915377 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (execute): 21:00:54.325086 => 21:00:57.915072
[0m21:00:57.916480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca4452000>]}
[0m21:00:57.917342 [info ] [Thread-1 (]: 17 of 24 OK created sql table model dbt_bike_gold.products_stores_ranking_yearly_report  [[32mCREATE TABLE (27.0 rows, 270.5 KiB processed)[0m in 3.69s]
[0m21:00:57.918652 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:00:57.919311 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_stores_sales_monthly
[0m21:00:57.919933 [info ] [Thread-1 (]: 21 of 24 START sql table model dbt_bike_gold.sales_stores_monthly_report ....... [RUN]
[0m21:00:57.921429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_products_ranking_yearly_top3, now model.local_bike.mrt_stores_sales_monthly)
[0m21:00:57.922141 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_stores_sales_monthly
[0m21:00:57.929224 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_stores_sales_monthly"
[0m21:00:57.930200 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (compile): 21:00:57.922695 => 21:00:57.929861
[0m21:00:57.930733 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_stores_sales_monthly
[0m21:00:57.936218 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.mrt_stores_sales_monthly"
[0m21:00:57.938990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:57.941053 [debug] [Thread-1 (]: On model.local_bike.mrt_stores_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_sales_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`sales_stores_monthly_report`
    
    

    OPTIONS(
      description="""This model provides **top sales by store** over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT *
FROM (

  SELECT
    yeardate AS year,
    month_2digits as month,
    store_name,
    ROUND(SUM(total_sales_amount), 2) AS sales_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year, month, store_name

)
PIVOT (

  SUM(sales_items) AS total_sales
  FOR store_name IN ('Santa Cruz Bikes','Baldwin Bikes','Rowlett Bikes')

)
ORDER BY year, month
------------------------------------------
    );
  
[0m21:00:59.607547 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:88001b17-7f6c-4e38-b17d-453f01b3523b&page=queryresults
[0m21:01:00.018665 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_stores_items_monthly (execute): 21:00:57.337890 => 21:01:00.018321
[0m21:01:00.019892 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca75397f0>]}
[0m21:01:00.020694 [info ] [Thread-3 (]: 19 of 24 OK created sql table model dbt_bike_gold.items_stores_monthly_report .. [[32mCREATE TABLE (35.0 rows, 104.5 KiB processed)[0m in 2.69s]
[0m21:01:00.021950 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_stores_items_monthly
[0m21:01:00.022573 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_products_brands_monthly
[0m21:01:00.023344 [info ] [Thread-3 (]: 22 of 24 START sql table model dbt_bike_gold.products_brands_monthly_report .... [RUN]
[0m21:01:00.024711 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_items_monthly, now model.local_bike.mrt_products_brands_monthly)
[0m21:01:00.025405 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_products_brands_monthly
[0m21:01:00.040607 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:01:00.042847 [debug] [Thread-3 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m21:01:00.384902 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:b905599e-1a04-4a17-8786-7cc1eb69c835&page=queryresults
[0m21:01:00.655421 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (execute): 21:00:57.634189 => 21:01:00.655113
[0m21:01:00.656671 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792cc1574740>]}
[0m21:01:00.658297 [info ] [Thread-2 (]: 20 of 24 OK created sql table model dbt_bike_gold.stores_ranking_yearly_report . [[32mCREATE TABLE (9.0 rows, 215.1 KiB processed)[0m in 3.03s]
[0m21:01:00.660127 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_stores_ranking_yearly
[0m21:01:00.661127 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_staff_ranking_yearly
[0m21:01:00.662006 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:6d48fc44-fc79-4fbf-a1f6-f0c947a6647f&page=queryresults
[0m21:01:00.662781 [info ] [Thread-2 (]: 23 of 24 START sql table model dbt_bike_gold.ranking_sales_staffs_yearly_top3_report  [RUN]
[0m21:01:00.667831 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_ranking_yearly, now model.local_bike.mrt_staff_ranking_yearly)
[0m21:01:00.668611 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_staff_ranking_yearly
[0m21:01:00.675248 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_staff_ranking_yearly"
[0m21:01:00.676336 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (compile): 21:01:00.669562 => 21:01:00.675959
[0m21:01:00.676880 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_staff_ranking_yearly
[0m21:01:00.689011 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_staff_ranking_yearly"
[0m21:01:00.690050 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:01:00.692204 [debug] [Thread-2 (]: On model.local_bike.mrt_staff_ranking_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_ranking_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`ranking_sales_staffs_yearly_top3_report`
    
    

    OPTIONS(
      description="""This model provides **Top seller** per store and per year over 3 years.\r\n\r\nIt provides a comprehensive view of each seller, allowing for easy analysis of seller performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH sales_staffs_stores AS (

  SELECT
    yeardate AS year,
    staff_first_name || '-' || staff_last_name || ' ('|| store_name || ')' AS staff_name,
    ROUND(SUM(total_item_sold_staff), 2) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  GROUP BY year, staff_name

)
SELECT
  year,
  staff_name,
  total_sales
FROM (
  SELECT
    *,
    RANK() OVER (PARTITION BY year ORDER BY total_sales DESC) AS rank_sales
  FROM sales_staffs_stores
)
WHERE rank_sales <= 3 
ORDER BY year, total_sales
    );
  
[0m21:01:01.045679 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (execute): 21:00:57.931841 => 21:01:01.045370
[0m21:01:01.046725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca431cf50>]}
[0m21:01:01.047484 [info ] [Thread-1 (]: 21 of 24 OK created sql table model dbt_bike_gold.sales_stores_monthly_report .. [[32mCREATE TABLE (35.0 rows, 215.1 KiB processed)[0m in 3.13s]
[0m21:01:01.048702 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_stores_sales_monthly
[0m21:01:01.049338 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_staff_sales_monthly
[0m21:01:01.049953 [info ] [Thread-1 (]: 24 of 24 START sql table model dbt_bike_gold.staffs_sales_monthly_report ....... [RUN]
[0m21:01:01.051615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_sales_monthly, now model.local_bike.mrt_staff_sales_monthly)
[0m21:01:01.052279 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_staff_sales_monthly
[0m21:01:01.059901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:01.062027 [debug] [Thread-1 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m21:01:02.384432 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:aeef5ba8-a82a-4de4-8671-6d02e1a8993d&page=queryresults
[0m21:01:02.385893 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_products_brands_monthly"
[0m21:01:02.387028 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_products_brands_monthly (compile): 21:01:00.025828 => 21:01:02.386608
[0m21:01:02.387612 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_products_brands_monthly
[0m21:01:02.393369 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.mrt_products_brands_monthly"
[0m21:01:02.394332 [debug] [Thread-3 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`products_brands_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **best-selling brands** per month over 3 years.\r\n\r\nIt provides a comprehensive view of each brand, allowing for easy analysis of brands performance."""
    )
    as (
      ------------------------------------------

------------------------------------------


------------------------------------------
SELECT *
FROM (

  SELECT
    yearmonth AS month,
    brand_name as Brand,    
    ROUND(SUM(total_item_discount_sold), 2 ) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily`
  GROUP BY month, brand

)
PIVOT (

  SUM(total_sales) AS sales
  FOR month IN ( '2016-01','2016-02','2016-03','2016-04','2016-05','2016-06','2016-07','2016-08','2016-09','2016-10','2016-11','2016-12','2017-01','2017-02','2017-03','2017-04','2017-05','2017-06','2017-07','2017-08','2017-09','2017-10','2017-11','2017-12','2018-01','2018-02','2018-03','2018-04','2018-06','2018-07','2018-08','2018-09','2018-10','2018-11','2018-12' )

)
ORDER BY Brand
------------------------------------------
    );
  
[0m21:01:03.442358 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:478025d0-8dc4-418a-9398-280bd01e8f6c&page=queryresults
[0m21:01:03.443736 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_staff_sales_monthly"
[0m21:01:03.444754 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (compile): 21:01:01.052672 => 21:01:03.444396
[0m21:01:03.445291 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_staff_sales_monthly
[0m21:01:03.450420 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.mrt_staff_sales_monthly"
[0m21:01:03.451217 [debug] [Thread-1 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`staffs_sales_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **best-seller** per month over 3 years.\r\n\r\nIt provides a comprehensive view of each seller, allowing for easy analysis of sellers performance."""
    )
    as (
      ------------------------------------------

------------------------------------------


------------------------------------------
SELECT *
FROM (

  SELECT
    staff_first_name || '-' || staff_last_name AS staff_name,
    yearmonth AS month,
    ROUND(SUM(total_item_sold_staff), 2 ) AS total_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  GROUP BY month, staff_name

)
PIVOT (

  SUM(total_items) AS sales
  FOR month IN ( '2016-01','2016-02','2016-03','2016-04','2016-05','2016-06','2016-07','2016-08','2016-09','2016-10','2016-11','2016-12','2017-01','2017-02','2017-03','2017-04','2017-05','2017-06','2017-07','2017-08','2017-09','2017-10','2017-11','2017-12','2018-01','2018-02','2018-03','2018-04','2018-06','2018-07','2018-08','2018-09','2018-10','2018-11','2018-12' )

)
ORDER BY staff_name
------------------------------------------
    );
  
[0m21:01:04.349708 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:d16e1107-aed7-479d-a29c-9654c6600257&page=queryresults
[0m21:01:04.659419 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (execute): 21:01:00.677162 => 21:01:04.659094
[0m21:01:04.660636 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca4433b90>]}
[0m21:01:04.661635 [info ] [Thread-2 (]: 23 of 24 OK created sql table model dbt_bike_gold.ranking_sales_staffs_yearly_top3_report  [[32mCREATE TABLE (9.0 rows, 185.9 KiB processed)[0m in 3.99s]
[0m21:01:04.663171 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_staff_ranking_yearly
[0m21:01:04.903730 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:74a2ffd8-f044-4558-bda2-8f9e0994c7cf&page=queryresults
[0m21:01:04.967507 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:7956e35f-b117-462f-be62-c7412b7619be&page=queryresults
[0m21:01:05.218465 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_products_brands_monthly (execute): 21:01:02.387932 => 21:01:05.218149
[0m21:01:05.219640 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca442ce60>]}
[0m21:01:05.220726 [info ] [Thread-3 (]: 22 of 24 OK created sql table model dbt_bike_gold.products_brands_monthly_report  [[32mCREATE TABLE (9.0 rows, 217.4 KiB processed)[0m in 5.20s]
[0m21:01:05.222087 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_products_brands_monthly
[0m21:01:05.249199 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (execute): 21:00:54.473200 => 21:01:05.248886
[0m21:01:05.250274 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca4349880>]}
[0m21:01:05.455392 [info ] [Thread-4 (]: 18 of 24 OK created sql table model dbt_bike_gold.sales_seasons_yearly_report .. [[32mCREATE TABLE (9.0 rows, 215.1 KiB processed)[0m in 10.79s]
[0m21:01:05.456839 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_sales_seasons_yearly
[0m21:01:07.980421 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:406c25e0-04fb-45c1-b0e9-79ed4938ad58&page=queryresults
[0m21:01:08.308329 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (execute): 21:01:03.445565 => 21:01:08.307971
[0m21:01:08.309662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25035264-494a-42fa-b901-104b73213dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792ca4433fb0>]}
[0m21:01:08.310635 [info ] [Thread-1 (]: 24 of 24 OK created sql table model dbt_bike_gold.staffs_sales_monthly_report .. [[32mCREATE TABLE (6.0 rows, 185.8 KiB processed)[0m in 7.26s]
[0m21:01:08.312009 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_staff_sales_monthly
[0m21:01:08.315674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:08.316175 [debug] [MainThread]: Connection 'model.local_bike.mrt_sales_seasons_yearly' was properly closed.
[0m21:01:08.316457 [debug] [MainThread]: Connection 'model.local_bike.mrt_products_brands_monthly' was properly closed.
[0m21:01:08.316721 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_sales_monthly' was properly closed.
[0m21:01:08.317086 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_ranking_yearly' was properly closed.
[0m21:01:08.317619 [info ] [MainThread]: 
[0m21:01:08.318303 [info ] [MainThread]: Finished running 14 view models, 10 table models in 0 hours 0 minutes and 21.10 seconds (21.10s).
[0m21:01:08.326185 [debug] [MainThread]: Command end result
[0m21:01:08.367851 [info ] [MainThread]: 
[0m21:01:08.368875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:01:08.369634 [info ] [MainThread]: 
[0m21:01:08.370376 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 TOTAL=24
[0m21:01:08.371694 [debug] [MainThread]: Command `dbt run` succeeded at 21:01:08.371496 after 22.78 seconds
[0m21:01:08.372203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792cc0243800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792cbf978d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792cbf9793a0>]}
[0m21:01:08.372751 [debug] [MainThread]: Flushing usage events
[0m21:01:46.075338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f95f3e35c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f95f9af6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f95f334260>]}


============================== 21:01:46.082155 | 09aabede-0e4b-4a54-8556-a1f15414793c ==============================
[0m21:01:46.082155 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:01:46.083625 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'static_parser': 'True', 'log_format': 'default', 'no_print': 'None', 'log_path': '/usr/app/dbt/logs', 'quiet': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error': 'None', 'profiles_dir': '/root/.dbt', 'indirect_selection': 'eager', 'write_json': 'True', 'introspect': 'True', 'printer_width': '80', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'debug': 'False'}
[0m21:01:47.738829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f95f4bbc80>]}
[0m21:01:47.762620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f94cd720f0>]}
[0m21:01:47.812305 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m21:01:47.904566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:01:47.905190 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:01:47.915756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9475c08c0>]}
[0m21:01:47.939073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f94750cad0>]}
[0m21:01:47.939882 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m21:01:47.944555 [info ] [MainThread]: 
[0m21:01:47.946757 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:01:47.951325 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m21:01:47.952900 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m21:01:47.953710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:47.954886 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m21:01:47.956176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:47.955374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:48.663716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_gold)
[0m21:01:48.665064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:48.666764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_bronze)
[0m21:01:48.667436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:48.747693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_silver)
[0m21:01:48.751498 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m21:01:48.752387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:48.753351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:49.107078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f94798f3b0>]}
[0m21:01:49.108397 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:01:49.109365 [info ] [MainThread]: 
[0m21:01:49.118144 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_brands
[0m21:01:49.118937 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_categories
[0m21:01:49.119760 [info ] [Thread-1 (]: 1 of 25 START sql view model dbt_bike_bronze.stg_src_local_bike_brands ......... [RUN]
[0m21:01:49.120779 [info ] [Thread-2 (]: 2 of 25 START sql view model dbt_bike_bronze.stg_src_local_bike_categories ..... [RUN]
[0m21:01:49.121738 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_customers
[0m21:01:49.123895 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_order_items
[0m21:01:49.125176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.stg_src_local_bike_brands)
[0m21:01:49.129353 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_brands
[0m21:01:49.127494 [info ] [Thread-3 (]: 3 of 25 START sql view model dbt_bike_bronze.stg_src_local_bike_customers ...... [RUN]
[0m21:01:49.126608 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.stg_src_local_bike_categories)
[0m21:01:49.128357 [info ] [Thread-4 (]: 4 of 25 START sql view model dbt_bike_bronze.stg_src_local_bike_order_items .... [RUN]
[0m21:01:49.135342 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_brands"
[0m21:01:49.136399 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.stg_src_local_bike_customers)
[0m21:01:49.137064 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_categories
[0m21:01:49.138035 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.stg_src_local_bike_order_items)
[0m21:01:49.138781 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_customers
[0m21:01:49.143694 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_categories"
[0m21:01:49.144480 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_order_items
[0m21:01:49.150237 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_customers"
[0m21:01:49.151376 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (compile): 21:01:49.130022 => 21:01:49.150971
[0m21:01:49.158914 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_brands
[0m21:01:49.166929 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (compile): 21:01:49.139246 => 21:01:49.166334
[0m21:01:49.181957 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_categories
[0m21:01:49.227422 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (compile): 21:01:49.144982 => 21:01:49.226907
[0m21:01:49.245607 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_customers
[0m21:01:49.257434 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_order_items"
[0m21:01:49.302938 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_categories"
[0m21:01:49.303892 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_customers"
[0m21:01:49.309706 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_brands"
[0m21:01:49.312254 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (compile): 21:01:49.152163 => 21:01:49.311110
[0m21:01:49.313048 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:01:49.313731 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_order_items
[0m21:01:49.314479 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:01:49.315345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:49.318464 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_categories: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_categories"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_categories`
  OPTIONS(
      description="""Product categories such as road, mountain, and electric bikes."""
    )
  as select
        category_id as category_id,
        INITCAP(category_name) as category_name
from `databird-473015`.`src_local_bike`.`categories`;


[0m21:01:49.327712 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_order_items"
[0m21:01:49.331519 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_customers: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_customers"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_customers`
  OPTIONS(
      description="""Customer informations."""
    )
  as select
    customer_id as customer_id,
    INITCAP(first_name) as customer_first_name,
    INITCAP(last_name) as customer_last_name,
    phone as customer_phone,
    email as customer_email,
    INITCAP(street) as customer_street,
    INITCAP(city) as customer_city,
    UPPER(state) as customer_state,
    zip_code as customer_zip_code
from `databird-473015`.`src_local_bike`.`customers`;


[0m21:01:49.334627 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_brands: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_brands"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
  OPTIONS(
      description="""Bike brands sold by Local Bike."""
    )
  as select
        brand_id as brand_id,
        INITCAP(brand_name) as brand_name
from `databird-473015`.`src_local_bike`.`brands`;


[0m21:01:49.455368 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:01:49.458358 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_order_items: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_order_items"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
  OPTIONS(
      description="""Detailed order line items with pricing and discounts."""
    )
  as SELECT
  order_id as order_id,
  item_id AS item_id,
  product_id as product_id,
  quantity as quantity,
  list_price as list_price,
  discount as discount,
  
    list_price * quantity * ( 1 - discount )
 AS total_item_discount_sold
FROM `databird-473015`.`src_local_bike`.`order_items`;


[0m21:01:50.065710 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:24643690-5ce5-4624-9772-cc9e6c1b7d89&page=queryresults
[0m21:01:50.085507 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:b80e44ec-f6af-480d-88f3-925360d98e69&page=queryresults
[0m21:01:50.122508 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:7ff662a0-5980-4e70-9a99-e177837552a1&page=queryresults
[0m21:01:50.128348 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:53fe1a06-9dbd-48cd-bfaa-c0bef87080d5&page=queryresults
[0m21:01:50.403324 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (execute): 21:01:49.319871 => 21:01:50.403012
[0m21:01:50.404523 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f947682630>]}
[0m21:01:50.405346 [info ] [Thread-4 (]: 4 of 25 OK created sql view model dbt_bike_bronze.stg_src_local_bike_order_items  [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m21:01:50.406625 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_order_items
[0m21:01:50.407263 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_orders
[0m21:01:50.407910 [info ] [Thread-4 (]: 5 of 25 START sql view model dbt_bike_bronze.stg_src_local_bike_orders ......... [RUN]
[0m21:01:50.409733 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_order_items, now model.local_bike.stg_src_local_bike_orders)
[0m21:01:50.410683 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_orders
[0m21:01:50.418895 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_orders"
[0m21:01:50.420065 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_orders (compile): 21:01:50.411132 => 21:01:50.419620
[0m21:01:50.421308 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_orders
[0m21:01:50.428606 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (execute): 21:01:49.160684 => 21:01:50.428295
[0m21:01:50.430029 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (execute): 21:01:49.182507 => 21:01:50.429700
[0m21:01:50.431116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9440b7800>]}
[0m21:01:50.438047 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_orders"
[0m21:01:50.439322 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f95fc0e870>]}
[0m21:01:50.440337 [info ] [Thread-1 (]: 1 of 25 OK created sql view model dbt_bike_bronze.stg_src_local_bike_brands .... [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m21:01:50.443503 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_brands
[0m21:01:50.444634 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:01:50.445562 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_products
[0m21:01:50.441849 [info ] [Thread-2 (]: 2 of 25 OK created sql view model dbt_bike_bronze.stg_src_local_bike_categories  [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m21:01:50.448975 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_categories
[0m21:01:50.447355 [info ] [Thread-1 (]: 6 of 25 START sql view model dbt_bike_bronze.stg_src_local_bike_products ....... [RUN]
[0m21:01:50.449680 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_staffs
[0m21:01:50.451870 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_orders: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_orders"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`
  OPTIONS(
      description="""Order headers with key dates and statuses"""
    )
  as select
    order_id as order_id,
    customer_id as customer_id,
    order_status as order_status,
    CAST(order_date as date) as order_date,
    CAST(required_date as date) as required_date,
    CAST(shipped_date as date) as shipped_date,
    store_id as store_id,
    staff_id as staff_id,
    
    CASE
        WHEN EXTRACT(MONTH FROM order_date) IN (12, 1, 2) THEN 'Winter'
        WHEN EXTRACT(MONTH FROM order_date) IN (3, 4, 5) THEN 'Spring'
        WHEN EXTRACT(MONTH FROM order_date) IN (6, 7, 8) THEN 'Summer'
        WHEN EXTRACT(MONTH FROM order_date) IN (9, 10, 11) THEN 'Autumn'
    END
 AS season_name
from `databird-473015`.`src_local_bike`.`orders`;


[0m21:01:50.453079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_brands, now model.local_bike.stg_src_local_bike_products)
[0m21:01:50.453898 [info ] [Thread-2 (]: 7 of 25 START sql view model dbt_bike_bronze.stg_src_local_bike_staffs ......... [RUN]
[0m21:01:50.494442 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_products
[0m21:01:50.495707 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_categories, now model.local_bike.stg_src_local_bike_staffs)
[0m21:01:50.499268 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (execute): 21:01:49.257935 => 21:01:50.498931
[0m21:01:50.504126 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_products"
[0m21:01:50.508837 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_products (compile): 21:01:50.499749 => 21:01:50.508294
[0m21:01:50.504924 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_staffs
[0m21:01:50.506236 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f947309040>]}
[0m21:01:50.509596 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_products
[0m21:01:50.524484 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_staffs"
[0m21:01:50.526034 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (compile): 21:01:50.510084 => 21:01:50.525428
[0m21:01:50.529514 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_staffs
[0m21:01:50.517730 [info ] [Thread-3 (]: 3 of 25 OK created sql view model dbt_bike_bronze.stg_src_local_bike_customers . [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m21:01:50.528578 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_products"
[0m21:01:50.534257 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_staffs"
[0m21:01:50.536840 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:01:50.535533 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_customers
[0m21:01:50.537999 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_stocks
[0m21:01:50.538753 [info ] [Thread-3 (]: 8 of 25 START sql view model dbt_bike_bronze.stg_src_local_bike_stocks ......... [RUN]
[0m21:01:50.540395 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_customers, now model.local_bike.stg_src_local_bike_stocks)
[0m21:01:50.541157 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_stocks
[0m21:01:50.548337 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stocks"
[0m21:01:50.549114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:50.551402 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_staffs: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_staffs"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs`
  OPTIONS(
      description="""Sales and management staff working in Local Bike stores."""
    )
  as select
    CAST(staff_id AS int) as staff_id,
    INITCAP(first_name) as staff_first_name,
    INITCAP(last_name) as staff_last_name,
    phone as staff_phone,
    email as staff_email,
    active as staff_active,
    store_id as store_id,
    CAST(manager_id AS int)  as manager_id
from `databird-473015`.`src_local_bike`.`staffs`;


[0m21:01:50.592557 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (compile): 21:01:50.541609 => 21:01:50.592076
[0m21:01:50.597558 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_products"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_products`
  OPTIONS(
      description="""Products sold, linked to brands and categories."""
    )
  as select
        product_id as product_id,
        INITCAP(product_name) as product_name,
        brand_id as brand_id,
        category_id as category_id,
        model_year as model_year,
        coalesce(list_price,0) as list_price
from `databird-473015`.`src_local_bike`.`products`;


[0m21:01:50.598443 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_stocks
[0m21:01:50.652770 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_stocks"
[0m21:01:50.661737 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:01:50.671849 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_stocks: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_stocks"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stocks`
  OPTIONS(
      description="""Stock of products and availability."""
    )
  as select
    store_id   as store_id,
    product_id as product_id,
    quantity   as stock_quantity
from `databird-473015`.`src_local_bike`.`stocks`;


[0m21:01:51.230607 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:273a3241-e59c-4ba0-8318-dcf0d7d12588&page=queryresults
[0m21:01:51.258096 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:1068166e-033b-4167-b981-2e7212603dab&page=queryresults
[0m21:01:51.367657 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:61f0e35e-5a41-40b1-a6b2-2bbac37cb41e&page=queryresults
[0m21:01:51.522504 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_products (execute): 21:01:50.518827 => 21:01:51.522153
[0m21:01:51.523579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9440ea2d0>]}
[0m21:01:51.524378 [info ] [Thread-1 (]: 6 of 25 OK created sql view model dbt_bike_bronze.stg_src_local_bike_products .. [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m21:01:51.525839 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_products
[0m21:01:51.526655 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_stores
[0m21:01:51.527908 [info ] [Thread-1 (]: 9 of 25 START sql view model dbt_bike_bronze.stg_src_local_bike_stores ......... [RUN]
[0m21:01:51.529686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_products, now model.local_bike.stg_src_local_bike_stores)
[0m21:01:51.530414 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_stores
[0m21:01:51.535334 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stores"
[0m21:01:51.536355 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_stores (compile): 21:01:51.530820 => 21:01:51.535984
[0m21:01:51.536869 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_stores
[0m21:01:51.541711 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_stores"
[0m21:01:51.542512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:51.544580 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_stores: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_stores"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`
  OPTIONS(
      description="""Store locations in California, New York, and Texas."""
    )
  as select
    store_id as store_id,
    INITCAP(store_name) as store_name,
    phone as store_phone,
    email as store_email,
    street as store_street,
    INITCAP(city) as store_city,
    UPPER(state) as store_state,
    zip_code as store_zip_code
from `databird-473015`.`src_local_bike`.`stores`;


[0m21:01:51.586278 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_orders (execute): 21:01:50.421762 => 21:01:51.585950
[0m21:01:51.587493 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9440faf00>]}
[0m21:01:51.588418 [info ] [Thread-4 (]: 5 of 25 OK created sql view model dbt_bike_bronze.stg_src_local_bike_orders .... [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m21:01:51.590250 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_orders
[0m21:01:51.591420 [debug] [Thread-4 (]: Began running node test.local_bike.assert_total_order_amount_is_positive
[0m21:01:51.592632 [info ] [Thread-4 (]: 10 of 25 START test assert_total_order_amount_is_positive ...................... [RUN]
[0m21:01:51.595553 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_orders, now test.local_bike.assert_total_order_amount_is_positive)
[0m21:01:51.596655 [debug] [Thread-4 (]: Began compiling node test.local_bike.assert_total_order_amount_is_positive
[0m21:01:51.604777 [debug] [Thread-4 (]: Writing injected SQL for node "test.local_bike.assert_total_order_amount_is_positive"
[0m21:01:51.606610 [debug] [Thread-4 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (compile): 21:01:51.597126 => 21:01:51.606038
[0m21:01:51.607524 [debug] [Thread-4 (]: Began executing node test.local_bike.assert_total_order_amount_is_positive
[0m21:01:51.633139 [debug] [Thread-4 (]: Writing runtime sql for node "test.local_bike.assert_total_order_amount_is_positive"
[0m21:01:51.634305 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:01:51.636904 [debug] [Thread-4 (]: On test.local_bike.assert_total_order_amount_is_positive: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "test.local_bike.assert_total_order_amount_is_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Refunds have a negative amount, so the total amount should always be >= 0.
-- Therefore return records where total_amount < 0 to make the test fail
select
    order_id,
    sum(total_item_discount_sold) as total_amount  
from `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
group by 1
having total_amount < 0
      
    ) dbt_internal_test
[0m21:01:51.706898 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (execute): 21:01:50.529924 => 21:01:51.706305
[0m21:01:51.709761 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f944112480>]}
[0m21:01:51.712705 [info ] [Thread-2 (]: 7 of 25 OK created sql view model dbt_bike_bronze.stg_src_local_bike_staffs .... [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m21:01:51.714580 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_staffs
[0m21:01:51.716397 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:01:51.717305 [info ] [Thread-2 (]: 11 of 25 START sql view model dbt_bike_silver.int_src_local_bike_staff_hierarchy  [RUN]
[0m21:01:51.719090 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_staffs, now model.local_bike.int_src_local_bike_staff_hierarchy)
[0m21:01:51.719816 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:01:51.728155 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m21:01:51.731839 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (compile): 21:01:51.720254 => 21:01:51.731210
[0m21:01:51.732611 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:01:51.748040 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m21:01:51.751072 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:01:51.759812 [debug] [Thread-2 (]: On model.local_bike.int_src_local_bike_staff_hierarchy: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_hierarchy"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy`
  OPTIONS(
      description="""This model provides an hirarchical view of employees. It enriches the store data with the following data:\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each employe.."""
    )
  as ------------------------------------------
  WITH RECURSIVE staff_hierarchy AS (

  -- Niveau 0 : managers racine
  SELECT
    m.staff_id,
    m.staff_first_name,
    m.staff_last_name,
    m.manager_id,
    m.store_id,
    m.staff_first_name || ' ' || m.staff_last_name AS path,
    0 AS level
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs` m
  WHERE m.manager_id IS NULL

  UNION ALL

  -- Niveaux suivants : rattacher les subordonnés
  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,    
    CONCAT(h.path, ' → ', s.staff_first_name, ' ', s.staff_last_name) AS path,
    h.level + 1 AS level
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs` s
  JOIN staff_hierarchy as h ON s.manager_id = h.staff_id
  
)
------------------------------------------
SELECT 
     * 
FROM staff_hierarchy
ORDER BY path, level;


[0m21:01:51.919116 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:fce6d343-1afc-4f03-b54b-e0ea718657cf&page=queryresults
[0m21:01:52.247388 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (execute): 21:01:50.601095 => 21:01:52.247062
[0m21:01:52.249730 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f944118ce0>]}
[0m21:01:52.250723 [info ] [Thread-3 (]: 8 of 25 OK created sql view model dbt_bike_bronze.stg_src_local_bike_stocks .... [[32mCREATE VIEW (0 processed)[0m in 1.71s]
[0m21:01:52.252143 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_stocks
[0m21:01:52.369526 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:e5b88929-3d05-4a91-9f70-aac7ca1e2860&page=queryresults
[0m21:01:52.447456 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:47d883de-2574-4f6f-b939-e1a2be9f6ab2&page=queryresults
[0m21:01:52.595342 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:dd26bddd-ef9f-4bac-b605-9ec28fd798bf&page=queryresults
[0m21:01:52.597604 [debug] [Thread-4 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (execute): 21:01:51.608006 => 21:01:52.597189
[0m21:01:52.598908 [info ] [Thread-4 (]: 10 of 25 PASS assert_total_order_amount_is_positive ............................ [[32mPASS[0m in 1.00s]
[0m21:01:52.600428 [debug] [Thread-4 (]: Finished running node test.local_bike.assert_total_order_amount_is_positive
[0m21:01:52.602096 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_product_daily
[0m21:01:52.603093 [info ] [Thread-3 (]: 12 of 25 START sql view model dbt_bike_silver.int_src_local_bike_product_daily . [RUN]
[0m21:01:52.604847 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stocks, now model.local_bike.int_src_local_bike_product_daily)
[0m21:01:52.605430 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_product_daily
[0m21:01:52.615669 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_product_daily"
[0m21:01:52.616774 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (compile): 21:01:52.605750 => 21:01:52.616403
[0m21:01:52.617337 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_product_daily
[0m21:01:52.742163 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_stores (execute): 21:01:51.537138 => 21:01:52.741825
[0m21:01:52.744952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9472dfd10>]}
[0m21:01:52.747222 [info ] [Thread-1 (]: 9 of 25 OK created sql view model dbt_bike_bronze.stg_src_local_bike_stores .... [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m21:01:52.749965 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_stores
[0m21:01:52.765708 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_store_daily
[0m21:01:52.770497 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:01:52.787002 [info ] [Thread-1 (]: 14 of 25 START sql view model dbt_bike_silver.int_src_local_bike_store_shipped_order  [RUN]
[0m21:01:52.776268 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (execute): 21:01:51.734258 => 21:01:52.775423
[0m21:01:52.790242 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9476579b0>]}
[0m21:01:52.785953 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_product_daily"
[0m21:01:52.771594 [info ] [Thread-4 (]: 13 of 25 START sql view model dbt_bike_silver.int_src_local_bike_store_daily ... [RUN]
[0m21:01:52.788647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stores, now model.local_bike.int_src_local_bike_store_shipped_order)
[0m21:01:52.792911 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.local_bike.assert_total_order_amount_is_positive, now model.local_bike.int_src_local_bike_store_daily)
[0m21:01:52.791429 [info ] [Thread-2 (]: 11 of 25 OK created sql view model dbt_bike_silver.int_src_local_bike_staff_hierarchy  [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m21:01:52.794087 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:01:52.795551 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:01:52.796602 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_store_daily
[0m21:01:52.797613 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:01:52.805287 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m21:01:52.812567 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_daily"
[0m21:01:52.813673 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_staff_daily
[0m21:01:52.815643 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (compile): 21:01:52.805904 => 21:01:52.814972
[0m21:01:52.816754 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (compile): 21:01:52.798017 => 21:01:52.816211
[0m21:01:52.814393 [info ] [Thread-2 (]: 15 of 25 START sql view model dbt_bike_silver.int_src_local_bike_staff_daily ... [RUN]
[0m21:01:52.820462 [debug] [Thread-3 (]: On model.local_bike.int_src_local_bike_product_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_product_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily`
  OPTIONS(
      description="""This model provides an aggregated view of product items. It enriches the products data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each product.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Product Informations**: Enriches the product with user-specific data, such as brand and category.\r\n\r\nIt provides a comprehensive view of each product, allowing for easy analysis of product performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH order_items AS (
  SELECT 
        order_id as order_id,
        item_id as item_id,
        product_id as product_id,
        quantity as quantity,
        list_price as list_price,
        discount as discount,
        ROUND((discount * 100),2) as discount_percent,
        ROUND(total_item_discount_sold, 2) as total_item_discount_sold 
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
),
------------------------------------------
orders_date AS (
  SELECT 
        order_id, 
        CAST(order_date as date) as order_date,
        store_id,
        season_name,
        EXTRACT(YEAR FROM order_date) as yeardate,
        EXTRACT(YEAR FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`
),
------------------------------------------
products AS (
  SELECT 
        product_id as product_id,
        product_name as product_name,
        brand_id as brand_id,
        category_id as category_id,
        model_year as product_model_year,
        ROUND(list_price,2) as list_price
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_products`
),
------------------------------------------
brands AS (
  SELECT 
        brand_id as brand_id,
        brand_name as brand_name
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
),
------------------------------------------
categories AS (
  SELECT 
        category_id as category_id,
        category_name as category_name
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_categories`
)
------------------------------------------
SELECT
  o.order_id,
  o.store_id,
  o.order_date,
  o.yeardate,
  o.monthday,
  o.yearmonth,
  o.month_2digits,
  o.month_name,
  o.month_abbrev,
  o.week_number,
  o.season_name,
  p.product_id,
  p.product_name,
  b.brand_name,
  c.category_name,
  oi.quantity,
  oi.list_price,
  oi.discount,
  oi.discount_percent,
  SUM(oi.total_item_discount_sold) as total_item_discount_sold,
  COUNT(*) as total_items
FROM orders_date as o
LEFT JOIN order_items as oi ON o.order_id = oi.order_id
LEFT JOIN products as p ON oi.product_id = p.product_id
LEFT JOIN brands as b ON p.brand_id = b.brand_id
LEFT JOIN categories as c ON p.category_id = c.category_id
GROUP BY 
  o.order_id,
  o.store_id,
  o.order_date,
  o.yeardate,
  o.monthday,
  o.yearmonth,
  o.month_2digits,
  o.month_name,
  o.month_abbrev,
  o.week_number,
  o.season_name, 
  p.product_id,
  p.product_name,
  b.brand_name,
  c.category_name,
  oi.quantity,
  oi.list_price,
  oi.discount,
  oi.discount_percent
ORDER BY o.yeardate, o.week_number, o.order_id;


[0m21:01:52.821517 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_store_daily
[0m21:01:52.822126 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:01:52.823207 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_hierarchy, now model.local_bike.int_src_local_bike_staff_daily)
[0m21:01:52.871056 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m21:01:52.865682 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_store_daily"
[0m21:01:52.874372 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:01:52.872945 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_staff_daily
[0m21:01:52.880989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:52.883164 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_daily"
[0m21:01:52.890005 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (compile): 21:01:52.874980 => 21:01:52.889457
[0m21:01:52.886147 [debug] [Thread-1 (]: On model.local_bike.int_src_local_bike_store_shipped_order: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_shipped_order"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_shipped_order`
  OPTIONS(
      description="""This model provides the list of order required, shipped and aborted per month over 3 years.\r\n\r\nIt provides a comprehensive view of each order, allowing for easy analysis of order performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_shipped_date AS (

  SELECT 
        order_id, 
        order_date,
        required_date,
        shipped_date, 
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    required_date,
    shipped_date,
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_shipped_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.order_id,
    ls.shipped_date ,
    ls.required_date ,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date, ls.shipped_date, ls.required_date,ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m21:01:52.890711 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_staff_daily
[0m21:01:52.932372 [debug] [Thread-4 (]: On model.local_bike.int_src_local_bike_store_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  OPTIONS(
      description="""This model provides an aggregated view of stores. It enriches the store data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each store.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Total Distinct Items**: The count of distinct product types in the order.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_date AS (

  SELECT 
        order_id, 
        order_date,
        shipped_date,
        required_date,
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    o.shipped_date,
    o.required_date,    
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.shipped_date,
    ls.required_date,     
    ls.order_id,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date,ls.shipped_date,ls.required_date, ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m21:01:52.938907 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_staff_daily"
[0m21:01:52.981013 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:01:52.984822 [debug] [Thread-2 (]: On model.local_bike.int_src_local_bike_staff_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  OPTIONS(
      description="""This model provides an aggregated view of staffs and stores. It enriches the store and staff data with the following metrics:\r\n- **Total item Amount**: The sum of all order items for each employe.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each store and staffs, allowing for easy analysis of store performance, employee performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH staff_list AS (

  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,
    s.path,
    s.level
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy` s

),
------------------------------------------
sales_by_employee AS (

  SELECT
    o.order_date as order_date,
    o.season_name,
    EXTRACT(YEAR FROM o.order_date) as yeardate,
    EXTRACT(YEAR FROM o.order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') AS yearmonth,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM o.order_date) AS STRING), 2, '0') AS monthday,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') as month_2digits,
    FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_name,
    FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_abbrev,
    LPAD(CAST(EXTRACT(ISOWEEK FROM o.order_date) AS STRING), 2, '0') AS week_number,
    o.staff_id,
    oi.total_item_discount_sold as total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders` as o
  LEFT JOIN `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items` as oi ON o.order_id = oi.order_id

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

)
------------------------------------------
SELECT 
    em.order_date,
    em.yeardate,
    em.monthday,
    em.yearmonth,
    em.month_2digits,
    em.month_name,
    em.month_abbrev,
    em.week_number,
    em.season_name,
    st.store_name,
    m.store_latitude,
    m.store_longitude,    
    st.store_city,
    st.store_state,    
    ROUND(em.total_item_discount_sold, 2) as total_item_sold_staff,
    s.*
FROM sales_by_employee as em 
JOIN staff_list as s ON em.staff_id = s.staff_id
LEFT JOIN map as m on s.store_id = m.store_id
LEFT JOIN stores as st on m.store_id = st.store_id
ORDER BY em.order_date;


[0m21:01:53.654527 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:338263b0-9509-496a-85a2-8a96e1d73690&page=queryresults
[0m21:01:53.730034 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:109a4927-74f4-41c2-8320-4a364a61b153&page=queryresults
[0m21:01:53.848708 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:862280e0-aa53-4eaf-9cdd-8dc25e8379a9&page=queryresults
[0m21:01:53.941231 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (execute): 21:01:52.860951 => 21:01:53.940870
[0m21:01:53.942560 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9440e56d0>]}
[0m21:01:53.943512 [info ] [Thread-4 (]: 13 of 25 OK created sql view model dbt_bike_silver.int_src_local_bike_store_daily  [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m21:01:53.944990 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_store_daily
[0m21:01:53.946257 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:01:53.947045 [info ] [Thread-4 (]: 16 of 25 START sql table model dbt_bike_gold.orders_shipped_aborted_monthly_report  [RUN]
[0m21:01:53.950354 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_daily, now model.local_bike.mrt_order_shipped_aborted_montly)
[0m21:01:53.951848 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:01:53.958901 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m21:01:53.962759 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (compile): 21:01:53.952689 => 21:01:53.962201
[0m21:01:53.963430 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:01:53.981881 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:01:54.028020 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:3f2339d8-1e38-4658-8dc5-92bc53af6017&page=queryresults
[0m21:01:54.036740 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (execute): 21:01:52.866825 => 21:01:54.036089
[0m21:01:54.038901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f947430aa0>]}
[0m21:01:54.040290 [info ] [Thread-1 (]: 14 of 25 OK created sql view model dbt_bike_silver.int_src_local_bike_store_shipped_order  [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m21:01:54.043755 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:01:54.045579 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_order_shipped_montly
[0m21:01:54.047299 [info ] [Thread-1 (]: 17 of 25 START sql table model dbt_bike_gold.orders_shipped_monthly_report ..... [RUN]
[0m21:01:54.049750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_shipped_order, now model.local_bike.mrt_order_shipped_montly)
[0m21:01:54.050619 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_order_shipped_montly
[0m21:01:54.058727 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_montly"
[0m21:01:54.061179 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_order_shipped_montly (compile): 21:01:54.051168 => 21:01:54.060239
[0m21:01:54.062077 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_order_shipped_montly
[0m21:01:54.067315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:54.129569 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (execute): 21:01:52.934242 => 21:01:54.129218
[0m21:01:54.131565 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f94723cb90>]}
[0m21:01:54.134831 [info ] [Thread-2 (]: 15 of 25 OK created sql view model dbt_bike_silver.int_src_local_bike_staff_daily  [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m21:01:54.137615 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_staff_daily
[0m21:01:54.139379 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_sales_seasons_yearly
[0m21:01:54.143786 [info ] [Thread-2 (]: 18 of 25 START sql table model dbt_bike_gold.sales_seasons_yearly_report ....... [RUN]
[0m21:01:54.147522 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_daily, now model.local_bike.mrt_sales_seasons_yearly)
[0m21:01:54.149499 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_sales_seasons_yearly
[0m21:01:54.161293 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_sales_seasons_yearly"
[0m21:01:54.164566 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (compile): 21:01:54.152682 => 21:01:54.163708
[0m21:01:54.165657 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_sales_seasons_yearly
[0m21:01:54.172227 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:01:54.347082 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m21:01:54.349677 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (execute): 21:01:52.617651 => 21:01:54.349334
[0m21:01:54.351093 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f94415eed0>]}
[0m21:01:54.353739 [debug] [Thread-4 (]: On model.local_bike.mrt_order_shipped_aborted_montly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_order_shipped_aborted_montly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`orders_shipped_aborted_monthly_report`
    
    

    OPTIONS(
      description="""This model provides an aggregated view of the canceled orders. It enriches the order data with the following metrics:\r\n- **nb_shipped_aborted**: The quantity of order aborted.\r\n- **total_aborted_sales**: The cost of aborted orders.\r\n- **Order Informations**: Enriches the product with user-specific data, such as store name.\r\n\r\nIt provides a comprehensive view the aborted order, allowing for easy analysis of order performance."""
    )
    as (
      ------------------------------------------

------------------------------------------

WITH total_aborted_orders AS (

  SELECT
    yearmonth AS month,
    COUNTIF(shipped_date IS NULL) AS nb_shipped_aborted,
    ROUND(SUM(total_sales_amount),2) as total_aborted_sales,
    store_name
  FROM  `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  WHERE shipped_date is null
  GROUP BY month,store_name

)
------------------------------------------
SELECT *
FROM total_aborted_orders
------------------------------------------
    );
  
[0m21:01:54.352475 [info ] [Thread-3 (]: 12 of 25 OK created sql view model dbt_bike_silver.int_src_local_bike_product_daily  [[32mCREATE VIEW (0 processed)[0m in 1.75s]
[0m21:01:54.358660 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_product_daily
[0m21:01:54.359662 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_stores_items_monthly
[0m21:01:54.360947 [info ] [Thread-3 (]: 19 of 25 START sql table model dbt_bike_gold.items_stores_monthly_report ....... [RUN]
[0m21:01:54.363183 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_product_daily, now model.local_bike.mrt_stores_items_monthly)
[0m21:01:54.364237 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_stores_items_monthly
[0m21:01:54.377638 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_stores_items_monthly"
[0m21:01:54.380559 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_sales_seasons_yearly"
[0m21:01:54.381789 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_stores_items_monthly (compile): 21:01:54.364833 => 21:01:54.381341
[0m21:01:54.382536 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_stores_items_monthly
[0m21:01:54.387164 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:01:54.390142 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.mrt_order_shipped_montly"
[0m21:01:54.391013 [debug] [Thread-2 (]: On model.local_bike.mrt_sales_seasons_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_sales_seasons_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`sales_seasons_yearly_report`
    
    

    OPTIONS(
      description="""This model provides the **top-performing store by season** and per year over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH sales_stores_seasons AS (

  SELECT
    yeardate AS year,
    store_name AS store,
    season_name,
    ROUND(SUM(total_sales_amount), 2) AS sales_amount
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year,store,season_name

)

SELECT *
FROM sales_stores_seasons
PIVOT (
  SUM(sales_amount) AS sales
  FOR season_name IN ('Winter','Spring','Summer','Autumn')
)
ORDER BY year, store
------------------------------------------
    );
  
[0m21:01:54.435790 [debug] [Thread-1 (]: On model.local_bike.mrt_order_shipped_montly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_order_shipped_montly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`orders_shipped_monthly_report`
    
    

    OPTIONS(
      description="""This model provides an aggregated view of the orders sent. It enriches the order data with the following metrics:\r\n- **nb_order_shipped**: The quantity of orders shipped.\r\n- **total_sales**: The cost of orders shipped.\r\n- **Order Informations**: Enriches the product with user-specific data, such as store name.\r\n\r\nIt provides a comprehensive view the aborted order, allowing for easy analysis of order performance."""
    )
    as (
      ------------------------------------------

------------------------------------------

WITH total_orders AS (

  SELECT
    yearmonth AS month,
    COUNT(order_date) AS nb_order_shipped,
    ROUND(SUM(total_sales_amount),2) as total_sales,
    store_name
  FROM  `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  WHERE shipped_date is not null
  GROUP BY month,store_name

)
------------------------------------------
SELECT *
FROM total_orders
------------------------------------------
    );
  
[0m21:01:54.574166 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.mrt_stores_items_monthly"
[0m21:01:54.575264 [debug] [Thread-3 (]: On model.local_bike.mrt_stores_items_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_items_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`items_stores_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **total number of items sold** per store over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT *
FROM (

  SELECT
    yeardate AS year,
    month_2digits as month,
    store_name,
    COUNT(total_items) AS nb_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year, month, store_name

)
PIVOT (

  SUM(nb_items) AS total_items
  FOR store_name IN ('Santa Cruz Bikes','Baldwin Bikes','Rowlett Bikes')

)
ORDER BY year, month
------------------------------------------
    );
  
[0m21:01:56.635533 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:a4060253-a50c-49db-a798-be5200859c5d&page=queryresults
[0m21:01:56.819487 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:9af57bde-3a52-4fab-8180-d23c1277b5d0&page=queryresults
[0m21:01:56.949393 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_order_shipped_montly (execute): 21:01:54.062435 => 21:01:56.949053
[0m21:01:56.950676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f944140560>]}
[0m21:01:56.951620 [info ] [Thread-1 (]: 17 of 25 OK created sql table model dbt_bike_gold.orders_shipped_monthly_report  [[32mCREATE TABLE (81.0 rows, 215.1 KiB processed)[0m in 2.90s]
[0m21:01:56.953313 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_order_shipped_montly
[0m21:01:56.954136 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_stores_ranking_yearly
[0m21:01:56.954850 [info ] [Thread-1 (]: 20 of 25 START sql table model dbt_bike_gold.stores_ranking_yearly_report ...... [RUN]
[0m21:01:56.956299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_montly, now model.local_bike.mrt_stores_ranking_yearly)
[0m21:01:56.958125 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_stores_ranking_yearly
[0m21:01:56.965534 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_stores_ranking_yearly"
[0m21:01:56.969653 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (compile): 21:01:56.958707 => 21:01:56.969033
[0m21:01:56.970550 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_stores_ranking_yearly
[0m21:01:56.971556 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:fc053ee5-5c35-4ae6-a134-88ab7380262f&page=queryresults
[0m21:01:56.975901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:57.118218 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (execute): 21:01:53.963750 => 21:01:57.117851
[0m21:01:57.119471 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9440d0ec0>]}
[0m21:01:57.120418 [info ] [Thread-4 (]: 16 of 25 OK created sql table model dbt_bike_gold.orders_shipped_aborted_monthly_report  [[32mCREATE TABLE (38.0 rows, 215.1 KiB processed)[0m in 3.17s]
[0m21:01:57.121718 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:01:57.122458 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_stores_sales_monthly
[0m21:01:57.123156 [info ] [Thread-4 (]: 21 of 25 START sql table model dbt_bike_gold.sales_stores_monthly_report ....... [RUN]
[0m21:01:57.124973 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_aborted_montly, now model.local_bike.mrt_stores_sales_monthly)
[0m21:01:57.125739 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_stores_sales_monthly
[0m21:01:57.134320 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_stores_sales_monthly"
[0m21:01:57.136750 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:32309d5c-98f9-4960-a102-7f2bb0841486&page=queryresults
[0m21:01:57.137699 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (compile): 21:01:57.126163 => 21:01:57.137290
[0m21:01:57.140930 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_stores_sales_monthly
[0m21:01:57.146106 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:01:57.192435 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.mrt_stores_ranking_yearly"
[0m21:01:57.193908 [debug] [Thread-1 (]: On model.local_bike.mrt_stores_ranking_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_ranking_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`stores_ranking_yearly_report`
    
    

    OPTIONS(
      description="""This model provides **the ranking of best stores** over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT
  yeardate AS year_date,
  store_name,
  store_latitude,
  store_longitude,
  ROUND(SUM(total_sales_amount), 2) AS total_sales,
  RANK() OVER (PARTITION BY yeardate ORDER BY SUM(total_sales_amount) DESC) AS store_rank
FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
GROUP BY yeardate, store_name,store_latitude,store_longitude
ORDER BY yeardate, store_rank
------------------------------------------
    );
  
[0m21:01:57.270479 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (execute): 21:01:54.167484 => 21:01:57.270130
[0m21:01:57.271812 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f944178650>]}
[0m21:01:57.272751 [info ] [Thread-2 (]: 18 of 25 OK created sql table model dbt_bike_gold.sales_seasons_yearly_report .. [[32mCREATE TABLE (9.0 rows, 215.1 KiB processed)[0m in 3.13s]
[0m21:01:57.274221 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_sales_seasons_yearly
[0m21:01:57.275154 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_staff_ranking_yearly
[0m21:01:57.276733 [info ] [Thread-2 (]: 22 of 25 START sql table model dbt_bike_gold.ranking_sales_staffs_yearly_top3_report  [RUN]
[0m21:01:57.279160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_sales_seasons_yearly, now model.local_bike.mrt_staff_ranking_yearly)
[0m21:01:57.279765 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_staff_ranking_yearly
[0m21:01:57.288641 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_staff_ranking_yearly"
[0m21:01:57.289907 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (compile): 21:01:57.280116 => 21:01:57.289470
[0m21:01:57.290536 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_staff_ranking_yearly
[0m21:01:57.295091 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:01:57.362582 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.mrt_stores_sales_monthly"
[0m21:01:57.364159 [debug] [Thread-4 (]: On model.local_bike.mrt_stores_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_sales_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`sales_stores_monthly_report`
    
    

    OPTIONS(
      description="""This model provides **top sales by store** over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT *
FROM (

  SELECT
    yeardate AS year,
    month_2digits as month,
    store_name,
    ROUND(SUM(total_sales_amount), 2) AS sales_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year, month, store_name

)
PIVOT (

  SUM(sales_items) AS total_sales
  FOR store_name IN ('Santa Cruz Bikes','Baldwin Bikes','Rowlett Bikes')

)
ORDER BY year, month
------------------------------------------
    );
  
[0m21:01:57.520966 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_staff_ranking_yearly"
[0m21:01:57.522093 [debug] [Thread-2 (]: On model.local_bike.mrt_staff_ranking_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_ranking_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`ranking_sales_staffs_yearly_top3_report`
    
    

    OPTIONS(
      description="""This model provides **Top seller** per store and per year over 3 years.\r\n\r\nIt provides a comprehensive view of each seller, allowing for easy analysis of seller performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH sales_staffs_stores AS (

  SELECT
    yeardate AS year,
    staff_first_name || '-' || staff_last_name || ' ('|| store_name || ')' AS staff_name,
    ROUND(SUM(total_item_sold_staff), 2) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  GROUP BY year, staff_name

)
SELECT
  year,
  staff_name,
  total_sales
FROM (
  SELECT
    *,
    RANK() OVER (PARTITION BY year ORDER BY total_sales DESC) AS rank_sales
  FROM sales_staffs_stores
)
WHERE rank_sales <= 3 
ORDER BY year, total_sales
    );
  
[0m21:01:57.580042 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_stores_items_monthly (execute): 21:01:54.382966 => 21:01:57.579647
[0m21:01:57.581309 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f94415eed0>]}
[0m21:01:57.582338 [info ] [Thread-3 (]: 19 of 25 OK created sql table model dbt_bike_gold.items_stores_monthly_report .. [[32mCREATE TABLE (35.0 rows, 104.5 KiB processed)[0m in 3.22s]
[0m21:01:57.584131 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_stores_items_monthly
[0m21:01:57.585347 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_staff_sales_monthly
[0m21:01:57.586673 [info ] [Thread-3 (]: 23 of 25 START sql table model dbt_bike_gold.staffs_sales_monthly_report ....... [RUN]
[0m21:01:57.588568 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_items_monthly, now model.local_bike.mrt_staff_sales_monthly)
[0m21:01:57.589390 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_staff_sales_monthly
[0m21:01:57.607402 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:01:57.610935 [debug] [Thread-3 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m21:01:59.647701 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:35b04439-871e-4f4f-b7a5-ceec6ed84f0a&page=queryresults
[0m21:01:59.649193 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_staff_sales_monthly"
[0m21:01:59.650308 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (compile): 21:01:57.590077 => 21:01:59.649927
[0m21:01:59.650929 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_staff_sales_monthly
[0m21:01:59.763905 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.mrt_staff_sales_monthly"
[0m21:01:59.764970 [debug] [Thread-3 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`staffs_sales_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **best-seller** per month over 3 years.\r\n\r\nIt provides a comprehensive view of each seller, allowing for easy analysis of sellers performance."""
    )
    as (
      ------------------------------------------

------------------------------------------


------------------------------------------
SELECT *
FROM (

  SELECT
    staff_first_name || '-' || staff_last_name AS staff_name,
    yearmonth AS month,
    ROUND(SUM(total_item_sold_staff), 2 ) AS total_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  GROUP BY month, staff_name

)
PIVOT (

  SUM(total_items) AS sales
  FOR month IN ( '2016-01','2016-02','2016-03','2016-04','2016-05','2016-06','2016-07','2016-08','2016-09','2016-10','2016-11','2016-12','2017-01','2017-02','2017-03','2017-04','2017-05','2017-06','2017-07','2017-08','2017-09','2017-10','2017-11','2017-12','2018-01','2018-02','2018-03','2018-04','2018-06','2018-07','2018-08','2018-09','2018-10','2018-11','2018-12' )

)
ORDER BY staff_name
------------------------------------------
    );
  
[0m21:01:59.886325 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:b23fbd2e-f29c-499f-b0c8-230510520112&page=queryresults
[0m21:01:59.891715 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:7dae4107-9af4-48ec-8887-1390cedaf9ef&page=queryresults
[0m21:02:00.142010 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (execute): 21:01:56.971971 => 21:02:00.141645
[0m21:02:00.143186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9472bd6a0>]}
[0m21:02:00.144040 [info ] [Thread-1 (]: 20 of 25 OK created sql table model dbt_bike_gold.stores_ranking_yearly_report . [[32mCREATE TABLE (9.0 rows, 215.1 KiB processed)[0m in 3.19s]
[0m21:02:00.145299 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_stores_ranking_yearly
[0m21:02:00.145982 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_products_brands_monthly
[0m21:02:00.146823 [info ] [Thread-1 (]: 24 of 25 START sql table model dbt_bike_gold.products_brands_monthly_report .... [RUN]
[0m21:02:00.148265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_ranking_yearly, now model.local_bike.mrt_products_brands_monthly)
[0m21:02:00.148971 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_products_brands_monthly
[0m21:02:00.157608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:02:00.159974 [debug] [Thread-1 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m21:02:00.208346 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (execute): 21:01:57.142008 => 21:02:00.207820
[0m21:02:00.210035 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9441402c0>]}
[0m21:02:00.211235 [info ] [Thread-4 (]: 21 of 25 OK created sql table model dbt_bike_gold.sales_stores_monthly_report .. [[32mCREATE TABLE (35.0 rows, 215.1 KiB processed)[0m in 3.09s]
[0m21:02:00.212668 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_stores_sales_monthly
[0m21:02:00.214370 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:02:00.215511 [info ] [Thread-4 (]: 25 of 25 START sql table model dbt_bike_gold.products_stores_ranking_yearly_report  [RUN]
[0m21:02:00.219095 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_sales_monthly, now model.local_bike.mrt_products_ranking_yearly_top3)
[0m21:02:00.220344 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:02:00.227588 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m21:02:00.229097 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (compile): 21:02:00.221118 => 21:02:00.228487
[0m21:02:00.229737 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:02:00.234064 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:02:00.459051 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m21:02:00.460007 [debug] [Thread-4 (]: On model.local_bike.mrt_products_ranking_yearly_top3: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_ranking_yearly_top3"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`products_stores_ranking_yearly_report`
    
    

    OPTIONS(
      description="""This model provides the top 3 **best-selling products** per year over 3 years.\r\n\r\nIt provides a comprehensive view of each product, allowing for easy analysis of products performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH product_sales AS (
  SELECT
    p.yeardate AS year,
    s.store_name AS store,
    p.product_name,
    p.brand_name,
    ROUND(SUM(total_item_discount_sold), 2) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily` AS p
  LEFT JOIN `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`AS s
    ON p.order_id = s.order_id 
   AND p.store_id = s.store_id
  GROUP BY year,store,product_name,brand_name
)
------------------------------------------
SELECT
  year,
  store,
  product_name,
  brand_name,
  total_sales
FROM (
  SELECT
    *,
    RANK() OVER ( PARTITION BY year, store ORDER BY total_sales DESC ) AS rank_product
  FROM product_sales
)
WHERE rank_product <= 3
ORDER BY year, store
------------------------------------------
    );
  
[0m21:02:00.962514 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:ce7012b8-f347-4b67-a83b-1f90ded15daa&page=queryresults
[0m21:02:01.307422 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (execute): 21:01:57.290985 => 21:02:01.307063
[0m21:02:01.308792 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9476b2c90>]}
[0m21:02:01.309883 [info ] [Thread-2 (]: 22 of 25 OK created sql table model dbt_bike_gold.ranking_sales_staffs_yearly_top3_report  [[32mCREATE TABLE (9.0 rows, 185.9 KiB processed)[0m in 4.03s]
[0m21:02:01.312259 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_staff_ranking_yearly
[0m21:02:02.744966 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:422b8b9d-f58b-4991-baf1-0083ae043eb9&page=queryresults
[0m21:02:02.746283 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_products_brands_monthly"
[0m21:02:02.747551 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_products_brands_monthly (compile): 21:02:00.149376 => 21:02:02.747152
[0m21:02:02.748130 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_products_brands_monthly
[0m21:02:02.868668 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.mrt_products_brands_monthly"
[0m21:02:02.869618 [debug] [Thread-1 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`products_brands_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **best-selling brands** per month over 3 years.\r\n\r\nIt provides a comprehensive view of each brand, allowing for easy analysis of brands performance."""
    )
    as (
      ------------------------------------------

------------------------------------------


------------------------------------------
SELECT *
FROM (

  SELECT
    yearmonth AS month,
    brand_name as Brand,    
    ROUND(SUM(total_item_discount_sold), 2 ) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily`
  GROUP BY month, brand

)
PIVOT (

  SUM(total_sales) AS sales
  FOR month IN ( '2016-01','2016-02','2016-03','2016-04','2016-05','2016-06','2016-07','2016-08','2016-09','2016-10','2016-11','2016-12','2017-01','2017-02','2017-03','2017-04','2017-05','2017-06','2017-07','2017-08','2017-09','2017-10','2017-11','2017-12','2018-01','2018-02','2018-03','2018-04','2018-06','2018-07','2018-08','2018-09','2018-10','2018-11','2018-12' )

)
ORDER BY Brand
------------------------------------------
    );
  
[0m21:02:03.163483 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:4c2ad2dd-1aa7-46a5-9564-f66f544644db&page=queryresults
[0m21:02:03.428815 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (execute): 21:01:59.651226 => 21:02:03.428470
[0m21:02:03.429934 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9476a49b0>]}
[0m21:02:03.430747 [info ] [Thread-3 (]: 23 of 25 OK created sql table model dbt_bike_gold.staffs_sales_monthly_report .. [[32mCREATE TABLE (6.0 rows, 185.8 KiB processed)[0m in 5.84s]
[0m21:02:03.432040 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_staff_sales_monthly
[0m21:02:04.196340 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:b0105af8-db01-493f-a4ca-d0291755748b&page=queryresults
[0m21:02:04.529518 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (execute): 21:02:00.230070 => 21:02:04.529201
[0m21:02:04.530743 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f94418e990>]}
[0m21:02:04.531573 [info ] [Thread-4 (]: 25 of 25 OK created sql table model dbt_bike_gold.products_stores_ranking_yearly_report  [[32mCREATE TABLE (27.0 rows, 270.5 KiB processed)[0m in 4.31s]
[0m21:02:04.532948 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:02:07.633118 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:c9bee233-77f1-4562-87f8-b3d6a2cf6fa6&page=queryresults
[0m21:02:07.913700 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_products_brands_monthly (execute): 21:02:02.748395 => 21:02:07.913385
[0m21:02:07.914933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09aabede-0e4b-4a54-8556-a1f15414793c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f92f737b60>]}
[0m21:02:08.127925 [info ] [Thread-1 (]: 24 of 25 OK created sql table model dbt_bike_gold.products_brands_monthly_report  [[32mCREATE TABLE (9.0 rows, 217.4 KiB processed)[0m in 7.77s]
[0m21:02:08.129400 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_products_brands_monthly
[0m21:02:08.132787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:08.133291 [debug] [MainThread]: Connection 'model.local_bike.mrt_products_brands_monthly' was properly closed.
[0m21:02:08.133602 [debug] [MainThread]: Connection 'model.local_bike.mrt_products_ranking_yearly_top3' was properly closed.
[0m21:02:08.133949 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_ranking_yearly' was properly closed.
[0m21:02:08.134246 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_sales_monthly' was properly closed.
[0m21:02:08.134693 [info ] [MainThread]: 
[0m21:02:08.135432 [info ] [MainThread]: Finished running 14 view models, 1 test, 10 table models in 0 hours 0 minutes and 20.19 seconds (20.19s).
[0m21:02:08.143578 [debug] [MainThread]: Command end result
[0m21:02:08.176885 [info ] [MainThread]: 
[0m21:02:08.177706 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:02:08.178630 [info ] [MainThread]: 
[0m21:02:08.179574 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 TOTAL=25
[0m21:02:08.180944 [debug] [MainThread]: Command `dbt build` succeeded at 21:02:08.180682 after 22.12 seconds
[0m21:02:08.181618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f95f9af6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f95f3e35c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f95f3e2f30>]}
[0m21:02:08.182257 [debug] [MainThread]: Flushing usage events
[0m23:47:04.311958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7956373ba960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7956374d8f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7956374d8bf0>]}


============================== 23:47:04.318560 | 35160389-38ca-4a25-9949-f738a57729cd ==============================
[0m23:47:04.318560 [info ] [MainThread]: Running with dbt=1.5.0
[0m23:47:04.319819 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'indirect_selection': 'eager', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'log_cache_events': 'False', 'profiles_dir': '/root/.dbt', 'log_format': 'default', 'version_check': 'True', 'warn_error': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'quiet': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'target_path': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False'}
[0m23:47:04.371258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35160389-38ca-4a25-9949-f738a57729cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7956379fd190>]}
[0m23:47:04.375484 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-t0xq0tmw'
[0m23:47:04.376267 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:47:04.481660 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:47:04.483877 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m23:47:04.536952 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m23:47:04.543733 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:47:04.600910 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:47:04.608980 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m23:47:04.662908 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m23:47:04.665642 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m23:47:04.666411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '35160389-38ca-4a25-9949-f738a57729cd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7956373d7fb0>]}
[0m23:47:04.681975 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m23:47:05.314183 [info ] [MainThread]: Installed from version 0.10.5
[0m23:47:05.314841 [info ] [MainThread]: Up to date!
[0m23:47:05.315805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '35160389-38ca-4a25-9949-f738a57729cd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795637a35580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7956375cb6e0>]}
[0m23:47:05.316462 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:47:05.539132 [info ] [MainThread]: Installed from version 1.3.2
[0m23:47:05.539883 [info ] [MainThread]: Up to date!
[0m23:47:05.540948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '35160389-38ca-4a25-9949-f738a57729cd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795638015a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7956375cb6e0>]}
[0m23:47:05.541564 [info ] [MainThread]: Installing calogica/dbt_date
[0m23:47:05.695121 [info ] [MainThread]: Installed from version 0.10.1
[0m23:47:05.695786 [info ] [MainThread]: Up to date!
[0m23:47:05.696514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '35160389-38ca-4a25-9949-f738a57729cd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795638015a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795638758cb0>]}
[0m23:47:05.698466 [debug] [MainThread]: Command `dbt deps` succeeded at 23:47:05.698223 after 1.41 seconds
[0m23:47:05.699050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7956374d8f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7956374d8bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79563740a240>]}
[0m23:47:05.699718 [debug] [MainThread]: Flushing usage events
[0m00:09:06.049540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762693ddb5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626944a5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762693ddaff0>]}


============================== 00:09:06.055574 | fc39b75a-f256-4a48-a940-6d62a7f26775 ==============================
[0m00:09:06.055574 [info ] [MainThread]: Running with dbt=1.5.0
[0m00:09:06.056527 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'profiles_dir': '/root/.dbt', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'quiet': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'printer_width': '80'}
[0m00:09:06.108714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc39b75a-f256-4a48-a940-6d62a7f26775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762693d2e540>]}
[0m00:09:06.110126 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-w6gtkeeh'
[0m00:09:06.110887 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:09:06.221979 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:09:06.224461 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m00:09:06.278167 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m00:09:06.285217 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:09:06.345863 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:09:06.354026 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m00:09:06.408316 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m00:09:06.411019 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m00:09:06.411967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fc39b75a-f256-4a48-a940-6d62a7f26775', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762693df0aa0>]}
[0m00:09:06.430216 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m00:09:07.201903 [info ] [MainThread]: Installed from version 0.10.5
[0m00:09:07.202703 [info ] [MainThread]: Up to date!
[0m00:09:07.203653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fc39b75a-f256-4a48-a940-6d62a7f26775', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762693f0f3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76269434ede0>]}
[0m00:09:07.204419 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:09:07.426915 [info ] [MainThread]: Installed from version 1.3.2
[0m00:09:07.427913 [info ] [MainThread]: Up to date!
[0m00:09:07.428866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fc39b75a-f256-4a48-a940-6d62a7f26775', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762693eb3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762693df09e0>]}
[0m00:09:07.429499 [info ] [MainThread]: Installing calogica/dbt_date
[0m00:09:07.575095 [info ] [MainThread]: Installed from version 0.10.1
[0m00:09:07.575793 [info ] [MainThread]: Up to date!
[0m00:09:07.576553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fc39b75a-f256-4a48-a940-6d62a7f26775', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762693eb3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762693df3140>]}
[0m00:09:07.579283 [debug] [MainThread]: Command `dbt deps` succeeded at 00:09:07.578891 after 1.54 seconds
[0m00:09:07.579931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626944a5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626946cccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762697a2a900>]}
[0m00:09:07.580621 [debug] [MainThread]: Flushing usage events
[0m13:12:26.228939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7294417f3680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7294419c5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7294417f38c0>]}


============================== 13:12:26.244529 | 80335859-75f9-476d-84fe-ba1d1e9ac089 ==============================
[0m13:12:26.244529 [info ] [MainThread]: Running with dbt=1.5.0
[0m13:12:26.245913 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'static_parser': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'introspect': 'True', 'profiles_dir': '/root/.dbt', 'write_json': 'True', 'quiet': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'log_format': 'default'}
[0m13:12:26.303960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80335859-75f9-476d-84fe-ba1d1e9ac089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7294417f3170>]}
[0m13:12:26.308721 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mq7y1ytw'
[0m13:12:26.309727 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:12:26.420725 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:12:26.423697 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m13:12:26.480109 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m13:12:26.487740 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:12:26.543331 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:12:26.551879 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m13:12:26.606382 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m13:12:26.609468 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m13:12:26.610269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '80335859-75f9-476d-84fe-ba1d1e9ac089', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729441634170>]}
[0m13:12:26.629841 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m13:12:27.324672 [info ] [MainThread]: Installed from version 0.10.5
[0m13:12:27.325605 [info ] [MainThread]: Up to date!
[0m13:12:27.326832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '80335859-75f9-476d-84fe-ba1d1e9ac089', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729441934740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72944161e150>]}
[0m13:12:27.327988 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:12:27.611334 [info ] [MainThread]: Installed from version 1.3.2
[0m13:12:27.612425 [info ] [MainThread]: Up to date!
[0m13:12:27.613744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '80335859-75f9-476d-84fe-ba1d1e9ac089', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729441634170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729441634080>]}
[0m13:12:27.615290 [info ] [MainThread]: Installing calogica/dbt_date
[0m13:12:27.774763 [info ] [MainThread]: Installed from version 0.10.1
[0m13:12:27.775753 [info ] [MainThread]: Up to date!
[0m13:12:27.776883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '80335859-75f9-476d-84fe-ba1d1e9ac089', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729441634170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7294416930e0>]}
[0m13:12:27.780430 [debug] [MainThread]: Command `dbt deps` succeeded at 13:12:27.779928 after 1.58 seconds
[0m13:12:27.781452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729441750830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7294423538c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7294419c5160>]}
[0m13:12:27.782504 [debug] [MainThread]: Flushing usage events
[0m13:12:55.272329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec2a06bdb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec2a05369c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec2a1170fe0>]}


============================== 13:12:55.278521 | 481c0fce-2fa3-4f49-b776-9023b0c77ddc ==============================
[0m13:12:55.278521 [info ] [MainThread]: Running with dbt=1.5.0
[0m13:12:55.279529 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'printer_width': '80', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None'}
[0m13:12:55.280185 [info ] [MainThread]: dbt version: 1.5.0
[0m13:12:55.280809 [info ] [MainThread]: python version: 3.12.12
[0m13:12:55.281448 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m13:12:55.282127 [info ] [MainThread]: os info: Linux-6.17.0-1003-gcp-x86_64-with-glibc2.41
[0m13:12:55.282795 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m13:12:55.283451 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m13:12:55.284284 [info ] [MainThread]: Configuration:
[0m13:12:57.876606 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:12:57.977065 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:12:57.979136 [info ] [MainThread]: Required dependencies:
[0m13:12:57.980492 [debug] [MainThread]: Executing "git --help"
[0m13:12:58.039584 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:12:58.040650 [debug] [MainThread]: STDERR: "b''"
[0m13:12:58.041281 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:12:58.042230 [info ] [MainThread]: Connection:
[0m13:12:58.044150 [info ] [MainThread]:   method: service-account
[0m13:12:58.047023 [info ] [MainThread]:   database: databird-473015
[0m13:12:58.049435 [info ] [MainThread]:   schema: dbt_bike
[0m13:12:58.050960 [info ] [MainThread]:   location: US
[0m13:12:58.051881 [info ] [MainThread]:   priority: interactive
[0m13:12:58.052550 [info ] [MainThread]:   timeout_seconds: None
[0m13:12:58.053494 [info ] [MainThread]:   maximum_bytes_billed: None
[0m13:12:58.054789 [info ] [MainThread]:   execution_project: databird-473015
[0m13:12:58.056444 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m13:12:58.057095 [info ] [MainThread]:   job_retries: 1
[0m13:12:58.057718 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m13:12:58.058946 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m13:12:58.060295 [info ] [MainThread]:   gcs_bucket: None
[0m13:12:58.062494 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m13:12:58.063582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:58.069784 [debug] [MainThread]: On debug: select 1 as id
[0m13:12:58.963037 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:9932708c-c335-4828-abb7-6e8e1e61bc6d&page=queryresults
[0m13:12:58.964274 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:12:58.965412 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:12:58.966850 [debug] [MainThread]: Command `dbt debug` succeeded at 13:12:58.966539 after 3.71 seconds
[0m13:12:58.968188 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:12:58.969003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec28c9f49b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec2a2f30080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec28cb2f950>]}
[0m13:12:58.969897 [debug] [MainThread]: Flushing usage events
[0m14:48:35.179831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717975cf6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717975c915e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717975c90bf0>]}


============================== 14:48:35.198813 | b2601ac4-252d-4acd-b036-173582522db2 ==============================
[0m14:48:35.198813 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:48:35.201137 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/app/dbt/logs', 'target_path': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'printer_width': '80', 'version_check': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error': 'None', 'write_json': 'True', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False'}
[0m14:48:35.282063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2601ac4-252d-4acd-b036-173582522db2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7179798f2a80>]}
[0m14:48:35.289095 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-28mve5f3'
[0m14:48:35.290216 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:48:35.436836 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:48:35.442829 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m14:48:35.538158 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m14:48:35.549401 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:48:35.646746 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:48:35.660601 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m14:48:35.831605 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m14:48:35.837493 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m14:48:35.838916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b2601ac4-252d-4acd-b036-173582522db2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717975c56c90>]}
[0m14:48:35.861371 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m14:48:36.634815 [info ] [MainThread]: Installed from version 0.10.5
[0m14:48:36.635721 [info ] [MainThread]: Up to date!
[0m14:48:36.637406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b2601ac4-252d-4acd-b036-173582522db2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717975b38a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717975c54770>]}
[0m14:48:36.638421 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:48:36.906691 [info ] [MainThread]: Installed from version 1.3.2
[0m14:48:36.907548 [info ] [MainThread]: Up to date!
[0m14:48:36.908509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b2601ac4-252d-4acd-b036-173582522db2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717975b38a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71797623b5f0>]}
[0m14:48:36.909139 [info ] [MainThread]: Installing calogica/dbt_date
[0m14:48:37.073801 [info ] [MainThread]: Installed from version 0.10.1
[0m14:48:37.074554 [info ] [MainThread]: Up to date!
[0m14:48:37.075615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b2601ac4-252d-4acd-b036-173582522db2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71797623b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717975b38a70>]}
[0m14:48:37.078986 [debug] [MainThread]: Command `dbt deps` succeeded at 14:48:37.078578 after 1.93 seconds
[0m14:48:37.079748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717975d9d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7179763a1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717976c95730>]}
[0m14:48:37.080937 [debug] [MainThread]: Flushing usage events
[0m14:50:09.777874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aed793e3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aed7b256960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aed795f0bf0>]}


============================== 14:50:09.793901 | 1627e399-3fc5-4111-9269-fbd84b8b85db ==============================
[0m14:50:09.793901 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:50:09.795721 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_format': 'default', 'no_print': 'None', 'version_check': 'True', 'introspect': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'printer_width': '80', 'quiet': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'debug': 'False', 'write_json': 'True'}
[0m14:50:09.797077 [info ] [MainThread]: dbt version: 1.5.0
[0m14:50:09.799652 [info ] [MainThread]: python version: 3.12.12
[0m14:50:09.801721 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m14:50:09.803619 [info ] [MainThread]: os info: Linux-6.17.0-1003-gcp-x86_64-with-glibc2.41
[0m14:50:09.805341 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m14:50:09.807464 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m14:50:09.809826 [info ] [MainThread]: Configuration:
[0m14:50:12.517331 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:50:12.567789 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:50:12.568861 [info ] [MainThread]: Required dependencies:
[0m14:50:12.569758 [debug] [MainThread]: Executing "git --help"
[0m14:50:12.577102 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:50:12.577881 [debug] [MainThread]: STDERR: "b''"
[0m14:50:12.578236 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:50:12.578836 [info ] [MainThread]: Connection:
[0m14:50:12.579842 [info ] [MainThread]:   method: service-account
[0m14:50:12.580462 [info ] [MainThread]:   database: databird-473015
[0m14:50:12.581073 [info ] [MainThread]:   schema: dbt_bike
[0m14:50:12.581937 [info ] [MainThread]:   location: US
[0m14:50:12.582602 [info ] [MainThread]:   priority: interactive
[0m14:50:12.583393 [info ] [MainThread]:   timeout_seconds: None
[0m14:50:12.584091 [info ] [MainThread]:   maximum_bytes_billed: None
[0m14:50:12.584780 [info ] [MainThread]:   execution_project: databird-473015
[0m14:50:12.585525 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m14:50:12.586371 [info ] [MainThread]:   job_retries: 1
[0m14:50:12.587064 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m14:50:12.587757 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m14:50:12.588447 [info ] [MainThread]:   gcs_bucket: None
[0m14:50:12.590004 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m14:50:12.590605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:12.594558 [debug] [MainThread]: On debug: select 1 as id
[0m14:50:13.247598 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:2f5c3362-09d0-4f82-89e1-e06cc1fd80dd&page=queryresults
[0m14:50:13.248290 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:50:13.249075 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:50:13.251054 [debug] [MainThread]: Command `dbt debug` succeeded at 14:50:13.250564 after 3.50 seconds
[0m14:50:13.252486 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:50:13.254080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aed793363f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aed61802c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aed794bb4d0>]}
[0m14:50:13.255206 [debug] [MainThread]: Flushing usage events
[0m16:50:29.509318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781868820860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7818690cbce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7818689f8bf0>]}


============================== 16:50:29.525361 | 9ebeb218-e94a-4428-b796-6b415ebabcaa ==============================
[0m16:50:29.525361 [info ] [MainThread]: Running with dbt=1.5.0
[0m16:50:29.526814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'introspect': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'target_path': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'quiet': 'False', 'debug': 'False', 'log_cache_events': 'False', 'log_path': '/usr/app/dbt/logs'}
[0m16:50:29.583139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ebeb218-e94a-4428-b796-6b415ebabcaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781868822c30>]}
[0m16:50:29.587047 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-g5qiavt4'
[0m16:50:29.587964 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:50:29.653363 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:50:29.655983 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m16:50:29.752143 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m16:50:29.760708 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:50:29.861648 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:50:29.871190 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m16:50:29.970382 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m16:50:29.975046 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m16:50:29.976130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9ebeb218-e94a-4428-b796-6b415ebabcaa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78186874d550>]}
[0m16:50:29.993109 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m16:50:31.260231 [info ] [MainThread]: Installed from version 0.10.5
[0m16:50:31.261512 [info ] [MainThread]: Up to date!
[0m16:50:31.263480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9ebeb218-e94a-4428-b796-6b415ebabcaa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781868752cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781868752e40>]}
[0m16:50:31.265087 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:50:31.510633 [info ] [MainThread]: Installed from version 1.3.2
[0m16:50:31.511504 [info ] [MainThread]: Up to date!
[0m16:50:31.512478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9ebeb218-e94a-4428-b796-6b415ebabcaa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7818688bff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7818688bdfd0>]}
[0m16:50:31.513490 [info ] [MainThread]: Installing calogica/dbt_date
[0m16:50:31.673927 [info ] [MainThread]: Installed from version 0.10.1
[0m16:50:31.674956 [info ] [MainThread]: Up to date!
[0m16:50:31.676142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9ebeb218-e94a-4428-b796-6b415ebabcaa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7818690a20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781868a01ee0>]}
[0m16:50:31.679349 [debug] [MainThread]: Command `dbt deps` succeeded at 16:50:31.678891 after 2.19 seconds
[0m16:50:31.680590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7818690cbce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7818689f8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7818689f8bf0>]}
[0m16:50:31.681537 [debug] [MainThread]: Flushing usage events
[0m21:25:32.127241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786765a74170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786765bcbfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7867661ae3c0>]}


============================== 21:25:32.143150 | 69337d7d-5684-44fe-867b-6b031fa4fa48 ==============================
[0m21:25:32.143150 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:25:32.144473 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/app/dbt/logs', 'printer_width': '80', 'profiles_dir': '/root/.dbt', 'no_print': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'fail_fast': 'False', 'log_format': 'default', 'warn_error': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True'}
[0m21:25:32.200113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69337d7d-5684-44fe-867b-6b031fa4fa48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786765a74170>]}
[0m21:25:32.204032 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xneeub5p'
[0m21:25:32.204902 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:25:32.314844 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:25:32.317354 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m21:25:32.370968 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m21:25:32.378263 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:25:32.431705 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:25:32.440064 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m21:25:32.494846 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m21:25:32.497993 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m21:25:32.499038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '69337d7d-5684-44fe-867b-6b031fa4fa48', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786765ae7bc0>]}
[0m21:25:32.515947 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m21:25:33.595649 [info ] [MainThread]: Installed from version 0.10.5
[0m21:25:33.596672 [info ] [MainThread]: Up to date!
[0m21:25:33.597494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '69337d7d-5684-44fe-867b-6b031fa4fa48', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786765ae58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786765ae75c0>]}
[0m21:25:33.598227 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:25:33.841292 [info ] [MainThread]: Installed from version 1.3.2
[0m21:25:33.842142 [info ] [MainThread]: Up to date!
[0m21:25:33.843672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '69337d7d-5684-44fe-867b-6b031fa4fa48', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786765ae7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786765ae58b0>]}
[0m21:25:33.844440 [info ] [MainThread]: Installing calogica/dbt_date
[0m21:25:34.015686 [info ] [MainThread]: Installed from version 0.10.1
[0m21:25:34.016469 [info ] [MainThread]: Up to date!
[0m21:25:34.017756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '69337d7d-5684-44fe-867b-6b031fa4fa48', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786765ae58e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786765ae75c0>]}
[0m21:25:34.019441 [debug] [MainThread]: Command `dbt deps` succeeded at 21:25:34.019241 after 1.92 seconds
[0m21:25:34.019867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786766098980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786766028500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786766092300>]}
[0m21:25:34.020607 [debug] [MainThread]: Flushing usage events
[0m21:27:20.180156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751fe49e2ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751fe4fe9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751fe4fb98b0>]}


============================== 21:27:20.185905 | fa317541-0303-4a26-b51c-19ce5ba79ee5 ==============================
[0m21:27:20.185905 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:27:20.187560 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'printer_width': '80', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'introspect': 'True'}
[0m21:27:20.188638 [info ] [MainThread]: dbt version: 1.5.0
[0m21:27:20.189775 [info ] [MainThread]: python version: 3.12.12
[0m21:27:20.190707 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m21:27:20.191690 [info ] [MainThread]: os info: Linux-6.17.0-1003-gcp-x86_64-with-glibc2.41
[0m21:27:20.192382 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m21:27:20.193161 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m21:27:20.193877 [info ] [MainThread]: Configuration:
[0m21:27:22.051136 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:27:22.103436 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:27:22.104215 [info ] [MainThread]: Required dependencies:
[0m21:27:22.105398 [debug] [MainThread]: Executing "git --help"
[0m21:27:22.111932 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:27:22.112870 [debug] [MainThread]: STDERR: "b''"
[0m21:27:22.113282 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:27:22.113780 [info ] [MainThread]: Connection:
[0m21:27:22.114453 [info ] [MainThread]:   method: service-account
[0m21:27:22.115077 [info ] [MainThread]:   database: databird-473015
[0m21:27:22.115687 [info ] [MainThread]:   schema: dbt_bike
[0m21:27:22.116345 [info ] [MainThread]:   location: US
[0m21:27:22.117022 [info ] [MainThread]:   priority: interactive
[0m21:27:22.117707 [info ] [MainThread]:   timeout_seconds: None
[0m21:27:22.118330 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:27:22.118936 [info ] [MainThread]:   execution_project: databird-473015
[0m21:27:22.119632 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:27:22.120365 [info ] [MainThread]:   job_retries: 1
[0m21:27:22.121052 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:27:22.121773 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m21:27:22.122405 [info ] [MainThread]:   gcs_bucket: None
[0m21:27:22.123697 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:27:22.124179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:22.127884 [debug] [MainThread]: On debug: select 1 as id
[0m21:27:22.858841 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:084a05d2-2c26-43ea-8301-b13859868e80&page=queryresults
[0m21:27:22.859439 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:27:22.860108 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:27:22.861303 [debug] [MainThread]: Command `dbt debug` succeeded at 21:27:22.861039 after 2.69 seconds
[0m21:27:22.861937 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:27:22.862667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751fe866ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751fe5020da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751fe4fe9220>]}
[0m21:27:22.863427 [debug] [MainThread]: Flushing usage events
[0m21:32:36.486802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e6a2edff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e6a3cf23c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e6a2edfb60>]}


============================== 21:32:36.495682 | be37ff20-c3c2-4757-aa55-3def56d7fbca ==============================
[0m21:32:36.495682 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:32:36.496875 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'cache_selected_only': 'False', 'log_path': '/usr/app/dbt/logs', 'write_json': 'True', 'log_cache_events': 'False', 'debug': 'False', 'use_colors': 'True', 'quiet': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'introspect': 'True', 'profiles_dir': '/root/.dbt', 'static_parser': 'True', 'warn_error': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_format': 'default', 'fail_fast': 'False'}
[0m21:32:38.333953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be37ff20-c3c2-4757-aa55-3def56d7fbca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e68b3874d0>]}
[0m21:32:38.400687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be37ff20-c3c2-4757-aa55-3def56d7fbca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e68b01e780>]}
[0m21:32:38.496016 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m21:32:38.724248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:32:38.724953 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:32:38.737332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be37ff20-c3c2-4757-aa55-3def56d7fbca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e68b7df680>]}
[0m21:32:38.744455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be37ff20-c3c2-4757-aa55-3def56d7fbca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e68b516c90>]}
[0m21:32:38.745182 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m21:32:38.745998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be37ff20-c3c2-4757-aa55-3def56d7fbca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e68b4ef1d0>]}
[0m21:32:38.752470 [info ] [MainThread]: 
[0m21:32:38.754834 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:32:38.758856 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m21:32:38.761026 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m21:32:38.761967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:38.763532 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m21:32:38.767046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:38.766223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:38.765659 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m21:32:38.870354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:39.420199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be37ff20-c3c2-4757-aa55-3def56d7fbca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e68b07a8d0>]}
[0m21:32:39.421405 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:32:39.422090 [info ] [MainThread]: 
[0m21:32:39.465228 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_brands
[0m21:32:39.466099 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_categories
[0m21:32:39.466749 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_customers
[0m21:32:39.467848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.stg_src_local_bike_brands)
[0m21:32:39.468456 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_order_items
[0m21:32:39.469565 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.stg_src_local_bike_categories)
[0m21:32:39.470535 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.stg_src_local_bike_customers)
[0m21:32:39.471098 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_brands
[0m21:32:39.472369 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.stg_src_local_bike_order_items)
[0m21:32:39.473125 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_categories
[0m21:32:39.473666 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_customers
[0m21:32:39.479209 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_order_items
[0m21:32:39.488492 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_categories"
[0m21:32:39.495340 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_customers"
[0m21:32:39.513483 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_order_items"
[0m21:32:39.514221 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_brands"
[0m21:32:39.518452 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (compile): 21:32:39.490895 => 21:32:39.517983
[0m21:32:39.519367 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_customers
[0m21:32:39.520179 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (compile): 21:32:39.474050 => 21:32:39.519831
[0m21:32:39.520959 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (compile): 21:32:39.482684 => 21:32:39.520623
[0m21:32:39.521639 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (execute): 21:32:39.521263 => 21:32:39.521302
[0m21:32:39.522348 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (compile): 21:32:39.499749 => 21:32:39.522038
[0m21:32:39.522907 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_brands
[0m21:32:39.523443 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_categories
[0m21:32:39.524925 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_customers
[0m21:32:39.525451 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_order_items
[0m21:32:39.526147 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (execute): 21:32:39.525838 => 21:32:39.525860
[0m21:32:39.526805 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (execute): 21:32:39.526472 => 21:32:39.526490
[0m21:32:39.527425 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_orders
[0m21:32:39.528267 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (execute): 21:32:39.527963 => 21:32:39.527981
[0m21:32:39.529695 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_brands
[0m21:32:39.531043 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_categories
[0m21:32:39.532005 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_customers, now model.local_bike.stg_src_local_bike_orders)
[0m21:32:39.533625 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_order_items
[0m21:32:39.534607 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_products
[0m21:32:39.535403 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_staffs
[0m21:32:39.536133 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_orders
[0m21:32:39.536783 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_stocks
[0m21:32:39.537856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_brands, now model.local_bike.stg_src_local_bike_products)
[0m21:32:39.538992 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_categories, now model.local_bike.stg_src_local_bike_staffs)
[0m21:32:39.546046 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_orders"
[0m21:32:39.547235 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_order_items, now model.local_bike.stg_src_local_bike_stocks)
[0m21:32:39.548222 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_products
[0m21:32:39.549012 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_staffs
[0m21:32:39.550030 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_stocks
[0m21:32:39.555232 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_products"
[0m21:32:39.560645 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_staffs"
[0m21:32:39.565822 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stocks"
[0m21:32:39.567350 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_orders (compile): 21:32:39.539387 => 21:32:39.566898
[0m21:32:39.568292 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (compile): 21:32:39.561238 => 21:32:39.567930
[0m21:32:39.569023 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (compile): 21:32:39.555804 => 21:32:39.568696
[0m21:32:39.569672 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_orders
[0m21:32:39.570410 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_products (compile): 21:32:39.550529 => 21:32:39.570103
[0m21:32:39.570973 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_stocks
[0m21:32:39.571533 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_staffs
[0m21:32:39.572217 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_orders (execute): 21:32:39.571897 => 21:32:39.571919
[0m21:32:39.572737 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_products
[0m21:32:39.573440 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (execute): 21:32:39.573090 => 21:32:39.573111
[0m21:32:39.574122 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (execute): 21:32:39.573816 => 21:32:39.573837
[0m21:32:39.575454 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_orders
[0m21:32:39.576130 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_products (execute): 21:32:39.575820 => 21:32:39.575839
[0m21:32:39.577453 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_stocks
[0m21:32:39.578763 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_staffs
[0m21:32:39.579392 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_stores
[0m21:32:39.580860 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_products
[0m21:32:39.581686 [debug] [Thread-4 (]: Began running node seed.local_bike.map
[0m21:32:39.582422 [debug] [Thread-2 (]: Began running node seed.local_bike.seasons
[0m21:32:39.583538 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_orders, now model.local_bike.stg_src_local_bike_stores)
[0m21:32:39.584324 [debug] [Thread-1 (]: Began running node test.local_bike.assert_total_order_amount_is_positive
[0m21:32:39.585448 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stocks, now seed.local_bike.map)
[0m21:32:39.586405 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_staffs, now seed.local_bike.seasons)
[0m21:32:39.586981 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_stores
[0m21:32:39.587903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_products, now test.local_bike.assert_total_order_amount_is_positive)
[0m21:32:39.588420 [debug] [Thread-4 (]: Began compiling node seed.local_bike.map
[0m21:32:39.588937 [debug] [Thread-2 (]: Began compiling node seed.local_bike.seasons
[0m21:32:39.594737 [debug] [Thread-1 (]: Began compiling node test.local_bike.assert_total_order_amount_is_positive
[0m21:32:39.594158 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stores"
[0m21:32:39.598626 [debug] [Thread-4 (]: Timing info for seed.local_bike.map (compile): 21:32:39.595335 => 21:32:39.598235
[0m21:32:39.602612 [debug] [Thread-2 (]: Timing info for seed.local_bike.seasons (compile): 21:32:39.599050 => 21:32:39.602178
[0m21:32:39.607935 [debug] [Thread-1 (]: Writing injected SQL for node "test.local_bike.assert_total_order_amount_is_positive"
[0m21:32:39.608868 [debug] [Thread-4 (]: Began executing node seed.local_bike.map
[0m21:32:39.609545 [debug] [Thread-2 (]: Began executing node seed.local_bike.seasons
[0m21:32:39.610432 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_stores (compile): 21:32:39.589278 => 21:32:39.610106
[0m21:32:39.613105 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_stores
[0m21:32:39.612466 [debug] [Thread-2 (]: Timing info for seed.local_bike.seasons (execute): 21:32:39.612155 => 21:32:39.612173
[0m21:32:39.611622 [debug] [Thread-4 (]: Timing info for seed.local_bike.map (execute): 21:32:39.611221 => 21:32:39.611242
[0m21:32:39.613778 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_stores (execute): 21:32:39.613405 => 21:32:39.613420
[0m21:32:39.615278 [debug] [Thread-2 (]: Finished running node seed.local_bike.seasons
[0m21:32:39.616710 [debug] [Thread-4 (]: Finished running node seed.local_bike.map
[0m21:32:39.617302 [debug] [Thread-1 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (compile): 21:32:39.603103 => 21:32:39.617022
[0m21:32:39.618620 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_stores
[0m21:32:39.619276 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:32:39.620053 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_product_daily
[0m21:32:39.620717 [debug] [Thread-1 (]: Began executing node test.local_bike.assert_total_order_amount_is_positive
[0m21:32:39.622117 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.local_bike.seasons, now model.local_bike.int_src_local_bike_staff_hierarchy)
[0m21:32:39.622873 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_store_daily
[0m21:32:39.623806 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.local_bike.map, now model.local_bike.int_src_local_bike_product_daily)
[0m21:32:39.624490 [debug] [Thread-1 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (execute): 21:32:39.624175 => 21:32:39.624194
[0m21:32:39.625076 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:32:39.628890 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stores, now model.local_bike.int_src_local_bike_store_daily)
[0m21:32:39.629664 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_product_daily
[0m21:32:39.631156 [debug] [Thread-1 (]: Finished running node test.local_bike.assert_total_order_amount_is_positive
[0m21:32:39.636200 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m21:32:39.636977 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_store_daily
[0m21:32:39.643251 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:32:39.645584 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_product_daily"
[0m21:32:39.653111 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_daily"
[0m21:32:39.654273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.local_bike.assert_total_order_amount_is_positive, now model.local_bike.int_src_local_bike_store_shipped_order)
[0m21:32:39.655424 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:32:39.662158 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (compile): 21:32:39.631554 => 21:32:39.661683
[0m21:32:39.663556 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m21:32:39.664377 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:32:39.665173 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (compile): 21:32:39.646320 => 21:32:39.664821
[0m21:32:39.667459 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_store_daily
[0m21:32:39.668167 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (execute): 21:32:39.667844 => 21:32:39.667862
[0m21:32:39.666041 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (compile): 21:32:39.637391 => 21:32:39.665709
[0m21:32:39.666841 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (execute): 21:32:39.666475 => 21:32:39.666515
[0m21:32:39.668812 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (compile): 21:32:39.655836 => 21:32:39.668482
[0m21:32:39.670120 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_store_daily
[0m21:32:39.670667 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_product_daily
[0m21:32:39.672024 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:32:39.672569 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:32:39.673569 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (execute): 21:32:39.673219 => 21:32:39.673235
[0m21:32:39.674470 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:32:39.675090 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_order_shipped_montly
[0m21:32:39.676004 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (execute): 21:32:39.675664 => 21:32:39.675683
[0m21:32:39.677344 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_product_daily
[0m21:32:39.678275 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_daily, now model.local_bike.mrt_order_shipped_aborted_montly)
[0m21:32:39.679208 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_hierarchy, now model.local_bike.mrt_order_shipped_montly)
[0m21:32:39.680689 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:32:39.681323 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_sales_seasons_yearly
[0m21:32:39.682051 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:32:39.682714 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_order_shipped_montly
[0m21:32:39.683334 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_stores_items_monthly
[0m21:32:39.684565 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_product_daily, now model.local_bike.mrt_sales_seasons_yearly)
[0m21:32:39.689650 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m21:32:39.694881 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_montly"
[0m21:32:39.696033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_shipped_order, now model.local_bike.mrt_stores_items_monthly)
[0m21:32:39.696718 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_sales_seasons_yearly
[0m21:32:39.697560 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_stores_items_monthly
[0m21:32:39.703327 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_sales_seasons_yearly"
[0m21:32:39.704666 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_montly (compile): 21:32:39.690172 => 21:32:39.704220
[0m21:32:39.705397 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (compile): 21:32:39.684951 => 21:32:39.705032
[0m21:32:39.711809 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_stores_items_monthly"
[0m21:32:39.712890 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_order_shipped_montly
[0m21:32:39.713693 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:32:39.714768 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (compile): 21:32:39.698333 => 21:32:39.714230
[0m21:32:39.717263 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_sales_seasons_yearly
[0m21:32:39.716663 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (execute): 21:32:39.716269 => 21:32:39.716286
[0m21:32:39.715667 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_montly (execute): 21:32:39.715281 => 21:32:39.715300
[0m21:32:39.717941 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_items_monthly (compile): 21:32:39.705769 => 21:32:39.717586
[0m21:32:39.718574 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (execute): 21:32:39.718249 => 21:32:39.718268
[0m21:32:39.719938 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:32:39.721261 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_order_shipped_montly
[0m21:32:39.721791 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_stores_items_monthly
[0m21:32:39.723165 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_sales_seasons_yearly
[0m21:32:39.723814 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_stores_ranking_yearly
[0m21:32:39.724577 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_stores_sales_monthly
[0m21:32:39.726147 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_items_monthly (execute): 21:32:39.725389 => 21:32:39.725412
[0m21:32:39.726811 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_staff_daily
[0m21:32:39.727929 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_aborted_montly, now model.local_bike.mrt_stores_ranking_yearly)
[0m21:32:39.728931 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_montly, now model.local_bike.mrt_stores_sales_monthly)
[0m21:32:39.730642 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_stores_items_monthly
[0m21:32:39.731610 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_sales_seasons_yearly, now model.local_bike.int_src_local_bike_staff_daily)
[0m21:32:39.732173 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_stores_ranking_yearly
[0m21:32:39.732756 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_stores_sales_monthly
[0m21:32:39.733422 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:32:39.734105 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_staff_daily
[0m21:32:39.746687 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_stores_ranking_yearly"
[0m21:32:39.747682 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_stores_sales_monthly"
[0m21:32:39.748815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_items_monthly, now model.local_bike.mrt_products_ranking_yearly_top3)
[0m21:32:39.756139 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_daily"
[0m21:32:39.757107 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:32:39.758133 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (compile): 21:32:39.734452 => 21:32:39.757780
[0m21:32:39.763520 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m21:32:39.764163 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_stores_ranking_yearly
[0m21:32:39.765583 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (compile): 21:32:39.749280 => 21:32:39.765185
[0m21:32:39.766298 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (execute): 21:32:39.765982 => 21:32:39.766004
[0m21:32:39.767006 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (compile): 21:32:39.739823 => 21:32:39.766679
[0m21:32:39.767602 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_staff_daily
[0m21:32:39.768432 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (compile): 21:32:39.758553 => 21:32:39.768143
[0m21:32:39.769878 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_stores_ranking_yearly
[0m21:32:39.770423 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_stores_sales_monthly
[0m21:32:39.771115 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (execute): 21:32:39.770812 => 21:32:39.770833
[0m21:32:39.771653 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:32:39.772936 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (execute): 21:32:39.772540 => 21:32:39.772558
[0m21:32:39.774427 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_staff_daily
[0m21:32:39.775126 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (execute): 21:32:39.774807 => 21:32:39.774827
[0m21:32:39.776433 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_stores_sales_monthly
[0m21:32:39.778087 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:32:39.778900 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_products_brands_monthly
[0m21:32:39.779386 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_staff_ranking_yearly
[0m21:32:39.780003 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_staff_sales_monthly
[0m21:32:39.781394 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_ranking_yearly, now model.local_bike.mrt_products_brands_monthly)
[0m21:32:39.782481 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_daily, now model.local_bike.mrt_staff_ranking_yearly)
[0m21:32:39.783456 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_sales_monthly, now model.local_bike.mrt_staff_sales_monthly)
[0m21:32:39.784077 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_products_brands_monthly
[0m21:32:39.784642 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_staff_ranking_yearly
[0m21:32:39.785162 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_staff_sales_monthly
[0m21:32:39.802263 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_staff_ranking_yearly"
[0m21:32:39.825268 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:32:39.829453 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:32:39.832217 [debug] [Thread-3 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m21:32:39.833013 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (compile): 21:32:39.797594 => 21:32:39.832653
[0m21:32:39.873579 [debug] [Thread-2 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m21:32:39.874443 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_staff_ranking_yearly
[0m21:32:39.876792 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (execute): 21:32:39.876207 => 21:32:39.876296
[0m21:32:39.929272 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_staff_ranking_yearly
[0m21:32:42.478606 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:d749ffcb-2253-4f07-949d-4f7c2ca060a8&page=queryresults
[0m21:32:42.479792 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_staff_sales_monthly"
[0m21:32:42.480871 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (compile): 21:32:39.802921 => 21:32:42.480463
[0m21:32:42.481480 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_staff_sales_monthly
[0m21:32:42.482112 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (execute): 21:32:42.481817 => 21:32:42.481833
[0m21:32:42.483375 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_staff_sales_monthly
[0m21:32:42.644716 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:c1bf3f34-fbcc-4332-bf93-9d2f03fb9cfb&page=queryresults
[0m21:32:42.645895 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_products_brands_monthly"
[0m21:32:42.647058 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_products_brands_monthly (compile): 21:32:39.785522 => 21:32:42.646663
[0m21:32:42.647666 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_products_brands_monthly
[0m21:32:42.648563 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_products_brands_monthly (execute): 21:32:42.648167 => 21:32:42.648185
[0m21:32:42.649970 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_products_brands_monthly
[0m21:32:42.652120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:42.652575 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_sales_monthly' was properly closed.
[0m21:32:42.652914 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_ranking_yearly' was properly closed.
[0m21:32:42.653228 [debug] [MainThread]: Connection 'model.local_bike.mrt_products_ranking_yearly_top3' was properly closed.
[0m21:32:42.653485 [debug] [MainThread]: Connection 'model.local_bike.mrt_products_brands_monthly' was properly closed.
[0m21:32:42.659176 [debug] [MainThread]: Command end result
[0m21:32:42.701894 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m21:32:42.702346 [info ] [MainThread]: Building catalog
[0m21:32:42.706973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:43.331236 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m21:32:43.337887 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m21:32:43.339233 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m21:32:43.352240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:43.348550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:43.354035 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m21:32:43.357988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:43.361239 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_gold`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_gold'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m21:32:43.365122 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_silver`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_silver'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m21:32:43.370454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:43.554212 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_bronze`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_bronze'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m21:32:43.559160 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_seeds`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_seeds'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m21:32:45.382156 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:6db23d83-8208-4d05-a8d0-82e032a1c6b4&page=queryresults
[0m21:32:45.400825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:45.405337 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`src_local_bike`.__TABLES__
        where (upper(dataset_id) = upper('src_local_bike'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m21:32:45.470800 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:8ce4a571-650b-4960-9637-8a3dcb9bdc04&page=queryresults
[0m21:32:45.496219 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:000d81ab-ffcb-48ff-933e-150e05d2afe2&page=queryresults
[0m21:32:45.710749 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:d56e7e24-f26b-42a5-9b47-a291d99701f4&page=queryresults
[0m21:32:47.196710 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:7d275156-0bec-49df-9428-7ac6567c4f04&page=queryresults
[0m21:32:47.401926 [info ] [MainThread]: Catalog written to /usr/app/dbt/target/catalog.json
[0m21:32:47.404385 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:32:47.404008 after 10.93 seconds
[0m21:32:47.405222 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:32:47.405823 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m21:32:47.406324 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m21:32:47.406824 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m21:32:47.407408 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m21:32:47.408541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e690a11d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e6a34a6ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e6a34a6db0>]}
[0m21:32:47.409152 [debug] [MainThread]: Flushing usage events
[0m21:35:06.613809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b7b3ee7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b7b43f18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b7b45acbf0>]}


============================== 21:35:06.622188 | f3364cb1-ca08-4cdf-a073-530ccf8e2509 ==============================
[0m21:35:06.622188 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:35:06.623188 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_colors': 'True', 'quiet': 'False', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'printer_width': '80', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'no_print': 'None', 'write_json': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None'}
[0m21:35:06.677664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3364cb1-ca08-4cdf-a073-530ccf8e2509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b7b3e7d490>]}
[0m21:35:06.681003 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-a16g3xzv'
[0m21:35:06.682122 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:35:06.819247 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:35:06.821767 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m21:35:06.877475 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m21:35:06.884995 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:35:06.937801 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:35:06.946424 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m21:35:07.000706 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m21:35:07.003645 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m21:35:07.004392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f3364cb1-ca08-4cdf-a073-530ccf8e2509', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b7b3e3a2a0>]}
[0m21:35:07.023891 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m21:35:08.620402 [info ] [MainThread]: Installed from version 0.10.5
[0m21:35:08.621108 [info ] [MainThread]: Up to date!
[0m21:35:08.621941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3364cb1-ca08-4cdf-a073-530ccf8e2509', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b7b45974a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b7b3efd8b0>]}
[0m21:35:08.622645 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:35:08.846175 [info ] [MainThread]: Installed from version 1.3.2
[0m21:35:08.846995 [info ] [MainThread]: Up to date!
[0m21:35:08.847859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3364cb1-ca08-4cdf-a073-530ccf8e2509', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b7b3d26090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b7b3d27680>]}
[0m21:35:08.849170 [info ] [MainThread]: Installing calogica/dbt_date
[0m21:35:08.994395 [info ] [MainThread]: Installed from version 0.10.1
[0m21:35:08.995228 [info ] [MainThread]: Up to date!
[0m21:35:08.996389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3364cb1-ca08-4cdf-a073-530ccf8e2509', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b7b3d68dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b7b3d8d520>]}
[0m21:35:08.999646 [debug] [MainThread]: Command `dbt deps` succeeded at 21:35:08.999217 after 2.40 seconds
[0m21:35:09.000918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b7b7b16a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b7b53293d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b7b3e7d490>]}
[0m21:35:09.001793 [debug] [MainThread]: Flushing usage events
[0m21:35:14.947333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7560b1e39cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7560b1eb0530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7560b2b28bf0>]}


============================== 21:35:14.955392 | e511c78e-436e-44d0-b67e-c367dc9e7122 ==============================
[0m21:35:14.955392 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:35:14.956767 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'introspect': 'True', 'log_path': '/usr/app/dbt/logs', 'log_format': 'default', 'no_print': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'write_json': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'target_path': 'None', 'static_parser': 'True', 'debug': 'False'}
[0m21:35:16.609979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75609a19bf20>]}
[0m21:35:16.634568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756099fbb680>]}
[0m21:35:16.685062 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m21:35:16.778887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:35:16.779410 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:35:16.790692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75609ab26480>]}
[0m21:35:16.818410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756099cf7e60>]}
[0m21:35:16.819106 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m21:35:16.819810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75609a698980>]}
[0m21:35:16.825252 [info ] [MainThread]: 
[0m21:35:16.826910 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:35:16.830420 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m21:35:16.831223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:16.832596 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m21:35:16.834577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:16.834048 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m21:35:16.835425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:17.510326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_gold)
[0m21:35:17.511143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:35:17.512201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_seeds)
[0m21:35:17.513686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_silver)
[0m21:35:17.569812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:35:17.514368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:35:17.575327 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m21:35:17.662610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:17.986284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75609a04cb90>]}
[0m21:35:17.987466 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:35:17.988166 [info ] [MainThread]: 
[0m21:35:17.997481 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_brands
[0m21:35:17.998304 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_categories
[0m21:35:17.999415 [info ] [Thread-1 (]: 1 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_brands ......... [RUN]
[0m21:35:18.000802 [info ] [Thread-2 (]: 2 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_categories ..... [RUN]
[0m21:35:18.002623 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_customers
[0m21:35:18.004234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.stg_src_local_bike_brands)
[0m21:35:18.004896 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_order_items
[0m21:35:18.006254 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.stg_src_local_bike_categories)
[0m21:35:18.011424 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_categories
[0m21:35:18.007103 [info ] [Thread-3 (]: 3 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_customers ...... [RUN]
[0m21:35:18.010346 [info ] [Thread-4 (]: 4 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_order_items .... [RUN]
[0m21:35:18.009531 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_brands
[0m21:35:18.019439 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_categories"
[0m21:35:18.020859 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.stg_src_local_bike_customers)
[0m21:35:18.022144 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.stg_src_local_bike_order_items)
[0m21:35:18.026950 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_brands"
[0m21:35:18.027844 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_customers
[0m21:35:18.028623 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_order_items
[0m21:35:18.029336 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (compile): 21:35:18.011940 => 21:35:18.028956
[0m21:35:18.040621 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_categories
[0m21:35:18.038170 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (compile): 21:35:18.022642 => 21:35:18.037740
[0m21:35:18.034034 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_customers"
[0m21:35:18.057376 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_brands
[0m21:35:18.131208 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_brands"
[0m21:35:18.135744 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_categories"
[0m21:35:18.144081 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (compile): 21:35:18.029871 => 21:35:18.143479
[0m21:35:18.151846 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_order_items"
[0m21:35:18.152820 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_customers
[0m21:35:18.154303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:18.159515 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_customers"
[0m21:35:18.161406 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (compile): 21:35:18.034662 => 21:35:18.160977
[0m21:35:18.162210 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:35:18.162784 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_order_items
[0m21:35:18.163435 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:35:18.165797 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_brands: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_brands"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
  OPTIONS(
      description="""Bike brands sold by Local Bike."""
    )
  as select
        brand_id as brand_id,
        INITCAP(brand_name) as brand_name
from `databird-473015`.`src_local_bike`.`brands`;


[0m21:35:18.170966 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_order_items"
[0m21:35:18.173296 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_categories: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_categories"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_categories`
  OPTIONS(
      description="""Product categories such as road, mountain, and electric bikes."""
    )
  as select
        category_id as category_id,
        INITCAP(category_name) as category_name
from `databird-473015`.`src_local_bike`.`categories`;


[0m21:35:18.215272 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_customers: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_customers"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_customers`
  OPTIONS(
      description="""Customer informations."""
    )
  as select
    customer_id as customer_id,
    INITCAP(first_name) as customer_first_name,
    INITCAP(last_name) as customer_last_name,
    phone as customer_phone,
    email as customer_email,
    INITCAP(street) as customer_street,
    INITCAP(city) as customer_city,
    UPPER(state) as customer_state,
    zip_code as customer_zip_code
from `databird-473015`.`src_local_bike`.`customers`;


[0m21:35:18.299900 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:35:18.307955 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_order_items: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_order_items"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
  OPTIONS(
      description="""Detailed order line items with pricing and discounts."""
    )
  as SELECT
  order_id as order_id,
  item_id AS item_id,
  product_id as product_id,
  quantity as quantity,
  list_price as list_price,
  discount as discount,
  
    list_price * quantity * ( 1 - discount )
 AS total_item_discount_sold
FROM `databird-473015`.`src_local_bike`.`order_items`;


[0m21:35:19.020606 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:58c82f49-9c5c-4438-8081-27d2e345ff2d&page=queryresults
[0m21:35:19.050775 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:dd103066-1420-40e1-870a-e111605ef47a&page=queryresults
[0m21:35:19.087998 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:49816f4a-467a-4e64-9a0a-e067afa480cf&page=queryresults
[0m21:35:19.369756 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (execute): 21:35:18.154885 => 21:35:19.369365
[0m21:35:19.370884 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756099fcc9e0>]}
[0m21:35:19.371717 [info ] [Thread-3 (]: 3 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_customers . [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m21:35:19.373255 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_customers
[0m21:35:19.374031 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_orders
[0m21:35:19.374822 [info ] [Thread-3 (]: 5 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_orders ......... [RUN]
[0m21:35:19.376545 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_customers, now model.local_bike.stg_src_local_bike_orders)
[0m21:35:19.377545 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_orders
[0m21:35:19.386896 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_orders"
[0m21:35:19.388085 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_orders (compile): 21:35:19.378303 => 21:35:19.387676
[0m21:35:19.388653 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_orders
[0m21:35:19.393959 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_orders"
[0m21:35:19.396520 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (execute): 21:35:18.087427 => 21:35:19.396211
[0m21:35:19.397564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756099d4ff20>]}
[0m21:35:19.398383 [info ] [Thread-1 (]: 1 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_brands .... [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m21:35:19.400246 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_brands
[0m21:35:19.401298 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:35:19.405796 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:765573b1-c155-418a-a0d7-c05f0bfc7dcb&page=queryresults
[0m21:35:19.406968 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_products
[0m21:35:19.415056 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_orders: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_orders"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`
  OPTIONS(
      description="""Order headers with key dates and statuses"""
    )
  as select
    order_id as order_id,
    customer_id as customer_id,
    order_status as order_status,
    CAST(order_date as date) as order_date,
    CAST(required_date as date) as required_date,
    CAST(shipped_date as date) as shipped_date,
    store_id as store_id,
    staff_id as staff_id,
    
    CASE
        WHEN EXTRACT(MONTH FROM order_date) IN (12, 1, 2) THEN 'Winter'
        WHEN EXTRACT(MONTH FROM order_date) IN (3, 4, 5) THEN 'Spring'
        WHEN EXTRACT(MONTH FROM order_date) IN (6, 7, 8) THEN 'Summer'
        WHEN EXTRACT(MONTH FROM order_date) IN (9, 10, 11) THEN 'Autumn'
    END
 AS season_name
from `databird-473015`.`src_local_bike`.`orders`;


[0m21:35:19.416191 [info ] [Thread-1 (]: 6 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_products ....... [RUN]
[0m21:35:19.419400 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (execute): 21:35:18.166403 => 21:35:19.418836
[0m21:35:19.460374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_brands, now model.local_bike.stg_src_local_bike_products)
[0m21:35:19.462547 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756099d3f260>]}
[0m21:35:19.463335 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_products
[0m21:35:19.464674 [info ] [Thread-4 (]: 4 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_order_items  [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m21:35:19.471975 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_order_items
[0m21:35:19.473358 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_staffs
[0m21:35:19.472536 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_products"
[0m21:35:19.475894 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_products (compile): 21:35:19.465225 => 21:35:19.475384
[0m21:35:19.476850 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_products
[0m21:35:19.474461 [info ] [Thread-4 (]: 7 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_staffs ......... [RUN]
[0m21:35:19.483330 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_order_items, now model.local_bike.stg_src_local_bike_staffs)
[0m21:35:19.486404 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_staffs
[0m21:35:19.497936 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_staffs"
[0m21:35:19.507236 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_products"
[0m21:35:19.508478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:19.511319 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_products"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_products`
  OPTIONS(
      description="""Products sold, linked to brands and categories."""
    )
  as select
        product_id as product_id,
        INITCAP(product_name) as product_name,
        brand_id as brand_id,
        category_id as category_id,
        model_year as model_year,
        coalesce(list_price,0) as list_price
from `databird-473015`.`src_local_bike`.`products`;


[0m21:35:19.512273 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (compile): 21:35:19.487018 => 21:35:19.511786
[0m21:35:19.566380 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_staffs
[0m21:35:19.578260 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_staffs"
[0m21:35:19.580918 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:35:19.588458 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_staffs: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_staffs"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs`
  OPTIONS(
      description="""Sales and management staff working in Local Bike stores."""
    )
  as select
    CAST(staff_id AS int) as staff_id,
    INITCAP(first_name) as staff_first_name,
    INITCAP(last_name) as staff_last_name,
    phone as staff_phone,
    email as staff_email,
    active as staff_active,
    store_id as store_id,
    CAST(manager_id AS int)  as manager_id
from `databird-473015`.`src_local_bike`.`staffs`;


[0m21:35:19.827952 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (execute): 21:35:18.042262 => 21:35:19.827608
[0m21:35:19.829031 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756099e22270>]}
[0m21:35:19.829835 [info ] [Thread-2 (]: 2 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_categories  [[32mCREATE VIEW (0 processed)[0m in 1.82s]
[0m21:35:19.831271 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_categories
[0m21:35:19.832289 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_stocks
[0m21:35:19.833208 [info ] [Thread-2 (]: 8 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_stocks ......... [RUN]
[0m21:35:19.835071 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_categories, now model.local_bike.stg_src_local_bike_stocks)
[0m21:35:19.836053 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_stocks
[0m21:35:19.844298 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stocks"
[0m21:35:19.845417 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (compile): 21:35:19.836488 => 21:35:19.845076
[0m21:35:19.846008 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_stocks
[0m21:35:19.850471 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_stocks"
[0m21:35:19.851369 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:35:19.854098 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_stocks: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_stocks"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stocks`
  OPTIONS(
      description="""Stock of products and availability."""
    )
  as select
    store_id   as store_id,
    product_id as product_id,
    quantity   as stock_quantity
from `databird-473015`.`src_local_bike`.`stocks`;


[0m21:35:20.268397 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:2b393ea6-0e26-41cf-b8e3-fc3e6da51746&page=queryresults
[0m21:35:20.276467 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:d087e400-fd96-4352-a6ca-5c0d5e67b23f&page=queryresults
[0m21:35:20.333692 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:65256a34-d6df-48b6-99d5-c745a3ceb375&page=queryresults
[0m21:35:20.592652 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (execute): 21:35:19.567029 => 21:35:20.592137
[0m21:35:20.596158 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:be03241e-312e-475b-8511-fd736a5de94e&page=queryresults
[0m21:35:20.597392 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756099e20830>]}
[0m21:35:20.600662 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_products (execute): 21:35:19.478275 => 21:35:20.600154
[0m21:35:20.607143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756099d54230>]}
[0m21:35:20.605423 [info ] [Thread-4 (]: 7 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_staffs .... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m21:35:20.611666 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_staffs
[0m21:35:20.613477 [info ] [Thread-1 (]: 6 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_products .. [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m21:35:20.615800 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_stores
[0m21:35:20.618213 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_products
[0m21:35:20.620651 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:35:20.619701 [info ] [Thread-4 (]: 9 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_stores ......... [RUN]
[0m21:35:20.623381 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_staffs, now model.local_bike.stg_src_local_bike_stores)
[0m21:35:20.621679 [info ] [Thread-1 (]: 10 of 24 START sql view model dbt_bike_silver.int_src_local_bike_staff_hierarchy  [RUN]
[0m21:35:20.624420 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_stores
[0m21:35:20.625738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_products, now model.local_bike.int_src_local_bike_staff_hierarchy)
[0m21:35:20.632403 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:35:20.641011 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stores"
[0m21:35:20.644027 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m21:35:20.645433 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (compile): 21:35:20.633052 => 21:35:20.644896
[0m21:35:20.646193 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:35:20.647307 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_stores (compile): 21:35:20.626272 => 21:35:20.646847
[0m21:35:20.650931 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_stores
[0m21:35:20.657366 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_stores"
[0m21:35:20.668766 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m21:35:20.670680 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:35:20.672316 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_orders (execute): 21:35:19.388954 => 21:35:20.672013
[0m21:35:20.673726 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756098426600>]}
[0m21:35:20.674663 [info ] [Thread-3 (]: 5 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_orders .... [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m21:35:20.675880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:20.677429 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_orders
[0m21:35:20.681806 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_stores: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_stores"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`
  OPTIONS(
      description="""Store locations in California, New York, and Texas."""
    )
  as select
    store_id as store_id,
    INITCAP(store_name) as store_name,
    phone as store_phone,
    email as store_email,
    street as store_street,
    INITCAP(city) as store_city,
    UPPER(state) as store_state,
    zip_code as store_zip_code
from `databird-473015`.`src_local_bike`.`stores`;


[0m21:35:20.685120 [debug] [Thread-1 (]: On model.local_bike.int_src_local_bike_staff_hierarchy: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_hierarchy"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy`
  OPTIONS(
      description="""This model provides an hirarchical view of employees. It enriches the store data with the following data:\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each employe.."""
    )
  as ------------------------------------------
  WITH RECURSIVE staff_hierarchy AS (

  -- Niveau 0 : managers racine
  SELECT
    m.staff_id,
    m.staff_first_name,
    m.staff_last_name,
    m.manager_id,
    m.store_id,
    m.staff_first_name || ' ' || m.staff_last_name AS path,
    0 AS level
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs` m
  WHERE m.manager_id IS NULL

  UNION ALL

  -- Niveaux suivants : rattacher les subordonnés
  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,    
    CONCAT(h.path, ' → ', s.staff_first_name, ' ', s.staff_last_name) AS path,
    h.level + 1 AS level
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs` s
  JOIN staff_hierarchy as h ON s.manager_id = h.staff_id
  
)
------------------------------------------
SELECT 
     * 
FROM staff_hierarchy
ORDER BY path, level;


[0m21:35:20.724676 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_product_daily
[0m21:35:20.765627 [info ] [Thread-3 (]: 11 of 24 START sql view model dbt_bike_silver.int_src_local_bike_product_daily . [RUN]
[0m21:35:20.771580 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_orders, now model.local_bike.int_src_local_bike_product_daily)
[0m21:35:20.773593 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_product_daily
[0m21:35:20.783840 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_product_daily"
[0m21:35:20.785259 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (compile): 21:35:20.774077 => 21:35:20.784724
[0m21:35:20.786540 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_product_daily
[0m21:35:20.805238 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_product_daily"
[0m21:35:20.807817 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:35:20.812603 [debug] [Thread-3 (]: On model.local_bike.int_src_local_bike_product_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_product_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily`
  OPTIONS(
      description="""This model provides an aggregated view of product items. It enriches the products data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each product.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Product Informations**: Enriches the product with user-specific data, such as brand and category.\r\n\r\nIt provides a comprehensive view of each product, allowing for easy analysis of product performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH order_items AS (
  SELECT 
        order_id as order_id,
        item_id as item_id,
        product_id as product_id,
        quantity as quantity,
        list_price as list_price,
        discount as discount,
        ROUND((discount * 100),2) as discount_percent,
        ROUND(total_item_discount_sold, 2) as total_item_discount_sold 
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
),
------------------------------------------
orders_date AS (
  SELECT 
        order_id, 
        CAST(order_date as date) as order_date,
        store_id,
        season_name,
        EXTRACT(YEAR FROM order_date) as yeardate,
        EXTRACT(YEAR FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`
),
------------------------------------------
products AS (
  SELECT 
        product_id as product_id,
        product_name as product_name,
        brand_id as brand_id,
        category_id as category_id,
        model_year as product_model_year,
        ROUND(list_price,2) as list_price
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_products`
),
------------------------------------------
brands AS (
  SELECT 
        brand_id as brand_id,
        brand_name as brand_name
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
),
------------------------------------------
categories AS (
  SELECT 
        category_id as category_id,
        category_name as category_name
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_categories`
)
------------------------------------------
SELECT
  o.order_id,
  o.store_id,
  o.order_date,
  o.yeardate,
  o.monthday,
  o.yearmonth,
  o.month_2digits,
  o.month_name,
  o.month_abbrev,
  o.week_number,
  o.season_name,
  p.product_id,
  p.product_name,
  b.brand_name,
  c.category_name,
  oi.quantity,
  oi.list_price,
  oi.discount,
  oi.discount_percent,
  SUM(oi.total_item_discount_sold) as total_item_discount_sold,
  COUNT(*) as total_items
FROM orders_date as o
LEFT JOIN order_items as oi ON o.order_id = oi.order_id
LEFT JOIN products as p ON oi.product_id = p.product_id
LEFT JOIN brands as b ON p.brand_id = b.brand_id
LEFT JOIN categories as c ON p.category_id = c.category_id
GROUP BY 
  o.order_id,
  o.store_id,
  o.order_date,
  o.yeardate,
  o.monthday,
  o.yearmonth,
  o.month_2digits,
  o.month_name,
  o.month_abbrev,
  o.week_number,
  o.season_name, 
  p.product_id,
  p.product_name,
  b.brand_name,
  c.category_name,
  oi.quantity,
  oi.list_price,
  oi.discount,
  oi.discount_percent
ORDER BY o.yeardate, o.week_number, o.order_id;


[0m21:35:20.978302 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (execute): 21:35:19.846280 => 21:35:20.977972
[0m21:35:20.979412 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756099dfbef0>]}
[0m21:35:20.980221 [info ] [Thread-2 (]: 8 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_stocks .... [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m21:35:20.981863 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_stocks
[0m21:35:21.592832 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:eb79f08e-8025-4a29-bf6f-224c8dcc6453&page=queryresults
[0m21:35:21.789244 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:c6e26e69-14ae-4325-b69e-81ca60b1d9e0&page=queryresults
[0m21:35:21.849193 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:2257a884-62ed-4b57-8c02-92c70cb136c1&page=queryresults
[0m21:35:21.900032 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_stores (execute): 21:35:20.652718 => 21:35:21.899399
[0m21:35:21.901564 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756099d7ea80>]}
[0m21:35:21.902640 [info ] [Thread-4 (]: 9 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_stores .... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m21:35:21.904120 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_stores
[0m21:35:21.906353 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_store_daily
[0m21:35:21.908187 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:35:21.909633 [info ] [Thread-2 (]: 12 of 24 START sql view model dbt_bike_silver.int_src_local_bike_store_daily ... [RUN]
[0m21:35:21.915879 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stocks, now model.local_bike.int_src_local_bike_store_daily)
[0m21:35:21.911378 [info ] [Thread-4 (]: 13 of 24 START sql view model dbt_bike_silver.int_src_local_bike_store_shipped_order  [RUN]
[0m21:35:21.917974 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_store_daily
[0m21:35:21.919318 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stores, now model.local_bike.int_src_local_bike_store_shipped_order)
[0m21:35:21.926152 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:35:21.935609 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_daily"
[0m21:35:21.940021 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m21:35:21.942448 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (compile): 21:35:21.927263 => 21:35:21.941864
[0m21:35:21.943198 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:35:21.949946 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m21:35:21.950947 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (compile): 21:35:21.920083 => 21:35:21.950472
[0m21:35:21.952046 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_store_daily
[0m21:35:21.958008 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_store_daily"
[0m21:35:21.959212 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:35:21.962098 [debug] [Thread-4 (]: On model.local_bike.int_src_local_bike_store_shipped_order: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_shipped_order"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_shipped_order`
  OPTIONS(
      description="""This model provides the list of order required, shipped and aborted per month over 3 years.\r\n\r\nIt provides a comprehensive view of each order, allowing for easy analysis of order performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_shipped_date AS (

  SELECT 
        order_id, 
        order_date,
        required_date,
        shipped_date, 
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    required_date,
    shipped_date,
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_shipped_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.order_id,
    ls.shipped_date ,
    ls.required_date ,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date, ls.shipped_date, ls.required_date,ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m21:35:21.963091 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:35:22.015468 [debug] [Thread-2 (]: On model.local_bike.int_src_local_bike_store_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  OPTIONS(
      description="""This model provides an aggregated view of stores. It enriches the store data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each store.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Total Distinct Items**: The count of distinct product types in the order.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_date AS (

  SELECT 
        order_id, 
        order_date,
        shipped_date,
        required_date,
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    o.shipped_date,
    o.required_date,    
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.shipped_date,
    ls.required_date,     
    ls.order_id,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date,ls.shipped_date,ls.required_date, ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m21:35:22.128947 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (execute): 21:35:20.647782 => 21:35:22.128358
[0m21:35:22.133253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756098434e30>]}
[0m21:35:22.136831 [info ] [Thread-1 (]: 10 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_staff_hierarchy  [[32mCREATE VIEW (0 processed)[0m in 1.51s]
[0m21:35:22.141556 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:35:22.143805 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_staff_daily
[0m21:35:22.144792 [info ] [Thread-1 (]: 14 of 24 START sql view model dbt_bike_silver.int_src_local_bike_staff_daily ... [RUN]
[0m21:35:22.150253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_hierarchy, now model.local_bike.int_src_local_bike_staff_daily)
[0m21:35:22.152476 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_staff_daily
[0m21:35:22.267350 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (execute): 21:35:20.788587 => 21:35:22.267056
[0m21:35:22.272119 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756099d3d400>]}
[0m21:35:22.273104 [info ] [Thread-3 (]: 11 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_product_daily  [[32mCREATE VIEW (0 processed)[0m in 1.50s]
[0m21:35:22.281326 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_product_daily
[0m21:35:22.304887 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_daily"
[0m21:35:22.306104 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (compile): 21:35:22.153061 => 21:35:22.305692
[0m21:35:22.306689 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_staff_daily
[0m21:35:22.311716 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_staff_daily"
[0m21:35:22.312657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:22.315010 [debug] [Thread-1 (]: On model.local_bike.int_src_local_bike_staff_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  OPTIONS(
      description="""This model provides an aggregated view of staffs and stores. It enriches the store and staff data with the following metrics:\r\n- **Total item Amount**: The sum of all order items for each employe.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each store and staffs, allowing for easy analysis of store performance, employee performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH staff_list AS (

  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,
    s.path,
    s.level
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy` s

),
------------------------------------------
sales_by_employee AS (

  SELECT
    o.order_date as order_date,
    o.season_name,
    EXTRACT(YEAR FROM o.order_date) as yeardate,
    EXTRACT(YEAR FROM o.order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') AS yearmonth,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM o.order_date) AS STRING), 2, '0') AS monthday,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') as month_2digits,
    FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_name,
    FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_abbrev,
    LPAD(CAST(EXTRACT(ISOWEEK FROM o.order_date) AS STRING), 2, '0') AS week_number,
    o.staff_id,
    oi.total_item_discount_sold as total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders` as o
  LEFT JOIN `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items` as oi ON o.order_id = oi.order_id

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

)
------------------------------------------
SELECT 
    em.order_date,
    em.yeardate,
    em.monthday,
    em.yearmonth,
    em.month_2digits,
    em.month_name,
    em.month_abbrev,
    em.week_number,
    em.season_name,
    st.store_name,
    m.store_latitude,
    m.store_longitude,    
    st.store_city,
    st.store_state,    
    ROUND(em.total_item_discount_sold, 2) as total_item_sold_staff,
    s.*
FROM sales_by_employee as em 
JOIN staff_list as s ON em.staff_id = s.staff_id
LEFT JOIN map as m on s.store_id = m.store_id
LEFT JOIN stores as st on m.store_id = st.store_id
ORDER BY em.order_date;


[0m21:35:22.757258 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:5e2f6942-7d17-4a6a-9c7f-0fb91782b401&page=queryresults
[0m21:35:23.019489 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:6b04ebca-ac1c-44fe-8369-9b733297f3aa&page=queryresults
[0m21:35:23.112786 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (execute): 21:35:21.943589 => 21:35:23.112451
[0m21:35:23.113856 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75609844f800>]}
[0m21:35:23.114706 [info ] [Thread-4 (]: 13 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_store_shipped_order  [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m21:35:23.115876 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:35:23.210843 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:b7e3c6c8-1b74-467e-87b4-6f4afdf12081&page=queryresults
[0m21:35:23.494419 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (execute): 21:35:22.307006 => 21:35:23.494113
[0m21:35:23.495563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7560b3c5bf50>]}
[0m21:35:23.496363 [info ] [Thread-1 (]: 14 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_staff_daily  [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m21:35:23.497614 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_staff_daily
[0m21:35:23.499021 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_products_brands_monthly
[0m21:35:23.499744 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_staff_ranking_yearly
[0m21:35:23.500420 [info ] [Thread-3 (]: 15 of 24 START sql table model dbt_bike_gold.products_brands_monthly_report .... [RUN]
[0m21:35:23.502830 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_product_daily, now model.local_bike.mrt_products_brands_monthly)
[0m21:35:23.501420 [info ] [Thread-4 (]: 16 of 24 START sql table model dbt_bike_gold.ranking_sales_staffs_yearly_top3_report  [RUN]
[0m21:35:23.504982 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_staff_sales_monthly
[0m21:35:23.505805 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_products_brands_monthly
[0m21:35:23.507214 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_shipped_order, now model.local_bike.mrt_staff_ranking_yearly)
[0m21:35:23.508178 [info ] [Thread-1 (]: 17 of 24 START sql table model dbt_bike_gold.staffs_sales_monthly_report ....... [RUN]
[0m21:35:23.526819 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_staff_ranking_yearly
[0m21:35:23.527378 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:35:23.528636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_daily, now model.local_bike.mrt_staff_sales_monthly)
[0m21:35:23.534011 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_staff_ranking_yearly"
[0m21:35:23.536197 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (execute): 21:35:21.952447 => 21:35:23.535868
[0m21:35:23.536937 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_staff_sales_monthly
[0m21:35:23.538878 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7560983be180>]}
[0m21:35:23.548776 [debug] [Thread-3 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m21:35:23.550773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:23.545762 [info ] [Thread-2 (]: 12 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_store_daily  [[32mCREATE VIEW (0 processed)[0m in 1.63s]
[0m21:35:23.589580 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (compile): 21:35:23.529191 => 21:35:23.589080
[0m21:35:23.593756 [debug] [Thread-1 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m21:35:23.594984 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_store_daily
[0m21:35:23.595908 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_staff_ranking_yearly
[0m21:35:23.662385 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:35:23.663251 [info ] [Thread-2 (]: 18 of 24 START sql table model dbt_bike_gold.orders_shipped_aborted_monthly_report  [RUN]
[0m21:35:23.664770 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_daily, now model.local_bike.mrt_order_shipped_aborted_montly)
[0m21:35:23.671006 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:35:23.668490 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:35:23.705171 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m21:35:23.709264 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (compile): 21:35:23.671520 => 21:35:23.708174
[0m21:35:23.715962 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:35:23.767942 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:35:24.032633 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.mrt_staff_ranking_yearly"
[0m21:35:24.034070 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m21:35:24.036528 [debug] [Thread-2 (]: On model.local_bike.mrt_order_shipped_aborted_montly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_order_shipped_aborted_montly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`orders_shipped_aborted_monthly_report`
    
    

    OPTIONS(
      description="""This model provides an aggregated view of the canceled orders. It enriches the order data with the following metrics:\r\n- **nb_shipped_aborted**: The quantity of order aborted.\r\n- **total_aborted_sales**: The cost of aborted orders.\r\n- **Order Informations**: Enriches the product with user-specific data, such as store name.\r\n\r\nIt provides a comprehensive view the aborted order, allowing for easy analysis of order performance."""
    )
    as (
      ------------------------------------------

------------------------------------------

WITH total_aborted_orders AS (

  SELECT
    yearmonth AS month,
    COUNTIF(shipped_date IS NULL) AS nb_shipped_aborted,
    ROUND(SUM(total_sales_amount),2) as total_aborted_sales,
    store_name
  FROM  `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  WHERE shipped_date is null
  GROUP BY month,store_name

)
------------------------------------------
SELECT *
FROM total_aborted_orders
------------------------------------------
    );
  
[0m21:35:24.037280 [debug] [Thread-4 (]: On model.local_bike.mrt_staff_ranking_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_ranking_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`ranking_sales_staffs_yearly_top3_report`
    
    

    OPTIONS(
      description="""This model provides **Top seller** per store and per year over 3 years.\r\n\r\nIt provides a comprehensive view of each seller, allowing for easy analysis of seller performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH sales_staffs_stores AS (

  SELECT
    yeardate AS year,
    staff_first_name || '-' || staff_last_name || ' ('|| store_name || ')' AS staff_name,
    ROUND(SUM(total_item_sold_staff), 2) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  GROUP BY year, staff_name

)
SELECT
  year,
  staff_name,
  total_sales
FROM (
  SELECT
    *,
    RANK() OVER (PARTITION BY year ORDER BY total_sales DESC) AS rank_sales
  FROM sales_staffs_stores
)
WHERE rank_sales <= 3 
ORDER BY year, total_sales
    );
  
[0m21:35:26.297675 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:910b4747-c53b-4135-961f-af12f518b08b&page=queryresults
[0m21:35:26.299119 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_products_brands_monthly"
[0m21:35:26.300762 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_products_brands_monthly (compile): 21:35:23.510527 => 21:35:26.300259
[0m21:35:26.301431 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_products_brands_monthly
[0m21:35:26.351462 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:471e920c-5d23-45e1-8566-fa45924abd11&page=queryresults
[0m21:35:26.352861 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_staff_sales_monthly"
[0m21:35:26.354035 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (compile): 21:35:23.539354 => 21:35:26.353634
[0m21:35:26.354624 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_staff_sales_monthly
[0m21:35:26.458332 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.mrt_staff_sales_monthly"
[0m21:35:26.459597 [debug] [Thread-1 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`staffs_sales_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **best-seller** per month over 3 years.\r\n\r\nIt provides a comprehensive view of each seller, allowing for easy analysis of sellers performance."""
    )
    as (
      ------------------------------------------

------------------------------------------


------------------------------------------
SELECT *
FROM (

  SELECT
    staff_first_name || '-' || staff_last_name AS staff_name,
    yearmonth AS month,
    ROUND(SUM(total_item_sold_staff), 2 ) AS total_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  GROUP BY month, staff_name

)
PIVOT (

  SUM(total_items) AS sales
  FOR month IN ( '2016-01','2016-02','2016-03','2016-04','2016-05','2016-06','2016-07','2016-08','2016-09','2016-10','2016-11','2016-12','2017-01','2017-02','2017-03','2017-04','2017-05','2017-06','2017-07','2017-08','2017-09','2017-10','2017-11','2017-12','2018-01','2018-02','2018-03','2018-04','2018-06','2018-07','2018-08','2018-09','2018-10','2018-11','2018-12' )

)
ORDER BY staff_name
------------------------------------------
    );
  
[0m21:35:26.467494 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.mrt_products_brands_monthly"
[0m21:35:26.468940 [debug] [Thread-3 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`products_brands_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **best-selling brands** per month over 3 years.\r\n\r\nIt provides a comprehensive view of each brand, allowing for easy analysis of brands performance."""
    )
    as (
      ------------------------------------------

------------------------------------------


------------------------------------------
SELECT *
FROM (

  SELECT
    yearmonth AS month,
    brand_name as Brand,    
    ROUND(SUM(total_item_discount_sold), 2 ) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily`
  GROUP BY month, brand

)
PIVOT (

  SUM(total_sales) AS sales
  FOR month IN ( '2016-01','2016-02','2016-03','2016-04','2016-05','2016-06','2016-07','2016-08','2016-09','2016-10','2016-11','2016-12','2017-01','2017-02','2017-03','2017-04','2017-05','2017-06','2017-07','2017-08','2017-09','2017-10','2017-11','2017-12','2018-01','2018-02','2018-03','2018-04','2018-06','2018-07','2018-08','2018-09','2018-10','2018-11','2018-12' )

)
ORDER BY Brand
------------------------------------------
    );
  
[0m21:35:27.708119 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:fca6efd7-17f1-4bca-8bee-a5564da2b715&page=queryresults
[0m21:35:27.875318 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:e54c2ab3-797e-4769-9505-fb14df4f149c&page=queryresults
[0m21:35:27.994205 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (execute): 21:35:23.764226 => 21:35:27.993852
[0m21:35:27.995275 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75609a04d9a0>]}
[0m21:35:27.996096 [info ] [Thread-2 (]: 18 of 24 OK created sql table model dbt_bike_gold.orders_shipped_aborted_monthly_report  [[32mCREATE TABLE (38.0 rows, 215.1 KiB processed)[0m in 4.33s]
[0m21:35:27.997295 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:35:27.998233 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_order_shipped_montly
[0m21:35:27.999156 [info ] [Thread-2 (]: 19 of 24 START sql table model dbt_bike_gold.orders_shipped_monthly_report ..... [RUN]
[0m21:35:28.000727 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_aborted_montly, now model.local_bike.mrt_order_shipped_montly)
[0m21:35:28.001488 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_order_shipped_montly
[0m21:35:28.009106 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_montly"
[0m21:35:28.010372 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_montly (compile): 21:35:28.002074 => 21:35:28.009961
[0m21:35:28.011000 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_order_shipped_montly
[0m21:35:28.014954 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:35:28.173392 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (execute): 21:35:23.644132 => 21:35:28.173089
[0m21:35:28.174441 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756099d09910>]}
[0m21:35:28.175295 [info ] [Thread-4 (]: 16 of 24 OK created sql table model dbt_bike_gold.ranking_sales_staffs_yearly_top3_report  [[32mCREATE TABLE (9.0 rows, 185.9 KiB processed)[0m in 4.67s]
[0m21:35:28.176584 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_staff_ranking_yearly
[0m21:35:28.177866 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:35:28.179096 [info ] [Thread-4 (]: 20 of 24 START sql table model dbt_bike_gold.products_stores_ranking_yearly_report  [RUN]
[0m21:35:28.181010 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_staff_ranking_yearly, now model.local_bike.mrt_products_ranking_yearly_top3)
[0m21:35:28.182451 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:35:28.194297 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m21:35:28.195364 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (compile): 21:35:28.182894 => 21:35:28.195007
[0m21:35:28.195909 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:35:28.199532 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:35:28.243622 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_order_shipped_montly"
[0m21:35:28.244753 [debug] [Thread-2 (]: On model.local_bike.mrt_order_shipped_montly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_order_shipped_montly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`orders_shipped_monthly_report`
    
    

    OPTIONS(
      description="""This model provides an aggregated view of the orders sent. It enriches the order data with the following metrics:\r\n- **nb_order_shipped**: The quantity of orders shipped.\r\n- **total_sales**: The cost of orders shipped.\r\n- **Order Informations**: Enriches the product with user-specific data, such as store name.\r\n\r\nIt provides a comprehensive view the aborted order, allowing for easy analysis of order performance."""
    )
    as (
      ------------------------------------------

------------------------------------------

WITH total_orders AS (

  SELECT
    yearmonth AS month,
    COUNT(order_date) AS nb_order_shipped,
    ROUND(SUM(total_sales_amount),2) as total_sales,
    store_name
  FROM  `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  WHERE shipped_date is not null
  GROUP BY month,store_name

)
------------------------------------------
SELECT *
FROM total_orders
------------------------------------------
    );
  
[0m21:35:28.437984 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m21:35:28.438920 [debug] [Thread-4 (]: On model.local_bike.mrt_products_ranking_yearly_top3: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_ranking_yearly_top3"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`products_stores_ranking_yearly_report`
    
    

    OPTIONS(
      description="""This model provides the top 3 **best-selling products** per year over 3 years.\r\n\r\nIt provides a comprehensive view of each product, allowing for easy analysis of products performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH product_sales AS (
  SELECT
    p.yeardate AS year,
    s.store_name AS store,
    p.product_name,
    p.brand_name,
    ROUND(SUM(total_item_discount_sold), 2) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily` AS p
  LEFT JOIN `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`AS s
    ON p.order_id = s.order_id 
   AND p.store_id = s.store_id
  GROUP BY year,store,product_name,brand_name
)
------------------------------------------
SELECT
  year,
  store,
  product_name,
  brand_name,
  total_sales
FROM (
  SELECT
    *,
    RANK() OVER ( PARTITION BY year, store ORDER BY total_sales DESC ) AS rank_product
  FROM product_sales
)
WHERE rank_product <= 3
ORDER BY year, store
------------------------------------------
    );
  
[0m21:35:29.051175 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:13a1f774-210e-410b-af04-88ffc2ed16ef&page=queryresults
[0m21:35:29.349572 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_products_brands_monthly (execute): 21:35:26.301792 => 21:35:29.349205
[0m21:35:29.350858 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756099f200e0>]}
[0m21:35:29.351801 [info ] [Thread-3 (]: 15 of 24 OK created sql table model dbt_bike_gold.products_brands_monthly_report  [[32mCREATE TABLE (9.0 rows, 217.4 KiB processed)[0m in 5.85s]
[0m21:35:29.353098 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_products_brands_monthly
[0m21:35:29.354088 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_sales_seasons_yearly
[0m21:35:29.355079 [info ] [Thread-3 (]: 21 of 24 START sql table model dbt_bike_gold.sales_seasons_yearly_report ....... [RUN]
[0m21:35:29.356563 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_products_brands_monthly, now model.local_bike.mrt_sales_seasons_yearly)
[0m21:35:29.357293 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_sales_seasons_yearly
[0m21:35:29.366265 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_sales_seasons_yearly"
[0m21:35:29.367705 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (compile): 21:35:29.357739 => 21:35:29.367227
[0m21:35:29.368394 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_sales_seasons_yearly
[0m21:35:29.373178 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:35:29.598135 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.mrt_sales_seasons_yearly"
[0m21:35:29.599723 [debug] [Thread-3 (]: On model.local_bike.mrt_sales_seasons_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_sales_seasons_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`sales_seasons_yearly_report`
    
    

    OPTIONS(
      description="""This model provides the **top-performing store by season** and per year over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH sales_stores_seasons AS (

  SELECT
    yeardate AS year,
    store_name AS store,
    season_name,
    ROUND(SUM(total_sales_amount), 2) AS sales_amount
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year,store,season_name

)

SELECT *
FROM sales_stores_seasons
PIVOT (
  SUM(sales_amount) AS sales
  FOR season_name IN ('Winter','Spring','Summer','Autumn')
)
ORDER BY year, store
------------------------------------------
    );
  
[0m21:35:30.910473 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:315bb4c7-52ba-4292-9e86-2a89699108ab&page=queryresults
[0m21:35:30.981824 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:db1712bf-07a1-4e0d-8c74-8d59dba50447&page=queryresults
[0m21:35:31.199880 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (execute): 21:35:26.354963 => 21:35:31.199462
[0m21:35:31.201212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756099d094c0>]}
[0m21:35:31.202293 [info ] [Thread-1 (]: 17 of 24 OK created sql table model dbt_bike_gold.staffs_sales_monthly_report .. [[32mCREATE TABLE (6.0 rows, 185.8 KiB processed)[0m in 7.67s]
[0m21:35:31.203843 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_staff_sales_monthly
[0m21:35:31.205153 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_stores_items_monthly
[0m21:35:31.206321 [info ] [Thread-1 (]: 22 of 24 START sql table model dbt_bike_gold.items_stores_monthly_report ....... [RUN]
[0m21:35:31.208054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_staff_sales_monthly, now model.local_bike.mrt_stores_items_monthly)
[0m21:35:31.209069 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_stores_items_monthly
[0m21:35:31.217324 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_stores_items_monthly"
[0m21:35:31.218658 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_items_monthly (compile): 21:35:31.209520 => 21:35:31.218213
[0m21:35:31.219290 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_stores_items_monthly
[0m21:35:31.224428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:31.317905 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_montly (execute): 21:35:28.011297 => 21:35:31.317276
[0m21:35:31.319879 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7560983ce1b0>]}
[0m21:35:31.321330 [info ] [Thread-2 (]: 19 of 24 OK created sql table model dbt_bike_gold.orders_shipped_monthly_report  [[32mCREATE TABLE (81.0 rows, 215.1 KiB processed)[0m in 3.32s]
[0m21:35:31.323827 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_order_shipped_montly
[0m21:35:31.327602 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_stores_ranking_yearly
[0m21:35:31.329341 [info ] [Thread-2 (]: 23 of 24 START sql table model dbt_bike_gold.stores_ranking_yearly_report ...... [RUN]
[0m21:35:31.333481 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_montly, now model.local_bike.mrt_stores_ranking_yearly)
[0m21:35:31.334405 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_stores_ranking_yearly
[0m21:35:31.341212 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_stores_ranking_yearly"
[0m21:35:31.343059 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (compile): 21:35:31.334921 => 21:35:31.342584
[0m21:35:31.343600 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_stores_ranking_yearly
[0m21:35:31.349699 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:35:31.464525 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.mrt_stores_items_monthly"
[0m21:35:31.465473 [debug] [Thread-1 (]: On model.local_bike.mrt_stores_items_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_items_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`items_stores_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **total number of items sold** per store over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT *
FROM (

  SELECT
    yeardate AS year,
    month_2digits as month,
    store_name,
    COUNT(total_items) AS nb_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year, month, store_name

)
PIVOT (

  SUM(nb_items) AS total_items
  FOR store_name IN ('Santa Cruz Bikes','Baldwin Bikes','Rowlett Bikes')

)
ORDER BY year, month
------------------------------------------
    );
  
[0m21:35:31.533701 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_stores_ranking_yearly"
[0m21:35:31.534638 [debug] [Thread-2 (]: On model.local_bike.mrt_stores_ranking_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_ranking_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`stores_ranking_yearly_report`
    
    

    OPTIONS(
      description="""This model provides **the ranking of best stores** over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT
  yeardate AS year_date,
  store_name,
  store_latitude,
  store_longitude,
  ROUND(SUM(total_sales_amount), 2) AS total_sales,
  RANK() OVER (PARTITION BY yeardate ORDER BY SUM(total_sales_amount) DESC) AS store_rank
FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
GROUP BY yeardate, store_name,store_latitude,store_longitude
ORDER BY yeardate, store_rank
------------------------------------------
    );
  
[0m21:35:31.815489 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:af84733d-b639-471e-a33f-0b2fd9047196&page=queryresults
[0m21:35:32.145179 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (execute): 21:35:28.196209 => 21:35:32.142240
[0m21:35:32.147324 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7560983c5100>]}
[0m21:35:32.148641 [info ] [Thread-4 (]: 20 of 24 OK created sql table model dbt_bike_gold.products_stores_ranking_yearly_report  [[32mCREATE TABLE (27.0 rows, 270.5 KiB processed)[0m in 3.97s]
[0m21:35:32.150150 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:35:32.151166 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_stores_sales_monthly
[0m21:35:32.152809 [info ] [Thread-4 (]: 24 of 24 START sql table model dbt_bike_gold.sales_stores_monthly_report ....... [RUN]
[0m21:35:32.156136 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_products_ranking_yearly_top3, now model.local_bike.mrt_stores_sales_monthly)
[0m21:35:32.157185 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_stores_sales_monthly
[0m21:35:32.172485 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_stores_sales_monthly"
[0m21:35:32.174264 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (compile): 21:35:32.157906 => 21:35:32.173689
[0m21:35:32.175185 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_stores_sales_monthly
[0m21:35:32.181460 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:35:32.398427 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.mrt_stores_sales_monthly"
[0m21:35:32.399381 [debug] [Thread-4 (]: On model.local_bike.mrt_stores_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_sales_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`sales_stores_monthly_report`
    
    

    OPTIONS(
      description="""This model provides **top sales by store** over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT *
FROM (

  SELECT
    yeardate AS year,
    month_2digits as month,
    store_name,
    ROUND(SUM(total_sales_amount), 2) AS sales_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year, month, store_name

)
PIVOT (

  SUM(sales_items) AS total_sales
  FOR store_name IN ('Santa Cruz Bikes','Baldwin Bikes','Rowlett Bikes')

)
ORDER BY year, month
------------------------------------------
    );
  
[0m21:35:35.011843 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:7e70a27b-8551-4253-8f70-24033ca183d2&page=queryresults
[0m21:35:35.167092 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:e8424342-1904-4a41-aa6b-d2d0687b1cc3&page=queryresults
[0m21:35:35.245315 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:a0c3af5d-fefe-46db-a9b7-589b60f9180e&page=queryresults
[0m21:35:35.288532 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (execute): 21:35:32.175668 => 21:35:35.288207
[0m21:35:35.289659 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756099d7bc20>]}
[0m21:35:35.290461 [info ] [Thread-4 (]: 24 of 24 OK created sql table model dbt_bike_gold.sales_stores_monthly_report .. [[32mCREATE TABLE (35.0 rows, 215.1 KiB processed)[0m in 3.14s]
[0m21:35:35.291663 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_stores_sales_monthly
[0m21:35:35.504919 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (execute): 21:35:29.368785 => 21:35:35.504551
[0m21:35:35.506209 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756099d30e00>]}
[0m21:35:35.507235 [info ] [Thread-3 (]: 21 of 24 OK created sql table model dbt_bike_gold.sales_seasons_yearly_report .. [[32mCREATE TABLE (9.0 rows, 215.1 KiB processed)[0m in 6.15s]
[0m21:35:35.508464 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_sales_seasons_yearly
[0m21:35:35.662465 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (execute): 21:35:31.343905 => 21:35:35.662109
[0m21:35:35.663899 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7560982e7bf0>]}
[0m21:35:35.871275 [info ] [Thread-2 (]: 23 of 24 OK created sql table model dbt_bike_gold.stores_ranking_yearly_report . [[32mCREATE TABLE (9.0 rows, 215.1 KiB processed)[0m in 4.33s]
[0m21:35:35.873059 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_stores_ranking_yearly
[0m21:35:39.473963 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:0405b162-f6a0-4957-9896-3f7fd552add7&page=queryresults
[0m21:35:39.785210 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_items_monthly (execute): 21:35:31.219657 => 21:35:39.784872
[0m21:35:39.786437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e511c78e-436e-44d0-b67e-c367dc9e7122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7560983ba300>]}
[0m21:35:39.787360 [info ] [Thread-1 (]: 22 of 24 OK created sql table model dbt_bike_gold.items_stores_monthly_report .. [[32mCREATE TABLE (35.0 rows, 104.5 KiB processed)[0m in 8.58s]
[0m21:35:39.788660 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_stores_items_monthly
[0m21:35:39.794065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:39.794834 [debug] [MainThread]: Connection 'model.local_bike.mrt_stores_ranking_yearly' was properly closed.
[0m21:35:39.795251 [debug] [MainThread]: Connection 'model.local_bike.mrt_sales_seasons_yearly' was properly closed.
[0m21:35:39.795574 [debug] [MainThread]: Connection 'model.local_bike.mrt_stores_sales_monthly' was properly closed.
[0m21:35:39.795904 [debug] [MainThread]: Connection 'model.local_bike.mrt_stores_items_monthly' was properly closed.
[0m21:35:39.796405 [info ] [MainThread]: 
[0m21:35:39.797316 [info ] [MainThread]: Finished running 14 view models, 10 table models in 0 hours 0 minutes and 22.97 seconds (22.97s).
[0m21:35:39.806445 [debug] [MainThread]: Command end result
[0m21:35:39.851480 [info ] [MainThread]: 
[0m21:35:39.852581 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:35:39.855332 [info ] [MainThread]: 
[0m21:35:39.857683 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 TOTAL=24
[0m21:35:39.860818 [debug] [MainThread]: Command `dbt run` succeeded at 21:35:39.860328 after 24.93 seconds
[0m21:35:39.862025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7560b5b12a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7560b2b28bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7560b2597500>]}
[0m21:35:39.862809 [debug] [MainThread]: Flushing usage events
[0m21:35:46.451791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c7ab5e36b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c7ad4ba840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c7ab5e3020>]}


============================== 21:35:46.457308 | 076b6776-d6dd-4f8e-9bcc-84487bd62bb8 ==============================
[0m21:35:46.457308 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:35:46.458402 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'target_path': 'None', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/app/dbt/logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False'}
[0m21:35:47.976066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '076b6776-d6dd-4f8e-9bcc-84487bd62bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c7ad110e90>]}
[0m21:35:47.999737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '076b6776-d6dd-4f8e-9bcc-84487bd62bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c7938874d0>]}
[0m21:35:48.051663 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m21:35:48.131146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:35:48.131705 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:35:48.142929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '076b6776-d6dd-4f8e-9bcc-84487bd62bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c7938865a0>]}
[0m21:35:48.165306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '076b6776-d6dd-4f8e-9bcc-84487bd62bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c79361c3e0>]}
[0m21:35:48.166370 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m21:35:48.167392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '076b6776-d6dd-4f8e-9bcc-84487bd62bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c7ab5fa0c0>]}
[0m21:35:48.172731 [info ] [MainThread]: 
[0m21:35:48.175465 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:35:48.178900 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m21:35:48.179724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:48.180867 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m21:35:48.181746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:48.224106 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m21:35:48.267297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:48.313643 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m21:35:48.316224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:48.606729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '076b6776-d6dd-4f8e-9bcc-84487bd62bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c7ab41c3e0>]}
[0m21:35:48.608359 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:35:48.609365 [info ] [MainThread]: 
[0m21:35:48.619160 [debug] [Thread-1 (]: Began running node test.local_bike.assert_total_order_amount_is_positive
[0m21:35:48.620188 [info ] [Thread-1 (]: 1 of 1 START test assert_total_order_amount_is_positive ........................ [RUN]
[0m21:35:48.623704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now test.local_bike.assert_total_order_amount_is_positive)
[0m21:35:48.625140 [debug] [Thread-1 (]: Began compiling node test.local_bike.assert_total_order_amount_is_positive
[0m21:35:48.654132 [debug] [Thread-1 (]: Writing injected SQL for node "test.local_bike.assert_total_order_amount_is_positive"
[0m21:35:48.655799 [debug] [Thread-1 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (compile): 21:35:48.625887 => 21:35:48.655166
[0m21:35:48.656730 [debug] [Thread-1 (]: Began executing node test.local_bike.assert_total_order_amount_is_positive
[0m21:35:48.695812 [debug] [Thread-1 (]: Writing runtime sql for node "test.local_bike.assert_total_order_amount_is_positive"
[0m21:35:48.697979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:48.700120 [debug] [Thread-1 (]: On test.local_bike.assert_total_order_amount_is_positive: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "test.local_bike.assert_total_order_amount_is_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Refunds have a negative amount, so the total amount should always be >= 0.
-- Therefore return records where total_amount < 0 to make the test fail
select
    order_id,
    sum(total_item_discount_sold) as total_amount  
from `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
group by 1
having total_amount < 0
      
    ) dbt_internal_test
[0m21:35:49.577472 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:761809e5-1fe6-4a8e-95cf-cc29dadb642e&page=queryresults
[0m21:35:49.579735 [debug] [Thread-1 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (execute): 21:35:48.657176 => 21:35:49.579289
[0m21:35:49.581058 [info ] [Thread-1 (]: 1 of 1 PASS assert_total_order_amount_is_positive .............................. [[32mPASS[0m in 0.96s]
[0m21:35:49.582401 [debug] [Thread-1 (]: Finished running node test.local_bike.assert_total_order_amount_is_positive
[0m21:35:49.586535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:49.587118 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_seeds' was properly closed.
[0m21:35:49.587629 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_silver' was properly closed.
[0m21:35:49.588026 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_bronze' was properly closed.
[0m21:35:49.588596 [debug] [MainThread]: Connection 'test.local_bike.assert_total_order_amount_is_positive' was properly closed.
[0m21:35:49.589236 [info ] [MainThread]: 
[0m21:35:49.589811 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m21:35:49.592202 [debug] [MainThread]: Command end result
[0m21:35:49.628293 [info ] [MainThread]: 
[0m21:35:49.629161 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:35:49.630405 [info ] [MainThread]: 
[0m21:35:49.631950 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:35:49.633690 [debug] [MainThread]: Command `dbt test` succeeded at 21:35:49.633296 after 3.19 seconds
[0m21:35:49.634564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c7abce6870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c7ab530260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c7abcd3920>]}
[0m21:35:49.635301 [debug] [MainThread]: Flushing usage events
[0m21:35:55.827942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c41bb6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c47adc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c41bbc20>]}


============================== 21:35:55.833635 | 753a8c18-f350-42ae-b010-fce012d19c72 ==============================
[0m21:35:55.833635 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:35:55.834712 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'debug': 'False', 'printer_width': '80', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'fail_fast': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_path': '/usr/app/dbt/logs', 'cache_selected_only': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'introspect': 'True', 'partial_parse': 'True', 'write_json': 'True', 'no_print': 'None'}
[0m21:35:57.343713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '753a8c18-f350-42ae-b010-fce012d19c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c41f93d0>]}
[0m21:35:57.366818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '753a8c18-f350-42ae-b010-fce012d19c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b1e4e480>]}
[0m21:35:57.416572 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m21:35:57.493886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:35:57.494446 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:35:57.505407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '753a8c18-f350-42ae-b010-fce012d19c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b04d26c0>]}
[0m21:35:57.510634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '753a8c18-f350-42ae-b010-fce012d19c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b032cfb0>]}
[0m21:35:57.511304 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m21:35:57.512139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '753a8c18-f350-42ae-b010-fce012d19c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b0c6cc80>]}
[0m21:35:57.518490 [info ] [MainThread]: 
[0m21:35:57.520454 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:35:57.523795 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m21:35:57.525665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:57.525192 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m21:35:57.526449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:57.527532 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m21:35:57.569227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:57.570529 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m21:35:57.612725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:57.943668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '753a8c18-f350-42ae-b010-fce012d19c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b1919b20>]}
[0m21:35:57.944868 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:35:57.945775 [info ] [MainThread]: 
[0m21:35:57.954869 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_brands
[0m21:35:57.955726 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_categories
[0m21:35:57.956833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.stg_src_local_bike_brands)
[0m21:35:57.957558 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_customers
[0m21:35:57.958617 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_order_items
[0m21:35:57.960419 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.stg_src_local_bike_categories)
[0m21:35:57.961148 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_brands
[0m21:35:57.962274 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.stg_src_local_bike_customers)
[0m21:35:57.963334 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.stg_src_local_bike_order_items)
[0m21:35:57.963991 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_categories
[0m21:35:57.969712 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_brands"
[0m21:35:57.970453 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_customers
[0m21:35:57.971089 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_order_items
[0m21:35:57.988920 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_order_items"
[0m21:35:57.990759 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_customers"
[0m21:35:57.998309 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (compile): 21:35:57.964379 => 21:35:57.997767
[0m21:35:58.004909 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_brands
[0m21:35:58.008585 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_categories"
[0m21:35:58.009604 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (compile): 21:35:57.977379 => 21:35:58.009124
[0m21:35:58.010717 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (execute): 21:35:58.010199 => 21:35:58.010252
[0m21:35:58.011558 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (compile): 21:35:57.982474 => 21:35:58.011172
[0m21:35:58.012379 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_customers
[0m21:35:58.014051 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_brands
[0m21:35:58.015054 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_order_items
[0m21:35:58.016289 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (execute): 21:35:58.015683 => 21:35:58.015708
[0m21:35:58.017238 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (compile): 21:35:57.971484 => 21:35:58.016799
[0m21:35:58.018177 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_orders
[0m21:35:58.019130 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (execute): 21:35:58.018781 => 21:35:58.018802
[0m21:35:58.020637 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_customers
[0m21:35:58.021219 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_categories
[0m21:35:58.022254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_brands, now model.local_bike.stg_src_local_bike_orders)
[0m21:35:58.024150 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_order_items
[0m21:35:58.024859 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_products
[0m21:35:58.025801 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (execute): 21:35:58.025400 => 21:35:58.025418
[0m21:35:58.026350 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_orders
[0m21:35:58.027033 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_staffs
[0m21:35:58.029130 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_customers, now model.local_bike.stg_src_local_bike_products)
[0m21:35:58.045850 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_products
[0m21:35:58.041408 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_order_items, now model.local_bike.stg_src_local_bike_staffs)
[0m21:35:58.053125 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_staffs
[0m21:35:58.031872 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_categories
[0m21:35:58.044879 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_orders"
[0m21:35:58.060019 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_products"
[0m21:35:58.061118 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_stocks
[0m21:35:58.067991 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_staffs"
[0m21:35:58.071704 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (compile): 21:35:58.032723 => 21:35:58.069338
[0m21:35:58.075341 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_products (compile): 21:35:58.046379 => 21:35:58.074687
[0m21:35:58.077575 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_categories, now model.local_bike.stg_src_local_bike_stocks)
[0m21:35:58.081636 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_stocks
[0m21:35:58.080193 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_orders
[0m21:35:58.080887 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_products
[0m21:35:58.079194 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (compile): 21:35:58.053837 => 21:35:58.078624
[0m21:35:58.094393 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_staffs
[0m21:35:58.088296 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (execute): 21:35:58.087607 => 21:35:58.087651
[0m21:35:58.095679 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (execute): 21:35:58.095089 => 21:35:58.095111
[0m21:35:58.092162 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stocks"
[0m21:35:58.093412 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_products (execute): 21:35:58.092728 => 21:35:58.092765
[0m21:35:58.102116 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_products
[0m21:35:58.097854 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_orders
[0m21:35:58.105294 [debug] [Thread-1 (]: Began running node seed.local_bike.map
[0m21:35:58.099924 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_staffs
[0m21:35:58.107596 [debug] [Thread-4 (]: Began running node seed.local_bike.seasons
[0m21:35:58.103407 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (compile): 21:35:58.082036 => 21:35:58.102917
[0m21:35:58.110017 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_stocks
[0m21:35:58.104352 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_stores
[0m21:35:58.106714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_orders, now seed.local_bike.map)
[0m21:35:58.108998 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_staffs, now seed.local_bike.seasons)
[0m21:35:58.110927 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (execute): 21:35:58.110439 => 21:35:58.110459
[0m21:35:58.112832 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_products, now model.local_bike.stg_src_local_bike_stores)
[0m21:35:58.114050 [debug] [Thread-1 (]: Began compiling node seed.local_bike.map
[0m21:35:58.115347 [debug] [Thread-4 (]: Began compiling node seed.local_bike.seasons
[0m21:35:58.116981 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_stocks
[0m21:35:58.117933 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_stores
[0m21:35:58.122037 [debug] [Thread-1 (]: Timing info for seed.local_bike.map (compile): 21:35:58.118409 => 21:35:58.121593
[0m21:35:58.125614 [debug] [Thread-4 (]: Timing info for seed.local_bike.seasons (compile): 21:35:58.122540 => 21:35:58.125120
[0m21:35:58.126558 [debug] [Thread-2 (]: Began running node test.local_bike.assert_total_order_amount_is_positive
[0m21:35:58.131398 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stores"
[0m21:35:58.132206 [debug] [Thread-1 (]: Began executing node seed.local_bike.map
[0m21:35:58.132845 [debug] [Thread-4 (]: Began executing node seed.local_bike.seasons
[0m21:35:58.133909 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stocks, now test.local_bike.assert_total_order_amount_is_positive)
[0m21:35:58.136367 [debug] [Thread-2 (]: Began compiling node test.local_bike.assert_total_order_amount_is_positive
[0m21:35:58.135787 [debug] [Thread-4 (]: Timing info for seed.local_bike.seasons (execute): 21:35:58.135350 => 21:35:58.135365
[0m21:35:58.134904 [debug] [Thread-1 (]: Timing info for seed.local_bike.map (execute): 21:35:58.134531 => 21:35:58.134556
[0m21:35:58.137071 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_stores (compile): 21:35:58.127170 => 21:35:58.136749
[0m21:35:58.144539 [debug] [Thread-4 (]: Finished running node seed.local_bike.seasons
[0m21:35:58.146637 [debug] [Thread-2 (]: Writing injected SQL for node "test.local_bike.assert_total_order_amount_is_positive"
[0m21:35:58.148481 [debug] [Thread-1 (]: Finished running node seed.local_bike.map
[0m21:35:58.149315 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_stores
[0m21:35:58.150114 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_product_daily
[0m21:35:58.151707 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:35:58.153418 [debug] [Thread-2 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (compile): 21:35:58.137403 => 21:35:58.152790
[0m21:35:58.154328 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_stores (execute): 21:35:58.153936 => 21:35:58.153957
[0m21:35:58.155443 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.local_bike.seasons, now model.local_bike.int_src_local_bike_product_daily)
[0m21:35:58.156614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.local_bike.map, now model.local_bike.int_src_local_bike_staff_hierarchy)
[0m21:35:58.157252 [debug] [Thread-2 (]: Began executing node test.local_bike.assert_total_order_amount_is_positive
[0m21:35:58.158727 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_stores
[0m21:35:58.159292 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_product_daily
[0m21:35:58.159858 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:35:58.160589 [debug] [Thread-2 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (execute): 21:35:58.160228 => 21:35:58.160250
[0m21:35:58.166927 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_store_daily
[0m21:35:58.170628 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_product_daily"
[0m21:35:58.175755 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m21:35:58.177407 [debug] [Thread-2 (]: Finished running node test.local_bike.assert_total_order_amount_is_positive
[0m21:35:58.178462 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stores, now model.local_bike.int_src_local_bike_store_daily)
[0m21:35:58.179660 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:35:58.180663 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_store_daily
[0m21:35:58.181678 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (compile): 21:35:58.161392 => 21:35:58.181262
[0m21:35:58.182671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.local_bike.assert_total_order_amount_is_positive, now model.local_bike.int_src_local_bike_store_shipped_order)
[0m21:35:58.183349 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (compile): 21:35:58.171212 => 21:35:58.183031
[0m21:35:58.190489 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_daily"
[0m21:35:58.191453 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_product_daily
[0m21:35:58.192437 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:35:58.193105 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:35:58.194043 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (execute): 21:35:58.193660 => 21:35:58.193686
[0m21:35:58.201280 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (execute): 21:35:58.200424 => 21:35:58.200449
[0m21:35:58.202716 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m21:35:58.204489 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_product_daily
[0m21:35:58.205191 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (compile): 21:35:58.183756 => 21:35:58.204860
[0m21:35:58.208093 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_store_daily
[0m21:35:58.206903 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m21:35:58.208827 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (execute): 21:35:58.208444 => 21:35:58.208465
[0m21:35:58.210453 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_store_daily
[0m21:35:58.211140 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (compile): 21:35:58.194452 => 21:35:58.210819
[0m21:35:58.212011 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:35:58.212662 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (execute): 21:35:58.212319 => 21:35:58.212335
[0m21:35:58.213214 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_staff_daily
[0m21:35:58.214738 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_store_shipped_order
[0m21:35:58.215657 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:35:58.216582 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_order_shipped_montly
[0m21:35:58.218087 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_product_daily, now model.local_bike.int_src_local_bike_staff_daily)
[0m21:35:58.218846 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:35:58.220059 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_daily, now model.local_bike.mrt_order_shipped_aborted_montly)
[0m21:35:58.221067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_hierarchy, now model.local_bike.mrt_order_shipped_montly)
[0m21:35:58.221704 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_staff_daily
[0m21:35:58.222658 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_shipped_order, now model.local_bike.mrt_products_ranking_yearly_top3)
[0m21:35:58.223282 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:35:58.223839 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_order_shipped_montly
[0m21:35:58.231108 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_daily"
[0m21:35:58.232246 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:35:58.237586 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m21:35:58.242702 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_montly"
[0m21:35:58.248450 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m21:35:58.250153 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (compile): 21:35:58.224213 => 21:35:58.249702
[0m21:35:58.251442 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_staff_daily
[0m21:35:58.252401 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (compile): 21:35:58.243382 => 21:35:58.251988
[0m21:35:58.253149 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (compile): 21:35:58.232729 => 21:35:58.252816
[0m21:35:58.254080 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_order_shipped_montly (compile): 21:35:58.238219 => 21:35:58.253474
[0m21:35:58.254836 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (execute): 21:35:58.254464 => 21:35:58.254485
[0m21:35:58.255431 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:35:58.256335 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:35:58.257174 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_order_shipped_montly
[0m21:35:58.258639 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_staff_daily
[0m21:35:58.259695 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (execute): 21:35:58.259060 => 21:35:58.259081
[0m21:35:58.260729 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (execute): 21:35:58.260324 => 21:35:58.260346
[0m21:35:58.261582 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_order_shipped_montly (execute): 21:35:58.261156 => 21:35:58.261184
[0m21:35:58.262281 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_sales_seasons_yearly
[0m21:35:58.263901 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_products_ranking_yearly_top3
[0m21:35:58.265492 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_order_shipped_aborted_montly
[0m21:35:58.266891 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_order_shipped_montly
[0m21:35:58.268306 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_daily, now model.local_bike.mrt_sales_seasons_yearly)
[0m21:35:58.269211 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_stores_items_monthly
[0m21:35:58.270053 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_stores_ranking_yearly
[0m21:35:58.271071 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_stores_sales_monthly
[0m21:35:58.271956 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_sales_seasons_yearly
[0m21:35:58.273154 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_products_ranking_yearly_top3, now model.local_bike.mrt_stores_items_monthly)
[0m21:35:58.274242 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_aborted_montly, now model.local_bike.mrt_stores_ranking_yearly)
[0m21:35:58.278623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_montly, now model.local_bike.mrt_stores_sales_monthly)
[0m21:35:58.283846 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_sales_seasons_yearly"
[0m21:35:58.285095 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_stores_items_monthly
[0m21:35:58.285826 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_stores_ranking_yearly
[0m21:35:58.286440 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_stores_sales_monthly
[0m21:35:58.296909 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_stores_ranking_yearly"
[0m21:35:58.297966 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_stores_items_monthly"
[0m21:35:58.304718 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_stores_sales_monthly"
[0m21:35:58.305851 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (compile): 21:35:58.279207 => 21:35:58.305425
[0m21:35:58.306949 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (compile): 21:35:58.298749 => 21:35:58.306583
[0m21:35:58.307625 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (compile): 21:35:58.292335 => 21:35:58.307262
[0m21:35:58.309689 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_stores_ranking_yearly
[0m21:35:58.308276 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_sales_seasons_yearly
[0m21:35:58.310586 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (execute): 21:35:58.310143 => 21:35:58.310161
[0m21:35:58.308868 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_stores_sales_monthly
[0m21:35:58.311307 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_items_monthly (compile): 21:35:58.287029 => 21:35:58.310992
[0m21:35:58.311996 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (execute): 21:35:58.311674 => 21:35:58.311694
[0m21:35:58.313396 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_stores_ranking_yearly
[0m21:35:58.314110 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (execute): 21:35:58.313784 => 21:35:58.313804
[0m21:35:58.314649 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_stores_items_monthly
[0m21:35:58.316039 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_sales_seasons_yearly
[0m21:35:58.316734 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_products_brands_monthly
[0m21:35:58.318993 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_stores_sales_monthly
[0m21:35:58.319799 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_items_monthly (execute): 21:35:58.319418 => 21:35:58.319442
[0m21:35:58.320461 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_staff_ranking_yearly
[0m21:35:58.321645 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_ranking_yearly, now model.local_bike.mrt_products_brands_monthly)
[0m21:35:58.322327 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_staff_sales_monthly
[0m21:35:58.323977 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_stores_items_monthly
[0m21:35:58.324964 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_sales_seasons_yearly, now model.local_bike.mrt_staff_ranking_yearly)
[0m21:35:58.325545 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_products_brands_monthly
[0m21:35:58.326537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_sales_monthly, now model.local_bike.mrt_staff_sales_monthly)
[0m21:35:58.327294 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_staff_ranking_yearly
[0m21:35:58.339181 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_staff_sales_monthly
[0m21:35:58.350077 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:35:58.355034 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_staff_ranking_yearly"
[0m21:35:58.362379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:58.365159 [debug] [Thread-1 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m21:35:58.404154 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (compile): 21:35:58.350560 => 21:35:58.403660
[0m21:35:58.406489 [debug] [Thread-3 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m21:35:58.407687 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_staff_ranking_yearly
[0m21:35:58.447967 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (execute): 21:35:58.447376 => 21:35:58.447409
[0m21:35:58.449704 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_staff_ranking_yearly
[0m21:35:59.293424 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:ac9ab832-ce82-496d-b4b6-351a150116c9&page=queryresults
[0m21:35:59.294678 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_products_brands_monthly"
[0m21:35:59.296277 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_products_brands_monthly (compile): 21:35:58.327679 => 21:35:59.295776
[0m21:35:59.296936 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_products_brands_monthly
[0m21:35:59.297585 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_products_brands_monthly (execute): 21:35:59.297251 => 21:35:59.297268
[0m21:35:59.298923 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_products_brands_monthly
[0m21:35:59.386205 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:57ec8032-b46e-46af-95e7-82a188a24636&page=queryresults
[0m21:35:59.387256 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_staff_sales_monthly"
[0m21:35:59.388294 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (compile): 21:35:58.355604 => 21:35:59.387914
[0m21:35:59.388836 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_staff_sales_monthly
[0m21:35:59.389399 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (execute): 21:35:59.389117 => 21:35:59.389131
[0m21:35:59.390654 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_staff_sales_monthly
[0m21:35:59.392993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:59.393375 [debug] [MainThread]: Connection 'model.local_bike.mrt_products_brands_monthly' was properly closed.
[0m21:35:59.393753 [debug] [MainThread]: Connection 'model.local_bike.mrt_stores_items_monthly' was properly closed.
[0m21:35:59.394068 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_ranking_yearly' was properly closed.
[0m21:35:59.394355 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_sales_monthly' was properly closed.
[0m21:35:59.399972 [debug] [MainThread]: Command end result
[0m21:35:59.430165 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m21:35:59.430630 [info ] [MainThread]: Building catalog
[0m21:35:59.437293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:59.967591 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m21:35:59.975113 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m21:35:59.981750 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m21:35:59.990356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:59.995815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:00.000589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:00.001973 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m21:36:00.005154 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_silver`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_silver'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m21:36:00.107668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:00.148936 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_gold`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_gold'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m21:36:00.151861 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_bronze`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_bronze'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m21:36:00.236547 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_seeds`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_seeds'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m21:36:01.939038 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:3518fd9a-43b5-4049-b05d-7123fc646f52&page=queryresults
[0m21:36:01.950033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:36:01.952710 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`src_local_bike`.__TABLES__
        where (upper(dataset_id) = upper('src_local_bike'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m21:36:02.010438 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:a30e88fc-0f72-4ea2-ac98-e74d89682a6f&page=queryresults
[0m21:36:02.152884 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:912794a6-2b2e-4e38-9924-47161ad96c4f&page=queryresults
[0m21:36:02.172808 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:9f70d0f4-e90a-424d-a34f-9c01f048d2cb&page=queryresults
[0m21:36:03.869946 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:74fb3920-10a4-49bd-9d9d-ed364107aa26&page=queryresults
[0m21:36:04.072346 [info ] [MainThread]: Catalog written to /usr/app/dbt/target/catalog.json
[0m21:36:04.074979 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:36:04.074584 after 8.26 seconds
[0m21:36:04.076268 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:36:04.076995 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m21:36:04.077586 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m21:36:04.078482 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m21:36:04.079008 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m21:36:04.079567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c47af2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c47adc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c475edb0>]}
[0m21:36:04.080121 [debug] [MainThread]: Flushing usage events
[0m23:48:45.412479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0f0170380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0f0180dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0f08b8440>]}


============================== 23:48:45.430260 | b232ab03-bb3f-401b-be0d-2e8b4e41f624 ==============================
[0m23:48:45.430260 [info ] [MainThread]: Running with dbt=1.5.0
[0m23:48:45.431587 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': '/root/.dbt', 'target_path': 'None', 'introspect': 'True', 'version_check': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'debug': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'printer_width': '80', 'log_path': '/usr/app/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_format': 'default'}
[0m23:48:47.740899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b232ab03-bb3f-401b-be0d-2e8b4e41f624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0f094b8c0>]}
[0m23:48:47.766488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b232ab03-bb3f-401b-be0d-2e8b4e41f624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0dc3aea50>]}
[0m23:48:47.832788 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m23:48:48.120210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:48:48.120825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:48:48.132732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b232ab03-bb3f-401b-be0d-2e8b4e41f624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0dc3ab440>]}
[0m23:48:48.140093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b232ab03-bb3f-401b-be0d-2e8b4e41f624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0dc0eb8c0>]}
[0m23:48:48.140779 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m23:48:48.141835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b232ab03-bb3f-401b-be0d-2e8b4e41f624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0dc7929c0>]}
[0m23:48:48.147997 [info ] [MainThread]: 
[0m23:48:48.149847 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:48:48.154078 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m23:48:48.157781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:48.156591 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m23:48:48.160996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:48.159890 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m23:48:48.162297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:48.205583 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m23:48:48.247262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:48.736304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b232ab03-bb3f-401b-be0d-2e8b4e41f624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0dc68ac30>]}
[0m23:48:48.737583 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:48:48.738239 [info ] [MainThread]: 
[0m23:48:48.782644 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_brands
[0m23:48:48.783447 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_categories
[0m23:48:48.787063 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.stg_src_local_bike_categories)
[0m23:48:48.785298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.stg_src_local_bike_brands)
[0m23:48:48.785950 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_order_items
[0m23:48:48.784202 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_customers
[0m23:48:48.787634 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_categories
[0m23:48:48.788239 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_brands
[0m23:48:48.789243 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.stg_src_local_bike_order_items)
[0m23:48:48.790237 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.stg_src_local_bike_customers)
[0m23:48:48.800202 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_brands"
[0m23:48:48.803327 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (compile): 23:48:48.796003 => 23:48:48.802981
[0m23:48:48.800863 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_categories"
[0m23:48:48.802191 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_customers
[0m23:48:48.801536 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_order_items
[0m23:48:48.803868 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_brands
[0m23:48:48.809465 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_customers"
[0m23:48:48.817427 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_order_items"
[0m23:48:48.818430 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (execute): 23:48:48.818015 => 23:48:48.818062
[0m23:48:48.820625 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_brands
[0m23:48:48.821361 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_orders
[0m23:48:48.822696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_brands, now model.local_bike.stg_src_local_bike_orders)
[0m23:48:48.823248 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_orders
[0m23:48:48.823907 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (compile): 23:48:48.790692 => 23:48:48.823588
[0m23:48:48.828207 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (compile): 23:48:48.804370 => 23:48:48.827611
[0m23:48:48.834178 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_categories
[0m23:48:48.840216 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (compile): 23:48:48.809719 => 23:48:48.839392
[0m23:48:48.841566 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_customers
[0m23:48:48.845617 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (execute): 23:48:48.845043 => 23:48:48.845085
[0m23:48:48.856015 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_orders"
[0m23:48:48.856751 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_order_items
[0m23:48:48.857646 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (execute): 23:48:48.857240 => 23:48:48.857261
[0m23:48:48.859162 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_categories
[0m23:48:48.862393 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_products
[0m23:48:48.861669 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_customers
[0m23:48:48.860100 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (execute): 23:48:48.859738 => 23:48:48.859759
[0m23:48:48.863263 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (compile): 23:48:48.824616 => 23:48:48.862948
[0m23:48:48.864177 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_categories, now model.local_bike.stg_src_local_bike_products)
[0m23:48:48.864886 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_staffs
[0m23:48:48.866388 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_order_items
[0m23:48:48.866949 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_orders
[0m23:48:48.867493 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_products
[0m23:48:48.868476 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_customers, now model.local_bike.stg_src_local_bike_staffs)
[0m23:48:48.869300 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_stocks
[0m23:48:48.870252 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (execute): 23:48:48.869903 => 23:48:48.869921
[0m23:48:48.875264 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_products"
[0m23:48:48.876026 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_staffs
[0m23:48:48.877104 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_order_items, now model.local_bike.stg_src_local_bike_stocks)
[0m23:48:48.878568 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_orders
[0m23:48:48.883623 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_staffs"
[0m23:48:48.884439 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_stocks
[0m23:48:48.885266 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_stores
[0m23:48:48.886373 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_products (compile): 23:48:48.870764 => 23:48:48.886011
[0m23:48:48.892696 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (compile): 23:48:48.879134 => 23:48:48.892229
[0m23:48:48.891827 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stocks"
[0m23:48:48.894127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_orders, now model.local_bike.stg_src_local_bike_stores)
[0m23:48:48.894867 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_products
[0m23:48:48.897039 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_products (execute): 23:48:48.896692 => 23:48:48.896711
[0m23:48:48.895478 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_staffs
[0m23:48:48.896258 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_stores
[0m23:48:48.898529 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_products
[0m23:48:48.899334 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (execute): 23:48:48.898996 => 23:48:48.899013
[0m23:48:48.904542 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stores"
[0m23:48:48.905413 [debug] [Thread-2 (]: Began running node seed.local_bike.map
[0m23:48:48.906292 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (compile): 23:48:48.886954 => 23:48:48.905953
[0m23:48:48.910051 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_stocks
[0m23:48:48.908038 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_staffs
[0m23:48:48.911436 [debug] [Thread-3 (]: Began running node seed.local_bike.seasons
[0m23:48:48.909353 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_products, now seed.local_bike.map)
[0m23:48:48.910764 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (execute): 23:48:48.910383 => 23:48:48.910400
[0m23:48:48.912402 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_staffs, now seed.local_bike.seasons)
[0m23:48:48.913586 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_stores (compile): 23:48:48.899759 => 23:48:48.913225
[0m23:48:48.914198 [debug] [Thread-2 (]: Began compiling node seed.local_bike.map
[0m23:48:48.915930 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_stocks
[0m23:48:48.916541 [debug] [Thread-3 (]: Began compiling node seed.local_bike.seasons
[0m23:48:48.917096 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_stores
[0m23:48:48.920610 [debug] [Thread-2 (]: Timing info for seed.local_bike.map (compile): 23:48:48.917453 => 23:48:48.920178
[0m23:48:48.921453 [debug] [Thread-4 (]: Began running node test.local_bike.assert_total_order_amount_is_positive
[0m23:48:48.924929 [debug] [Thread-3 (]: Timing info for seed.local_bike.seasons (compile): 23:48:48.922138 => 23:48:48.924529
[0m23:48:48.925834 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_stores (execute): 23:48:48.925397 => 23:48:48.925426
[0m23:48:48.926451 [debug] [Thread-2 (]: Began executing node seed.local_bike.map
[0m23:48:48.930928 [debug] [Thread-2 (]: Timing info for seed.local_bike.map (execute): 23:48:48.930593 => 23:48:48.930611
[0m23:48:48.928203 [debug] [Thread-3 (]: Began executing node seed.local_bike.seasons
[0m23:48:48.930174 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_stores
[0m23:48:48.927579 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stocks, now test.local_bike.assert_total_order_amount_is_positive)
[0m23:48:48.932270 [debug] [Thread-2 (]: Finished running node seed.local_bike.map
[0m23:48:48.933033 [debug] [Thread-3 (]: Timing info for seed.local_bike.seasons (execute): 23:48:48.932666 => 23:48:48.932683
[0m23:48:48.934040 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_product_daily
[0m23:48:48.934814 [debug] [Thread-4 (]: Began compiling node test.local_bike.assert_total_order_amount_is_positive
[0m23:48:48.935586 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m23:48:48.937276 [debug] [Thread-3 (]: Finished running node seed.local_bike.seasons
[0m23:48:48.938250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stores, now model.local_bike.int_src_local_bike_product_daily)
[0m23:48:48.944627 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.local_bike.map, now model.local_bike.int_src_local_bike_staff_hierarchy)
[0m23:48:48.943715 [debug] [Thread-4 (]: Writing injected SQL for node "test.local_bike.assert_total_order_amount_is_positive"
[0m23:48:48.945753 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_store_daily
[0m23:48:48.946980 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_product_daily
[0m23:48:48.947852 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_staff_hierarchy
[0m23:48:48.949237 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.local_bike.seasons, now model.local_bike.int_src_local_bike_store_daily)
[0m23:48:48.957197 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_product_daily"
[0m23:48:48.958207 [debug] [Thread-4 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (compile): 23:48:48.938693 => 23:48:48.957820
[0m23:48:48.964137 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_store_daily
[0m23:48:48.966228 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m23:48:48.967096 [debug] [Thread-4 (]: Began executing node test.local_bike.assert_total_order_amount_is_positive
[0m23:48:48.974457 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_daily"
[0m23:48:48.975686 [debug] [Thread-4 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (execute): 23:48:48.975154 => 23:48:48.975211
[0m23:48:48.976623 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (compile): 23:48:48.950022 => 23:48:48.976239
[0m23:48:48.977857 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (compile): 23:48:48.958615 => 23:48:48.977441
[0m23:48:48.979531 [debug] [Thread-4 (]: Finished running node test.local_bike.assert_total_order_amount_is_positive
[0m23:48:48.980454 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (compile): 23:48:48.967676 => 23:48:48.979884
[0m23:48:48.981402 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_product_daily
[0m23:48:48.982096 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_staff_hierarchy
[0m23:48:48.982796 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_store_shipped_order
[0m23:48:48.983673 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_store_daily
[0m23:48:48.984622 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (execute): 23:48:48.984224 => 23:48:48.984250
[0m23:48:48.985309 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (execute): 23:48:48.984989 => 23:48:48.985013
[0m23:48:48.986571 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.local_bike.assert_total_order_amount_is_positive, now model.local_bike.int_src_local_bike_store_shipped_order)
[0m23:48:48.987398 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (execute): 23:48:48.987028 => 23:48:48.987051
[0m23:48:48.988912 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_product_daily
[0m23:48:48.990316 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m23:48:48.990891 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_store_shipped_order
[0m23:48:48.992713 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_store_daily
[0m23:48:48.999895 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_staff_daily
[0m23:48:49.001226 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_daily, now model.local_bike.int_src_local_bike_staff_daily)
[0m23:48:49.002121 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_staff_daily
[0m23:48:49.009937 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m23:48:49.011159 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_order_shipped_aborted_montly
[0m23:48:49.011834 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_order_shipped_montly
[0m23:48:49.013835 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_daily"
[0m23:48:49.015007 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_hierarchy, now model.local_bike.mrt_order_shipped_aborted_montly)
[0m23:48:49.016122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_product_daily, now model.local_bike.mrt_order_shipped_montly)
[0m23:48:49.018275 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_order_shipped_montly
[0m23:48:49.017646 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_order_shipped_aborted_montly
[0m23:48:49.016901 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (compile): 23:48:48.993790 => 23:48:49.016548
[0m23:48:49.023619 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_montly"
[0m23:48:49.028813 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m23:48:49.030050 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (compile): 23:48:49.002554 => 23:48:49.029444
[0m23:48:49.031807 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_staff_daily
[0m23:48:49.032525 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (execute): 23:48:49.032162 => 23:48:49.032186
[0m23:48:49.030734 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_store_shipped_order
[0m23:48:49.034752 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (execute): 23:48:49.034397 => 23:48:49.034412
[0m23:48:49.036019 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_store_shipped_order
[0m23:48:49.033959 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_staff_daily
[0m23:48:49.038284 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_sales_seasons_yearly
[0m23:48:49.039452 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_daily, now model.local_bike.mrt_sales_seasons_yearly)
[0m23:48:49.040245 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_sales_seasons_yearly
[0m23:48:49.037651 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_order_shipped_montly (compile): 23:48:49.018718 => 23:48:49.037287
[0m23:48:49.036638 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_products_ranking_yearly_top3
[0m23:48:49.040975 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (compile): 23:48:49.024277 => 23:48:49.040591
[0m23:48:49.046924 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_sales_seasons_yearly"
[0m23:48:49.047786 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_order_shipped_montly
[0m23:48:49.048991 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_shipped_order, now model.local_bike.mrt_products_ranking_yearly_top3)
[0m23:48:49.051266 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_products_ranking_yearly_top3
[0m23:48:49.049694 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_order_shipped_aborted_montly
[0m23:48:49.050643 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_order_shipped_montly (execute): 23:48:49.050250 => 23:48:49.050271
[0m23:48:49.057375 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (execute): 23:48:49.056985 => 23:48:49.057007
[0m23:48:49.056671 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m23:48:49.059356 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_order_shipped_montly
[0m23:48:49.060054 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (compile): 23:48:49.041298 => 23:48:49.059710
[0m23:48:49.061431 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_order_shipped_aborted_montly
[0m23:48:49.062239 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_stores_items_monthly
[0m23:48:49.063052 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_sales_seasons_yearly
[0m23:48:49.063740 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_stores_ranking_yearly
[0m23:48:49.064689 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (compile): 23:48:49.051614 => 23:48:49.064210
[0m23:48:49.066379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_montly, now model.local_bike.mrt_stores_items_monthly)
[0m23:48:49.067229 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (execute): 23:48:49.066883 => 23:48:49.066907
[0m23:48:49.068199 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_aborted_montly, now model.local_bike.mrt_stores_ranking_yearly)
[0m23:48:49.068819 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_products_ranking_yearly_top3
[0m23:48:49.069363 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_stores_items_monthly
[0m23:48:49.070870 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_sales_seasons_yearly
[0m23:48:49.071411 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_stores_ranking_yearly
[0m23:48:49.072166 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (execute): 23:48:49.071808 => 23:48:49.071830
[0m23:48:49.078244 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_stores_sales_monthly
[0m23:48:49.079286 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_stores_items_monthly"
[0m23:48:49.089190 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_stores_ranking_yearly"
[0m23:48:49.093923 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_sales_seasons_yearly, now model.local_bike.mrt_stores_sales_monthly)
[0m23:48:49.092250 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_products_ranking_yearly_top3
[0m23:48:49.095248 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_stores_sales_monthly
[0m23:48:49.096301 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_products_brands_monthly
[0m23:48:49.107787 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_products_ranking_yearly_top3, now model.local_bike.mrt_products_brands_monthly)
[0m23:48:49.097702 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_items_monthly (compile): 23:48:49.072526 => 23:48:49.097150
[0m23:48:49.111176 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_stores_items_monthly
[0m23:48:49.112126 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_items_monthly (execute): 23:48:49.111646 => 23:48:49.111669
[0m23:48:49.098801 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (compile): 23:48:49.079896 => 23:48:49.098320
[0m23:48:49.114805 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_stores_ranking_yearly
[0m23:48:49.115761 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (execute): 23:48:49.115268 => 23:48:49.115289
[0m23:48:49.108750 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_products_brands_monthly
[0m23:48:49.110358 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_stores_sales_monthly"
[0m23:48:49.126785 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (compile): 23:48:49.099236 => 23:48:49.126133
[0m23:48:49.114051 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_stores_items_monthly
[0m23:48:49.128836 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_staff_ranking_yearly
[0m23:48:49.117736 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_stores_ranking_yearly
[0m23:48:49.137535 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_staff_sales_monthly
[0m23:48:49.127668 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_stores_sales_monthly
[0m23:48:49.146602 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (execute): 23:48:49.145910 => 23:48:49.145941
[0m23:48:49.130415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_items_monthly, now model.local_bike.mrt_staff_ranking_yearly)
[0m23:48:49.149695 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_staff_ranking_yearly
[0m23:48:49.139044 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_ranking_yearly, now model.local_bike.mrt_staff_sales_monthly)
[0m23:48:49.148823 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_stores_sales_monthly
[0m23:48:49.156284 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_staff_sales_monthly
[0m23:48:49.166385 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_staff_ranking_yearly"
[0m23:48:49.181062 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (compile): 23:48:49.150192 => 23:48:49.180227
[0m23:48:49.193694 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:48:49.205388 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_staff_ranking_yearly
[0m23:48:49.209575 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:48:49.210567 [debug] [Thread-4 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m23:48:49.211829 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (execute): 23:48:49.211219 => 23:48:49.211243
[0m23:48:49.269064 [debug] [Thread-2 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m23:48:49.271911 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_staff_ranking_yearly
[0m23:48:50.541415 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:bf9804bf-f48c-4ab7-980c-91cac2971c42&page=queryresults
[0m23:48:50.543381 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_staff_sales_monthly"
[0m23:48:50.544814 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (compile): 23:48:49.167139 => 23:48:50.544312
[0m23:48:50.545545 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_staff_sales_monthly
[0m23:48:50.546162 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (execute): 23:48:50.545867 => 23:48:50.545889
[0m23:48:50.547603 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_staff_sales_monthly
[0m23:48:50.575613 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:98de5182-5b5e-49b1-ba2b-bb9bf2b0c164&page=queryresults
[0m23:48:50.577179 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_products_brands_monthly"
[0m23:48:50.578412 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_products_brands_monthly (compile): 23:48:49.118240 => 23:48:50.578013
[0m23:48:50.579109 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_products_brands_monthly
[0m23:48:50.580121 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_products_brands_monthly (execute): 23:48:50.579612 => 23:48:50.579647
[0m23:48:50.582343 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_products_brands_monthly
[0m23:48:50.585930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:50.586714 [debug] [MainThread]: Connection 'model.local_bike.mrt_products_brands_monthly' was properly closed.
[0m23:48:50.587278 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_sales_monthly' was properly closed.
[0m23:48:50.587836 [debug] [MainThread]: Connection 'model.local_bike.mrt_stores_sales_monthly' was properly closed.
[0m23:48:50.588296 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_ranking_yearly' was properly closed.
[0m23:48:50.595072 [debug] [MainThread]: Command end result
[0m23:48:50.649365 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m23:48:50.650263 [info ] [MainThread]: Building catalog
[0m23:48:50.655454 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:48:51.204751 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m23:48:51.211698 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m23:48:51.225768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:51.233757 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m23:48:51.237850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:51.239129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:51.240448 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m23:48:51.244358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:51.247465 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_bronze`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_bronze'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m23:48:51.289659 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_seeds`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_seeds'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m23:48:51.292594 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_silver`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_silver'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m23:48:51.295865 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_gold`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_gold'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m23:48:53.289813 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:d77fc7c7-7c63-4e34-8a1b-925e52bfdd6f&page=queryresults
[0m23:48:53.290734 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:c0e5b05e-4104-4cc4-a17f-dec6f29fb17b&page=queryresults
[0m23:48:53.311019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:48:53.316728 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:3087a4e4-6edf-4e7d-8004-b8c3a28ae1ec&page=queryresults
[0m23:48:53.319534 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`src_local_bike`.__TABLES__
        where (upper(dataset_id) = upper('src_local_bike'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m23:48:53.389253 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:4b0fe432-92be-4eec-ab06-46b5acf07a4d&page=queryresults
[0m23:48:55.306936 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:b654ff7c-6362-48e5-8003-8cf6634b6069&page=queryresults
[0m23:48:55.501190 [info ] [MainThread]: Catalog written to /usr/app/dbt/target/catalog.json
[0m23:48:55.504441 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:48:55.504018 after 10.11 seconds
[0m23:48:55.505274 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:48:55.505929 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m23:48:55.506404 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m23:48:55.507042 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m23:48:55.507618 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m23:48:55.508110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0f0182e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0ddf58320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0f0840500>]}
[0m23:48:55.508624 [debug] [MainThread]: Flushing usage events
[0m23:54:59.525711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce827fe39e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce827fe3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce827fe2390>]}


============================== 23:54:59.534009 | badc6ed0-ed02-4bde-a379-29e975f558e1 ==============================
[0m23:54:59.534009 [info ] [MainThread]: Running with dbt=1.5.0
[0m23:54:59.535007 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'debug': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'log_format': 'default', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'static_parser': 'True', 'use_colors': 'True', 'profiles_dir': '/root/.dbt'}
[0m23:54:59.588862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'badc6ed0-ed02-4bde-a379-29e975f558e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce82b482900>]}
[0m23:54:59.594335 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1ox22mcw'
[0m23:54:59.595258 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:54:59.704333 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:54:59.707113 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m23:54:59.761925 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m23:54:59.769181 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:54:59.823849 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:54:59.838599 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m23:54:59.893592 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m23:54:59.896473 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m23:54:59.897303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'badc6ed0-ed02-4bde-a379-29e975f558e1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce827f024e0>]}
[0m23:54:59.914706 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m23:55:00.767856 [info ] [MainThread]: Installed from version 0.10.5
[0m23:55:00.768808 [info ] [MainThread]: Up to date!
[0m23:55:00.769900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'badc6ed0-ed02-4bde-a379-29e975f558e1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce827f74b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce827f75640>]}
[0m23:55:00.771152 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:55:01.010555 [info ] [MainThread]: Installed from version 1.3.2
[0m23:55:01.011349 [info ] [MainThread]: Up to date!
[0m23:55:01.012136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'badc6ed0-ed02-4bde-a379-29e975f558e1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce828b414f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce829497bf0>]}
[0m23:55:01.012934 [info ] [MainThread]: Installing calogica/dbt_date
[0m23:55:01.171334 [info ] [MainThread]: Installed from version 0.10.1
[0m23:55:01.172207 [info ] [MainThread]: Up to date!
[0m23:55:01.173115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'badc6ed0-ed02-4bde-a379-29e975f558e1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce829497bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce827f75640>]}
[0m23:55:01.176127 [debug] [MainThread]: Command `dbt deps` succeeded at 23:55:01.175559 after 1.66 seconds
[0m23:55:01.177213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce829d7a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce829d7b9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce82bc32a50>]}
[0m23:55:01.178295 [debug] [MainThread]: Flushing usage events
[0m23:55:07.036935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77790f9dac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77791064e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77790f9dbf20>]}


============================== 23:55:07.042527 | b2180fd4-5892-43a7-adc5-eaa58d692d27 ==============================
[0m23:55:07.042527 [info ] [MainThread]: Running with dbt=1.5.0
[0m23:55:07.043670 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_path': '/usr/app/dbt/logs', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'no_print': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'quiet': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'partial_parse': 'True'}
[0m23:55:08.645328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77790fefad80>]}
[0m23:55:08.669099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778fc176f00>]}
[0m23:55:08.719015 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m23:55:08.808032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:55:08.808924 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:55:08.826082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f7d934a0>]}
[0m23:55:08.858414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f76dbec0>]}
[0m23:55:08.859236 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m23:55:08.860048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778fd346ae0>]}
[0m23:55:08.866034 [info ] [MainThread]: 
[0m23:55:08.867665 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:55:08.871239 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m23:55:08.872099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:08.873206 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m23:55:08.874102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:08.915072 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m23:55:08.916683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:09.578849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_seeds)
[0m23:55:09.579696 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:09.581018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_gold)
[0m23:55:09.582588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_silver)
[0m23:55:09.583196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:09.624403 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m23:55:09.626190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:09.667957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:10.048161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778fe82a360>]}
[0m23:55:10.049371 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:55:10.050057 [info ] [MainThread]: 
[0m23:55:10.059381 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_brands
[0m23:55:10.060180 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_categories
[0m23:55:10.063590 [info ] [Thread-2 (]: 2 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_categories ..... [RUN]
[0m23:55:10.061449 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_order_items
[0m23:55:10.062285 [info ] [Thread-1 (]: 1 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_brands ......... [RUN]
[0m23:55:10.060855 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_customers
[0m23:55:10.066382 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.stg_src_local_bike_categories)
[0m23:55:10.068334 [info ] [Thread-4 (]: 4 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_order_items .... [RUN]
[0m23:55:10.071225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.stg_src_local_bike_brands)
[0m23:55:10.072397 [info ] [Thread-3 (]: 3 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_customers ...... [RUN]
[0m23:55:10.073942 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_categories
[0m23:55:10.075415 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.stg_src_local_bike_order_items)
[0m23:55:10.076092 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_brands
[0m23:55:10.077078 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.stg_src_local_bike_customers)
[0m23:55:10.083398 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_categories"
[0m23:55:10.084150 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_order_items
[0m23:55:10.090082 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_customers
[0m23:55:10.089568 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_brands"
[0m23:55:10.098886 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_order_items"
[0m23:55:10.101897 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (compile): 23:55:10.077481 => 23:55:10.101206
[0m23:55:10.115411 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (compile): 23:55:10.084647 => 23:55:10.114915
[0m23:55:10.116254 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_categories
[0m23:55:10.118263 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (compile): 23:55:10.091096 => 23:55:10.117778
[0m23:55:10.121260 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_brands
[0m23:55:10.150540 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_customers"
[0m23:55:10.172147 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_order_items
[0m23:55:10.190150 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_categories"
[0m23:55:10.195652 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_brands"
[0m23:55:10.200959 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_order_items"
[0m23:55:10.202412 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:55:10.203252 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (compile): 23:55:10.099474 => 23:55:10.202901
[0m23:55:10.206467 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_customers
[0m23:55:10.205650 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_categories: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_categories"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_categories`
  OPTIONS(
      description="""Product categories such as road, mountain, and electric bikes."""
    )
  as select
        category_id as category_id,
        INITCAP(category_name) as category_name
from `databird-473015`.`src_local_bike`.`categories`;


[0m23:55:10.212421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:10.211790 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_customers"
[0m23:55:10.251767 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:55:10.256471 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_order_items: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_order_items"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
  OPTIONS(
      description="""Detailed order line items with pricing and discounts."""
    )
  as SELECT
  order_id as order_id,
  item_id AS item_id,
  product_id as product_id,
  quantity as quantity,
  list_price as list_price,
  discount as discount,
  
    list_price * quantity * ( 1 - discount )
 AS total_item_discount_sold
FROM `databird-473015`.`src_local_bike`.`order_items`;


[0m23:55:10.307398 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_brands: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_brands"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
  OPTIONS(
      description="""Bike brands sold by Local Bike."""
    )
  as select
        brand_id as brand_id,
        INITCAP(brand_name) as brand_name
from `databird-473015`.`src_local_bike`.`brands`;


[0m23:55:10.309572 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:55:10.313464 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_customers: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_customers"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_customers`
  OPTIONS(
      description="""Customer informations."""
    )
  as select
    customer_id as customer_id,
    INITCAP(first_name) as customer_first_name,
    INITCAP(last_name) as customer_last_name,
    phone as customer_phone,
    email as customer_email,
    INITCAP(street) as customer_street,
    INITCAP(city) as customer_city,
    UPPER(state) as customer_state,
    zip_code as customer_zip_code
from `databird-473015`.`src_local_bike`.`customers`;


[0m23:55:11.011723 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:e445a9d9-3307-4cb8-a8e3-b780ec30d733&page=queryresults
[0m23:55:11.051041 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:9de5eb74-da11-4805-b335-6a877b242c12&page=queryresults
[0m23:55:11.057948 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:ae1d2872-e40e-490d-839f-0c6b18d4d621&page=queryresults
[0m23:55:11.064214 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:1a7e0c68-ebc0-4a84-9c8d-a475458f5076&page=queryresults
[0m23:55:11.356628 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (execute): 23:55:10.190678 => 23:55:11.356135
[0m23:55:11.357862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f771a660>]}
[0m23:55:11.359396 [info ] [Thread-1 (]: 1 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_brands .... [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m23:55:11.360795 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_brands
[0m23:55:11.361973 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_orders
[0m23:55:11.362746 [info ] [Thread-1 (]: 5 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_orders ......... [RUN]
[0m23:55:11.364756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_brands, now model.local_bike.stg_src_local_bike_orders)
[0m23:55:11.367667 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (execute): 23:55:10.196471 => 23:55:11.367039
[0m23:55:11.369136 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_orders
[0m23:55:11.371260 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f77146b0>]}
[0m23:55:11.379494 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_orders"
[0m23:55:11.380530 [info ] [Thread-4 (]: 4 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_order_items  [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m23:55:11.382670 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_order_items
[0m23:55:11.383813 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_products
[0m23:55:11.384938 [info ] [Thread-4 (]: 6 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_products ....... [RUN]
[0m23:55:11.387709 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_order_items, now model.local_bike.stg_src_local_bike_products)
[0m23:55:11.388622 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (compile): 23:55:11.371784 => 23:55:11.388229
[0m23:55:11.389189 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_products
[0m23:55:11.389891 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_orders
[0m23:55:11.400296 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_orders"
[0m23:55:11.411517 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_products"
[0m23:55:11.412646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:11.413888 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_products (compile): 23:55:11.390244 => 23:55:11.413145
[0m23:55:11.414556 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_products
[0m23:55:11.421092 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_products"
[0m23:55:11.423820 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_orders: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_orders"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`
  OPTIONS(
      description="""Order headers with key dates and statuses"""
    )
  as select
    order_id as order_id,
    customer_id as customer_id,
    order_status as order_status,
    CAST(order_date as date) as order_date,
    CAST(required_date as date) as required_date,
    CAST(shipped_date as date) as shipped_date,
    store_id as store_id,
    staff_id as staff_id,
    
    CASE
        WHEN EXTRACT(MONTH FROM order_date) IN (12, 1, 2) THEN 'Winter'
        WHEN EXTRACT(MONTH FROM order_date) IN (3, 4, 5) THEN 'Spring'
        WHEN EXTRACT(MONTH FROM order_date) IN (6, 7, 8) THEN 'Summer'
        WHEN EXTRACT(MONTH FROM order_date) IN (9, 10, 11) THEN 'Autumn'
    END
 AS season_name
from `databird-473015`.`src_local_bike`.`orders`;


[0m23:55:11.425856 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (execute): 23:55:10.206889 => 23:55:11.425421
[0m23:55:11.466888 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:55:11.468730 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f7809d90>]}
[0m23:55:11.470276 [info ] [Thread-3 (]: 3 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_customers . [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m23:55:11.471629 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_customers
[0m23:55:11.476062 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_staffs
[0m23:55:11.480400 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (execute): 23:55:10.125033 => 23:55:11.479871
[0m23:55:11.477296 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_products"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_products`
  OPTIONS(
      description="""Products sold, linked to brands and categories."""
    )
  as select
        product_id as product_id,
        INITCAP(product_name) as product_name,
        brand_id as brand_id,
        category_id as category_id,
        model_year as model_year,
        coalesce(list_price,0) as list_price
from `databird-473015`.`src_local_bike`.`products`;


[0m23:55:11.484080 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f78092e0>]}
[0m23:55:11.481379 [info ] [Thread-3 (]: 7 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_staffs ......... [RUN]
[0m23:55:11.531078 [info ] [Thread-2 (]: 2 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_categories  [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m23:55:11.533968 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_customers, now model.local_bike.stg_src_local_bike_staffs)
[0m23:55:11.537616 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_categories
[0m23:55:11.538309 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_staffs
[0m23:55:11.539353 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_stocks
[0m23:55:11.546132 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_staffs"
[0m23:55:11.548362 [info ] [Thread-2 (]: 8 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_stocks ......... [RUN]
[0m23:55:11.551204 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (compile): 23:55:11.539854 => 23:55:11.549969
[0m23:55:11.553640 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_staffs
[0m23:55:11.552719 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_categories, now model.local_bike.stg_src_local_bike_stocks)
[0m23:55:11.561182 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_stocks
[0m23:55:11.569455 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_staffs"
[0m23:55:11.570882 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stocks"
[0m23:55:11.572701 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (compile): 23:55:11.561797 => 23:55:11.572032
[0m23:55:11.573665 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_stocks
[0m23:55:11.580840 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_stocks"
[0m23:55:11.582092 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:55:11.583829 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:55:11.586229 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_staffs: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_staffs"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs`
  OPTIONS(
      description="""Sales and management staff working in Local Bike stores."""
    )
  as select
    CAST(staff_id AS int) as staff_id,
    INITCAP(first_name) as staff_first_name,
    INITCAP(last_name) as staff_last_name,
    phone as staff_phone,
    email as staff_email,
    active as staff_active,
    store_id as store_id,
    CAST(manager_id AS int)  as manager_id
from `databird-473015`.`src_local_bike`.`staffs`;


[0m23:55:11.634473 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_stocks: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_stocks"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stocks`
  OPTIONS(
      description="""Stock of products and availability."""
    )
  as select
    store_id   as store_id,
    product_id as product_id,
    quantity   as stock_quantity
from `databird-473015`.`src_local_bike`.`stocks`;


[0m23:55:12.311876 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:bc0c8ce7-bdb5-4548-a096-576681d75d88&page=queryresults
[0m23:55:12.360128 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:eba97bc6-12c2-458d-9d00-04463c7a0cf7&page=queryresults
[0m23:55:12.395454 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:7c43197d-f387-42f3-8a62-703e3fdca48b&page=queryresults
[0m23:55:12.427802 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:bc220ec7-757e-47ec-ac64-053754abcd1e&page=queryresults
[0m23:55:12.585386 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (execute): 23:55:11.574113 => 23:55:12.585041
[0m23:55:12.586709 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f45ffb30>]}
[0m23:55:12.587683 [info ] [Thread-2 (]: 8 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_stocks .... [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m23:55:12.589346 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_stocks
[0m23:55:12.590738 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_stores
[0m23:55:12.591772 [info ] [Thread-2 (]: 9 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_stores ......... [RUN]
[0m23:55:12.593793 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stocks, now model.local_bike.stg_src_local_bike_stores)
[0m23:55:12.595072 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_stores
[0m23:55:12.605484 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stores"
[0m23:55:12.607009 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_stores (compile): 23:55:12.595695 => 23:55:12.606515
[0m23:55:12.607694 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_stores
[0m23:55:12.622418 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_stores"
[0m23:55:12.623847 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:55:12.626409 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_stores: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_stores"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`
  OPTIONS(
      description="""Store locations in California, New York, and Texas."""
    )
  as select
    store_id as store_id,
    INITCAP(store_name) as store_name,
    phone as store_phone,
    email as store_email,
    street as store_street,
    INITCAP(city) as store_city,
    UPPER(state) as store_state,
    zip_code as store_zip_code
from `databird-473015`.`src_local_bike`.`stores`;


[0m23:55:12.683818 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (execute): 23:55:11.393185 => 23:55:12.683210
[0m23:55:12.685833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f77777a0>]}
[0m23:55:12.687283 [info ] [Thread-1 (]: 5 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_orders .... [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m23:55:12.689458 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_orders
[0m23:55:12.718180 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_products (execute): 23:55:11.415839 => 23:55:12.717572
[0m23:55:12.720090 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f779c1a0>]}
[0m23:55:12.721637 [info ] [Thread-4 (]: 6 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_products .. [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m23:55:12.723240 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_products
[0m23:55:12.727624 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_product_daily
[0m23:55:12.730028 [info ] [Thread-1 (]: 10 of 24 START sql view model dbt_bike_silver.int_src_local_bike_product_daily . [RUN]
[0m23:55:12.733107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_orders, now model.local_bike.int_src_local_bike_product_daily)
[0m23:55:12.734012 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_product_daily
[0m23:55:12.744932 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_product_daily"
[0m23:55:12.747412 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (execute): 23:55:11.554134 => 23:55:12.747046
[0m23:55:12.749223 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f7794b00>]}
[0m23:55:12.754245 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (compile): 23:55:12.735076 => 23:55:12.752224
[0m23:55:12.755910 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_product_daily
[0m23:55:12.750609 [info ] [Thread-3 (]: 7 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_staffs .... [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m23:55:12.764215 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_product_daily"
[0m23:55:12.765631 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_staffs
[0m23:55:12.767329 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m23:55:12.768272 [info ] [Thread-4 (]: 11 of 24 START sql view model dbt_bike_silver.int_src_local_bike_staff_hierarchy  [RUN]
[0m23:55:12.769751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:12.771717 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_products, now model.local_bike.int_src_local_bike_staff_hierarchy)
[0m23:55:12.773991 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_staff_hierarchy
[0m23:55:12.782475 [debug] [Thread-1 (]: On model.local_bike.int_src_local_bike_product_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_product_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily`
  OPTIONS(
      description="""This model provides an aggregated view of product items. It enriches the products data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each product.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Product Informations**: Enriches the product with user-specific data, such as brand and category.\r\n\r\nIt provides a comprehensive view of each product, allowing for easy analysis of product performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH order_items AS (
  SELECT 
        order_id as order_id,
        item_id as item_id,
        product_id as product_id,
        quantity as quantity,
        list_price as list_price,
        discount as discount,
        ROUND((discount * 100),2) as discount_percent,
        ROUND(total_item_discount_sold, 2) as total_item_discount_sold 
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
),
------------------------------------------
orders_date AS (
  SELECT 
        order_id, 
        CAST(order_date as date) as order_date,
        store_id,
        season_name,
        EXTRACT(YEAR FROM order_date) as yeardate,
        EXTRACT(YEAR FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`
),
------------------------------------------
products AS (
  SELECT 
        product_id as product_id,
        product_name as product_name,
        brand_id as brand_id,
        category_id as category_id,
        model_year as product_model_year,
        ROUND(list_price,2) as list_price
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_products`
),
------------------------------------------
brands AS (
  SELECT 
        brand_id as brand_id,
        brand_name as brand_name
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
),
------------------------------------------
categories AS (
  SELECT 
        category_id as category_id,
        category_name as category_name
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_categories`
)
------------------------------------------
SELECT
  o.order_id,
  o.store_id,
  o.order_date,
  o.yeardate,
  o.monthday,
  o.yearmonth,
  o.month_2digits,
  o.month_name,
  o.month_abbrev,
  o.week_number,
  o.season_name,
  p.product_id,
  p.product_name,
  b.brand_name,
  c.category_name,
  oi.quantity,
  oi.list_price,
  oi.discount,
  oi.discount_percent,
  SUM(oi.total_item_discount_sold) as total_item_discount_sold,
  COUNT(*) as total_items
FROM orders_date as o
LEFT JOIN order_items as oi ON o.order_id = oi.order_id
LEFT JOIN products as p ON oi.product_id = p.product_id
LEFT JOIN brands as b ON p.brand_id = b.brand_id
LEFT JOIN categories as c ON p.category_id = c.category_id
GROUP BY 
  o.order_id,
  o.store_id,
  o.order_date,
  o.yeardate,
  o.monthday,
  o.yearmonth,
  o.month_2digits,
  o.month_name,
  o.month_abbrev,
  o.week_number,
  o.season_name, 
  p.product_id,
  p.product_name,
  b.brand_name,
  c.category_name,
  oi.quantity,
  oi.list_price,
  oi.discount,
  oi.discount_percent
ORDER BY o.yeardate, o.week_number, o.order_id;


[0m23:55:12.785866 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m23:55:12.827410 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (compile): 23:55:12.774688 => 23:55:12.825882
[0m23:55:12.828602 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_staff_hierarchy
[0m23:55:12.835149 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m23:55:12.836712 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:55:12.840831 [debug] [Thread-4 (]: On model.local_bike.int_src_local_bike_staff_hierarchy: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_hierarchy"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy`
  OPTIONS(
      description="""This model provides an hirarchical view of employees. It enriches the store data with the following data:\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each employe.."""
    )
  as ------------------------------------------
  WITH RECURSIVE staff_hierarchy AS (

  -- Niveau 0 : managers racine
  SELECT
    m.staff_id,
    m.staff_first_name,
    m.staff_last_name,
    m.manager_id,
    m.store_id,
    m.staff_first_name || ' ' || m.staff_last_name AS path,
    0 AS level
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs` m
  WHERE m.manager_id IS NULL

  UNION ALL

  -- Niveaux suivants : rattacher les subordonnés
  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,    
    CONCAT(h.path, ' → ', s.staff_first_name, ' ', s.staff_last_name) AS path,
    h.level + 1 AS level
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs` s
  JOIN staff_hierarchy as h ON s.manager_id = h.staff_id
  
)
------------------------------------------
SELECT 
     * 
FROM staff_hierarchy
ORDER BY path, level;


[0m23:55:13.281547 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:b4a8db8d-e0a2-44c6-a714-687ce2ec31b7&page=queryresults
[0m23:55:13.649415 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:e86ec605-7fd6-4880-a470-c0544a32cf36&page=queryresults
[0m23:55:13.655771 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_stores (execute): 23:55:12.608006 => 23:55:13.655418
[0m23:55:13.656886 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f45d3620>]}
[0m23:55:13.657734 [info ] [Thread-2 (]: 9 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_stores .... [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m23:55:13.659083 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_stores
[0m23:55:13.660697 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_store_daily
[0m23:55:13.661869 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_store_shipped_order
[0m23:55:13.662952 [info ] [Thread-3 (]: 12 of 24 START sql view model dbt_bike_silver.int_src_local_bike_store_daily ... [RUN]
[0m23:55:13.665004 [info ] [Thread-2 (]: 13 of 24 START sql view model dbt_bike_silver.int_src_local_bike_store_shipped_order  [RUN]
[0m23:55:13.668297 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_staffs, now model.local_bike.int_src_local_bike_store_daily)
[0m23:55:13.669712 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stores, now model.local_bike.int_src_local_bike_store_shipped_order)
[0m23:55:13.670595 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_store_daily
[0m23:55:13.671296 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_store_shipped_order
[0m23:55:13.679441 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_daily"
[0m23:55:13.687158 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m23:55:13.688435 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (compile): 23:55:13.671769 => 23:55:13.688046
[0m23:55:13.689184 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (compile): 23:55:13.680061 => 23:55:13.688820
[0m23:55:13.689727 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_store_daily
[0m23:55:13.690274 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_store_shipped_order
[0m23:55:13.706067 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m23:55:13.707474 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_store_daily"
[0m23:55:13.708690 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:55:13.709279 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:55:13.711980 [debug] [Thread-2 (]: On model.local_bike.int_src_local_bike_store_shipped_order: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_shipped_order"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_shipped_order`
  OPTIONS(
      description="""This model provides the list of order required, shipped and aborted per month over 3 years.\r\n\r\nIt provides a comprehensive view of each order, allowing for easy analysis of order performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_shipped_date AS (

  SELECT 
        order_id, 
        order_date,
        required_date,
        shipped_date, 
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    required_date,
    shipped_date,
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_shipped_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.order_id,
    ls.shipped_date ,
    ls.required_date ,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date, ls.shipped_date, ls.required_date,ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m23:55:13.714378 [debug] [Thread-3 (]: On model.local_bike.int_src_local_bike_store_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  OPTIONS(
      description="""This model provides an aggregated view of stores. It enriches the store data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each store.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Total Distinct Items**: The count of distinct product types in the order.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_date AS (

  SELECT 
        order_id, 
        order_date,
        shipped_date,
        required_date,
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    o.shipped_date,
    o.required_date,    
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.shipped_date,
    ls.required_date,     
    ls.order_id,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date,ls.shipped_date,ls.required_date, ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m23:55:13.949178 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:2875c8b7-f5a7-4b0c-8d5b-ecf90c8c8949&page=queryresults
[0m23:55:14.070940 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (execute): 23:55:12.829136 => 23:55:14.070609
[0m23:55:14.072212 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f465cc50>]}
[0m23:55:14.074748 [info ] [Thread-4 (]: 11 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_staff_hierarchy  [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m23:55:14.076179 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m23:55:14.079492 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_staff_daily
[0m23:55:14.081129 [info ] [Thread-4 (]: 14 of 24 START sql view model dbt_bike_silver.int_src_local_bike_staff_daily ... [RUN]
[0m23:55:14.083039 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_hierarchy, now model.local_bike.int_src_local_bike_staff_daily)
[0m23:55:14.084360 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_staff_daily
[0m23:55:14.092166 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_daily"
[0m23:55:14.093347 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (compile): 23:55:14.084904 => 23:55:14.092904
[0m23:55:14.093900 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_staff_daily
[0m23:55:14.098517 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_staff_daily"
[0m23:55:14.099391 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:55:14.101698 [debug] [Thread-4 (]: On model.local_bike.int_src_local_bike_staff_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  OPTIONS(
      description="""This model provides an aggregated view of staffs and stores. It enriches the store and staff data with the following metrics:\r\n- **Total item Amount**: The sum of all order items for each employe.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each store and staffs, allowing for easy analysis of store performance, employee performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH staff_list AS (

  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,
    s.path,
    s.level
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy` s

),
------------------------------------------
sales_by_employee AS (

  SELECT
    o.order_date as order_date,
    o.season_name,
    EXTRACT(YEAR FROM o.order_date) as yeardate,
    EXTRACT(YEAR FROM o.order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') AS yearmonth,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM o.order_date) AS STRING), 2, '0') AS monthday,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') as month_2digits,
    FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_name,
    FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_abbrev,
    LPAD(CAST(EXTRACT(ISOWEEK FROM o.order_date) AS STRING), 2, '0') AS week_number,
    o.staff_id,
    oi.total_item_discount_sold as total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders` as o
  LEFT JOIN `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items` as oi ON o.order_id = oi.order_id

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

)
------------------------------------------
SELECT 
    em.order_date,
    em.yeardate,
    em.monthday,
    em.yearmonth,
    em.month_2digits,
    em.month_name,
    em.month_abbrev,
    em.week_number,
    em.season_name,
    st.store_name,
    m.store_latitude,
    m.store_longitude,    
    st.store_city,
    st.store_state,    
    ROUND(em.total_item_discount_sold, 2) as total_item_sold_staff,
    s.*
FROM sales_by_employee as em 
JOIN staff_list as s ON em.staff_id = s.staff_id
LEFT JOIN map as m on s.store_id = m.store_id
LEFT JOIN stores as st on m.store_id = st.store_id
ORDER BY em.order_date;


[0m23:55:14.258494 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (execute): 23:55:12.756908 => 23:55:14.258169
[0m23:55:14.259893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77790f9f1c70>]}
[0m23:55:14.260859 [info ] [Thread-1 (]: 10 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_product_daily  [[32mCREATE VIEW (0 processed)[0m in 1.53s]
[0m23:55:14.262286 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_product_daily
[0m23:55:14.654931 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:5f4a9a4e-fcf3-42f7-af63-7f3a7712c9c5&page=queryresults
[0m23:55:14.682336 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:b77b8078-dfdc-4315-90a3-c7091b997d68&page=queryresults
[0m23:55:14.912286 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:65f11d89-239d-4e49-acba-53b26ca52871&page=queryresults
[0m23:55:14.953898 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (execute): 23:55:13.690649 => 23:55:14.953579
[0m23:55:14.955156 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f775d9a0>]}
[0m23:55:14.955988 [info ] [Thread-3 (]: 12 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_store_daily  [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m23:55:14.957455 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_store_daily
[0m23:55:14.959118 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_order_shipped_aborted_montly
[0m23:55:14.961430 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_order_shipped_montly
[0m23:55:14.960038 [info ] [Thread-1 (]: 15 of 24 START sql table model dbt_bike_gold.orders_shipped_aborted_monthly_report  [RUN]
[0m23:55:14.964573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_product_daily, now model.local_bike.mrt_order_shipped_aborted_montly)
[0m23:55:14.965518 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_order_shipped_aborted_montly
[0m23:55:14.962748 [info ] [Thread-3 (]: 16 of 24 START sql table model dbt_bike_gold.orders_shipped_monthly_report ..... [RUN]
[0m23:55:14.971952 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m23:55:14.973040 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_daily, now model.local_bike.mrt_order_shipped_montly)
[0m23:55:14.973784 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_order_shipped_montly
[0m23:55:14.978721 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_montly"
[0m23:55:14.980694 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (compile): 23:55:14.966836 => 23:55:14.980247
[0m23:55:14.981253 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_order_shipped_aborted_montly
[0m23:55:14.992621 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_order_shipped_montly (compile): 23:55:14.974137 => 23:55:14.992084
[0m23:55:14.999195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:15.000924 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (execute): 23:55:13.695704 => 23:55:15.000595
[0m23:55:15.001491 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_order_shipped_montly
[0m23:55:15.002898 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f465fb00>]}
[0m23:55:15.006795 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:55:15.049001 [info ] [Thread-2 (]: 13 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_store_shipped_order  [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m23:55:15.105431 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_store_shipped_order
[0m23:55:15.108844 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_products_ranking_yearly_top3
[0m23:55:15.109946 [info ] [Thread-2 (]: 17 of 24 START sql table model dbt_bike_gold.products_stores_ranking_yearly_report  [RUN]
[0m23:55:15.114157 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_shipped_order, now model.local_bike.mrt_products_ranking_yearly_top3)
[0m23:55:15.116976 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_products_ranking_yearly_top3
[0m23:55:15.137078 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m23:55:15.138660 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (compile): 23:55:15.117480 => 23:55:15.138035
[0m23:55:15.139444 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_products_ranking_yearly_top3
[0m23:55:15.144933 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:55:15.317758 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (execute): 23:55:14.094180 => 23:55:15.317417
[0m23:55:15.318870 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f4694c20>]}
[0m23:55:15.319750 [info ] [Thread-4 (]: 14 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_staff_daily  [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m23:55:15.321792 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_staff_daily
[0m23:55:15.323067 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_sales_seasons_yearly
[0m23:55:15.324525 [info ] [Thread-4 (]: 18 of 24 START sql table model dbt_bike_gold.sales_seasons_yearly_report ....... [RUN]
[0m23:55:15.326236 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_daily, now model.local_bike.mrt_sales_seasons_yearly)
[0m23:55:15.327072 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_sales_seasons_yearly
[0m23:55:15.333675 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_sales_seasons_yearly"
[0m23:55:15.334723 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (compile): 23:55:15.327486 => 23:55:15.334334
[0m23:55:15.335257 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_sales_seasons_yearly
[0m23:55:15.338975 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:55:15.414113 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.mrt_order_shipped_montly"
[0m23:55:15.418836 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m23:55:15.424010 [debug] [Thread-3 (]: On model.local_bike.mrt_order_shipped_montly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_order_shipped_montly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`orders_shipped_monthly_report`
    
    

    OPTIONS(
      description="""This model provides an aggregated view of the orders sent. It enriches the order data with the following metrics:\r\n- **nb_order_shipped**: The quantity of orders shipped.\r\n- **total_sales**: The cost of orders shipped.\r\n- **Order Informations**: Enriches the product with user-specific data, such as store name.\r\n\r\nIt provides a comprehensive view the aborted order, allowing for easy analysis of order performance."""
    )
    as (
      ------------------------------------------

------------------------------------------

WITH total_orders AS (

  SELECT
    yearmonth AS month,
    COUNT(order_date) AS nb_order_shipped,
    ROUND(SUM(total_sales_amount),2) as total_sales,
    store_name
  FROM  `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  WHERE shipped_date is not null
  GROUP BY month,store_name

)
------------------------------------------
SELECT *
FROM total_orders
------------------------------------------
    );
  
[0m23:55:15.425514 [debug] [Thread-2 (]: On model.local_bike.mrt_products_ranking_yearly_top3: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_ranking_yearly_top3"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`products_stores_ranking_yearly_report`
    
    

    OPTIONS(
      description="""This model provides the top 3 **best-selling products** per year over 3 years.\r\n\r\nIt provides a comprehensive view of each product, allowing for easy analysis of products performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH product_sales AS (
  SELECT
    p.yeardate AS year,
    s.store_name AS store,
    p.product_name,
    p.brand_name,
    ROUND(SUM(total_item_discount_sold), 2) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily` AS p
  LEFT JOIN `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`AS s
    ON p.order_id = s.order_id 
   AND p.store_id = s.store_id
  GROUP BY year,store,product_name,brand_name
)
------------------------------------------
SELECT
  year,
  store,
  product_name,
  brand_name,
  total_sales
FROM (
  SELECT
    *,
    RANK() OVER ( PARTITION BY year, store ORDER BY total_sales DESC ) AS rank_product
  FROM product_sales
)
WHERE rank_product <= 3
ORDER BY year, store
------------------------------------------
    );
  
[0m23:55:15.422425 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m23:55:15.431080 [debug] [Thread-1 (]: On model.local_bike.mrt_order_shipped_aborted_montly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_order_shipped_aborted_montly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`orders_shipped_aborted_monthly_report`
    
    

    OPTIONS(
      description="""This model provides an aggregated view of the canceled orders. It enriches the order data with the following metrics:\r\n- **nb_shipped_aborted**: The quantity of order aborted.\r\n- **total_aborted_sales**: The cost of aborted orders.\r\n- **Order Informations**: Enriches the product with user-specific data, such as store name.\r\n\r\nIt provides a comprehensive view the aborted order, allowing for easy analysis of order performance."""
    )
    as (
      ------------------------------------------

------------------------------------------

WITH total_aborted_orders AS (

  SELECT
    yearmonth AS month,
    COUNTIF(shipped_date IS NULL) AS nb_shipped_aborted,
    ROUND(SUM(total_sales_amount),2) as total_aborted_sales,
    store_name
  FROM  `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  WHERE shipped_date is null
  GROUP BY month,store_name

)
------------------------------------------
SELECT *
FROM total_aborted_orders
------------------------------------------
    );
  
[0m23:55:15.597548 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.mrt_sales_seasons_yearly"
[0m23:55:15.598542 [debug] [Thread-4 (]: On model.local_bike.mrt_sales_seasons_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_sales_seasons_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`sales_seasons_yearly_report`
    
    

    OPTIONS(
      description="""This model provides the **top-performing store by season** and per year over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH sales_stores_seasons AS (

  SELECT
    yeardate AS year,
    store_name AS store,
    season_name,
    ROUND(SUM(total_sales_amount), 2) AS sales_amount
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year,store,season_name

)

SELECT *
FROM sales_stores_seasons
PIVOT (
  SUM(sales_amount) AS sales
  FOR season_name IN ('Winter','Spring','Summer','Autumn')
)
ORDER BY year, store
------------------------------------------
    );
  
[0m23:55:17.947837 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:9f111b44-2154-417e-bee7-ea819df89539&page=queryresults
[0m23:55:18.158539 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:ca65e253-8d60-4dd4-9543-d3778bed22cf&page=queryresults
[0m23:55:18.252999 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (execute): 23:55:14.981613 => 23:55:18.252603
[0m23:55:18.254979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f775f980>]}
[0m23:55:18.255993 [info ] [Thread-1 (]: 15 of 24 OK created sql table model dbt_bike_gold.orders_shipped_aborted_monthly_report  [[32mCREATE TABLE (38.0 rows, 215.1 KiB processed)[0m in 3.29s]
[0m23:55:18.257491 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_order_shipped_aborted_montly
[0m23:55:18.258824 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:ebf4caa6-5ffa-4f44-9fe6-c271acdeacc1&page=queryresults
[0m23:55:18.259733 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_stores_items_monthly
[0m23:55:18.265149 [info ] [Thread-1 (]: 19 of 24 START sql table model dbt_bike_gold.items_stores_monthly_report ....... [RUN]
[0m23:55:18.268115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_aborted_montly, now model.local_bike.mrt_stores_items_monthly)
[0m23:55:18.268916 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_stores_items_monthly
[0m23:55:18.276349 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_stores_items_monthly"
[0m23:55:18.277422 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_items_monthly (compile): 23:55:18.269357 => 23:55:18.277034
[0m23:55:18.278054 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_stores_items_monthly
[0m23:55:18.281538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:18.324818 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:49e2ccbf-a49f-441a-a5d8-e103fa5f4acb&page=queryresults
[0m23:55:18.504953 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.mrt_stores_items_monthly"
[0m23:55:18.505920 [debug] [Thread-1 (]: On model.local_bike.mrt_stores_items_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_items_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`items_stores_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **total number of items sold** per store over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT *
FROM (

  SELECT
    yeardate AS year,
    month_2digits as month,
    store_name,
    COUNT(total_items) AS nb_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year, month, store_name

)
PIVOT (

  SUM(nb_items) AS total_items
  FOR store_name IN ('Santa Cruz Bikes','Baldwin Bikes','Rowlett Bikes')

)
ORDER BY year, month
------------------------------------------
    );
  
[0m23:55:18.595595 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (execute): 23:55:15.139919 => 23:55:18.595248
[0m23:55:18.596722 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f7743080>]}
[0m23:55:18.597548 [info ] [Thread-2 (]: 17 of 24 OK created sql table model dbt_bike_gold.products_stores_ranking_yearly_report  [[32mCREATE TABLE (27.0 rows, 270.5 KiB processed)[0m in 3.48s]
[0m23:55:18.598949 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_products_ranking_yearly_top3
[0m23:55:18.599975 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_stores_ranking_yearly
[0m23:55:18.600865 [info ] [Thread-2 (]: 20 of 24 START sql table model dbt_bike_gold.stores_ranking_yearly_report ...... [RUN]
[0m23:55:18.603441 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_products_ranking_yearly_top3, now model.local_bike.mrt_stores_ranking_yearly)
[0m23:55:18.604191 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_stores_ranking_yearly
[0m23:55:18.610151 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_stores_ranking_yearly"
[0m23:55:18.611173 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (compile): 23:55:18.605016 => 23:55:18.610802
[0m23:55:18.611702 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_stores_ranking_yearly
[0m23:55:18.615340 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:55:18.659392 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (execute): 23:55:15.335540 => 23:55:18.658841
[0m23:55:18.661734 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f46948f0>]}
[0m23:55:18.663751 [info ] [Thread-4 (]: 18 of 24 OK created sql table model dbt_bike_gold.sales_seasons_yearly_report .. [[32mCREATE TABLE (9.0 rows, 215.1 KiB processed)[0m in 3.34s]
[0m23:55:18.666231 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_sales_seasons_yearly
[0m23:55:18.668388 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_stores_sales_monthly
[0m23:55:18.672967 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_order_shipped_montly (execute): 23:55:15.003427 => 23:55:18.672143
[0m23:55:18.676659 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f465ff80>]}
[0m23:55:18.674048 [info ] [Thread-4 (]: 21 of 24 START sql table model dbt_bike_gold.sales_stores_monthly_report ....... [RUN]
[0m23:55:18.679804 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_sales_seasons_yearly, now model.local_bike.mrt_stores_sales_monthly)
[0m23:55:18.681809 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_stores_sales_monthly
[0m23:55:18.678218 [info ] [Thread-3 (]: 16 of 24 OK created sql table model dbt_bike_gold.orders_shipped_monthly_report  [[32mCREATE TABLE (81.0 rows, 215.1 KiB processed)[0m in 3.70s]
[0m23:55:18.689650 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_order_shipped_montly
[0m23:55:18.695338 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_stores_sales_monthly"
[0m23:55:18.696569 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_products_brands_monthly
[0m23:55:18.698173 [info ] [Thread-3 (]: 22 of 24 START sql table model dbt_bike_gold.products_brands_monthly_report .... [RUN]
[0m23:55:18.702657 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_montly, now model.local_bike.mrt_products_brands_monthly)
[0m23:55:18.701194 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (compile): 23:55:18.683454 => 23:55:18.700181
[0m23:55:18.703393 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_products_brands_monthly
[0m23:55:18.704241 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_stores_sales_monthly
[0m23:55:18.720230 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:55:18.724451 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:55:18.767226 [debug] [Thread-3 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m23:55:18.933967 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_stores_ranking_yearly"
[0m23:55:18.934910 [debug] [Thread-2 (]: On model.local_bike.mrt_stores_ranking_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_ranking_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`stores_ranking_yearly_report`
    
    

    OPTIONS(
      description="""This model provides **the ranking of best stores** over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT
  yeardate AS year_date,
  store_name,
  store_latitude,
  store_longitude,
  ROUND(SUM(total_sales_amount), 2) AS total_sales,
  RANK() OVER (PARTITION BY yeardate ORDER BY SUM(total_sales_amount) DESC) AS store_rank
FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
GROUP BY yeardate, store_name,store_latitude,store_longitude
ORDER BY yeardate, store_rank
------------------------------------------
    );
  
[0m23:55:19.027653 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.mrt_stores_sales_monthly"
[0m23:55:19.028699 [debug] [Thread-4 (]: On model.local_bike.mrt_stores_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_sales_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`sales_stores_monthly_report`
    
    

    OPTIONS(
      description="""This model provides **top sales by store** over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT *
FROM (

  SELECT
    yeardate AS year,
    month_2digits as month,
    store_name,
    ROUND(SUM(total_sales_amount), 2) AS sales_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year, month, store_name

)
PIVOT (

  SUM(sales_items) AS total_sales
  FOR store_name IN ('Santa Cruz Bikes','Baldwin Bikes','Rowlett Bikes')

)
ORDER BY year, month
------------------------------------------
    );
  
[0m23:55:21.018858 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:68f69260-c0fa-4595-b7f0-d1114362af63&page=queryresults
[0m23:55:21.019960 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_products_brands_monthly"
[0m23:55:21.020930 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_products_brands_monthly (compile): 23:55:18.705018 => 23:55:21.020573
[0m23:55:21.021495 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_products_brands_monthly
[0m23:55:21.125655 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.mrt_products_brands_monthly"
[0m23:55:21.126615 [debug] [Thread-3 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`products_brands_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **best-selling brands** per month over 3 years.\r\n\r\nIt provides a comprehensive view of each brand, allowing for easy analysis of brands performance."""
    )
    as (
      ------------------------------------------

------------------------------------------


------------------------------------------
SELECT *
FROM (

  SELECT
    yearmonth AS month,
    brand_name as Brand,    
    ROUND(SUM(total_item_discount_sold), 2 ) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily`
  GROUP BY month, brand

)
PIVOT (

  SUM(total_sales) AS sales
  FOR month IN ( '2016-01','2016-02','2016-03','2016-04','2016-05','2016-06','2016-07','2016-08','2016-09','2016-10','2016-11','2016-12','2017-01','2017-02','2017-03','2017-04','2017-05','2017-06','2017-07','2017-08','2017-09','2017-10','2017-11','2017-12','2018-01','2018-02','2018-03','2018-04','2018-06','2018-07','2018-08','2018-09','2018-10','2018-11','2018-12' )

)
ORDER BY Brand
------------------------------------------
    );
  
[0m23:55:21.228879 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:b435a27c-8caa-4930-9236-31fce4db80fa&page=queryresults
[0m23:55:21.531905 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_items_monthly (execute): 23:55:18.278311 => 23:55:21.531542
[0m23:55:21.533587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777913153c50>]}
[0m23:55:21.534494 [info ] [Thread-1 (]: 19 of 24 OK created sql table model dbt_bike_gold.items_stores_monthly_report .. [[32mCREATE TABLE (35.0 rows, 104.5 KiB processed)[0m in 3.27s]
[0m23:55:21.535834 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_stores_items_monthly
[0m23:55:21.536802 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_staff_ranking_yearly
[0m23:55:21.537436 [info ] [Thread-1 (]: 23 of 24 START sql table model dbt_bike_gold.ranking_sales_staffs_yearly_top3_report  [RUN]
[0m23:55:21.539593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_items_monthly, now model.local_bike.mrt_staff_ranking_yearly)
[0m23:55:21.540307 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_staff_ranking_yearly
[0m23:55:21.549483 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_staff_ranking_yearly"
[0m23:55:21.550632 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (compile): 23:55:21.540733 => 23:55:21.550251
[0m23:55:21.551196 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_staff_ranking_yearly
[0m23:55:21.555070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:21.603392 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:600ac609-f1ac-42ed-9b30-fa54a664f019&page=queryresults
[0m23:55:21.707817 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:01031e58-42d2-4c28-a9a4-13ff95a83a9a&page=queryresults
[0m23:55:21.776865 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.mrt_staff_ranking_yearly"
[0m23:55:21.777835 [debug] [Thread-1 (]: On model.local_bike.mrt_staff_ranking_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_ranking_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`ranking_sales_staffs_yearly_top3_report`
    
    

    OPTIONS(
      description="""This model provides **Top seller** per store and per year over 3 years.\r\n\r\nIt provides a comprehensive view of each seller, allowing for easy analysis of seller performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH sales_staffs_stores AS (

  SELECT
    yeardate AS year,
    staff_first_name || '-' || staff_last_name || ' ('|| store_name || ')' AS staff_name,
    ROUND(SUM(total_item_sold_staff), 2) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  GROUP BY year, staff_name

)
SELECT
  year,
  staff_name,
  total_sales
FROM (
  SELECT
    *,
    RANK() OVER (PARTITION BY year ORDER BY total_sales DESC) AS rank_sales
  FROM sales_staffs_stores
)
WHERE rank_sales <= 3 
ORDER BY year, total_sales
    );
  
[0m23:55:21.986676 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (execute): 23:55:18.611983 => 23:55:21.986070
[0m23:55:21.988636 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f44c3890>]}
[0m23:55:21.989872 [info ] [Thread-2 (]: 20 of 24 OK created sql table model dbt_bike_gold.stores_ranking_yearly_report . [[32mCREATE TABLE (9.0 rows, 215.1 KiB processed)[0m in 3.39s]
[0m23:55:21.991319 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_stores_ranking_yearly
[0m23:55:21.994091 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_staff_sales_monthly
[0m23:55:21.995938 [info ] [Thread-2 (]: 24 of 24 START sql table model dbt_bike_gold.staffs_sales_monthly_report ....... [RUN]
[0m23:55:22.000710 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_ranking_yearly, now model.local_bike.mrt_staff_sales_monthly)
[0m23:55:22.001667 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_staff_sales_monthly
[0m23:55:22.010453 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:55:22.012641 [debug] [Thread-2 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m23:55:22.055788 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (execute): 23:55:18.720799 => 23:55:22.055305
[0m23:55:22.057197 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f46947a0>]}
[0m23:55:22.058545 [info ] [Thread-4 (]: 21 of 24 OK created sql table model dbt_bike_gold.sales_stores_monthly_report .. [[32mCREATE TABLE (35.0 rows, 215.1 KiB processed)[0m in 3.38s]
[0m23:55:22.060037 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_stores_sales_monthly
[0m23:55:24.087441 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:f2bcef10-e8a8-4a15-951d-1e4523ecc76d&page=queryresults
[0m23:55:24.088553 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_staff_sales_monthly"
[0m23:55:24.089489 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (compile): 23:55:22.002191 => 23:55:24.089150
[0m23:55:24.090068 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_staff_sales_monthly
[0m23:55:24.229552 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_staff_sales_monthly"
[0m23:55:24.231139 [debug] [Thread-2 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`staffs_sales_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **best-seller** per month over 3 years.\r\n\r\nIt provides a comprehensive view of each seller, allowing for easy analysis of sellers performance."""
    )
    as (
      ------------------------------------------

------------------------------------------


------------------------------------------
SELECT *
FROM (

  SELECT
    staff_first_name || '-' || staff_last_name AS staff_name,
    yearmonth AS month,
    ROUND(SUM(total_item_sold_staff), 2 ) AS total_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  GROUP BY month, staff_name

)
PIVOT (

  SUM(total_items) AS sales
  FOR month IN ( '2016-01','2016-02','2016-03','2016-04','2016-05','2016-06','2016-07','2016-08','2016-09','2016-10','2016-11','2016-12','2017-01','2017-02','2017-03','2017-04','2017-05','2017-06','2017-07','2017-08','2017-09','2017-10','2017-11','2017-12','2018-01','2018-02','2018-03','2018-04','2018-06','2018-07','2018-08','2018-09','2018-10','2018-11','2018-12' )

)
ORDER BY staff_name
------------------------------------------
    );
  
[0m23:55:25.107953 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:fba5431c-9272-4675-9dbc-f5ac423fcaf5&page=queryresults
[0m23:55:25.205428 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:918d6d98-edab-4e70-83e1-5560cefe7d40&page=queryresults
[0m23:55:25.445473 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (execute): 23:55:21.551466 => 23:55:25.445168
[0m23:55:25.446646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f44d9340>]}
[0m23:55:25.447452 [info ] [Thread-1 (]: 23 of 24 OK created sql table model dbt_bike_gold.ranking_sales_staffs_yearly_top3_report  [[32mCREATE TABLE (9.0 rows, 185.9 KiB processed)[0m in 3.91s]
[0m23:55:25.448737 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_staff_ranking_yearly
[0m23:55:25.464848 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_products_brands_monthly (execute): 23:55:21.021857 => 23:55:25.464521
[0m23:55:25.466169 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f44dc9e0>]}
[0m23:55:25.672690 [info ] [Thread-3 (]: 22 of 24 OK created sql table model dbt_bike_gold.products_brands_monthly_report  [[32mCREATE TABLE (9.0 rows, 217.4 KiB processed)[0m in 6.76s]
[0m23:55:25.678717 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_products_brands_monthly
[0m23:55:28.589085 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:72c4093f-f624-4867-9490-22f1014a898c&page=queryresults
[0m23:55:28.891753 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (execute): 23:55:24.090345 => 23:55:28.891404
[0m23:55:28.892835 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2180fd4-5892-43a7-adc5-eaa58d692d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f4608da0>]}
[0m23:55:28.893650 [info ] [Thread-2 (]: 24 of 24 OK created sql table model dbt_bike_gold.staffs_sales_monthly_report .. [[32mCREATE TABLE (6.0 rows, 185.8 KiB processed)[0m in 6.89s]
[0m23:55:28.895109 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_staff_sales_monthly
[0m23:55:28.899990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:55:28.900576 [debug] [MainThread]: Connection 'model.local_bike.mrt_products_brands_monthly' was properly closed.
[0m23:55:28.901003 [debug] [MainThread]: Connection 'model.local_bike.mrt_stores_sales_monthly' was properly closed.
[0m23:55:28.901351 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_ranking_yearly' was properly closed.
[0m23:55:28.901741 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_sales_monthly' was properly closed.
[0m23:55:28.902223 [info ] [MainThread]: 
[0m23:55:28.902788 [info ] [MainThread]: Finished running 14 view models, 10 table models in 0 hours 0 minutes and 20.04 seconds (20.04s).
[0m23:55:28.915264 [debug] [MainThread]: Command end result
[0m23:55:28.966212 [info ] [MainThread]: 
[0m23:55:28.967250 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:55:28.968491 [info ] [MainThread]: 
[0m23:55:28.969751 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 TOTAL=24
[0m23:55:28.971315 [debug] [MainThread]: Command `dbt run` succeeded at 23:55:28.971036 after 21.95 seconds
[0m23:55:28.972283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77790f972780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f7ba64e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778f4632a20>]}
[0m23:55:28.972975 [debug] [MainThread]: Flushing usage events
[0m23:55:35.186260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7060519f9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7060519fa090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7060519f95e0>]}


============================== 23:55:35.191907 | 8868700f-1630-4d74-ad60-1e215dad14aa ==============================
[0m23:55:35.191907 [info ] [MainThread]: Running with dbt=1.5.0
[0m23:55:35.192955 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'static_parser': 'True', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': '/root/.dbt', 'use_experimental_parser': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'no_print': 'None', 'quiet': 'False'}
[0m23:55:36.983165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8868700f-1630-4d74-ad60-1e215dad14aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706039feef60>]}
[0m23:55:37.006720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8868700f-1630-4d74-ad60-1e215dad14aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706039d30740>]}
[0m23:55:37.056835 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m23:55:37.134346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:55:37.134901 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:55:37.145145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8868700f-1630-4d74-ad60-1e215dad14aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706039fb35f0>]}
[0m23:55:37.167538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8868700f-1630-4d74-ad60-1e215dad14aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706039ab0c50>]}
[0m23:55:37.168258 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m23:55:37.168941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8868700f-1630-4d74-ad60-1e215dad14aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70603b516090>]}
[0m23:55:37.173066 [info ] [MainThread]: 
[0m23:55:37.175063 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:55:37.179961 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m23:55:37.181016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:37.182659 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m23:55:37.186264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:37.278465 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m23:55:37.279876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:37.281559 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m23:55:37.321799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:37.674632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8868700f-1630-4d74-ad60-1e215dad14aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7060518186e0>]}
[0m23:55:37.675900 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:55:37.676569 [info ] [MainThread]: 
[0m23:55:37.685587 [debug] [Thread-1 (]: Began running node test.local_bike.assert_total_order_amount_is_positive
[0m23:55:37.686578 [info ] [Thread-1 (]: 1 of 1 START test assert_total_order_amount_is_positive ........................ [RUN]
[0m23:55:37.688368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now test.local_bike.assert_total_order_amount_is_positive)
[0m23:55:37.689283 [debug] [Thread-1 (]: Began compiling node test.local_bike.assert_total_order_amount_is_positive
[0m23:55:37.695121 [debug] [Thread-1 (]: Writing injected SQL for node "test.local_bike.assert_total_order_amount_is_positive"
[0m23:55:37.696223 [debug] [Thread-1 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (compile): 23:55:37.689671 => 23:55:37.695845
[0m23:55:37.696789 [debug] [Thread-1 (]: Began executing node test.local_bike.assert_total_order_amount_is_positive
[0m23:55:37.727127 [debug] [Thread-1 (]: Writing runtime sql for node "test.local_bike.assert_total_order_amount_is_positive"
[0m23:55:37.728112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:37.730247 [debug] [Thread-1 (]: On test.local_bike.assert_total_order_amount_is_positive: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "test.local_bike.assert_total_order_amount_is_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Refunds have a negative amount, so the total amount should always be >= 0.
-- Therefore return records where total_amount < 0 to make the test fail
select
    order_id,
    sum(total_item_discount_sold) as total_amount  
from `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
group by 1
having total_amount < 0
      
    ) dbt_internal_test
[0m23:55:38.740862 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:e5357935-d79b-4eb5-ba90-315047f24d8a&page=queryresults
[0m23:55:38.743750 [debug] [Thread-1 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (execute): 23:55:37.697092 => 23:55:38.743187
[0m23:55:38.745342 [info ] [Thread-1 (]: 1 of 1 PASS assert_total_order_amount_is_positive .............................. [[32mPASS[0m in 1.06s]
[0m23:55:38.747006 [debug] [Thread-1 (]: Finished running node test.local_bike.assert_total_order_amount_is_positive
[0m23:55:38.752870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:55:38.753673 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_seeds' was properly closed.
[0m23:55:38.754113 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_silver' was properly closed.
[0m23:55:38.754449 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_gold' was properly closed.
[0m23:55:38.754935 [debug] [MainThread]: Connection 'test.local_bike.assert_total_order_amount_is_positive' was properly closed.
[0m23:55:38.755336 [info ] [MainThread]: 
[0m23:55:38.756261 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m23:55:38.758541 [debug] [MainThread]: Command end result
[0m23:55:38.807948 [info ] [MainThread]: 
[0m23:55:38.809426 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:55:38.811335 [info ] [MainThread]: 
[0m23:55:38.813170 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:55:38.815107 [debug] [MainThread]: Command `dbt test` succeeded at 23:55:38.814698 after 3.64 seconds
[0m23:55:38.816153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706051bee3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706051b14980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70605234bbf0>]}
[0m23:55:38.816881 [debug] [MainThread]: Flushing usage events
[0m23:55:45.255182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704ca4fdaf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704ca3f41c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704ca34e78f0>]}


============================== 23:55:45.266698 | 89ef7e60-61a0-491e-97df-caadf751f90f ==============================
[0m23:55:45.266698 [info ] [MainThread]: Running with dbt=1.5.0
[0m23:55:45.269316 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'introspect': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/dbt/logs', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'write_json': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'debug': 'False', 'printer_width': '80', 'version_check': 'True', 'quiet': 'False', 'warn_error': 'None'}
[0m23:55:47.139885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89ef7e60-61a0-491e-97df-caadf751f90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704c8b683da0>]}
[0m23:55:47.165242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89ef7e60-61a0-491e-97df-caadf751f90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704c901ae930>]}
[0m23:55:47.216292 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m23:55:47.299024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:55:47.299614 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:55:47.315001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89ef7e60-61a0-491e-97df-caadf751f90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704c8b683500>]}
[0m23:55:47.320563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89ef7e60-61a0-491e-97df-caadf751f90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704c8b50a240>]}
[0m23:55:47.321569 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m23:55:47.322340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ef7e60-61a0-491e-97df-caadf751f90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704c8b7f3b30>]}
[0m23:55:47.330433 [info ] [MainThread]: 
[0m23:55:47.333072 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:55:47.336765 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m23:55:47.338189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:47.339691 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m23:55:47.342015 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m23:55:47.343024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:47.414731 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m23:55:47.415838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:47.456894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:47.795936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ef7e60-61a0-491e-97df-caadf751f90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704c91d86450>]}
[0m23:55:47.797259 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:55:47.798163 [info ] [MainThread]: 
[0m23:55:47.808152 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_brands
[0m23:55:47.808947 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_categories
[0m23:55:47.809600 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_customers
[0m23:55:47.810150 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_order_items
[0m23:55:47.811241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.stg_src_local_bike_brands)
[0m23:55:47.812266 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.stg_src_local_bike_categories)
[0m23:55:47.813272 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.stg_src_local_bike_customers)
[0m23:55:47.814240 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.stg_src_local_bike_order_items)
[0m23:55:47.814825 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_brands
[0m23:55:47.815354 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_categories
[0m23:55:47.815933 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_customers
[0m23:55:47.816449 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_order_items
[0m23:55:47.821883 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_brands"
[0m23:55:47.830272 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_customers"
[0m23:55:47.845637 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_order_items"
[0m23:55:47.859140 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_categories"
[0m23:55:47.860902 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (compile): 23:55:47.825704 => 23:55:47.860419
[0m23:55:47.861657 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_customers
[0m23:55:47.862454 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (execute): 23:55:47.862102 => 23:55:47.862141
[0m23:55:47.863143 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (compile): 23:55:47.816852 => 23:55:47.862817
[0m23:55:47.863870 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (compile): 23:55:47.822448 => 23:55:47.863536
[0m23:55:47.864487 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (compile): 23:55:47.834935 => 23:55:47.864171
[0m23:55:47.865981 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_customers
[0m23:55:47.866567 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_brands
[0m23:55:47.867112 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_categories
[0m23:55:47.867672 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_order_items
[0m23:55:47.868343 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_orders
[0m23:55:47.869742 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (execute): 23:55:47.869340 => 23:55:47.869361
[0m23:55:47.870636 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (execute): 23:55:47.870247 => 23:55:47.870265
[0m23:55:47.871317 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (execute): 23:55:47.870994 => 23:55:47.871014
[0m23:55:47.872306 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_customers, now model.local_bike.stg_src_local_bike_orders)
[0m23:55:47.873800 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_brands
[0m23:55:47.875131 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_categories
[0m23:55:47.876437 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_order_items
[0m23:55:47.876993 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_orders
[0m23:55:47.878077 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_products
[0m23:55:47.878953 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_staffs
[0m23:55:47.879810 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_stocks
[0m23:55:47.887596 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_orders"
[0m23:55:47.889143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_brands, now model.local_bike.stg_src_local_bike_products)
[0m23:55:47.890309 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_categories, now model.local_bike.stg_src_local_bike_staffs)
[0m23:55:47.893624 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_staffs
[0m23:55:47.892912 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_products
[0m23:55:47.891881 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_order_items, now model.local_bike.stg_src_local_bike_stocks)
[0m23:55:47.904012 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_products"
[0m23:55:47.898575 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_staffs"
[0m23:55:47.905266 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_orders (compile): 23:55:47.880320 => 23:55:47.904876
[0m23:55:47.906720 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_orders
[0m23:55:47.907413 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_orders (execute): 23:55:47.907094 => 23:55:47.907113
[0m23:55:47.905817 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_stocks
[0m23:55:47.909024 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_orders
[0m23:55:47.909803 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_products (compile): 23:55:47.899421 => 23:55:47.909431
[0m23:55:47.915787 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stocks"
[0m23:55:47.916608 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (compile): 23:55:47.894038 => 23:55:47.916211
[0m23:55:47.917305 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_stores
[0m23:55:47.918115 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_products
[0m23:55:47.920910 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_products (execute): 23:55:47.920543 => 23:55:47.920563
[0m23:55:47.918877 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_staffs
[0m23:55:47.919983 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_orders, now model.local_bike.stg_src_local_bike_stores)
[0m23:55:47.922330 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_products
[0m23:55:47.923084 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (execute): 23:55:47.922756 => 23:55:47.922774
[0m23:55:47.923854 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (compile): 23:55:47.910138 => 23:55:47.923465
[0m23:55:47.924345 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_stores
[0m23:55:47.925091 [debug] [Thread-1 (]: Began running node seed.local_bike.map
[0m23:55:47.926477 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_staffs
[0m23:55:47.927576 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_stocks
[0m23:55:47.933663 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stores"
[0m23:55:47.934836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_products, now seed.local_bike.map)
[0m23:55:47.935676 [debug] [Thread-2 (]: Began running node seed.local_bike.seasons
[0m23:55:47.936624 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (execute): 23:55:47.936243 => 23:55:47.936261
[0m23:55:47.939935 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_stocks
[0m23:55:47.938424 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_staffs, now seed.local_bike.seasons)
[0m23:55:47.937388 [debug] [Thread-1 (]: Began compiling node seed.local_bike.map
[0m23:55:47.940702 [debug] [Thread-4 (]: Began running node test.local_bike.assert_total_order_amount_is_positive
[0m23:55:47.941725 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_stores (compile): 23:55:47.928005 => 23:55:47.941233
[0m23:55:47.942273 [debug] [Thread-2 (]: Began compiling node seed.local_bike.seasons
[0m23:55:47.945728 [debug] [Thread-1 (]: Timing info for seed.local_bike.map (compile): 23:55:47.942653 => 23:55:47.945348
[0m23:55:47.946761 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stocks, now test.local_bike.assert_total_order_amount_is_positive)
[0m23:55:47.947350 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_stores
[0m23:55:47.950575 [debug] [Thread-2 (]: Timing info for seed.local_bike.seasons (compile): 23:55:47.947776 => 23:55:47.950204
[0m23:55:47.951199 [debug] [Thread-1 (]: Began executing node seed.local_bike.map
[0m23:55:47.951792 [debug] [Thread-4 (]: Began compiling node test.local_bike.assert_total_order_amount_is_positive
[0m23:55:47.952472 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_stores (execute): 23:55:47.952155 => 23:55:47.952178
[0m23:55:47.953017 [debug] [Thread-2 (]: Began executing node seed.local_bike.seasons
[0m23:55:47.954161 [debug] [Thread-1 (]: Timing info for seed.local_bike.map (execute): 23:55:47.953368 => 23:55:47.953395
[0m23:55:47.961155 [debug] [Thread-4 (]: Writing injected SQL for node "test.local_bike.assert_total_order_amount_is_positive"
[0m23:55:47.962804 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_stores
[0m23:55:47.963645 [debug] [Thread-2 (]: Timing info for seed.local_bike.seasons (execute): 23:55:47.963241 => 23:55:47.963265
[0m23:55:47.965133 [debug] [Thread-1 (]: Finished running node seed.local_bike.map
[0m23:55:47.966004 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_product_daily
[0m23:55:47.967479 [debug] [Thread-2 (]: Finished running node seed.local_bike.seasons
[0m23:55:47.968610 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m23:55:47.970138 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stores, now model.local_bike.int_src_local_bike_product_daily)
[0m23:55:47.971331 [debug] [Thread-4 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (compile): 23:55:47.954584 => 23:55:47.970989
[0m23:55:47.971948 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_store_daily
[0m23:55:47.972988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.local_bike.map, now model.local_bike.int_src_local_bike_staff_hierarchy)
[0m23:55:47.973632 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_product_daily
[0m23:55:47.974192 [debug] [Thread-4 (]: Began executing node test.local_bike.assert_total_order_amount_is_positive
[0m23:55:47.975189 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.local_bike.seasons, now model.local_bike.int_src_local_bike_store_daily)
[0m23:55:47.975767 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_staff_hierarchy
[0m23:55:47.983379 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_product_daily"
[0m23:55:47.984275 [debug] [Thread-4 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (execute): 23:55:47.983902 => 23:55:47.983926
[0m23:55:47.984904 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_store_daily
[0m23:55:47.990186 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m23:55:47.992027 [debug] [Thread-4 (]: Finished running node test.local_bike.assert_total_order_amount_is_positive
[0m23:55:47.999888 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_daily"
[0m23:55:48.000973 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_store_shipped_order
[0m23:55:48.001914 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (compile): 23:55:47.976135 => 23:55:48.001477
[0m23:55:48.003260 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (compile): 23:55:47.985335 => 23:55:48.002857
[0m23:55:48.004023 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (compile): 23:55:47.992524 => 23:55:48.003685
[0m23:55:48.005149 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.local_bike.assert_total_order_amount_is_positive, now model.local_bike.int_src_local_bike_store_shipped_order)
[0m23:55:48.005959 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_product_daily
[0m23:55:48.006620 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_staff_hierarchy
[0m23:55:48.007186 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_store_daily
[0m23:55:48.007766 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_store_shipped_order
[0m23:55:48.008461 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (execute): 23:55:48.008135 => 23:55:48.008158
[0m23:55:48.009185 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (execute): 23:55:48.008860 => 23:55:48.008881
[0m23:55:48.009882 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (execute): 23:55:48.009574 => 23:55:48.009589
[0m23:55:48.016995 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m23:55:48.019003 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_product_daily
[0m23:55:48.020883 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m23:55:48.022417 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_store_daily
[0m23:55:48.024695 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (compile): 23:55:48.010249 => 23:55:48.024228
[0m23:55:48.025210 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_store_shipped_order
[0m23:55:48.025907 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_staff_daily
[0m23:55:48.026438 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_order_shipped_aborted_montly
[0m23:55:48.027148 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (execute): 23:55:48.026812 => 23:55:48.026845
[0m23:55:48.027665 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_order_shipped_montly
[0m23:55:48.028688 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_product_daily, now model.local_bike.int_src_local_bike_staff_daily)
[0m23:55:48.029768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_hierarchy, now model.local_bike.mrt_order_shipped_aborted_montly)
[0m23:55:48.031183 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_store_shipped_order
[0m23:55:48.032177 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_daily, now model.local_bike.mrt_order_shipped_montly)
[0m23:55:48.032782 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_staff_daily
[0m23:55:48.033320 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_order_shipped_aborted_montly
[0m23:55:48.033994 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_products_ranking_yearly_top3
[0m23:55:48.034669 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_order_shipped_montly
[0m23:55:48.041933 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_daily"
[0m23:55:48.048021 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m23:55:48.049213 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_shipped_order, now model.local_bike.mrt_products_ranking_yearly_top3)
[0m23:55:48.054635 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_montly"
[0m23:55:48.056051 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (compile): 23:55:48.035031 => 23:55:48.055638
[0m23:55:48.056937 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (compile): 23:55:48.042398 => 23:55:48.056547
[0m23:55:48.058852 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_order_shipped_aborted_montly
[0m23:55:48.057492 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_products_ranking_yearly_top3
[0m23:55:48.059481 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (execute): 23:55:48.059172 => 23:55:48.059189
[0m23:55:48.058256 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_staff_daily
[0m23:55:48.066419 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_order_shipped_aborted_montly
[0m23:55:48.066978 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m23:55:48.067688 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_montly (compile): 23:55:48.050020 => 23:55:48.067331
[0m23:55:48.069942 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_order_shipped_montly
[0m23:55:48.069034 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_sales_seasons_yearly
[0m23:55:48.070646 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_montly (execute): 23:55:48.070314 => 23:55:48.070330
[0m23:55:48.068372 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (execute): 23:55:48.068062 => 23:55:48.068079
[0m23:55:48.071637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_aborted_montly, now model.local_bike.mrt_sales_seasons_yearly)
[0m23:55:48.073062 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_order_shipped_montly
[0m23:55:48.074748 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_staff_daily
[0m23:55:48.075400 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (compile): 23:55:48.059950 => 23:55:48.075109
[0m23:55:48.075964 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_sales_seasons_yearly
[0m23:55:48.076654 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_stores_items_monthly
[0m23:55:48.077412 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_stores_ranking_yearly
[0m23:55:48.078125 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_products_ranking_yearly_top3
[0m23:55:48.086075 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_sales_seasons_yearly"
[0m23:55:48.087433 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_montly, now model.local_bike.mrt_stores_items_monthly)
[0m23:55:48.088719 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_daily, now model.local_bike.mrt_stores_ranking_yearly)
[0m23:55:48.091231 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_stores_ranking_yearly
[0m23:55:48.090429 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_stores_items_monthly
[0m23:55:48.089664 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (execute): 23:55:48.089218 => 23:55:48.089243
[0m23:55:48.092219 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (compile): 23:55:48.078706 => 23:55:48.091599
[0m23:55:48.097357 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_stores_ranking_yearly"
[0m23:55:48.104578 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_products_ranking_yearly_top3
[0m23:55:48.106674 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_stores_items_monthly"
[0m23:55:48.107414 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_sales_seasons_yearly
[0m23:55:48.108368 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_stores_sales_monthly
[0m23:55:48.109951 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (execute): 23:55:48.109420 => 23:55:48.109448
[0m23:55:48.110683 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (compile): 23:55:48.092579 => 23:55:48.110320
[0m23:55:48.113944 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_stores_ranking_yearly
[0m23:55:48.111786 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_products_ranking_yearly_top3, now model.local_bike.mrt_stores_sales_monthly)
[0m23:55:48.114686 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (execute): 23:55:48.114267 => 23:55:48.114282
[0m23:55:48.113320 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_sales_seasons_yearly
[0m23:55:48.115272 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_items_monthly (compile): 23:55:48.097980 => 23:55:48.114985
[0m23:55:48.115781 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_stores_sales_monthly
[0m23:55:48.117111 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_stores_ranking_yearly
[0m23:55:48.118134 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_products_brands_monthly
[0m23:55:48.118850 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_stores_items_monthly
[0m23:55:48.125223 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_stores_sales_monthly"
[0m23:55:48.126067 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_staff_ranking_yearly
[0m23:55:48.127219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_sales_seasons_yearly, now model.local_bike.mrt_products_brands_monthly)
[0m23:55:48.129812 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_products_brands_monthly
[0m23:55:48.128015 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_items_monthly (execute): 23:55:48.127646 => 23:55:48.127671
[0m23:55:48.129142 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_ranking_yearly, now model.local_bike.mrt_staff_ranking_yearly)
[0m23:55:48.141748 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (compile): 23:55:48.119228 => 23:55:48.141233
[0m23:55:48.143302 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_stores_items_monthly
[0m23:55:48.155103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:48.155806 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_staff_ranking_yearly
[0m23:55:48.156470 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_stores_sales_monthly
[0m23:55:48.157240 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_staff_sales_monthly
[0m23:55:48.162649 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_staff_ranking_yearly"
[0m23:55:48.163802 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (execute): 23:55:48.163361 => 23:55:48.163382
[0m23:55:48.165841 [debug] [Thread-1 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m23:55:48.167229 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_items_monthly, now model.local_bike.mrt_staff_sales_monthly)
[0m23:55:48.168916 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_stores_sales_monthly
[0m23:55:48.210239 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_staff_sales_monthly
[0m23:55:48.217105 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (compile): 23:55:48.157926 => 23:55:48.216639
[0m23:55:48.220103 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:55:48.220815 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_staff_ranking_yearly
[0m23:55:48.225114 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (execute): 23:55:48.224528 => 23:55:48.224555
[0m23:55:48.223679 [debug] [Thread-2 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m23:55:48.227278 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_staff_ranking_yearly
[0m23:55:49.161026 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:94824cdd-8566-4acd-aa7a-5fda712ad133&page=queryresults
[0m23:55:49.162248 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_products_brands_monthly"
[0m23:55:49.163310 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_products_brands_monthly (compile): 23:55:48.130140 => 23:55:49.162945
[0m23:55:49.163885 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_products_brands_monthly
[0m23:55:49.164466 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_products_brands_monthly (execute): 23:55:49.164180 => 23:55:49.164196
[0m23:55:49.165798 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_products_brands_monthly
[0m23:55:49.259291 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:a83c32df-c248-4bd1-ac67-2d6412f394e6&page=queryresults
[0m23:55:49.260617 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_staff_sales_monthly"
[0m23:55:49.261992 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (compile): 23:55:48.211431 => 23:55:49.261561
[0m23:55:49.262594 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_staff_sales_monthly
[0m23:55:49.263235 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (execute): 23:55:49.262928 => 23:55:49.262944
[0m23:55:49.264563 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_staff_sales_monthly
[0m23:55:49.267096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:55:49.267589 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_ranking_yearly' was properly closed.
[0m23:55:49.267949 [debug] [MainThread]: Connection 'model.local_bike.mrt_products_brands_monthly' was properly closed.
[0m23:55:49.268231 [debug] [MainThread]: Connection 'model.local_bike.mrt_stores_sales_monthly' was properly closed.
[0m23:55:49.268484 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_sales_monthly' was properly closed.
[0m23:55:49.274131 [debug] [MainThread]: Command end result
[0m23:55:49.305991 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m23:55:49.306434 [info ] [MainThread]: Building catalog
[0m23:55:49.311694 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:55:49.880621 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m23:55:49.887713 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m23:55:49.894855 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m23:55:49.916665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:49.917672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:49.919127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:49.920655 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m23:55:49.923959 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_bronze`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_bronze'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m23:55:49.927276 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_silver`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_silver'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m23:55:49.933222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:49.938069 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_gold`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_gold'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m23:55:50.022295 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_seeds`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_seeds'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m23:55:51.849838 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:8a8f3e34-c036-4377-adb0-cf3e8cde09bd&page=queryresults
[0m23:55:51.871678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:51.872710 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:6a0be6eb-87d7-4db9-ad84-23131b548ce3&page=queryresults
[0m23:55:51.884799 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`src_local_bike`.__TABLES__
        where (upper(dataset_id) = upper('src_local_bike'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m23:55:51.925997 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:f493f1ba-5036-4bf0-a9f8-33b09ab7f982&page=queryresults
[0m23:55:51.934133 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:82803f7a-eec7-4f9a-927e-3fa0339fec01&page=queryresults
[0m23:55:53.597724 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:2f313b5d-1ba7-4736-9bce-56193df3969f&page=queryresults
[0m23:55:53.790593 [info ] [MainThread]: Catalog written to /usr/app/dbt/target/catalog.json
[0m23:55:53.793088 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:55:53.792728 after 8.55 seconds
[0m23:55:53.793865 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:55:53.794403 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m23:55:53.794890 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m23:55:53.795315 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m23:55:53.795783 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m23:55:53.796362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704ca3402f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704ca39a9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704c8b759a60>]}
[0m23:55:53.797043 [debug] [MainThread]: Flushing usage events
[0m23:33:28.980159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774034be6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77403522c140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774034be7710>]}


============================== 23:33:28.997583 | 0b619e2e-0323-48e1-9e3a-41b5f9918528 ==============================
[0m23:33:28.997583 [info ] [MainThread]: Running with dbt=1.5.0
[0m23:33:28.999223 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'warn_error': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'introspect': 'True', 'log_path': '/usr/app/dbt/logs', 'cache_selected_only': 'False', 'partial_parse': 'True', 'no_print': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'use_colors': 'True', 'quiet': 'False', 'target_path': 'None', 'printer_width': '80', 'static_parser': 'True', 'profiles_dir': '/root/.dbt', 'log_format': 'default', 'use_experimental_parser': 'False'}
[0m23:33:31.181945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b619e2e-0323-48e1-9e3a-41b5f9918528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7740357da930>]}
[0m23:33:31.206152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b619e2e-0323-48e1-9e3a-41b5f9918528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774020d85280>]}
[0m23:33:31.278249 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m23:33:31.532602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:33:31.533152 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:33:31.544756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b619e2e-0323-48e1-9e3a-41b5f9918528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774024ace2d0>]}
[0m23:33:31.573489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b619e2e-0323-48e1-9e3a-41b5f9918528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774020ce84d0>]}
[0m23:33:31.574348 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m23:33:31.575154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b619e2e-0323-48e1-9e3a-41b5f9918528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7740213badb0>]}
[0m23:33:31.580102 [info ] [MainThread]: 
[0m23:33:31.582435 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:33:31.584631 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m23:33:31.585303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:32.161887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_gold)
[0m23:33:32.163058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:32.164358 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m23:33:32.165398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:32.166778 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m23:33:32.167289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:32.168926 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m23:33:32.257595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:32.815256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b619e2e-0323-48e1-9e3a-41b5f9918528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774020e62ab0>]}
[0m23:33:32.816476 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:33:32.817274 [info ] [MainThread]: 
[0m23:33:32.854663 [debug] [Thread-1 (]: Began running node seed.local_bike.map
[0m23:33:32.855522 [debug] [Thread-2 (]: Began running node seed.local_bike.seasons
[0m23:33:32.856307 [info ] [Thread-1 (]: 1 of 2 START seed file dbt_bike_seeds.map ...................................... [RUN]
[0m23:33:32.858073 [info ] [Thread-2 (]: 2 of 2 START seed file dbt_bike_seeds.seasons .................................. [RUN]
[0m23:33:32.861744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now seed.local_bike.map)
[0m23:33:32.863654 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now seed.local_bike.seasons)
[0m23:33:32.864726 [debug] [Thread-1 (]: Began compiling node seed.local_bike.map
[0m23:33:32.865624 [debug] [Thread-2 (]: Began compiling node seed.local_bike.seasons
[0m23:33:32.866572 [debug] [Thread-1 (]: Timing info for seed.local_bike.map (compile): 23:33:32.866076 => 23:33:32.866093
[0m23:33:32.867330 [debug] [Thread-2 (]: Timing info for seed.local_bike.seasons (compile): 23:33:32.866997 => 23:33:32.867011
[0m23:33:32.867937 [debug] [Thread-1 (]: Began executing node seed.local_bike.map
[0m23:33:32.868750 [debug] [Thread-2 (]: Began executing node seed.local_bike.seasons
[0m23:33:32.934316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:33:32.936467 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:33:36.158105 [debug] [Thread-2 (]: On seed.local_bike.seasons: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "seed.local_bike.seasons"} */

    alter table `databird-473015`.`dbt_bike_seeds`.`seasons` set OPTIONS()
  
[0m23:33:36.339341 [debug] [Thread-1 (]: On seed.local_bike.map: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "seed.local_bike.map"} */

    alter table `databird-473015`.`dbt_bike_seeds`.`map` set OPTIONS()
  
[0m23:33:36.657142 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:e22768fa-c7fc-4d6f-a27c-6bc48e769ab3&page=queryresults
[0m23:33:36.665805 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.local_bike.seasons"
[0m23:33:36.688524 [debug] [Thread-2 (]: Timing info for seed.local_bike.seasons (execute): 23:33:32.879605 => 23:33:36.688201
[0m23:33:36.689727 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b619e2e-0323-48e1-9e3a-41b5f9918528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774020c8fa10>]}
[0m23:33:36.690484 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file dbt_bike_seeds.seasons .............................. [[32mINSERT 12[0m in 3.83s]
[0m23:33:36.691772 [debug] [Thread-2 (]: Finished running node seed.local_bike.seasons
[0m23:33:37.131521 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:e477d760-27f0-49cc-a88e-9e93caab8a4a&page=queryresults
[0m23:33:37.132835 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.local_bike.map"
[0m23:33:37.136380 [debug] [Thread-1 (]: Timing info for seed.local_bike.map (execute): 23:33:32.869144 => 23:33:37.136095
[0m23:33:37.137452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b619e2e-0323-48e1-9e3a-41b5f9918528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774020ac6840>]}
[0m23:33:37.138122 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file dbt_bike_seeds.map .................................. [[32mINSERT 3[0m in 4.28s]
[0m23:33:37.139208 [debug] [Thread-1 (]: Finished running node seed.local_bike.map
[0m23:33:37.143696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:33:37.144778 [debug] [MainThread]: Connection 'seed.local_bike.map' was properly closed.
[0m23:33:37.145386 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_silver' was properly closed.
[0m23:33:37.145826 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_seeds' was properly closed.
[0m23:33:37.146124 [debug] [MainThread]: Connection 'seed.local_bike.seasons' was properly closed.
[0m23:33:37.146580 [info ] [MainThread]: 
[0m23:33:37.147459 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 5.57 seconds (5.57s).
[0m23:33:37.150068 [debug] [MainThread]: Command end result
[0m23:33:37.186797 [info ] [MainThread]: 
[0m23:33:37.187900 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:33:37.189317 [info ] [MainThread]: 
[0m23:33:37.190907 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:33:37.192678 [debug] [MainThread]: Command `dbt seed` succeeded at 23:33:37.192198 after 8.25 seconds
[0m23:33:37.193543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77403522c140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774038482d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774034bb4b00>]}
[0m23:33:37.194221 [debug] [MainThread]: Flushing usage events
[0m00:39:47.451970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3ffbbaff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e400a77bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3ffbbb620>]}


============================== 00:39:47.463311 | 72f0bbfb-1fe2-4bbd-8521-f625de3c0a74 ==============================
[0m00:39:47.463311 [info ] [MainThread]: Running with dbt=1.5.0
[0m00:39:47.464841 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'no_print': 'None', 'introspect': 'True', 'version_check': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/root/.dbt', 'log_format': 'default', 'printer_width': '80', 'debug': 'False', 'use_experimental_parser': 'False'}
[0m00:39:51.081347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72f0bbfb-1fe2-4bbd-8521-f625de3c0a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3ffbfcc80>]}
[0m00:39:51.105438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72f0bbfb-1fe2-4bbd-8521-f625de3c0a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3e7da6fc0>]}
[0m00:39:51.162723 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m00:39:51.368839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:39:51.369685 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:39:51.384676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72f0bbfb-1fe2-4bbd-8521-f625de3c0a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3e7dc9880>]}
[0m00:39:51.416826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72f0bbfb-1fe2-4bbd-8521-f625de3c0a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3e7c25640>]}
[0m00:39:51.417697 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m00:39:51.418450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72f0bbfb-1fe2-4bbd-8521-f625de3c0a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3ece9ea50>]}
[0m00:39:51.422754 [info ] [MainThread]: 
[0m00:39:51.424572 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:39:51.427586 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m00:39:51.428711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:51.946783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_bronze)
[0m00:39:51.947765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:51.948915 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m00:39:51.949804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:51.990361 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m00:39:51.991011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:51.993460 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m00:39:51.994010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:52.429862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72f0bbfb-1fe2-4bbd-8521-f625de3c0a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3e7ea3aa0>]}
[0m00:39:52.431239 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:39:52.432849 [info ] [MainThread]: 
[0m00:39:52.444399 [debug] [Thread-1 (]: Began running node seed.local_bike.map
[0m00:39:52.445326 [info ] [Thread-1 (]: 1 of 2 START seed file dbt_bike_seeds.map ...................................... [RUN]
[0m00:39:52.446849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now seed.local_bike.map)
[0m00:39:52.447879 [debug] [Thread-2 (]: Began running node seed.local_bike.seasons
[0m00:39:52.448764 [debug] [Thread-1 (]: Began compiling node seed.local_bike.map
[0m00:39:52.451633 [debug] [Thread-1 (]: Timing info for seed.local_bike.map (compile): 00:39:52.450481 => 00:39:52.450493
[0m00:39:52.449829 [info ] [Thread-2 (]: 2 of 2 START seed file dbt_bike_seeds.seasons .................................. [RUN]
[0m00:39:52.452875 [debug] [Thread-1 (]: Began executing node seed.local_bike.map
[0m00:39:52.454333 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now seed.local_bike.seasons)
[0m00:39:52.460332 [debug] [Thread-2 (]: Began compiling node seed.local_bike.seasons
[0m00:39:52.466461 [debug] [Thread-2 (]: Timing info for seed.local_bike.seasons (compile): 00:39:52.465977 => 00:39:52.465992
[0m00:39:52.472353 [debug] [Thread-2 (]: Began executing node seed.local_bike.seasons
[0m00:39:52.524630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:52.570852 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:39:55.886179 [debug] [Thread-1 (]: On seed.local_bike.map: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "seed.local_bike.map"} */

    alter table `databird-473015`.`dbt_bike_seeds`.`map` set OPTIONS()
  
[0m00:39:56.479581 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:69d30bec-f0ef-4f4e-8235-69c34c1d60b8&page=queryresults
[0m00:39:56.509643 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.local_bike.map"
[0m00:39:56.548927 [debug] [Thread-1 (]: Timing info for seed.local_bike.map (execute): 00:39:52.454828 => 00:39:56.548297
[0m00:39:56.550904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f0bbfb-1fe2-4bbd-8521-f625de3c0a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3e7bd5b80>]}
[0m00:39:56.552110 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file dbt_bike_seeds.map .................................. [[32mINSERT 3[0m in 4.10s]
[0m00:39:56.553887 [debug] [Thread-1 (]: Finished running node seed.local_bike.map
[0m00:39:56.725213 [debug] [Thread-2 (]: On seed.local_bike.seasons: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "seed.local_bike.seasons"} */

    alter table `databird-473015`.`dbt_bike_seeds`.`seasons` set OPTIONS()
  
[0m00:39:57.179605 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:94be040a-8c53-4a74-903c-53f69c4c5e62&page=queryresults
[0m00:39:57.181161 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.local_bike.seasons"
[0m00:39:57.185505 [debug] [Thread-2 (]: Timing info for seed.local_bike.seasons (execute): 00:39:52.483071 => 00:39:57.185130
[0m00:39:57.186741 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f0bbfb-1fe2-4bbd-8521-f625de3c0a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3e7bd5e80>]}
[0m00:39:57.187570 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file dbt_bike_seeds.seasons .............................. [[32mINSERT 12[0m in 4.73s]
[0m00:39:57.188846 [debug] [Thread-2 (]: Finished running node seed.local_bike.seasons
[0m00:39:57.193867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:57.194685 [debug] [MainThread]: Connection 'seed.local_bike.seasons' was properly closed.
[0m00:39:57.195131 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_gold' was properly closed.
[0m00:39:57.195552 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_silver' was properly closed.
[0m00:39:57.195864 [debug] [MainThread]: Connection 'seed.local_bike.map' was properly closed.
[0m00:39:57.196313 [info ] [MainThread]: 
[0m00:39:57.197155 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 5.77 seconds (5.77s).
[0m00:39:57.200030 [debug] [MainThread]: Command end result
[0m00:39:57.224239 [info ] [MainThread]: 
[0m00:39:57.225388 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:39:57.226356 [info ] [MainThread]: 
[0m00:39:57.227227 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:39:57.228861 [debug] [MainThread]: Command `dbt seed` succeeded at 00:39:57.228201 after 9.80 seconds
[0m00:39:57.230134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3ffbfc590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3ffbd3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3ffbbb8c0>]}
[0m00:39:57.230799 [debug] [MainThread]: Flushing usage events
[0m00:54:31.842749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76542d3f5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76542d3341d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76542d3e3620>]}


============================== 00:54:31.848508 | 81a63462-ff79-48bc-8b1e-07d191339a3c ==============================
[0m00:54:31.848508 [info ] [MainThread]: Running with dbt=1.5.0
[0m00:54:31.849517 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'no_print': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/dbt/logs', 'introspect': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'static_parser': 'True', 'debug': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'partial_parse': 'True', 'log_format': 'default', 'indirect_selection': 'eager'}
[0m00:54:33.463870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81a63462-ff79-48bc-8b1e-07d191339a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76542d219760>]}
[0m00:54:33.488146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81a63462-ff79-48bc-8b1e-07d191339a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7654194f1eb0>]}
[0m00:54:33.539467 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m00:54:33.635049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:54:33.635632 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:54:33.645874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81a63462-ff79-48bc-8b1e-07d191339a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76542d218170>]}
[0m00:54:33.669579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81a63462-ff79-48bc-8b1e-07d191339a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765419458cb0>]}
[0m00:54:33.670331 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m00:54:33.671060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81a63462-ff79-48bc-8b1e-07d191339a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76541af873b0>]}
[0m00:54:33.676296 [info ] [MainThread]: 
[0m00:54:33.678613 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:54:33.683361 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m00:54:33.684485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:34.385767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_gold)
[0m00:54:34.386695 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:54:34.387892 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m00:54:34.388833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:34.430265 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m00:54:34.433097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:34.474696 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m00:54:34.475371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:34.814098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81a63462-ff79-48bc-8b1e-07d191339a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765419458440>]}
[0m00:54:34.815350 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:54:34.816170 [info ] [MainThread]: 
[0m00:54:34.825592 [debug] [Thread-1 (]: Began running node seed.local_bike.map
[0m00:54:34.826540 [info ] [Thread-1 (]: 1 of 2 START seed file dbt_bike_seeds.map ...................................... [RUN]
[0m00:54:34.828027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now seed.local_bike.map)
[0m00:54:34.828960 [debug] [Thread-2 (]: Began running node seed.local_bike.seasons
[0m00:54:34.829605 [debug] [Thread-1 (]: Began compiling node seed.local_bike.map
[0m00:54:34.831221 [debug] [Thread-1 (]: Timing info for seed.local_bike.map (compile): 00:54:34.830744 => 00:54:34.830757
[0m00:54:34.831952 [debug] [Thread-1 (]: Began executing node seed.local_bike.map
[0m00:54:34.830321 [info ] [Thread-2 (]: 2 of 2 START seed file dbt_bike_seeds.seasons .................................. [RUN]
[0m00:54:34.848866 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now seed.local_bike.seasons)
[0m00:54:34.857541 [debug] [Thread-2 (]: Began compiling node seed.local_bike.seasons
[0m00:54:34.863779 [debug] [Thread-2 (]: Timing info for seed.local_bike.seasons (compile): 00:54:34.863263 => 00:54:34.863275
[0m00:54:34.864526 [debug] [Thread-2 (]: Began executing node seed.local_bike.seasons
[0m00:54:34.882796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:34.885047 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:38.076452 [debug] [Thread-1 (]: On seed.local_bike.map: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "seed.local_bike.map"} */

    alter table `databird-473015`.`dbt_bike_seeds`.`map` set OPTIONS()
  
[0m00:54:38.080192 [debug] [Thread-2 (]: On seed.local_bike.seasons: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "seed.local_bike.seasons"} */

    alter table `databird-473015`.`dbt_bike_seeds`.`seasons` set OPTIONS()
  
[0m00:54:38.505137 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:6a202734-1dea-4cde-a770-3f77d33f0117&page=queryresults
[0m00:54:38.527698 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.local_bike.seasons"
[0m00:54:38.550616 [debug] [Thread-2 (]: Timing info for seed.local_bike.seasons (execute): 00:54:34.864899 => 00:54:38.550296
[0m00:54:38.551734 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81a63462-ff79-48bc-8b1e-07d191339a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7654193144d0>]}
[0m00:54:38.552517 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file dbt_bike_seeds.seasons .............................. [[32mINSERT 12[0m in 3.70s]
[0m00:54:38.553882 [debug] [Thread-2 (]: Finished running node seed.local_bike.seasons
[0m00:54:39.239239 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:37d06088-0f3e-4533-a6d1-3eef147beeb9&page=queryresults
[0m00:54:39.240574 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.local_bike.map"
[0m00:54:39.244220 [debug] [Thread-1 (]: Timing info for seed.local_bike.map (execute): 00:54:34.832593 => 00:54:39.243928
[0m00:54:39.245267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81a63462-ff79-48bc-8b1e-07d191339a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76541923ddf0>]}
[0m00:54:39.245978 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file dbt_bike_seeds.map .................................. [[32mINSERT 3[0m in 4.42s]
[0m00:54:39.247094 [debug] [Thread-1 (]: Finished running node seed.local_bike.map
[0m00:54:39.251165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:54:39.251736 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_gold' was properly closed.
[0m00:54:39.252067 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_bronze' was properly closed.
[0m00:54:39.252327 [debug] [MainThread]: Connection 'seed.local_bike.seasons' was properly closed.
[0m00:54:39.252665 [debug] [MainThread]: Connection 'seed.local_bike.map' was properly closed.
[0m00:54:39.253028 [info ] [MainThread]: 
[0m00:54:39.253639 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 5.58 seconds (5.58s).
[0m00:54:39.256443 [debug] [MainThread]: Command end result
[0m00:54:39.277025 [info ] [MainThread]: 
[0m00:54:39.277985 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:54:39.278783 [info ] [MainThread]: 
[0m00:54:39.280454 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:54:39.282503 [debug] [MainThread]: Command `dbt seed` succeeded at 00:54:39.282003 after 7.45 seconds
[0m00:54:39.283392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76542d3e3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76542d3e3b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76542d3e3b90>]}
[0m00:54:39.284316 [debug] [MainThread]: Flushing usage events
[0m00:54:45.564222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bd9dbdbf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bd9dde9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bd9e1baed0>]}


============================== 00:54:45.570067 | d623e193-96b8-4b4f-b0e5-2a37ebaa88c1 ==============================
[0m00:54:45.570067 [info ] [MainThread]: Running with dbt=1.5.0
[0m00:54:45.571151 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'static_parser': 'True', 'no_print': 'None', 'target_path': 'None', 'debug': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'warn_error': 'None', 'write_json': 'True'}
[0m00:54:45.626775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd623e193-96b8-4b4f-b0e5-2a37ebaa88c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bd9ddeacc0>]}
[0m00:54:45.659373 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-g5453ypd'
[0m00:54:45.660348 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:54:45.781294 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:54:45.784277 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m00:54:45.887360 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m00:54:45.894831 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:54:45.994111 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:54:46.002860 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m00:54:46.105091 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m00:54:46.108435 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m00:54:46.109464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd623e193-96b8-4b4f-b0e5-2a37ebaa88c1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bd9da40740>]}
[0m00:54:46.126312 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m00:54:46.828716 [info ] [MainThread]: Installed from version 0.10.5
[0m00:54:46.829440 [info ] [MainThread]: Up to date!
[0m00:54:46.830243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd623e193-96b8-4b4f-b0e5-2a37ebaa88c1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bd9da5a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bd9da40560>]}
[0m00:54:46.831478 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:54:47.056270 [info ] [MainThread]: Installed from version 1.3.2
[0m00:54:47.057182 [info ] [MainThread]: Up to date!
[0m00:54:47.058092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd623e193-96b8-4b4f-b0e5-2a37ebaa88c1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bd9da5a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bd9da40560>]}
[0m00:54:47.059259 [info ] [MainThread]: Installing calogica/dbt_date
[0m00:54:47.214367 [info ] [MainThread]: Installed from version 0.10.1
[0m00:54:47.215222 [info ] [MainThread]: Up to date!
[0m00:54:47.216084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd623e193-96b8-4b4f-b0e5-2a37ebaa88c1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bd9da5a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bd9da10530>]}
[0m00:54:47.218560 [debug] [MainThread]: Command `dbt deps` succeeded at 00:54:47.218182 after 1.67 seconds
[0m00:54:47.219250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bd9dcf9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bd9f3921b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bd9ddeacc0>]}
[0m00:54:47.220323 [debug] [MainThread]: Flushing usage events
[0m00:54:53.041077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e59d4762d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e59bfe63c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e59bd6ecf0>]}


============================== 00:54:53.049887 | 7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f ==============================
[0m00:54:53.049887 [info ] [MainThread]: Running with dbt=1.5.0
[0m00:54:53.051196 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'quiet': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'partial_parse': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'no_print': 'None', 'debug': 'False', 'version_check': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'log_path': '/usr/app/dbt/logs', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80'}
[0m00:54:54.581585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e59fa2ea50>]}
[0m00:54:54.604644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e5882cb140>]}
[0m00:54:54.669618 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m00:54:54.771363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:54:54.771937 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:54:54.782666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e5882ca690>]}
[0m00:54:54.804597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e58814c590>]}
[0m00:54:54.805285 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m00:54:54.806197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e58843fa40>]}
[0m00:54:54.810231 [info ] [MainThread]: 
[0m00:54:54.812540 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:54:54.816915 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m00:54:54.818463 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m00:54:54.819314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:54.820378 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m00:54:54.821208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:54.821964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:55.529652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_bronze)
[0m00:54:55.530521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:54:55.531633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_seeds)
[0m00:54:55.533582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:54:55.533045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_gold)
[0m00:54:55.534163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:54:55.616985 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m00:54:55.621499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:55.971861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e5885fac30>]}
[0m00:54:55.973113 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:54:55.974140 [info ] [MainThread]: 
[0m00:54:55.985682 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_brands
[0m00:54:55.986511 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_categories
[0m00:54:55.987140 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_customers
[0m00:54:55.987944 [info ] [Thread-1 (]: 1 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_brands ......... [RUN]
[0m00:54:55.991231 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_order_items
[0m00:54:55.989175 [info ] [Thread-2 (]: 2 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_categories ..... [RUN]
[0m00:54:55.992732 [info ] [Thread-3 (]: 3 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_customers ...... [RUN]
[0m00:54:55.994930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.stg_src_local_bike_brands)
[0m00:54:55.999074 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.stg_src_local_bike_categories)
[0m00:54:55.996475 [info ] [Thread-4 (]: 4 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_order_items .... [RUN]
[0m00:54:56.000523 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.stg_src_local_bike_customers)
[0m00:54:56.001327 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_brands
[0m00:54:56.002294 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_categories
[0m00:54:56.003483 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.stg_src_local_bike_order_items)
[0m00:54:56.004150 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_customers
[0m00:54:56.010596 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_brands"
[0m00:54:56.016910 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_categories"
[0m00:54:56.017666 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_order_items
[0m00:54:56.023063 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_customers"
[0m00:54:56.035218 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (compile): 00:54:56.018191 => 00:54:56.034653
[0m00:54:56.036348 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_customers
[0m00:54:56.043285 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (compile): 00:54:56.011103 => 00:54:56.042729
[0m00:54:56.044612 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (compile): 00:54:56.004607 => 00:54:56.044070
[0m00:54:56.054045 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_categories
[0m00:54:56.087233 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_brands
[0m00:54:56.109054 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_customers"
[0m00:54:56.115226 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_categories"
[0m00:54:56.127778 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_brands"
[0m00:54:56.135608 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_order_items"
[0m00:54:56.137612 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:54:56.139979 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_customers: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_customers"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_customers`
  OPTIONS(
      description="""Customer informations."""
    )
  as select
    customer_id as customer_id,
    INITCAP(first_name) as customer_first_name,
    INITCAP(last_name) as customer_last_name,
    phone as customer_phone,
    email as customer_email,
    INITCAP(street) as customer_street,
    INITCAP(city) as customer_city,
    UPPER(state) as customer_state,
    zip_code as customer_zip_code
from `databird-473015`.`src_local_bike`.`customers`;


[0m00:54:56.140770 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:56.179712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:56.182976 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (compile): 00:54:56.024739 => 00:54:56.181754
[0m00:54:56.185314 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_categories: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_categories"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_categories`
  OPTIONS(
      description="""Product categories such as road, mountain, and electric bikes."""
    )
  as select
        category_id as category_id,
        INITCAP(category_name) as category_name
from `databird-473015`.`src_local_bike`.`categories`;


[0m00:54:56.186649 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_order_items
[0m00:54:56.189657 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_brands: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_brands"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
  OPTIONS(
      description="""Bike brands sold by Local Bike."""
    )
  as select
        brand_id as brand_id,
        INITCAP(brand_name) as brand_name
from `databird-473015`.`src_local_bike`.`brands`;


[0m00:54:56.288643 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_order_items"
[0m00:54:56.291995 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:54:56.296681 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_order_items: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_order_items"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
  OPTIONS(
      description="""Detailed order line items with pricing and discounts."""
    )
  as SELECT
  order_id as order_id,
  item_id AS item_id,
  product_id as product_id,
  quantity as quantity,
  list_price as list_price,
  discount as discount,
  
    list_price * quantity * ( 1 - discount )
 AS total_item_discount_sold
FROM `databird-473015`.`src_local_bike`.`order_items`;


[0m00:54:56.939185 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:2f716d4f-c4eb-436a-bcf7-167edfbccc58&page=queryresults
[0m00:54:56.973346 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:c360db78-cf6f-4d19-9a09-8141a4b3bd4f&page=queryresults
[0m00:54:56.975714 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:950f73ff-24c8-4bc0-b05c-90458ef6e15a&page=queryresults
[0m00:54:56.985651 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:2654d4c5-adf8-4269-9926-68b614a2e41b&page=queryresults
[0m00:54:57.258665 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (execute): 00:54:56.109976 => 00:54:57.258304
[0m00:54:57.260293 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (execute): 00:54:56.237554 => 00:54:57.259975
[0m00:54:57.261536 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e583cfe780>]}
[0m00:54:57.262788 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e58801b590>]}
[0m00:54:57.263860 [info ] [Thread-2 (]: 2 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_categories  [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m00:54:57.267374 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_categories
[0m00:54:57.268769 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_orders
[0m00:54:57.265378 [info ] [Thread-4 (]: 4 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_order_items  [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m00:54:57.272114 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_order_items
[0m00:54:57.273235 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_products
[0m00:54:57.270063 [info ] [Thread-2 (]: 5 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_orders ......... [RUN]
[0m00:54:57.274589 [info ] [Thread-4 (]: 6 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_products ....... [RUN]
[0m00:54:57.276156 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_categories, now model.local_bike.stg_src_local_bike_orders)
[0m00:54:57.278281 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_order_items, now model.local_bike.stg_src_local_bike_products)
[0m00:54:57.279504 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_orders
[0m00:54:57.280598 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_products
[0m00:54:57.289185 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_orders"
[0m00:54:57.294107 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_products"
[0m00:54:57.295598 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_orders (compile): 00:54:57.281163 => 00:54:57.295119
[0m00:54:57.296665 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_products (compile): 00:54:57.289706 => 00:54:57.296145
[0m00:54:57.297325 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_orders
[0m00:54:57.298045 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_products
[0m00:54:57.303210 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_orders"
[0m00:54:57.319172 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_products"
[0m00:54:57.322453 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:57.324396 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (execute): 00:54:56.037571 => 00:54:57.324050
[0m00:54:57.325675 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e5802b1c40>]}
[0m00:54:57.326305 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:54:57.327235 [info ] [Thread-3 (]: 3 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_customers . [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m00:54:57.332889 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_orders: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_orders"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`
  OPTIONS(
      description="""Order headers with key dates and statuses"""
    )
  as select
    order_id as order_id,
    customer_id as customer_id,
    order_status as order_status,
    CAST(order_date as date) as order_date,
    CAST(required_date as date) as required_date,
    CAST(shipped_date as date) as shipped_date,
    store_id as store_id,
    staff_id as staff_id,
    
    CASE
        WHEN EXTRACT(MONTH FROM order_date) IN (12, 1, 2) THEN 'Winter'
        WHEN EXTRACT(MONTH FROM order_date) IN (3, 4, 5) THEN 'Spring'
        WHEN EXTRACT(MONTH FROM order_date) IN (6, 7, 8) THEN 'Summer'
        WHEN EXTRACT(MONTH FROM order_date) IN (9, 10, 11) THEN 'Autumn'
    END
 AS season_name
from `databird-473015`.`src_local_bike`.`orders`;


[0m00:54:57.335548 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_products"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_products`
  OPTIONS(
      description="""Products sold, linked to brands and categories."""
    )
  as select
        product_id as product_id,
        INITCAP(product_name) as product_name,
        brand_id as brand_id,
        category_id as category_id,
        model_year as model_year,
        coalesce(list_price,0) as list_price
from `databird-473015`.`src_local_bike`.`products`;


[0m00:54:57.336659 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_customers
[0m00:54:57.417050 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_staffs
[0m00:54:57.419478 [info ] [Thread-3 (]: 7 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_staffs ......... [RUN]
[0m00:54:57.422790 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_customers, now model.local_bike.stg_src_local_bike_staffs)
[0m00:54:57.424846 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_staffs
[0m00:54:57.429128 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (execute): 00:54:56.117385 => 00:54:57.428438
[0m00:54:57.437517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e583cfe420>]}
[0m00:54:57.440811 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_staffs"
[0m00:54:57.445661 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (compile): 00:54:57.429702 => 00:54:57.444916
[0m00:54:57.439063 [info ] [Thread-1 (]: 1 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_brands .... [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m00:54:57.448617 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_staffs
[0m00:54:57.449967 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_brands
[0m00:54:57.460525 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_stocks
[0m00:54:57.459224 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_staffs"
[0m00:54:57.463847 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:54:57.461741 [info ] [Thread-1 (]: 8 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_stocks ......... [RUN]
[0m00:54:57.466011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_brands, now model.local_bike.stg_src_local_bike_stocks)
[0m00:54:57.470993 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_staffs: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_staffs"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs`
  OPTIONS(
      description="""Sales and management staff working in Local Bike stores."""
    )
  as select
    CAST(staff_id AS int) as staff_id,
    INITCAP(first_name) as staff_first_name,
    INITCAP(last_name) as staff_last_name,
    phone as staff_phone,
    email as staff_email,
    active as staff_active,
    store_id as store_id,
    CAST(manager_id AS int)  as manager_id
from `databird-473015`.`src_local_bike`.`staffs`;


[0m00:54:57.472787 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_stocks
[0m00:54:57.527564 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stocks"
[0m00:54:57.530074 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (compile): 00:54:57.521686 => 00:54:57.529028
[0m00:54:57.538381 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_stocks
[0m00:54:57.555235 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_stocks"
[0m00:54:57.559880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:57.566282 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_stocks: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_stocks"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stocks`
  OPTIONS(
      description="""Stock of products and availability."""
    )
  as select
    store_id   as store_id,
    product_id as product_id,
    quantity   as stock_quantity
from `databird-473015`.`src_local_bike`.`stocks`;


[0m00:54:58.138221 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:c6625630-c1f6-4257-8e96-6c56c92a0d79&page=queryresults
[0m00:54:58.157622 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:23af7af1-e2de-4f0a-9c3a-72ba5b6ed5cc&page=queryresults
[0m00:54:58.174517 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:a31840a8-4200-4ce1-919e-31a627ea971a&page=queryresults
[0m00:54:58.410595 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:2833e530-c046-4f48-837f-dbe75c1b9cfb&page=queryresults
[0m00:54:58.466671 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (execute): 00:54:57.450547 => 00:54:58.466344
[0m00:54:58.467760 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e588131040>]}
[0m00:54:58.468574 [info ] [Thread-3 (]: 7 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_staffs .... [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m00:54:58.469731 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_staffs
[0m00:54:58.470846 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_stores
[0m00:54:58.472020 [info ] [Thread-3 (]: 9 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_stores ......... [RUN]
[0m00:54:58.474884 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_staffs, now model.local_bike.stg_src_local_bike_stores)
[0m00:54:58.475833 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_stores
[0m00:54:58.481268 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stores"
[0m00:54:58.482452 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_stores (compile): 00:54:58.476281 => 00:54:58.482012
[0m00:54:58.483137 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_stores
[0m00:54:58.488540 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_stores"
[0m00:54:58.489733 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:54:58.492769 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_stores: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_stores"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`
  OPTIONS(
      description="""Store locations in California, New York, and Texas."""
    )
  as select
    store_id as store_id,
    INITCAP(store_name) as store_name,
    phone as store_phone,
    email as store_email,
    street as store_street,
    INITCAP(city) as store_city,
    UPPER(state) as store_state,
    zip_code as store_zip_code
from `databird-473015`.`src_local_bike`.`stores`;


[0m00:54:58.538595 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_orders (execute): 00:54:57.298484 => 00:54:58.538212
[0m00:54:58.539818 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e58030ee40>]}
[0m00:54:58.547332 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_products (execute): 00:54:57.303840 => 00:54:58.546073
[0m00:54:58.542472 [info ] [Thread-2 (]: 5 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_orders .... [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m00:54:58.558965 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_orders
[0m00:54:58.562764 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e583cfdc40>]}
[0m00:54:58.564093 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m00:54:58.565327 [info ] [Thread-4 (]: 6 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_products .. [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m00:54:58.570501 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_products
[0m00:54:58.567522 [info ] [Thread-2 (]: 10 of 24 START sql view model dbt_bike_silver.int_src_local_bike_staff_hierarchy  [RUN]
[0m00:54:58.572693 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_product_daily
[0m00:54:58.574669 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_orders, now model.local_bike.int_src_local_bike_staff_hierarchy)
[0m00:54:58.575732 [info ] [Thread-4 (]: 11 of 24 START sql view model dbt_bike_silver.int_src_local_bike_product_daily . [RUN]
[0m00:54:58.577715 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_staff_hierarchy
[0m00:54:58.579129 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_products, now model.local_bike.int_src_local_bike_product_daily)
[0m00:54:58.586751 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_product_daily
[0m00:54:58.610774 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m00:54:58.601219 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_product_daily"
[0m00:54:58.614021 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (compile): 00:54:58.579697 => 00:54:58.613551
[0m00:54:58.614877 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_staff_hierarchy
[0m00:54:58.620234 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m00:54:58.622606 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:58.625291 [debug] [Thread-2 (]: On model.local_bike.int_src_local_bike_staff_hierarchy: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_hierarchy"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy`
  OPTIONS(
      description="""This model provides an hirarchical view of employees. It enriches the store data with the following data:\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each employe.."""
    )
  as ------------------------------------------
  WITH RECURSIVE staff_hierarchy AS (

  -- Niveau 0 : managers racine
  SELECT
    m.staff_id,
    m.staff_first_name,
    m.staff_last_name,
    m.manager_id,
    m.store_id,
    m.staff_first_name || ' ' || m.staff_last_name AS path,
    0 AS level
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs` m
  WHERE m.manager_id IS NULL

  UNION ALL

  -- Niveaux suivants : rattacher les subordonnés
  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,    
    CONCAT(h.path, ' → ', s.staff_first_name, ' ', s.staff_last_name) AS path,
    h.level + 1 AS level
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs` s
  JOIN staff_hierarchy as h ON s.manager_id = h.staff_id
  
)
------------------------------------------
SELECT 
     * 
FROM staff_hierarchy
ORDER BY path, level;


[0m00:54:58.626559 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (compile): 00:54:58.588469 => 00:54:58.626015
[0m00:54:58.665122 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_product_daily
[0m00:54:58.676082 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_product_daily"
[0m00:54:58.677898 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:54:58.685764 [debug] [Thread-4 (]: On model.local_bike.int_src_local_bike_product_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_product_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily`
  OPTIONS(
      description="""This model provides an aggregated view of product items. It enriches the products data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each product.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Product Informations**: Enriches the product with user-specific data, such as brand and category.\r\n\r\nIt provides a comprehensive view of each product, allowing for easy analysis of product performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH order_items AS (
  SELECT 
        order_id as order_id,
        item_id as item_id,
        product_id as product_id,
        quantity as quantity,
        list_price as list_price,
        discount as discount,
        ROUND((discount * 100),2) as discount_percent,
        ROUND(total_item_discount_sold, 2) as total_item_discount_sold 
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
),
------------------------------------------
orders_date AS (
  SELECT 
        order_id, 
        CAST(order_date as date) as order_date,
        store_id,
        season_name,
        EXTRACT(YEAR FROM order_date) as yeardate,
        EXTRACT(YEAR FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`
),
------------------------------------------
products AS (
  SELECT 
        product_id as product_id,
        product_name as product_name,
        brand_id as brand_id,
        category_id as category_id,
        model_year as product_model_year,
        ROUND(list_price,2) as list_price
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_products`
),
------------------------------------------
brands AS (
  SELECT 
        brand_id as brand_id,
        brand_name as brand_name
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
),
------------------------------------------
categories AS (
  SELECT 
        category_id as category_id,
        category_name as category_name
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_categories`
)
------------------------------------------
SELECT
  o.order_id,
  o.store_id,
  o.order_date,
  o.yeardate,
  o.monthday,
  o.yearmonth,
  o.month_2digits,
  o.month_name,
  o.month_abbrev,
  o.week_number,
  o.season_name,
  p.product_id,
  p.product_name,
  b.brand_name,
  c.category_name,
  oi.quantity,
  oi.list_price,
  oi.discount,
  oi.discount_percent,
  SUM(oi.total_item_discount_sold) as total_item_discount_sold,
  COUNT(*) as total_items
FROM orders_date as o
LEFT JOIN order_items as oi ON o.order_id = oi.order_id
LEFT JOIN products as p ON oi.product_id = p.product_id
LEFT JOIN brands as b ON p.brand_id = b.brand_id
LEFT JOIN categories as c ON p.category_id = c.category_id
GROUP BY 
  o.order_id,
  o.store_id,
  o.order_date,
  o.yeardate,
  o.monthday,
  o.yearmonth,
  o.month_2digits,
  o.month_name,
  o.month_abbrev,
  o.week_number,
  o.season_name, 
  p.product_id,
  p.product_name,
  b.brand_name,
  c.category_name,
  oi.quantity,
  oi.list_price,
  oi.discount,
  oi.discount_percent
ORDER BY o.yeardate, o.week_number, o.order_id;


[0m00:54:58.736983 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (execute): 00:54:57.538996 => 00:54:58.736476
[0m00:54:58.741445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e583cd7f80>]}
[0m00:54:58.743843 [info ] [Thread-1 (]: 8 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_stocks .... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m00:54:58.748731 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_stocks
[0m00:54:59.293163 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:dcee70fb-3458-4312-8f81-a78f3576ca66&page=queryresults
[0m00:54:59.467792 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:163cc08b-b75f-41fe-8d1b-8b3d21855982&page=queryresults
[0m00:54:59.507089 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:5721e657-3bee-468b-869f-c42690c498f4&page=queryresults
[0m00:54:59.580285 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_stores (execute): 00:54:58.483474 => 00:54:59.579973
[0m00:54:59.581375 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e5802ea300>]}
[0m00:54:59.582205 [info ] [Thread-3 (]: 9 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_stores .... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m00:54:59.583447 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_stores
[0m00:54:59.585055 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_store_daily
[0m00:54:59.586873 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_store_shipped_order
[0m00:54:59.586047 [info ] [Thread-1 (]: 12 of 24 START sql view model dbt_bike_silver.int_src_local_bike_store_daily ... [RUN]
[0m00:54:59.589606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stocks, now model.local_bike.int_src_local_bike_store_daily)
[0m00:54:59.590461 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_store_daily
[0m00:54:59.587786 [info ] [Thread-3 (]: 13 of 24 START sql view model dbt_bike_silver.int_src_local_bike_store_shipped_order  [RUN]
[0m00:54:59.599239 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_daily"
[0m00:54:59.602999 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stores, now model.local_bike.int_src_local_bike_store_shipped_order)
[0m00:54:59.605025 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_store_shipped_order
[0m00:54:59.612727 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m00:54:59.613783 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (compile): 00:54:59.591115 => 00:54:59.613325
[0m00:54:59.614424 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_store_daily
[0m00:54:59.619370 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_store_daily"
[0m00:54:59.620499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:59.621329 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (compile): 00:54:59.605449 => 00:54:59.620932
[0m00:54:59.622071 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_store_shipped_order
[0m00:54:59.627760 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m00:54:59.631043 [debug] [Thread-1 (]: On model.local_bike.int_src_local_bike_store_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  OPTIONS(
      description="""This model provides an aggregated view of stores. It enriches the store data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each store.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Total Distinct Items**: The count of distinct product types in the order.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_date AS (

  SELECT 
        order_id, 
        order_date,
        shipped_date,
        required_date,
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    o.shipped_date,
    o.required_date,    
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.shipped_date,
    ls.required_date,     
    ls.order_id,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date,ls.shipped_date,ls.required_date, ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m00:54:59.673038 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:54:59.676122 [debug] [Thread-3 (]: On model.local_bike.int_src_local_bike_store_shipped_order: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_shipped_order"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_shipped_order`
  OPTIONS(
      description="""This model provides the list of order required, shipped and aborted per month over 3 years.\r\n\r\nIt provides a comprehensive view of each order, allowing for easy analysis of order performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_shipped_date AS (

  SELECT 
        order_id, 
        order_date,
        required_date,
        shipped_date, 
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    required_date,
    shipped_date,
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_shipped_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.order_id,
    ls.shipped_date ,
    ls.required_date ,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date, ls.shipped_date, ls.required_date,ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m00:54:59.805295 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (execute): 00:54:58.615241 => 00:54:59.804987
[0m00:54:59.806377 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e583c2cda0>]}
[0m00:54:59.807232 [info ] [Thread-2 (]: 10 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_staff_hierarchy  [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m00:54:59.808802 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m00:54:59.809883 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_staff_daily
[0m00:54:59.810760 [info ] [Thread-2 (]: 14 of 24 START sql view model dbt_bike_silver.int_src_local_bike_staff_daily ... [RUN]
[0m00:54:59.812754 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_hierarchy, now model.local_bike.int_src_local_bike_staff_daily)
[0m00:54:59.813527 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_staff_daily
[0m00:54:59.928266 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (execute): 00:54:58.665763 => 00:54:59.927929
[0m00:54:59.931398 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e583c833b0>]}
[0m00:54:59.934097 [info ] [Thread-4 (]: 11 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_product_daily  [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m00:54:59.938958 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_product_daily
[0m00:54:59.955861 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_daily"
[0m00:54:59.957023 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (compile): 00:54:59.813969 => 00:54:59.956627
[0m00:54:59.957596 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_staff_daily
[0m00:54:59.962524 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_staff_daily"
[0m00:54:59.963505 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:59.965810 [debug] [Thread-2 (]: On model.local_bike.int_src_local_bike_staff_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  OPTIONS(
      description="""This model provides an aggregated view of staffs and stores. It enriches the store and staff data with the following metrics:\r\n- **Total item Amount**: The sum of all order items for each employe.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each store and staffs, allowing for easy analysis of store performance, employee performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH staff_list AS (

  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,
    s.path,
    s.level
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy` s

),
------------------------------------------
sales_by_employee AS (

  SELECT
    o.order_date as order_date,
    o.season_name,
    EXTRACT(YEAR FROM o.order_date) as yeardate,
    EXTRACT(YEAR FROM o.order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') AS yearmonth,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM o.order_date) AS STRING), 2, '0') AS monthday,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') as month_2digits,
    FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_name,
    FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_abbrev,
    LPAD(CAST(EXTRACT(ISOWEEK FROM o.order_date) AS STRING), 2, '0') AS week_number,
    o.staff_id,
    oi.total_item_discount_sold as total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders` as o
  LEFT JOIN `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items` as oi ON o.order_id = oi.order_id

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

)
------------------------------------------
SELECT 
    em.order_date,
    em.yeardate,
    em.monthday,
    em.yearmonth,
    em.month_2digits,
    em.month_name,
    em.month_abbrev,
    em.week_number,
    em.season_name,
    st.store_name,
    m.store_latitude,
    m.store_longitude,    
    st.store_city,
    st.store_state,    
    ROUND(em.total_item_discount_sold, 2) as total_item_sold_staff,
    s.*
FROM sales_by_employee as em 
JOIN staff_list as s ON em.staff_id = s.staff_id
LEFT JOIN map as m on s.store_id = m.store_id
LEFT JOIN stores as st on m.store_id = st.store_id
ORDER BY em.order_date;


[0m00:55:00.357752 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:99525364-cbea-4896-915d-880c2aa74cdd&page=queryresults
[0m00:55:00.433858 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:21b07b5b-bb43-47dd-a70d-99769e7b1d3a&page=queryresults
[0m00:55:00.687986 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (execute): 00:54:59.622431 => 00:55:00.687662
[0m00:55:00.689109 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e588130260>]}
[0m00:55:00.689960 [info ] [Thread-3 (]: 13 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_store_shipped_order  [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m00:55:00.691155 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_store_shipped_order
[0m00:55:00.740709 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (execute): 00:54:59.614815 => 00:55:00.740352
[0m00:55:00.741833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e58033c2c0>]}
[0m00:55:00.742925 [info ] [Thread-1 (]: 12 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_store_daily  [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m00:55:00.745173 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_store_daily
[0m00:55:00.746753 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_order_shipped_aborted_montly
[0m00:55:00.747776 [info ] [Thread-4 (]: 15 of 24 START sql table model dbt_bike_gold.orders_shipped_aborted_monthly_report  [RUN]
[0m00:55:00.748972 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_order_shipped_montly
[0m00:55:00.750714 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_product_daily, now model.local_bike.mrt_order_shipped_aborted_montly)
[0m00:55:00.751367 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_products_ranking_yearly_top3
[0m00:55:00.752194 [info ] [Thread-3 (]: 16 of 24 START sql table model dbt_bike_gold.orders_shipped_monthly_report ..... [RUN]
[0m00:55:00.753538 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_order_shipped_aborted_montly
[0m00:55:00.754642 [info ] [Thread-1 (]: 17 of 24 START sql table model dbt_bike_gold.products_stores_ranking_yearly_report  [RUN]
[0m00:55:00.757072 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_shipped_order, now model.local_bike.mrt_order_shipped_montly)
[0m00:55:00.763066 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m00:55:00.764160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_daily, now model.local_bike.mrt_products_ranking_yearly_top3)
[0m00:55:00.765084 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_order_shipped_montly
[0m00:55:00.765852 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_products_ranking_yearly_top3
[0m00:55:00.771335 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_montly"
[0m00:55:00.778576 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m00:55:00.780170 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (compile): 00:55:00.757549 => 00:55:00.779724
[0m00:55:00.780926 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_order_shipped_aborted_montly
[0m00:55:00.781807 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (compile): 00:55:00.772349 => 00:55:00.781430
[0m00:55:00.788026 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_order_shipped_montly (compile): 00:55:00.766444 => 00:55:00.787524
[0m00:55:00.803074 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:55:00.804220 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_products_ranking_yearly_top3
[0m00:55:00.806328 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:ab244b84-db3b-46b9-a32a-355c05c4ee44&page=queryresults
[0m00:55:00.807122 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_order_shipped_montly
[0m00:55:00.811217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:00.860371 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:55:01.155165 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m00:55:01.158267 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m00:55:01.159302 [debug] [Thread-1 (]: On model.local_bike.mrt_products_ranking_yearly_top3: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_ranking_yearly_top3"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`products_stores_ranking_yearly_report`
    
    

    OPTIONS(
      description="""This model provides the top 3 **best-selling products** per year over 3 years.\r\n\r\nIt provides a comprehensive view of each product, allowing for easy analysis of products performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH product_sales AS (
  SELECT
    p.yeardate AS year,
    s.store_name AS store,
    p.product_name,
    p.brand_name,
    ROUND(SUM(total_item_discount_sold), 2) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily` AS p
  LEFT JOIN `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`AS s
    ON p.order_id = s.order_id 
   AND p.store_id = s.store_id
  GROUP BY year,store,product_name,brand_name
)
------------------------------------------
SELECT
  year,
  store,
  product_name,
  brand_name,
  total_sales
FROM (
  SELECT
    *,
    RANK() OVER ( PARTITION BY year, store ORDER BY total_sales DESC ) AS rank_product
  FROM product_sales
)
WHERE rank_product <= 3
ORDER BY year, store
------------------------------------------
    );
  
[0m00:55:01.161161 [debug] [Thread-4 (]: On model.local_bike.mrt_order_shipped_aborted_montly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_order_shipped_aborted_montly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`orders_shipped_aborted_monthly_report`
    
    

    OPTIONS(
      description="""This model provides an aggregated view of the canceled orders. It enriches the order data with the following metrics:\r\n- **nb_shipped_aborted**: The quantity of order aborted.\r\n- **total_aborted_sales**: The cost of aborted orders.\r\n- **Order Informations**: Enriches the product with user-specific data, such as store name.\r\n\r\nIt provides a comprehensive view the aborted order, allowing for easy analysis of order performance."""
    )
    as (
      ------------------------------------------

------------------------------------------

WITH total_aborted_orders AS (

  SELECT
    yearmonth AS month,
    COUNTIF(shipped_date IS NULL) AS nb_shipped_aborted,
    ROUND(SUM(total_sales_amount),2) as total_aborted_sales,
    store_name
  FROM  `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  WHERE shipped_date is null
  GROUP BY month,store_name

)
------------------------------------------
SELECT *
FROM total_aborted_orders
------------------------------------------
    );
  
[0m00:55:01.166234 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.mrt_order_shipped_montly"
[0m00:55:01.167590 [debug] [Thread-3 (]: On model.local_bike.mrt_order_shipped_montly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_order_shipped_montly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`orders_shipped_monthly_report`
    
    

    OPTIONS(
      description="""This model provides an aggregated view of the orders sent. It enriches the order data with the following metrics:\r\n- **nb_order_shipped**: The quantity of orders shipped.\r\n- **total_sales**: The cost of orders shipped.\r\n- **Order Informations**: Enriches the product with user-specific data, such as store name.\r\n\r\nIt provides a comprehensive view the aborted order, allowing for easy analysis of order performance."""
    )
    as (
      ------------------------------------------

------------------------------------------

WITH total_orders AS (

  SELECT
    yearmonth AS month,
    COUNT(order_date) AS nb_order_shipped,
    ROUND(SUM(total_sales_amount),2) as total_sales,
    store_name
  FROM  `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  WHERE shipped_date is not null
  GROUP BY month,store_name

)
------------------------------------------
SELECT *
FROM total_orders
------------------------------------------
    );
  
[0m00:55:01.196481 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (execute): 00:54:59.957909 => 00:55:01.196147
[0m00:55:01.197596 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e583c81580>]}
[0m00:55:01.198400 [info ] [Thread-2 (]: 14 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_staff_daily  [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m00:55:01.199740 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_staff_daily
[0m00:55:01.201017 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_sales_seasons_yearly
[0m00:55:01.202160 [info ] [Thread-2 (]: 18 of 24 START sql table model dbt_bike_gold.sales_seasons_yearly_report ....... [RUN]
[0m00:55:01.205394 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_daily, now model.local_bike.mrt_sales_seasons_yearly)
[0m00:55:01.206299 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_sales_seasons_yearly
[0m00:55:01.212826 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_sales_seasons_yearly"
[0m00:55:01.214041 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (compile): 00:55:01.206888 => 00:55:01.213625
[0m00:55:01.214663 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_sales_seasons_yearly
[0m00:55:01.218838 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:55:01.438131 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_sales_seasons_yearly"
[0m00:55:01.439054 [debug] [Thread-2 (]: On model.local_bike.mrt_sales_seasons_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_sales_seasons_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`sales_seasons_yearly_report`
    
    

    OPTIONS(
      description="""This model provides the **top-performing store by season** and per year over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH sales_stores_seasons AS (

  SELECT
    yeardate AS year,
    store_name AS store,
    season_name,
    ROUND(SUM(total_sales_amount), 2) AS sales_amount
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year,store,season_name

)

SELECT *
FROM sales_stores_seasons
PIVOT (
  SUM(sales_amount) AS sales
  FOR season_name IN ('Winter','Spring','Summer','Autumn')
)
ORDER BY year, store
------------------------------------------
    );
  
[0m00:55:03.880351 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:fdb85ba3-f43c-4796-9a85-691400403f09&page=queryresults
[0m00:55:03.956962 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:8986a006-f169-4680-b541-622b3d9ea9aa&page=queryresults
[0m00:55:04.150085 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (execute): 00:55:00.782292 => 00:55:04.149756
[0m00:55:04.151230 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e580357da0>]}
[0m00:55:04.152115 [info ] [Thread-4 (]: 15 of 24 OK created sql table model dbt_bike_gold.orders_shipped_aborted_monthly_report  [[32mCREATE TABLE (38.0 rows, 215.1 KiB processed)[0m in 3.40s]
[0m00:55:04.153558 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_order_shipped_aborted_montly
[0m00:55:04.154682 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_stores_items_monthly
[0m00:55:04.156095 [info ] [Thread-4 (]: 19 of 24 START sql table model dbt_bike_gold.items_stores_monthly_report ....... [RUN]
[0m00:55:04.157998 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_aborted_montly, now model.local_bike.mrt_stores_items_monthly)
[0m00:55:04.159154 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_stores_items_monthly
[0m00:55:04.167586 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_stores_items_monthly"
[0m00:55:04.168794 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_items_monthly (compile): 00:55:04.159651 => 00:55:04.168353
[0m00:55:04.169386 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_stores_items_monthly
[0m00:55:04.173220 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:55:04.269438 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_order_shipped_montly (execute): 00:55:00.814852 => 00:55:04.268875
[0m00:55:04.270941 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e583c8b2c0>]}
[0m00:55:04.271945 [info ] [Thread-3 (]: 16 of 24 OK created sql table model dbt_bike_gold.orders_shipped_monthly_report  [[32mCREATE TABLE (81.0 rows, 215.1 KiB processed)[0m in 3.52s]
[0m00:55:04.273269 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_order_shipped_montly
[0m00:55:04.275847 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_stores_ranking_yearly
[0m00:55:04.276997 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:55ff68d2-36ea-46c7-8c99-7b1b539f363e&page=queryresults
[0m00:55:04.278691 [info ] [Thread-3 (]: 20 of 24 START sql table model dbt_bike_gold.stores_ranking_yearly_report ...... [RUN]
[0m00:55:04.284849 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_montly, now model.local_bike.mrt_stores_ranking_yearly)
[0m00:55:04.286203 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_stores_ranking_yearly
[0m00:55:04.292354 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_stores_ranking_yearly"
[0m00:55:04.293565 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (compile): 00:55:04.286854 => 00:55:04.293152
[0m00:55:04.294163 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_stores_ranking_yearly
[0m00:55:04.310267 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:55:04.390446 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.mrt_stores_items_monthly"
[0m00:55:04.391956 [debug] [Thread-4 (]: On model.local_bike.mrt_stores_items_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_items_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`items_stores_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **total number of items sold** per store over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT *
FROM (

  SELECT
    yeardate AS year,
    month_2digits as month,
    store_name,
    COUNT(total_items) AS nb_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year, month, store_name

)
PIVOT (

  SUM(nb_items) AS total_items
  FOR store_name IN ('Santa Cruz Bikes','Baldwin Bikes','Rowlett Bikes')

)
ORDER BY year, month
------------------------------------------
    );
  
[0m00:55:04.456778 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:cf8369be-ebd1-4dc6-92f6-512134031667&page=queryresults
[0m00:55:04.500521 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.mrt_stores_ranking_yearly"
[0m00:55:04.501499 [debug] [Thread-3 (]: On model.local_bike.mrt_stores_ranking_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_ranking_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`stores_ranking_yearly_report`
    
    

    OPTIONS(
      description="""This model provides **the ranking of best stores** over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT
  yeardate AS year_date,
  store_name,
  store_latitude,
  store_longitude,
  ROUND(SUM(total_sales_amount), 2) AS total_sales,
  RANK() OVER (PARTITION BY yeardate ORDER BY SUM(total_sales_amount) DESC) AS store_rank
FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
GROUP BY yeardate, store_name,store_latitude,store_longitude
ORDER BY yeardate, store_rank
------------------------------------------
    );
  
[0m00:55:04.586717 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (execute): 00:55:01.214976 => 00:55:04.586331
[0m00:55:04.587875 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e583c2d8e0>]}
[0m00:55:04.588736 [info ] [Thread-2 (]: 18 of 24 OK created sql table model dbt_bike_gold.sales_seasons_yearly_report .. [[32mCREATE TABLE (9.0 rows, 215.1 KiB processed)[0m in 3.38s]
[0m00:55:04.589991 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_sales_seasons_yearly
[0m00:55:04.590938 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_stores_sales_monthly
[0m00:55:04.591658 [info ] [Thread-2 (]: 21 of 24 START sql table model dbt_bike_gold.sales_stores_monthly_report ....... [RUN]
[0m00:55:04.593234 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_sales_seasons_yearly, now model.local_bike.mrt_stores_sales_monthly)
[0m00:55:04.593988 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_stores_sales_monthly
[0m00:55:04.602521 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_stores_sales_monthly"
[0m00:55:04.603773 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (compile): 00:55:04.594400 => 00:55:04.603299
[0m00:55:04.604388 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_stores_sales_monthly
[0m00:55:04.608727 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:55:04.762478 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (execute): 00:55:00.807704 => 00:55:04.762059
[0m00:55:04.763626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e583c89430>]}
[0m00:55:04.764470 [info ] [Thread-1 (]: 17 of 24 OK created sql table model dbt_bike_gold.products_stores_ranking_yearly_report  [[32mCREATE TABLE (27.0 rows, 270.5 KiB processed)[0m in 4.00s]
[0m00:55:04.765697 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_products_ranking_yearly_top3
[0m00:55:04.767036 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_products_brands_monthly
[0m00:55:04.767935 [info ] [Thread-1 (]: 22 of 24 START sql table model dbt_bike_gold.products_brands_monthly_report .... [RUN]
[0m00:55:04.769885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_products_ranking_yearly_top3, now model.local_bike.mrt_products_brands_monthly)
[0m00:55:04.770647 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_products_brands_monthly
[0m00:55:04.787459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:04.790017 [debug] [Thread-1 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m00:55:04.837614 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_stores_sales_monthly"
[0m00:55:04.839029 [debug] [Thread-2 (]: On model.local_bike.mrt_stores_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_sales_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`sales_stores_monthly_report`
    
    

    OPTIONS(
      description="""This model provides **top sales by store** over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT *
FROM (

  SELECT
    yeardate AS year,
    month_2digits as month,
    store_name,
    ROUND(SUM(total_sales_amount), 2) AS sales_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year, month, store_name

)
PIVOT (

  SUM(sales_items) AS total_sales
  FOR store_name IN ('Santa Cruz Bikes','Baldwin Bikes','Rowlett Bikes')

)
ORDER BY year, month
------------------------------------------
    );
  
[0m00:55:06.880829 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:87d35fe9-586e-4be8-aafe-759ab5db8e29&page=queryresults
[0m00:55:06.988719 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:a43f4a69-9a0c-4424-846c-331b7b14cf11&page=queryresults
[0m00:55:06.989945 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_products_brands_monthly"
[0m00:55:06.991017 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_products_brands_monthly (compile): 00:55:04.771501 => 00:55:06.990623
[0m00:55:06.991786 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_products_brands_monthly
[0m00:55:07.027181 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:fc9edf6e-4d05-4a14-89a6-977b77900fa2&page=queryresults
[0m00:55:07.120071 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.mrt_products_brands_monthly"
[0m00:55:07.121041 [debug] [Thread-1 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`products_brands_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **best-selling brands** per month over 3 years.\r\n\r\nIt provides a comprehensive view of each brand, allowing for easy analysis of brands performance."""
    )
    as (
      ------------------------------------------

------------------------------------------


------------------------------------------
SELECT *
FROM (

  SELECT
    yearmonth AS month,
    brand_name as Brand,    
    ROUND(SUM(total_item_discount_sold), 2 ) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily`
  GROUP BY month, brand

)
PIVOT (

  SUM(total_sales) AS sales
  FOR month IN ( '2016-01','2016-02','2016-03','2016-04','2016-05','2016-06','2016-07','2016-08','2016-09','2016-10','2016-11','2016-12','2017-01','2017-02','2017-03','2017-04','2017-05','2017-06','2017-07','2017-08','2017-09','2017-10','2017-11','2017-12','2018-01','2018-02','2018-03','2018-04','2018-06','2018-07','2018-08','2018-09','2018-10','2018-11','2018-12' )

)
ORDER BY Brand
------------------------------------------
    );
  
[0m00:55:07.179003 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_items_monthly (execute): 00:55:04.169717 => 00:55:07.178481
[0m00:55:07.180766 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e58033c0b0>]}
[0m00:55:07.182009 [info ] [Thread-4 (]: 19 of 24 OK created sql table model dbt_bike_gold.items_stores_monthly_report .. [[32mCREATE TABLE (35.0 rows, 104.5 KiB processed)[0m in 3.02s]
[0m00:55:07.183544 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_stores_items_monthly
[0m00:55:07.184903 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_staff_ranking_yearly
[0m00:55:07.186605 [info ] [Thread-4 (]: 23 of 24 START sql table model dbt_bike_gold.ranking_sales_staffs_yearly_top3_report  [RUN]
[0m00:55:07.191490 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_items_monthly, now model.local_bike.mrt_staff_ranking_yearly)
[0m00:55:07.193371 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_staff_ranking_yearly
[0m00:55:07.202889 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_staff_ranking_yearly"
[0m00:55:07.204245 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (compile): 00:55:07.194173 => 00:55:07.203763
[0m00:55:07.205097 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_staff_ranking_yearly
[0m00:55:07.213683 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:55:07.341037 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (execute): 00:55:04.294463 => 00:55:07.340729
[0m00:55:07.342113 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e58033c530>]}
[0m00:55:07.342949 [info ] [Thread-3 (]: 20 of 24 OK created sql table model dbt_bike_gold.stores_ranking_yearly_report . [[32mCREATE TABLE (9.0 rows, 215.1 KiB processed)[0m in 3.06s]
[0m00:55:07.344090 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_stores_ranking_yearly
[0m00:55:07.345190 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_staff_sales_monthly
[0m00:55:07.346036 [info ] [Thread-3 (]: 24 of 24 START sql table model dbt_bike_gold.staffs_sales_monthly_report ....... [RUN]
[0m00:55:07.347441 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_ranking_yearly, now model.local_bike.mrt_staff_sales_monthly)
[0m00:55:07.348446 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_staff_sales_monthly
[0m00:55:07.357936 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:55:07.360238 [debug] [Thread-3 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m00:55:07.450620 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.mrt_staff_ranking_yearly"
[0m00:55:07.452019 [debug] [Thread-4 (]: On model.local_bike.mrt_staff_ranking_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_ranking_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`ranking_sales_staffs_yearly_top3_report`
    
    

    OPTIONS(
      description="""This model provides **Top seller** per store and per year over 3 years.\r\n\r\nIt provides a comprehensive view of each seller, allowing for easy analysis of seller performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH sales_staffs_stores AS (

  SELECT
    yeardate AS year,
    staff_first_name || '-' || staff_last_name || ' ('|| store_name || ')' AS staff_name,
    ROUND(SUM(total_item_sold_staff), 2) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  GROUP BY year, staff_name

)
SELECT
  year,
  staff_name,
  total_sales
FROM (
  SELECT
    *,
    RANK() OVER (PARTITION BY year ORDER BY total_sales DESC) AS rank_sales
  FROM sales_staffs_stores
)
WHERE rank_sales <= 3 
ORDER BY year, total_sales
    );
  
[0m00:55:07.602976 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:6ab3a7e3-c6ff-4339-b67e-492c0154cea4&page=queryresults
[0m00:55:07.871895 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (execute): 00:55:04.604688 => 00:55:07.871332
[0m00:55:07.873640 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e583c5ba10>]}
[0m00:55:07.874962 [info ] [Thread-2 (]: 21 of 24 OK created sql table model dbt_bike_gold.sales_stores_monthly_report .. [[32mCREATE TABLE (35.0 rows, 215.1 KiB processed)[0m in 3.28s]
[0m00:55:07.876686 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_stores_sales_monthly
[0m00:55:09.445369 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:561419a3-14cb-4703-91d4-c26f72979086&page=queryresults
[0m00:55:09.446463 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_staff_sales_monthly"
[0m00:55:09.447387 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (compile): 00:55:07.349178 => 00:55:09.447046
[0m00:55:09.447928 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_staff_sales_monthly
[0m00:55:09.570188 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.mrt_staff_sales_monthly"
[0m00:55:09.571150 [debug] [Thread-3 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`staffs_sales_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **best-seller** per month over 3 years.\r\n\r\nIt provides a comprehensive view of each seller, allowing for easy analysis of sellers performance."""
    )
    as (
      ------------------------------------------

------------------------------------------


------------------------------------------
SELECT *
FROM (

  SELECT
    staff_first_name || '-' || staff_last_name AS staff_name,
    yearmonth AS month,
    ROUND(SUM(total_item_sold_staff), 2 ) AS total_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  GROUP BY month, staff_name

)
PIVOT (

  SUM(total_items) AS sales
  FOR month IN ( '2016-01','2016-02','2016-03','2016-04','2016-05','2016-06','2016-07','2016-08','2016-09','2016-10','2016-11','2016-12','2017-01','2017-02','2017-03','2017-04','2017-05','2017-06','2017-07','2017-08','2017-09','2017-10','2017-11','2017-12','2018-01','2018-02','2018-03','2018-04','2018-06','2018-07','2018-08','2018-09','2018-10','2018-11','2018-12' )

)
ORDER BY staff_name
------------------------------------------
    );
  
[0m00:55:09.587096 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:cff2e8b1-5dd3-4028-9947-281c9d883783&page=queryresults
[0m00:55:09.853146 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_products_brands_monthly (execute): 00:55:06.992275 => 00:55:09.852825
[0m00:55:09.854282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e580372510>]}
[0m00:55:09.855154 [info ] [Thread-1 (]: 22 of 24 OK created sql table model dbt_bike_gold.products_brands_monthly_report  [[32mCREATE TABLE (9.0 rows, 217.4 KiB processed)[0m in 5.09s]
[0m00:55:09.856475 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_products_brands_monthly
[0m00:55:13.378035 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:8776763b-ac57-42ed-ae6e-8a29c6b13bfe&page=queryresults
[0m00:55:13.705043 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (execute): 00:55:09.448263 => 00:55:13.704723
[0m00:55:13.706132 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e583c593a0>]}
[0m00:55:13.929831 [info ] [Thread-3 (]: 24 of 24 OK created sql table model dbt_bike_gold.staffs_sales_monthly_report .. [[32mCREATE TABLE (6.0 rows, 185.8 KiB processed)[0m in 6.36s]
[0m00:55:13.931573 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_staff_sales_monthly
[0m00:55:21.061509 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:403724cb-d42b-42ad-8987-0f6593612bd4&page=queryresults
[0m00:55:21.347354 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (execute): 00:55:07.205595 => 00:55:21.347048
[0m00:55:21.348577 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e036ed1-17e6-4ab2-9ba9-9b3d082c0a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e583c91e80>]}
[0m00:55:21.349428 [info ] [Thread-4 (]: 23 of 24 OK created sql table model dbt_bike_gold.ranking_sales_staffs_yearly_top3_report  [[32mCREATE TABLE (9.0 rows, 185.9 KiB processed)[0m in 14.16s]
[0m00:55:21.350777 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_staff_ranking_yearly
[0m00:55:21.355380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:21.355953 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_ranking_yearly' was properly closed.
[0m00:55:21.356273 [debug] [MainThread]: Connection 'model.local_bike.mrt_products_brands_monthly' was properly closed.
[0m00:55:21.356620 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_sales_monthly' was properly closed.
[0m00:55:21.356904 [debug] [MainThread]: Connection 'model.local_bike.mrt_stores_sales_monthly' was properly closed.
[0m00:55:21.357370 [info ] [MainThread]: 
[0m00:55:21.358274 [info ] [MainThread]: Finished running 14 view models, 10 table models in 0 hours 0 minutes and 26.55 seconds (26.55s).
[0m00:55:21.367915 [debug] [MainThread]: Command end result
[0m00:55:21.398720 [info ] [MainThread]: 
[0m00:55:21.399599 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:55:21.400358 [info ] [MainThread]: 
[0m00:55:21.401243 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 TOTAL=24
[0m00:55:21.402748 [debug] [MainThread]: Command `dbt run` succeeded at 00:55:21.402474 after 28.38 seconds
[0m00:55:21.403472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e59e8f3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e59c4a6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e5803029f0>]}
[0m00:55:21.404343 [debug] [MainThread]: Flushing usage events
[0m00:55:28.100546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c4aeb6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c4b11abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c4b1a0bf0>]}


============================== 00:55:28.106756 | 44176676-aa3e-495a-83ed-51a8399e08ce ==============================
[0m00:55:28.106756 [info ] [MainThread]: Running with dbt=1.5.0
[0m00:55:28.107763 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'target_path': 'None', 'version_check': 'True', 'static_parser': 'True', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'printer_width': '80', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'write_json': 'True'}
[0m00:55:29.604317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44176676-aa3e-495a-83ed-51a8399e08ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c3352abd0>]}
[0m00:55:29.627798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44176676-aa3e-495a-83ed-51a8399e08ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c394e13a0>]}
[0m00:55:29.677651 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m00:55:29.758419 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:55:29.758970 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:55:29.769222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44176676-aa3e-495a-83ed-51a8399e08ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c39c3a090>]}
[0m00:55:29.794011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44176676-aa3e-495a-83ed-51a8399e08ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c32d6be60>]}
[0m00:55:29.794739 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m00:55:29.795446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44176676-aa3e-495a-83ed-51a8399e08ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c4aeb7fb0>]}
[0m00:55:29.798732 [info ] [MainThread]: 
[0m00:55:29.800448 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:55:29.803840 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m00:55:29.804740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:29.805914 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m00:55:29.807473 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m00:55:29.808576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:29.808019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:29.850229 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m00:55:29.929376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:30.207739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44176676-aa3e-495a-83ed-51a8399e08ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c33c7a870>]}
[0m00:55:30.208970 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:55:30.209628 [info ] [MainThread]: 
[0m00:55:30.218036 [debug] [Thread-1 (]: Began running node test.local_bike.assert_total_order_amount_is_positive
[0m00:55:30.218813 [info ] [Thread-1 (]: 1 of 1 START test assert_total_order_amount_is_positive ........................ [RUN]
[0m00:55:30.220335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now test.local_bike.assert_total_order_amount_is_positive)
[0m00:55:30.221144 [debug] [Thread-1 (]: Began compiling node test.local_bike.assert_total_order_amount_is_positive
[0m00:55:30.228307 [debug] [Thread-1 (]: Writing injected SQL for node "test.local_bike.assert_total_order_amount_is_positive"
[0m00:55:30.229448 [debug] [Thread-1 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (compile): 00:55:30.221609 => 00:55:30.229053
[0m00:55:30.229999 [debug] [Thread-1 (]: Began executing node test.local_bike.assert_total_order_amount_is_positive
[0m00:55:30.260320 [debug] [Thread-1 (]: Writing runtime sql for node "test.local_bike.assert_total_order_amount_is_positive"
[0m00:55:30.261324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:30.263499 [debug] [Thread-1 (]: On test.local_bike.assert_total_order_amount_is_positive: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "test.local_bike.assert_total_order_amount_is_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Refunds have a negative amount, so the total amount should always be >= 0.
-- Therefore return records where total_amount < 0 to make the test fail
select
    order_id,
    sum(total_item_discount_sold) as total_amount  
from `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
group by 1
having total_amount < 0
      
    ) dbt_internal_test
[0m00:55:31.278330 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:e84d7734-aa1a-4683-b61b-81a95a78c725&page=queryresults
[0m00:55:31.280627 [debug] [Thread-1 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (execute): 00:55:30.230280 => 00:55:31.280208
[0m00:55:31.281906 [info ] [Thread-1 (]: 1 of 1 PASS assert_total_order_amount_is_positive .............................. [[32mPASS[0m in 1.06s]
[0m00:55:31.283190 [debug] [Thread-1 (]: Finished running node test.local_bike.assert_total_order_amount_is_positive
[0m00:55:31.287714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:31.288374 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_seeds' was properly closed.
[0m00:55:31.288893 [debug] [MainThread]: Connection 'test.local_bike.assert_total_order_amount_is_positive' was properly closed.
[0m00:55:31.289253 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_bronze' was properly closed.
[0m00:55:31.289663 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_gold' was properly closed.
[0m00:55:31.290055 [info ] [MainThread]: 
[0m00:55:31.290722 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m00:55:31.291984 [debug] [MainThread]: Command end result
[0m00:55:31.327968 [info ] [MainThread]: 
[0m00:55:31.329281 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:55:31.330633 [info ] [MainThread]: 
[0m00:55:31.331853 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:55:31.333552 [debug] [MainThread]: Command `dbt test` succeeded at 00:55:31.333099 after 3.24 seconds
[0m00:55:31.334270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c4b5e6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c4ae0ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c4ae0a420>]}
[0m00:55:31.335242 [debug] [MainThread]: Flushing usage events
[0m00:55:37.568969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b64dba000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b653cbf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b652faf90>]}


============================== 00:55:37.574884 | 260cc0da-988f-48d6-ae38-2016072e3252 ==============================
[0m00:55:37.574884 [info ] [MainThread]: Running with dbt=1.5.0
[0m00:55:37.576137 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'introspect': 'True', 'printer_width': '80', 'write_json': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'quiet': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_format': 'default'}
[0m00:55:39.018278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '260cc0da-988f-48d6-ae38-2016072e3252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b53ce7050>]}
[0m00:55:39.041877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '260cc0da-988f-48d6-ae38-2016072e3252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b51296300>]}
[0m00:55:39.121988 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m00:55:39.254282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:55:39.255097 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:55:39.271391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '260cc0da-988f-48d6-ae38-2016072e3252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b51299b80>]}
[0m00:55:39.279695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '260cc0da-988f-48d6-ae38-2016072e3252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b510fcce0>]}
[0m00:55:39.280743 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m00:55:39.281601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '260cc0da-988f-48d6-ae38-2016072e3252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b51348ef0>]}
[0m00:55:39.290865 [info ] [MainThread]: 
[0m00:55:39.293975 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:55:39.300105 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m00:55:39.301311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:39.303020 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m00:55:39.308911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:39.308037 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m00:55:39.361139 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m00:55:39.401219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:39.402011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:39.725834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '260cc0da-988f-48d6-ae38-2016072e3252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b510fc950>]}
[0m00:55:39.727001 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:55:39.727926 [info ] [MainThread]: 
[0m00:55:39.737086 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_brands
[0m00:55:39.737900 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_categories
[0m00:55:39.738607 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_customers
[0m00:55:39.739808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.stg_src_local_bike_brands)
[0m00:55:39.740391 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_order_items
[0m00:55:39.741511 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.stg_src_local_bike_categories)
[0m00:55:39.742483 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.stg_src_local_bike_customers)
[0m00:55:39.743054 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_brands
[0m00:55:39.744025 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.stg_src_local_bike_order_items)
[0m00:55:39.744613 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_categories
[0m00:55:39.745134 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_customers
[0m00:55:39.751169 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_brands"
[0m00:55:39.751850 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_order_items
[0m00:55:39.759999 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_customers"
[0m00:55:39.770730 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_order_items"
[0m00:55:39.778042 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (compile): 00:55:39.745531 => 00:55:39.777537
[0m00:55:39.778763 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_brands
[0m00:55:39.781328 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (execute): 00:55:39.780705 => 00:55:39.780753
[0m00:55:39.782940 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_brands
[0m00:55:39.790234 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_orders
[0m00:55:39.791626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_brands, now model.local_bike.stg_src_local_bike_orders)
[0m00:55:39.794637 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_categories"
[0m00:55:39.795696 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_orders
[0m00:55:39.796504 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (compile): 00:55:39.755391 => 00:55:39.796121
[0m00:55:39.797381 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (compile): 00:55:39.763815 => 00:55:39.797029
[0m00:55:39.803548 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_customers
[0m00:55:39.805599 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_orders"
[0m00:55:39.806525 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (compile): 00:55:39.752303 => 00:55:39.806106
[0m00:55:39.807108 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_order_items
[0m00:55:39.807876 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (execute): 00:55:39.807534 => 00:55:39.807562
[0m00:55:39.810823 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_customers
[0m00:55:39.808588 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_categories
[0m00:55:39.809316 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (execute): 00:55:39.809006 => 00:55:39.809022
[0m00:55:39.811469 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_products
[0m00:55:39.812209 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (execute): 00:55:39.811878 => 00:55:39.811897
[0m00:55:39.813284 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (compile): 00:55:39.797917 => 00:55:39.812947
[0m00:55:39.815000 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_order_items
[0m00:55:39.815981 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_customers, now model.local_bike.stg_src_local_bike_products)
[0m00:55:39.817342 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_categories
[0m00:55:39.817910 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_orders
[0m00:55:39.818600 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_staffs
[0m00:55:39.819269 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_products
[0m00:55:39.820067 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_stocks
[0m00:55:39.820886 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (execute): 00:55:39.820562 => 00:55:39.820580
[0m00:55:39.821880 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_order_items, now model.local_bike.stg_src_local_bike_staffs)
[0m00:55:39.826689 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_products"
[0m00:55:39.827820 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_categories, now model.local_bike.stg_src_local_bike_stocks)
[0m00:55:39.829321 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_orders
[0m00:55:39.829901 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_staffs
[0m00:55:39.830571 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_stocks
[0m00:55:39.831280 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_stores
[0m00:55:39.836304 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_staffs"
[0m00:55:39.837108 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_products (compile): 00:55:39.822271 => 00:55:39.836741
[0m00:55:39.841647 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stocks"
[0m00:55:39.843151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_orders, now model.local_bike.stg_src_local_bike_stores)
[0m00:55:39.844047 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_products
[0m00:55:39.845123 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (compile): 00:55:39.831927 => 00:55:39.844760
[0m00:55:39.845872 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (compile): 00:55:39.837545 => 00:55:39.845474
[0m00:55:39.846443 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_stores
[0m00:55:39.847188 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_products (execute): 00:55:39.846825 => 00:55:39.846845
[0m00:55:39.847741 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_staffs
[0m00:55:39.848274 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_stocks
[0m00:55:39.853021 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stores"
[0m00:55:39.854596 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_products
[0m00:55:39.855356 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (execute): 00:55:39.855006 => 00:55:39.855025
[0m00:55:39.856084 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (execute): 00:55:39.855756 => 00:55:39.855774
[0m00:55:39.856915 [debug] [Thread-3 (]: Began running node seed.local_bike.map
[0m00:55:39.858682 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_staffs
[0m00:55:39.859605 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_stores (compile): 00:55:39.848656 => 00:55:39.859237
[0m00:55:39.861021 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_stocks
[0m00:55:39.861987 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_products, now seed.local_bike.map)
[0m00:55:39.862672 [debug] [Thread-4 (]: Began running node seed.local_bike.seasons
[0m00:55:39.863342 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_stores
[0m00:55:39.864146 [debug] [Thread-2 (]: Began running node test.local_bike.assert_total_order_amount_is_positive
[0m00:55:39.864774 [debug] [Thread-3 (]: Began compiling node seed.local_bike.map
[0m00:55:39.865748 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_staffs, now seed.local_bike.seasons)
[0m00:55:39.866477 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_stores (execute): 00:55:39.866121 => 00:55:39.866143
[0m00:55:39.867395 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stocks, now test.local_bike.assert_total_order_amount_is_positive)
[0m00:55:39.870831 [debug] [Thread-3 (]: Timing info for seed.local_bike.map (compile): 00:55:39.867801 => 00:55:39.870506
[0m00:55:39.871581 [debug] [Thread-4 (]: Began compiling node seed.local_bike.seasons
[0m00:55:39.873118 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_stores
[0m00:55:39.873651 [debug] [Thread-2 (]: Began compiling node test.local_bike.assert_total_order_amount_is_positive
[0m00:55:39.874159 [debug] [Thread-3 (]: Began executing node seed.local_bike.map
[0m00:55:39.877053 [debug] [Thread-4 (]: Timing info for seed.local_bike.seasons (compile): 00:55:39.874499 => 00:55:39.876728
[0m00:55:39.877734 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_product_daily
[0m00:55:39.883982 [debug] [Thread-3 (]: Timing info for seed.local_bike.map (execute): 00:55:39.883552 => 00:55:39.883576
[0m00:55:39.885556 [debug] [Thread-2 (]: Writing injected SQL for node "test.local_bike.assert_total_order_amount_is_positive"
[0m00:55:39.886228 [debug] [Thread-4 (]: Began executing node seed.local_bike.seasons
[0m00:55:39.887231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stores, now model.local_bike.int_src_local_bike_product_daily)
[0m00:55:39.890017 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_product_daily
[0m00:55:39.888640 [debug] [Thread-3 (]: Finished running node seed.local_bike.map
[0m00:55:39.889450 [debug] [Thread-4 (]: Timing info for seed.local_bike.seasons (execute): 00:55:39.889107 => 00:55:39.889125
[0m00:55:39.897118 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_product_daily"
[0m00:55:39.898118 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m00:55:39.899875 [debug] [Thread-4 (]: Finished running node seed.local_bike.seasons
[0m00:55:39.900704 [debug] [Thread-2 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (compile): 00:55:39.878239 => 00:55:39.900338
[0m00:55:39.904216 [debug] [Thread-2 (]: Began executing node test.local_bike.assert_total_order_amount_is_positive
[0m00:55:39.903161 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_store_daily
[0m00:55:39.901876 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.local_bike.map, now model.local_bike.int_src_local_bike_staff_hierarchy)
[0m00:55:39.904920 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (compile): 00:55:39.890316 => 00:55:39.904595
[0m00:55:39.905630 [debug] [Thread-2 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (execute): 00:55:39.905259 => 00:55:39.905282
[0m00:55:39.906607 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.local_bike.seasons, now model.local_bike.int_src_local_bike_store_daily)
[0m00:55:39.907186 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_staff_hierarchy
[0m00:55:39.907752 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_product_daily
[0m00:55:39.909096 [debug] [Thread-2 (]: Finished running node test.local_bike.assert_total_order_amount_is_positive
[0m00:55:39.909647 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_store_daily
[0m00:55:39.914637 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m00:55:39.915582 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (execute): 00:55:39.915171 => 00:55:39.915193
[0m00:55:39.916625 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_store_shipped_order
[0m00:55:39.923922 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_daily"
[0m00:55:39.925685 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_product_daily
[0m00:55:39.926730 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.local_bike.assert_total_order_amount_is_positive, now model.local_bike.int_src_local_bike_store_shipped_order)
[0m00:55:39.927694 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (compile): 00:55:39.909999 => 00:55:39.927293
[0m00:55:39.929324 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_staff_hierarchy
[0m00:55:39.928503 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_store_shipped_order
[0m00:55:39.930019 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (compile): 00:55:39.917215 => 00:55:39.929699
[0m00:55:39.930698 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (execute): 00:55:39.930341 => 00:55:39.930363
[0m00:55:39.937801 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m00:55:39.938537 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_store_daily
[0m00:55:39.940040 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m00:55:39.940977 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (execute): 00:55:39.940605 => 00:55:39.940625
[0m00:55:39.943067 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_store_daily
[0m00:55:39.943752 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_staff_daily
[0m00:55:39.945202 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_daily, now model.local_bike.int_src_local_bike_staff_daily)
[0m00:55:39.945906 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_order_shipped_aborted_montly
[0m00:55:39.946371 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_staff_daily
[0m00:55:39.947103 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (compile): 00:55:39.931041 => 00:55:39.946777
[0m00:55:39.947635 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_order_shipped_montly
[0m00:55:39.948620 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_hierarchy, now model.local_bike.mrt_order_shipped_aborted_montly)
[0m00:55:39.955924 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_daily"
[0m00:55:39.956649 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_store_shipped_order
[0m00:55:39.957754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_product_daily, now model.local_bike.mrt_order_shipped_montly)
[0m00:55:39.959974 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_order_shipped_montly
[0m00:55:39.958462 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_order_shipped_aborted_montly
[0m00:55:39.959321 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (execute): 00:55:39.958977 => 00:55:39.958997
[0m00:55:39.964893 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_montly"
[0m00:55:39.970136 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m00:55:39.971830 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_store_shipped_order
[0m00:55:39.973007 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (compile): 00:55:39.948994 => 00:55:39.972508
[0m00:55:39.974099 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_products_ranking_yearly_top3
[0m00:55:39.976031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_shipped_order, now model.local_bike.mrt_products_ranking_yearly_top3)
[0m00:55:39.974977 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_staff_daily
[0m00:55:39.976785 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (compile): 00:55:39.965522 => 00:55:39.976461
[0m00:55:39.977266 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_products_ranking_yearly_top3
[0m00:55:39.978022 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (execute): 00:55:39.977691 => 00:55:39.977709
[0m00:55:39.978687 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_order_shipped_montly (compile): 00:55:39.960296 => 00:55:39.978352
[0m00:55:39.979209 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_order_shipped_aborted_montly
[0m00:55:39.984712 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m00:55:39.986397 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_staff_daily
[0m00:55:39.987024 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_order_shipped_montly
[0m00:55:39.989823 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_order_shipped_montly (execute): 00:55:39.989483 => 00:55:39.989501
[0m00:55:39.991156 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_order_shipped_montly
[0m00:55:39.987818 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (execute): 00:55:39.987474 => 00:55:39.987492
[0m00:55:39.988804 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_sales_seasons_yearly
[0m00:55:39.992281 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_stores_items_monthly
[0m00:55:39.994071 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_order_shipped_aborted_montly
[0m00:55:39.995213 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (compile): 00:55:39.979605 => 00:55:39.994722
[0m00:55:39.996266 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_daily, now model.local_bike.mrt_sales_seasons_yearly)
[0m00:55:39.997326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_montly, now model.local_bike.mrt_stores_items_monthly)
[0m00:55:39.998092 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_stores_ranking_yearly
[0m00:55:39.998820 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_products_ranking_yearly_top3
[0m00:55:39.999367 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_sales_seasons_yearly
[0m00:55:39.999917 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_stores_items_monthly
[0m00:55:40.000877 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_aborted_montly, now model.local_bike.mrt_stores_ranking_yearly)
[0m00:55:40.001623 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (execute): 00:55:40.001253 => 00:55:40.001273
[0m00:55:40.009621 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_sales_seasons_yearly"
[0m00:55:40.015760 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_stores_items_monthly"
[0m00:55:40.016486 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_stores_ranking_yearly
[0m00:55:40.017984 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_products_ranking_yearly_top3
[0m00:55:40.023292 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_stores_ranking_yearly"
[0m00:55:40.024299 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_stores_sales_monthly
[0m00:55:40.025711 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_items_monthly (compile): 00:55:40.010117 => 00:55:40.025300
[0m00:55:40.026318 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (compile): 00:55:40.001955 => 00:55:40.026012
[0m00:55:40.027143 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (compile): 00:55:40.018661 => 00:55:40.026833
[0m00:55:40.028108 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_products_ranking_yearly_top3, now model.local_bike.mrt_stores_sales_monthly)
[0m00:55:40.028712 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_stores_items_monthly
[0m00:55:40.029239 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_sales_seasons_yearly
[0m00:55:40.029780 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_stores_ranking_yearly
[0m00:55:40.030320 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_stores_sales_monthly
[0m00:55:40.031035 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_items_monthly (execute): 00:55:40.030712 => 00:55:40.030733
[0m00:55:40.031708 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (execute): 00:55:40.031364 => 00:55:40.031385
[0m00:55:40.032370 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (execute): 00:55:40.032044 => 00:55:40.032062
[0m00:55:40.039243 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_stores_items_monthly
[0m00:55:40.040163 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_stores_sales_monthly"
[0m00:55:40.041762 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_sales_seasons_yearly
[0m00:55:40.044960 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_staff_ranking_yearly
[0m00:55:40.043950 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_products_brands_monthly
[0m00:55:40.043212 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_stores_ranking_yearly
[0m00:55:40.045949 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_sales_seasons_yearly, now model.local_bike.mrt_staff_ranking_yearly)
[0m00:55:40.047527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_items_monthly, now model.local_bike.mrt_products_brands_monthly)
[0m00:55:40.048334 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_staff_sales_monthly
[0m00:55:40.049234 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (compile): 00:55:40.032732 => 00:55:40.048882
[0m00:55:40.049827 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_staff_ranking_yearly
[0m00:55:40.050659 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_products_brands_monthly
[0m00:55:40.051735 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_ranking_yearly, now model.local_bike.mrt_staff_sales_monthly)
[0m00:55:40.052319 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_stores_sales_monthly
[0m00:55:40.058177 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_staff_ranking_yearly"
[0m00:55:40.070346 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_staff_sales_monthly
[0m00:55:40.082339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:40.083311 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (execute): 00:55:40.082902 => 00:55:40.082925
[0m00:55:40.090766 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:55:40.093277 [debug] [Thread-1 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m00:55:40.094903 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_stores_sales_monthly
[0m00:55:40.095876 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (compile): 00:55:40.052721 => 00:55:40.095486
[0m00:55:40.144698 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_staff_ranking_yearly
[0m00:55:40.145849 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (execute): 00:55:40.145305 => 00:55:40.145327
[0m00:55:40.148679 [debug] [Thread-3 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m00:55:40.151307 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_staff_ranking_yearly
[0m00:55:41.379503 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:7e7a6646-02d8-492d-b3de-af4a75cccebc&page=queryresults
[0m00:55:41.380658 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_staff_sales_monthly"
[0m00:55:41.382098 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (compile): 00:55:40.083942 => 00:55:41.381512
[0m00:55:41.382765 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_staff_sales_monthly
[0m00:55:41.383388 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (execute): 00:55:41.383074 => 00:55:41.383095
[0m00:55:41.385057 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_staff_sales_monthly
[0m00:55:41.429009 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:44fe04eb-c2b5-4d83-8696-d37eeb3f8085&page=queryresults
[0m00:55:41.430123 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_products_brands_monthly"
[0m00:55:41.431113 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_products_brands_monthly (compile): 00:55:40.058880 => 00:55:41.430765
[0m00:55:41.431633 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_products_brands_monthly
[0m00:55:41.432229 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_products_brands_monthly (execute): 00:55:41.431928 => 00:55:41.431944
[0m00:55:41.433513 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_products_brands_monthly
[0m00:55:41.435699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:41.436097 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_sales_monthly' was properly closed.
[0m00:55:41.436371 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_ranking_yearly' was properly closed.
[0m00:55:41.436740 [debug] [MainThread]: Connection 'model.local_bike.mrt_stores_sales_monthly' was properly closed.
[0m00:55:41.437014 [debug] [MainThread]: Connection 'model.local_bike.mrt_products_brands_monthly' was properly closed.
[0m00:55:41.442508 [debug] [MainThread]: Command end result
[0m00:55:41.485016 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m00:55:41.485596 [info ] [MainThread]: Building catalog
[0m00:55:41.492692 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:55:42.036250 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m00:55:42.043049 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m00:55:42.057131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:42.058464 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m00:55:42.065512 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m00:55:42.069199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:42.073439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:42.076249 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_silver`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_silver'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m00:55:42.081376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:42.125867 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_bronze`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_bronze'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m00:55:42.130370 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_gold`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_gold'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m00:55:42.135870 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_seeds`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_seeds'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m00:55:44.037886 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:905a91c0-d246-4021-8106-acf9070fc173&page=queryresults
[0m00:55:44.058895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:44.063472 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`src_local_bike`.__TABLES__
        where (upper(dataset_id) = upper('src_local_bike'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m00:55:44.064876 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:2f5e63bb-f096-41e1-9757-08f56d3c187e&page=queryresults
[0m00:55:44.112663 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:0aa13ffc-1c29-4191-87af-1e507d0c298f&page=queryresults
[0m00:55:44.120617 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:8479dbe1-d0bd-4537-817d-4c1a06fc286f&page=queryresults
[0m00:55:45.706014 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:4f68a10d-26e5-4e8c-8710-bd9efc8f8daf&page=queryresults
[0m00:55:45.904346 [info ] [MainThread]: Catalog written to /usr/app/dbt/target/catalog.json
[0m00:55:45.906602 [debug] [MainThread]: Command `dbt docs generate` succeeded at 00:55:45.906205 after 8.35 seconds
[0m00:55:45.907139 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m00:55:45.907579 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m00:55:45.907876 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m00:55:45.908151 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m00:55:45.908441 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m00:55:45.908897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b65c4af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b66b5c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b654e4260>]}
[0m00:55:45.909337 [debug] [MainThread]: Flushing usage events
[0m10:56:40.341473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74793cb1c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74793cb1d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74793cc063c0>]}


============================== 10:56:40.369759 | b3e19d82-44d0-493d-ae80-0367774f47e4 ==============================
[0m10:56:40.369759 [info ] [MainThread]: Running with dbt=1.5.0
[0m10:56:40.371099 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'use_colors': 'True', 'static_parser': 'True', 'printer_width': '80', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_format': 'default', 'log_path': '/usr/app/dbt/logs', 'no_print': 'None'}
[0m10:56:40.464299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3e19d82-44d0-493d-ae80-0367774f47e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74793da6ab70>]}
[0m10:56:40.469849 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4jjf46q5'
[0m10:56:40.470742 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:56:40.632417 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:56:40.638413 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m10:56:40.756077 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m10:56:40.764838 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:56:40.878256 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:56:40.890477 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m10:56:41.002642 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m10:56:41.007912 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m10:56:41.009280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b3e19d82-44d0-493d-ae80-0367774f47e4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74793cb1e0c0>]}
[0m10:56:41.039919 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m10:56:42.132441 [info ] [MainThread]: Installed from version 0.10.5
[0m10:56:42.133674 [info ] [MainThread]: Up to date!
[0m10:56:42.135621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b3e19d82-44d0-493d-ae80-0367774f47e4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74793ca6c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74793ca6c5f0>]}
[0m10:56:42.140135 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:56:42.381717 [info ] [MainThread]: Installed from version 1.3.2
[0m10:56:42.382758 [info ] [MainThread]: Up to date!
[0m10:56:42.384486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b3e19d82-44d0-493d-ae80-0367774f47e4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74793cb83fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74793cb83e30>]}
[0m10:56:42.385881 [info ] [MainThread]: Installing calogica/dbt_date
[0m10:56:42.556464 [info ] [MainThread]: Installed from version 0.10.1
[0m10:56:42.558098 [info ] [MainThread]: Up to date!
[0m10:56:42.559352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b3e19d82-44d0-493d-ae80-0367774f47e4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74793d200bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74793d9f6900>]}
[0m10:56:42.565444 [debug] [MainThread]: Command `dbt deps` succeeded at 10:56:42.564627 after 2.28 seconds
[0m10:56:42.566952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74793d270710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74793d8c2930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74793d1f8500>]}
[0m10:56:42.568179 [debug] [MainThread]: Flushing usage events
[0m10:56:49.392046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcdb5dac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcdb52dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcdb52c140>]}


============================== 10:56:49.397856 | e4620064-92b9-4c91-88af-b9ce7febcb3b ==============================
[0m10:56:49.397856 [info ] [MainThread]: Running with dbt=1.5.0
[0m10:56:49.398998 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/root/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'log_format': 'default', 'printer_width': '80', 'log_cache_events': 'False'}
[0m10:56:52.601964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcdb418890>]}
[0m10:56:52.626097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc37d72c0>]}
[0m10:56:52.680577 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m10:56:52.906240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:56:52.906786 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:56:52.917701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc39c6ae0>]}
[0m10:56:52.945174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc3ad4500>]}
[0m10:56:52.945891 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m10:56:52.946647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc3805670>]}
[0m10:56:52.950791 [info ] [MainThread]: 
[0m10:56:52.952625 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:56:52.958258 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m10:56:52.960353 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m10:56:52.961325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:52.961945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:52.963113 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m10:56:52.964425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:53.686086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_gold)
[0m10:56:53.686983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:53.688293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_bronze)
[0m10:56:53.690173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_silver)
[0m10:56:53.691248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:53.692698 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m10:56:53.732239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:53.775382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:54.188183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc9d254f0>]}
[0m10:56:54.189382 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:56:54.190178 [info ] [MainThread]: 
[0m10:56:54.270434 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_brands
[0m10:56:54.277466 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_customers
[0m10:56:54.276326 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_categories
[0m10:56:54.282474 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_order_items
[0m10:56:54.278831 [info ] [Thread-1 (]: 1 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_brands ......... [RUN]
[0m10:56:54.285884 [info ] [Thread-3 (]: 3 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_customers ...... [RUN]
[0m10:56:54.294756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.stg_src_local_bike_brands)
[0m10:56:54.290283 [info ] [Thread-4 (]: 4 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_order_items .... [RUN]
[0m10:56:54.299635 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_brands
[0m10:56:54.298575 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.stg_src_local_bike_customers)
[0m10:56:54.288399 [info ] [Thread-2 (]: 2 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_categories ..... [RUN]
[0m10:56:54.309804 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_customers
[0m10:56:54.301270 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.stg_src_local_bike_order_items)
[0m10:56:54.311462 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.stg_src_local_bike_categories)
[0m10:56:54.326902 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_categories
[0m10:56:54.319144 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_brands"
[0m10:56:54.325789 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_order_items
[0m10:56:54.345242 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (compile): 10:56:54.304145 => 10:56:54.344389
[0m10:56:54.347385 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_categories"
[0m10:56:54.341095 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_customers"
[0m10:56:54.368009 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (compile): 10:56:54.319912 => 10:56:54.367331
[0m10:56:54.354991 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_brands
[0m10:56:54.366146 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_order_items"
[0m10:56:54.357193 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (compile): 10:56:54.327460 => 10:56:54.356536
[0m10:56:54.368942 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_customers
[0m10:56:54.378335 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_categories
[0m10:56:54.377201 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (compile): 10:56:54.348152 => 10:56:54.376420
[0m10:56:54.401299 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_order_items
[0m10:56:54.673000 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_order_items"
[0m10:56:54.674555 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_brands"
[0m10:56:54.686323 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_categories"
[0m10:56:54.688976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:54.690583 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:56:54.693806 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_customers"
[0m10:56:54.703391 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:56:54.695318 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:56:54.701875 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_order_items: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_order_items"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
  OPTIONS(
      description="""Detailed order line items with pricing and discounts."""
    )
  as SELECT
  order_id as order_id,
  item_id AS item_id,
  product_id as product_id,
  quantity as quantity,
  list_price as list_price,
  discount as discount,
  
    list_price * quantity * ( 1 - discount )
 AS total_item_discount_sold
FROM `databird-473015`.`src_local_bike`.`order_items`;


[0m10:56:54.706901 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_brands: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_brands"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
  OPTIONS(
      description="""Bike brands sold by Local Bike."""
    )
  as select
        brand_id as brand_id,
        INITCAP(brand_name) as brand_name
from `databird-473015`.`src_local_bike`.`brands`;


[0m10:56:54.767664 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_categories: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_categories"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_categories`
  OPTIONS(
      description="""Product categories such as road, mountain, and electric bikes."""
    )
  as select
        category_id as category_id,
        INITCAP(category_name) as category_name
from `databird-473015`.`src_local_bike`.`categories`;


[0m10:56:54.833160 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_customers: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_customers"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_customers`
  OPTIONS(
      description="""Customer informations."""
    )
  as select
    customer_id as customer_id,
    INITCAP(first_name) as customer_first_name,
    INITCAP(last_name) as customer_last_name,
    phone as customer_phone,
    email as customer_email,
    INITCAP(street) as customer_street,
    INITCAP(city) as customer_city,
    UPPER(state) as customer_state,
    zip_code as customer_zip_code
from `databird-473015`.`src_local_bike`.`customers`;


[0m10:56:55.670064 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:2eb545ea-5300-45e5-8831-34e361ee8b75&page=queryresults
[0m10:56:55.709030 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:10525b63-66ed-4cd8-8678-f0d5ae53fce1&page=queryresults
[0m10:56:55.717535 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:e7a3a537-38bd-4ba1-b7c7-4afc6ca2d56d&page=queryresults
[0m10:56:55.890498 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:48588fda-3259-448f-9d3b-03f964ffff4b&page=queryresults
[0m10:56:56.057853 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (execute): 10:56:54.369519 => 10:56:56.057467
[0m10:56:56.059205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc3395f40>]}
[0m10:56:56.060229 [info ] [Thread-1 (]: 1 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_brands .... [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m10:56:56.061749 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_brands
[0m10:56:56.063261 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_orders
[0m10:56:56.064481 [info ] [Thread-1 (]: 5 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_orders ......... [RUN]
[0m10:56:56.068853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_brands, now model.local_bike.stg_src_local_bike_orders)
[0m10:56:56.071222 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_orders
[0m10:56:56.079435 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (execute): 10:56:54.378953 => 10:56:56.079071
[0m10:56:56.082940 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_orders"
[0m10:56:56.084532 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc3654f50>]}
[0m10:56:56.086042 [info ] [Thread-3 (]: 3 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_customers . [[32mCREATE VIEW (0 processed)[0m in 1.79s]
[0m10:56:56.087449 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_customers
[0m10:56:56.090742 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_products
[0m10:56:56.095693 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (compile): 10:56:56.071898 => 10:56:56.094200
[0m10:56:56.092727 [info ] [Thread-3 (]: 6 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_products ....... [RUN]
[0m10:56:56.097129 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_orders
[0m10:56:56.099450 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_customers, now model.local_bike.stg_src_local_bike_products)
[0m10:56:56.109269 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_orders"
[0m10:56:56.110329 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_products
[0m10:56:56.118298 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_products"
[0m10:56:56.120313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:56.122620 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (execute): 10:56:54.390054 => 10:56:56.122181
[0m10:56:56.124117 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_products (compile): 10:56:56.111188 => 10:56:56.123654
[0m10:56:56.127135 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_orders: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_orders"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`
  OPTIONS(
      description="""Order headers with key dates and statuses"""
    )
  as select
    order_id as order_id,
    customer_id as customer_id,
    order_status as order_status,
    CAST(order_date as date) as order_date,
    CAST(required_date as date) as required_date,
    CAST(shipped_date as date) as shipped_date,
    store_id as store_id,
    staff_id as staff_id,
    
    CASE
        WHEN EXTRACT(MONTH FROM order_date) IN (12, 1, 2) THEN 'Winter'
        WHEN EXTRACT(MONTH FROM order_date) IN (3, 4, 5) THEN 'Spring'
        WHEN EXTRACT(MONTH FROM order_date) IN (6, 7, 8) THEN 'Summer'
        WHEN EXTRACT(MONTH FROM order_date) IN (9, 10, 11) THEN 'Autumn'
    END
 AS season_name
from `databird-473015`.`src_local_bike`.`orders`;


[0m10:56:56.129333 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc35f40b0>]}
[0m10:56:56.130389 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_products
[0m10:56:56.171903 [info ] [Thread-2 (]: 2 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_categories  [[32mCREATE VIEW (0 processed)[0m in 1.82s]
[0m10:56:56.182325 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_categories
[0m10:56:56.183869 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_staffs
[0m10:56:56.192341 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_products"
[0m10:56:56.190449 [info ] [Thread-2 (]: 7 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_staffs ......... [RUN]
[0m10:56:56.197024 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_categories, now model.local_bike.stg_src_local_bike_staffs)
[0m10:56:56.199765 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_staffs
[0m10:56:56.198570 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:56:56.213063 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_staffs"
[0m10:56:56.214270 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_products"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_products`
  OPTIONS(
      description="""Products sold, linked to brands and categories."""
    )
  as select
        product_id as product_id,
        INITCAP(product_name) as product_name,
        brand_id as brand_id,
        category_id as category_id,
        model_year as model_year,
        coalesce(list_price,0) as list_price
from `databird-473015`.`src_local_bike`.`products`;


[0m10:56:56.257639 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (compile): 10:56:56.200476 => 10:56:56.257039
[0m10:56:56.259453 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_staffs
[0m10:56:56.267960 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (execute): 10:56:54.417506 => 10:56:56.267507
[0m10:56:56.274708 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc360f3e0>]}
[0m10:56:56.279655 [info ] [Thread-4 (]: 4 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_order_items  [[32mCREATE VIEW (0 processed)[0m in 1.97s]
[0m10:56:56.284492 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_order_items
[0m10:56:56.294946 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_stocks
[0m10:56:56.296768 [info ] [Thread-4 (]: 8 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_stocks ......... [RUN]
[0m10:56:56.299451 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_order_items, now model.local_bike.stg_src_local_bike_stocks)
[0m10:56:56.311907 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_stocks
[0m10:56:56.324328 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stocks"
[0m10:56:56.326153 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_staffs"
[0m10:56:56.328224 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:56:56.330270 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (compile): 10:56:56.312947 => 10:56:56.329495
[0m10:56:56.331494 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_stocks
[0m10:56:56.344905 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_stocks"
[0m10:56:56.348977 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:56:56.351692 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_staffs: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_staffs"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs`
  OPTIONS(
      description="""Sales and management staff working in Local Bike stores."""
    )
  as select
    CAST(staff_id AS int) as staff_id,
    INITCAP(first_name) as staff_first_name,
    INITCAP(last_name) as staff_last_name,
    phone as staff_phone,
    email as staff_email,
    active as staff_active,
    store_id as store_id,
    CAST(manager_id AS int)  as manager_id
from `databird-473015`.`src_local_bike`.`staffs`;


[0m10:56:56.395989 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_stocks: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_stocks"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stocks`
  OPTIONS(
      description="""Stock of products and availability."""
    )
  as select
    store_id   as store_id,
    product_id as product_id,
    quantity   as stock_quantity
from `databird-473015`.`src_local_bike`.`stocks`;


[0m10:56:57.041452 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:0912072d-3bf6-4404-9abd-19e038f21f88&page=queryresults
[0m10:56:57.055425 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:0fb4d6c5-b7b3-47ee-ab9e-99aedb948a63&page=queryresults
[0m10:56:57.336157 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_products (execute): 10:56:56.175269 => 10:56:57.335723
[0m10:56:57.337431 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc350d610>]}
[0m10:56:57.338423 [info ] [Thread-3 (]: 6 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_products .. [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m10:56:57.339937 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_products
[0m10:56:57.341040 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_stores
[0m10:56:57.342485 [info ] [Thread-3 (]: 9 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_stores ......... [RUN]
[0m10:56:57.345659 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_products, now model.local_bike.stg_src_local_bike_stores)
[0m10:56:57.348579 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_stores
[0m10:56:57.356892 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stores"
[0m10:56:57.360067 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:45baab37-5ff3-4b4c-871e-41e00f8b55b3&page=queryresults
[0m10:56:57.361116 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_stores (compile): 10:56:57.349746 => 10:56:57.360664
[0m10:56:57.363838 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:9fcf92e2-045b-4e4b-ab28-f2326c20bf39&page=queryresults
[0m10:56:57.369888 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_stores
[0m10:56:57.383817 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_stores"
[0m10:56:57.387291 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:56:57.389802 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (execute): 10:56:56.100545 => 10:56:57.389375
[0m10:56:57.391645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc33b2030>]}
[0m10:56:57.395179 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_stores: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_stores"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`
  OPTIONS(
      description="""Store locations in California, New York, and Texas."""
    )
  as select
    store_id as store_id,
    INITCAP(store_name) as store_name,
    phone as store_phone,
    email as store_email,
    street as store_street,
    INITCAP(city) as store_city,
    UPPER(state) as store_state,
    zip_code as store_zip_code
from `databird-473015`.`src_local_bike`.`stores`;


[0m10:56:57.396874 [info ] [Thread-1 (]: 5 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_orders .... [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m10:56:57.399543 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_orders
[0m10:56:57.445413 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_product_daily
[0m10:56:57.446364 [info ] [Thread-1 (]: 10 of 24 START sql view model dbt_bike_silver.int_src_local_bike_product_daily . [RUN]
[0m10:56:57.448322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_orders, now model.local_bike.int_src_local_bike_product_daily)
[0m10:56:57.450255 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_product_daily
[0m10:56:57.459846 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_product_daily"
[0m10:56:57.461637 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (compile): 10:56:57.451197 => 10:56:57.461099
[0m10:56:57.462785 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_product_daily
[0m10:56:57.478709 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_product_daily"
[0m10:56:57.485522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:57.489163 [debug] [Thread-1 (]: On model.local_bike.int_src_local_bike_product_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_product_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily`
  OPTIONS(
      description="""This model provides an aggregated view of product items. It enriches the products data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each product.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Product Informations**: Enriches the product with user-specific data, such as brand and category.\r\n\r\nIt provides a comprehensive view of each product, allowing for easy analysis of product performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH order_items AS (
  SELECT 
        order_id as order_id,
        item_id as item_id,
        product_id as product_id,
        quantity as quantity,
        list_price as list_price,
        discount as discount,
        ROUND((discount * 100),2) as discount_percent,
        ROUND(total_item_discount_sold, 2) as total_item_discount_sold 
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
),
------------------------------------------
orders_date AS (
  SELECT 
        order_id, 
        CAST(order_date as date) as order_date,
        store_id,
        season_name,
        EXTRACT(YEAR FROM order_date) as yeardate,
        EXTRACT(YEAR FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`
),
------------------------------------------
products AS (
  SELECT 
        product_id as product_id,
        product_name as product_name,
        brand_id as brand_id,
        category_id as category_id,
        model_year as product_model_year,
        ROUND(list_price,2) as list_price
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_products`
),
------------------------------------------
brands AS (
  SELECT 
        brand_id as brand_id,
        brand_name as brand_name
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
),
------------------------------------------
categories AS (
  SELECT 
        category_id as category_id,
        category_name as category_name
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_categories`
)
------------------------------------------
SELECT
  o.order_id,
  o.store_id,
  o.order_date,
  o.yeardate,
  o.monthday,
  o.yearmonth,
  o.month_2digits,
  o.month_name,
  o.month_abbrev,
  o.week_number,
  o.season_name,
  p.product_id,
  p.product_name,
  b.brand_name,
  c.category_name,
  oi.quantity,
  oi.list_price,
  oi.discount,
  oi.discount_percent,
  SUM(oi.total_item_discount_sold) as total_item_discount_sold,
  COUNT(*) as total_items
FROM orders_date as o
LEFT JOIN order_items as oi ON o.order_id = oi.order_id
LEFT JOIN products as p ON oi.product_id = p.product_id
LEFT JOIN brands as b ON p.brand_id = b.brand_id
LEFT JOIN categories as c ON p.category_id = c.category_id
GROUP BY 
  o.order_id,
  o.store_id,
  o.order_date,
  o.yeardate,
  o.monthday,
  o.yearmonth,
  o.month_2digits,
  o.month_name,
  o.month_abbrev,
  o.week_number,
  o.season_name, 
  p.product_id,
  p.product_name,
  b.brand_name,
  c.category_name,
  oi.quantity,
  oi.list_price,
  oi.discount,
  oi.discount_percent
ORDER BY o.yeardate, o.week_number, o.order_id;


[0m10:56:57.699170 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (execute): 10:56:56.332084 => 10:56:57.698566
[0m10:56:57.702199 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (execute): 10:56:56.260069 => 10:56:57.700882
[0m10:56:57.704046 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc0288050>]}
[0m10:56:57.705985 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc0288200>]}
[0m10:56:57.707496 [info ] [Thread-4 (]: 8 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_stocks .... [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m10:56:57.710137 [info ] [Thread-2 (]: 7 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_staffs .... [[32mCREATE VIEW (0 processed)[0m in 1.51s]
[0m10:56:57.715155 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_staffs
[0m10:56:57.712952 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_stocks
[0m10:56:57.716815 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m10:56:57.717771 [info ] [Thread-2 (]: 11 of 24 START sql view model dbt_bike_silver.int_src_local_bike_staff_hierarchy  [RUN]
[0m10:56:57.725029 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_staffs, now model.local_bike.int_src_local_bike_staff_hierarchy)
[0m10:56:57.728657 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_staff_hierarchy
[0m10:56:57.735543 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m10:56:57.736954 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (compile): 10:56:57.729272 => 10:56:57.736474
[0m10:56:57.737973 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_staff_hierarchy
[0m10:56:57.744573 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m10:56:57.745946 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:56:57.748714 [debug] [Thread-2 (]: On model.local_bike.int_src_local_bike_staff_hierarchy: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_hierarchy"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy`
  OPTIONS(
      description="""This model provides an hirarchical view of employees. It enriches the store data with the following data:\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each employe.."""
    )
  as ------------------------------------------
  WITH RECURSIVE staff_hierarchy AS (

  -- Niveau 0 : managers racine
  SELECT
    m.staff_id,
    m.staff_first_name,
    m.staff_last_name,
    m.manager_id,
    m.store_id,
    m.staff_first_name || ' ' || m.staff_last_name AS path,
    0 AS level
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs` m
  WHERE m.manager_id IS NULL

  UNION ALL

  -- Niveaux suivants : rattacher les subordonnés
  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,    
    CONCAT(h.path, ' → ', s.staff_first_name, ' ', s.staff_last_name) AS path,
    h.level + 1 AS level
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs` s
  JOIN staff_hierarchy as h ON s.manager_id = h.staff_id
  
)
------------------------------------------
SELECT 
     * 
FROM staff_hierarchy
ORDER BY path, level;


[0m10:56:58.279570 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:95cc5e02-5f32-4d84-b8e8-f324857d3a05&page=queryresults
[0m10:56:58.413823 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:7df2767c-da9b-4d1e-b70e-4c3cb665aa20&page=queryresults
[0m10:56:58.505248 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:ff32a01f-0242-4b5d-9eec-f045ef6967d1&page=queryresults
[0m10:56:58.607173 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (execute): 10:56:57.463339 => 10:56:58.606841
[0m10:56:58.608387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc027b590>]}
[0m10:56:58.609323 [info ] [Thread-1 (]: 10 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_product_daily  [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m10:56:58.610979 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_product_daily
[0m10:56:58.715688 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_stores (execute): 10:56:57.376236 => 10:56:58.715328
[0m10:56:58.716885 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc0251f10>]}
[0m10:56:58.718050 [info ] [Thread-3 (]: 9 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_stores .... [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m10:56:58.719623 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_stores
[0m10:56:58.721138 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_store_daily
[0m10:56:58.722843 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_store_shipped_order
[0m10:56:58.724435 [info ] [Thread-4 (]: 12 of 24 START sql view model dbt_bike_silver.int_src_local_bike_store_daily ... [RUN]
[0m10:56:58.726023 [info ] [Thread-1 (]: 13 of 24 START sql view model dbt_bike_silver.int_src_local_bike_store_shipped_order  [RUN]
[0m10:56:58.729164 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stocks, now model.local_bike.int_src_local_bike_store_daily)
[0m10:56:58.731843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_product_daily, now model.local_bike.int_src_local_bike_store_shipped_order)
[0m10:56:58.733110 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_store_daily
[0m10:56:58.733954 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_store_shipped_order
[0m10:56:58.742381 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_daily"
[0m10:56:58.751322 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m10:56:58.752862 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (compile): 10:56:58.742895 => 10:56:58.752178
[0m10:56:58.753731 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (compile): 10:56:58.734450 => 10:56:58.753331
[0m10:56:58.754484 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_store_shipped_order
[0m10:56:58.755274 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_store_daily
[0m10:56:58.767077 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m10:56:58.768345 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_store_daily"
[0m10:56:58.770224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:58.771293 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:56:58.774000 [debug] [Thread-1 (]: On model.local_bike.int_src_local_bike_store_shipped_order: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_shipped_order"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_shipped_order`
  OPTIONS(
      description="""This model provides the list of order required, shipped and aborted per month over 3 years.\r\n\r\nIt provides a comprehensive view of each order, allowing for easy analysis of order performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_shipped_date AS (

  SELECT 
        order_id, 
        order_date,
        required_date,
        shipped_date, 
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    required_date,
    shipped_date,
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_shipped_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.order_id,
    ls.shipped_date ,
    ls.required_date ,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date, ls.shipped_date, ls.required_date,ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m10:56:58.815566 [debug] [Thread-4 (]: On model.local_bike.int_src_local_bike_store_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  OPTIONS(
      description="""This model provides an aggregated view of stores. It enriches the store data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each store.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Total Distinct Items**: The count of distinct product types in the order.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_date AS (

  SELECT 
        order_id, 
        order_date,
        shipped_date,
        required_date,
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    o.shipped_date,
    o.required_date,    
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.shipped_date,
    ls.required_date,     
    ls.order_id,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date,ls.shipped_date,ls.required_date, ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m10:56:58.860830 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (execute): 10:56:57.738449 => 10:56:58.860486
[0m10:56:58.864230 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc33f2db0>]}
[0m10:56:58.865396 [info ] [Thread-2 (]: 11 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_staff_hierarchy  [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m10:56:58.867561 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m10:56:58.874535 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_staff_daily
[0m10:56:58.877334 [info ] [Thread-3 (]: 14 of 24 START sql view model dbt_bike_silver.int_src_local_bike_staff_daily ... [RUN]
[0m10:56:58.884249 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stores, now model.local_bike.int_src_local_bike_staff_daily)
[0m10:56:58.886564 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_staff_daily
[0m10:56:58.916138 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_daily"
[0m10:56:58.918333 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (compile): 10:56:58.888789 => 10:56:58.917874
[0m10:56:58.919237 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_staff_daily
[0m10:56:59.091443 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_staff_daily"
[0m10:56:59.092946 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:56:59.096491 [debug] [Thread-3 (]: On model.local_bike.int_src_local_bike_staff_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  OPTIONS(
      description="""This model provides an aggregated view of staffs and stores. It enriches the store and staff data with the following metrics:\r\n- **Total item Amount**: The sum of all order items for each employe.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each store and staffs, allowing for easy analysis of store performance, employee performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH staff_list AS (

  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,
    s.path,
    s.level
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy` s

),
------------------------------------------
sales_by_employee AS (

  SELECT
    o.order_date as order_date,
    o.season_name,
    EXTRACT(YEAR FROM o.order_date) as yeardate,
    EXTRACT(YEAR FROM o.order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') AS yearmonth,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM o.order_date) AS STRING), 2, '0') AS monthday,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') as month_2digits,
    FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_name,
    FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_abbrev,
    LPAD(CAST(EXTRACT(ISOWEEK FROM o.order_date) AS STRING), 2, '0') AS week_number,
    o.staff_id,
    oi.total_item_discount_sold as total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders` as o
  LEFT JOIN `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items` as oi ON o.order_id = oi.order_id

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

)
------------------------------------------
SELECT 
    em.order_date,
    em.yeardate,
    em.monthday,
    em.yearmonth,
    em.month_2digits,
    em.month_name,
    em.month_abbrev,
    em.week_number,
    em.season_name,
    st.store_name,
    m.store_latitude,
    m.store_longitude,    
    st.store_city,
    st.store_state,    
    ROUND(em.total_item_discount_sold, 2) as total_item_sold_staff,
    s.*
FROM sales_by_employee as em 
JOIN staff_list as s ON em.staff_id = s.staff_id
LEFT JOIN map as m on s.store_id = m.store_id
LEFT JOIN stores as st on m.store_id = st.store_id
ORDER BY em.order_date;


[0m10:56:59.754411 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:498790ff-96fc-4210-90a2-b1cb878c6471&page=queryresults
[0m10:56:59.811722 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:ffa7cceb-3196-4297-8198-8a11f2a2181a&page=queryresults
[0m10:56:59.864223 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:43a8438c-e79b-4845-b31f-689d21e5108e&page=queryresults
[0m10:57:00.089335 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (execute): 10:56:58.755726 => 10:57:00.088546
[0m10:57:00.091856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc02ce210>]}
[0m10:57:00.093462 [info ] [Thread-1 (]: 13 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_store_shipped_order  [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m10:57:00.095996 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_store_shipped_order
[0m10:57:00.147260 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (execute): 10:56:58.761098 => 10:57:00.146864
[0m10:57:00.148736 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc02e1d30>]}
[0m10:57:00.150134 [info ] [Thread-4 (]: 12 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_store_daily  [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m10:57:00.152158 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_store_daily
[0m10:57:00.156034 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_order_shipped_aborted_montly
[0m10:57:00.162302 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_order_shipped_montly
[0m10:57:00.159216 [info ] [Thread-2 (]: 15 of 24 START sql table model dbt_bike_gold.orders_shipped_aborted_monthly_report  [RUN]
[0m10:57:00.164458 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_products_ranking_yearly_top3
[0m10:57:00.172536 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_hierarchy, now model.local_bike.mrt_order_shipped_aborted_montly)
[0m10:57:00.178069 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_order_shipped_aborted_montly
[0m10:57:00.167998 [info ] [Thread-1 (]: 16 of 24 START sql table model dbt_bike_gold.orders_shipped_monthly_report ..... [RUN]
[0m10:57:00.175223 [info ] [Thread-4 (]: 17 of 24 START sql table model dbt_bike_gold.products_stores_ranking_yearly_report  [RUN]
[0m10:57:00.187123 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m10:57:00.188904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_shipped_order, now model.local_bike.mrt_order_shipped_montly)
[0m10:57:00.190930 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_daily, now model.local_bike.mrt_products_ranking_yearly_top3)
[0m10:57:00.192374 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_order_shipped_montly
[0m10:57:00.193830 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_products_ranking_yearly_top3
[0m10:57:00.200990 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (compile): 10:57:00.179073 => 10:57:00.200287
[0m10:57:00.203190 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_montly"
[0m10:57:00.212037 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m10:57:00.213334 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_order_shipped_aborted_montly
[0m10:57:00.215130 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_order_shipped_montly (compile): 10:57:00.194517 => 10:57:00.214620
[0m10:57:00.216436 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (compile): 10:57:00.204367 => 10:57:00.215541
[0m10:57:00.228451 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_order_shipped_montly
[0m10:57:00.238543 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:00.239521 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_products_ranking_yearly_top3
[0m10:57:00.244447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:00.251183 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:00.255999 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (execute): 10:56:58.919583 => 10:57:00.255562
[0m10:57:00.350148 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc3371250>]}
[0m10:57:00.364689 [info ] [Thread-3 (]: 14 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_staff_daily  [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m10:57:00.414956 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_staff_daily
[0m10:57:00.420958 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_sales_seasons_yearly
[0m10:57:00.422793 [info ] [Thread-3 (]: 18 of 24 START sql table model dbt_bike_gold.sales_seasons_yearly_report ....... [RUN]
[0m10:57:00.431473 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_daily, now model.local_bike.mrt_sales_seasons_yearly)
[0m10:57:00.435690 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_sales_seasons_yearly
[0m10:57:00.457264 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_sales_seasons_yearly"
[0m10:57:00.464059 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (compile): 10:57:00.436492 => 10:57:00.463095
[0m10:57:00.466583 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_sales_seasons_yearly
[0m10:57:00.474458 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:00.674796 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m10:57:00.678859 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.mrt_order_shipped_montly"
[0m10:57:00.683016 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m10:57:00.684141 [debug] [Thread-2 (]: On model.local_bike.mrt_order_shipped_aborted_montly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_order_shipped_aborted_montly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`orders_shipped_aborted_monthly_report`
    
    

    OPTIONS(
      description="""This model provides an aggregated view of the canceled orders. It enriches the order data with the following metrics:\r\n- **nb_shipped_aborted**: The quantity of order aborted.\r\n- **total_aborted_sales**: The cost of aborted orders.\r\n- **Order Informations**: Enriches the product with user-specific data, such as store name.\r\n\r\nIt provides a comprehensive view the aborted order, allowing for easy analysis of order performance."""
    )
    as (
      ------------------------------------------

------------------------------------------

WITH total_aborted_orders AS (

  SELECT
    yearmonth AS month,
    COUNTIF(shipped_date IS NULL) AS nb_shipped_aborted,
    ROUND(SUM(total_sales_amount),2) as total_aborted_sales,
    store_name
  FROM  `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  WHERE shipped_date is null
  GROUP BY month,store_name

)
------------------------------------------
SELECT *
FROM total_aborted_orders
------------------------------------------
    );
  
[0m10:57:00.688143 [debug] [Thread-4 (]: On model.local_bike.mrt_products_ranking_yearly_top3: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_ranking_yearly_top3"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`products_stores_ranking_yearly_report`
    
    

    OPTIONS(
      description="""This model provides the top 3 **best-selling products** per year over 3 years.\r\n\r\nIt provides a comprehensive view of each product, allowing for easy analysis of products performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH product_sales AS (
  SELECT
    p.yeardate AS year,
    s.store_name AS store,
    p.product_name,
    p.brand_name,
    ROUND(SUM(total_item_discount_sold), 2) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily` AS p
  LEFT JOIN `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`AS s
    ON p.order_id = s.order_id 
   AND p.store_id = s.store_id
  GROUP BY year,store,product_name,brand_name
)
------------------------------------------
SELECT
  year,
  store,
  product_name,
  brand_name,
  total_sales
FROM (
  SELECT
    *,
    RANK() OVER ( PARTITION BY year, store ORDER BY total_sales DESC ) AS rank_product
  FROM product_sales
)
WHERE rank_product <= 3
ORDER BY year, store
------------------------------------------
    );
  
[0m10:57:00.690719 [debug] [Thread-1 (]: On model.local_bike.mrt_order_shipped_montly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_order_shipped_montly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`orders_shipped_monthly_report`
    
    

    OPTIONS(
      description="""This model provides an aggregated view of the orders sent. It enriches the order data with the following metrics:\r\n- **nb_order_shipped**: The quantity of orders shipped.\r\n- **total_sales**: The cost of orders shipped.\r\n- **Order Informations**: Enriches the product with user-specific data, such as store name.\r\n\r\nIt provides a comprehensive view the aborted order, allowing for easy analysis of order performance."""
    )
    as (
      ------------------------------------------

------------------------------------------

WITH total_orders AS (

  SELECT
    yearmonth AS month,
    COUNT(order_date) AS nb_order_shipped,
    ROUND(SUM(total_sales_amount),2) as total_sales,
    store_name
  FROM  `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  WHERE shipped_date is not null
  GROUP BY month,store_name

)
------------------------------------------
SELECT *
FROM total_orders
------------------------------------------
    );
  
[0m10:57:00.705137 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.mrt_sales_seasons_yearly"
[0m10:57:00.706321 [debug] [Thread-3 (]: On model.local_bike.mrt_sales_seasons_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_sales_seasons_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`sales_seasons_yearly_report`
    
    

    OPTIONS(
      description="""This model provides the **top-performing store by season** and per year over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH sales_stores_seasons AS (

  SELECT
    yeardate AS year,
    store_name AS store,
    season_name,
    ROUND(SUM(total_sales_amount), 2) AS sales_amount
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year,store,season_name

)

SELECT *
FROM sales_stores_seasons
PIVOT (
  SUM(sales_amount) AS sales
  FOR season_name IN ('Winter','Spring','Summer','Autumn')
)
ORDER BY year, store
------------------------------------------
    );
  
[0m10:57:03.297388 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:8895abcd-4f9c-4b20-8834-3f504efadac8&page=queryresults
[0m10:57:03.537985 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:bf36bd52-8439-4c03-b5a2-87d93d7692c3&page=queryresults
[0m10:57:03.655964 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_order_shipped_montly (execute): 10:57:00.240126 => 10:57:03.655546
[0m10:57:03.658742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc3837260>]}
[0m10:57:03.661843 [info ] [Thread-1 (]: 16 of 24 OK created sql table model dbt_bike_gold.orders_shipped_monthly_report  [[32mCREATE TABLE (81.0 rows, 215.1 KiB processed)[0m in 3.47s]
[0m10:57:03.664819 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_order_shipped_montly
[0m10:57:03.669260 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_stores_items_monthly
[0m10:57:03.672811 [info ] [Thread-1 (]: 19 of 24 START sql table model dbt_bike_gold.items_stores_monthly_report ....... [RUN]
[0m10:57:03.674690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_montly, now model.local_bike.mrt_stores_items_monthly)
[0m10:57:03.676445 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_stores_items_monthly
[0m10:57:03.689841 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_stores_items_monthly"
[0m10:57:03.693499 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_items_monthly (compile): 10:57:03.677317 => 10:57:03.692491
[0m10:57:03.695048 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_stores_items_monthly
[0m10:57:03.703107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:03.895256 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (execute): 10:57:00.217498 => 10:57:03.894930
[0m10:57:03.896325 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc37f4bf0>]}
[0m10:57:03.897325 [info ] [Thread-2 (]: 15 of 24 OK created sql table model dbt_bike_gold.orders_shipped_aborted_monthly_report  [[32mCREATE TABLE (38.0 rows, 215.1 KiB processed)[0m in 3.73s]
[0m10:57:03.899332 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_order_shipped_aborted_montly
[0m10:57:03.900783 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_stores_ranking_yearly
[0m10:57:03.901541 [info ] [Thread-2 (]: 20 of 24 START sql table model dbt_bike_gold.stores_ranking_yearly_report ...... [RUN]
[0m10:57:03.903087 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_aborted_montly, now model.local_bike.mrt_stores_ranking_yearly)
[0m10:57:03.904557 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_stores_ranking_yearly
[0m10:57:03.913039 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:6838e9a3-75a6-4e82-b42a-d15e877c35b4&page=queryresults
[0m10:57:03.920569 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.mrt_stores_items_monthly"
[0m10:57:03.921918 [debug] [Thread-1 (]: On model.local_bike.mrt_stores_items_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_items_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`items_stores_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **total number of items sold** per store over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT *
FROM (

  SELECT
    yeardate AS year,
    month_2digits as month,
    store_name,
    COUNT(total_items) AS nb_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year, month, store_name

)
PIVOT (

  SUM(nb_items) AS total_items
  FOR store_name IN ('Santa Cruz Bikes','Baldwin Bikes','Rowlett Bikes')

)
ORDER BY year, month
------------------------------------------
    );
  
[0m10:57:03.925723 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_stores_ranking_yearly"
[0m10:57:03.931151 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (compile): 10:57:03.906056 => 10:57:03.930463
[0m10:57:03.932762 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_stores_ranking_yearly
[0m10:57:03.943699 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:04.163584 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_stores_ranking_yearly"
[0m10:57:04.164508 [debug] [Thread-2 (]: On model.local_bike.mrt_stores_ranking_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_ranking_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`stores_ranking_yearly_report`
    
    

    OPTIONS(
      description="""This model provides **the ranking of best stores** over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT
  yeardate AS year_date,
  store_name,
  store_latitude,
  store_longitude,
  ROUND(SUM(total_sales_amount), 2) AS total_sales,
  RANK() OVER (PARTITION BY yeardate ORDER BY SUM(total_sales_amount) DESC) AS store_rank
FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
GROUP BY yeardate, store_name,store_latitude,store_longitude
ORDER BY yeardate, store_rank
------------------------------------------
    );
  
[0m10:57:04.197089 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (execute): 10:57:00.245693 => 10:57:04.196760
[0m10:57:04.198208 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc02918b0>]}
[0m10:57:04.199070 [info ] [Thread-4 (]: 17 of 24 OK created sql table model dbt_bike_gold.products_stores_ranking_yearly_report  [[32mCREATE TABLE (27.0 rows, 270.5 KiB processed)[0m in 4.01s]
[0m10:57:04.200362 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_products_ranking_yearly_top3
[0m10:57:04.201360 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_stores_sales_monthly
[0m10:57:04.202193 [info ] [Thread-4 (]: 21 of 24 START sql table model dbt_bike_gold.sales_stores_monthly_report ....... [RUN]
[0m10:57:04.203743 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_products_ranking_yearly_top3, now model.local_bike.mrt_stores_sales_monthly)
[0m10:57:04.204521 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_stores_sales_monthly
[0m10:57:04.211544 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_stores_sales_monthly"
[0m10:57:04.212705 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (compile): 10:57:04.204917 => 10:57:04.212301
[0m10:57:04.213622 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_stores_sales_monthly
[0m10:57:04.218101 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:04.422148 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.mrt_stores_sales_monthly"
[0m10:57:04.423101 [debug] [Thread-4 (]: On model.local_bike.mrt_stores_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_sales_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`sales_stores_monthly_report`
    
    

    OPTIONS(
      description="""This model provides **top sales by store** over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT *
FROM (

  SELECT
    yeardate AS year,
    month_2digits as month,
    store_name,
    ROUND(SUM(total_sales_amount), 2) AS sales_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year, month, store_name

)
PIVOT (

  SUM(sales_items) AS total_sales
  FOR store_name IN ('Santa Cruz Bikes','Baldwin Bikes','Rowlett Bikes')

)
ORDER BY year, month
------------------------------------------
    );
  
[0m10:57:06.534222 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:2d8ac3fe-5f01-4620-a0aa-767b94147cd2&page=queryresults
[0m10:57:06.768628 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:4a41a1b4-0816-420c-9948-6fc65b0181c8&page=queryresults
[0m10:57:06.825037 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:2a071150-a84e-4501-b26a-8eae7aa8b282&page=queryresults
[0m10:57:06.871233 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (execute): 10:57:04.214021 => 10:57:06.870889
[0m10:57:06.872563 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc33e7470>]}
[0m10:57:06.873698 [info ] [Thread-4 (]: 21 of 24 OK created sql table model dbt_bike_gold.sales_stores_monthly_report .. [[32mCREATE TABLE (35.0 rows, 215.1 KiB processed)[0m in 2.67s]
[0m10:57:06.875221 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_stores_sales_monthly
[0m10:57:06.876634 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_products_brands_monthly
[0m10:57:06.877737 [info ] [Thread-4 (]: 22 of 24 START sql table model dbt_bike_gold.products_brands_monthly_report .... [RUN]
[0m10:57:06.879545 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_sales_monthly, now model.local_bike.mrt_products_brands_monthly)
[0m10:57:06.880796 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_products_brands_monthly
[0m10:57:06.899247 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:06.903630 [debug] [Thread-4 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m10:57:07.135089 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (execute): 10:57:03.933681 => 10:57:07.134297
[0m10:57:07.136659 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcdd3c83e0>]}
[0m10:57:07.137947 [info ] [Thread-2 (]: 20 of 24 OK created sql table model dbt_bike_gold.stores_ranking_yearly_report . [[32mCREATE TABLE (9.0 rows, 215.1 KiB processed)[0m in 3.23s]
[0m10:57:07.140441 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_stores_ranking_yearly
[0m10:57:07.142005 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_staff_ranking_yearly
[0m10:57:07.143265 [info ] [Thread-2 (]: 23 of 24 START sql table model dbt_bike_gold.ranking_sales_staffs_yearly_top3_report  [RUN]
[0m10:57:07.145983 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_ranking_yearly, now model.local_bike.mrt_staff_ranking_yearly)
[0m10:57:07.146912 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_staff_ranking_yearly
[0m10:57:07.153191 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_staff_ranking_yearly"
[0m10:57:07.154843 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (compile): 10:57:07.147325 => 10:57:07.154291
[0m10:57:07.156502 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_staff_ranking_yearly
[0m10:57:07.161272 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:07.163505 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_items_monthly (execute): 10:57:03.695948 => 10:57:07.163163
[0m10:57:07.165104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc0250fe0>]}
[0m10:57:07.206109 [info ] [Thread-1 (]: 19 of 24 OK created sql table model dbt_bike_gold.items_stores_monthly_report .. [[32mCREATE TABLE (35.0 rows, 104.5 KiB processed)[0m in 3.49s]
[0m10:57:07.210722 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_stores_items_monthly
[0m10:57:07.212994 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_staff_sales_monthly
[0m10:57:07.214486 [info ] [Thread-1 (]: 24 of 24 START sql table model dbt_bike_gold.staffs_sales_monthly_report ....... [RUN]
[0m10:57:07.216400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_items_monthly, now model.local_bike.mrt_staff_sales_monthly)
[0m10:57:07.217701 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_staff_sales_monthly
[0m10:57:07.247794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:07.250747 [debug] [Thread-1 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m10:57:07.449998 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_staff_ranking_yearly"
[0m10:57:07.450924 [debug] [Thread-2 (]: On model.local_bike.mrt_staff_ranking_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_ranking_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`ranking_sales_staffs_yearly_top3_report`
    
    

    OPTIONS(
      description="""This model provides **Top seller** per store and per year over 3 years.\r\n\r\nIt provides a comprehensive view of each seller, allowing for easy analysis of seller performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH sales_staffs_stores AS (

  SELECT
    yeardate AS year,
    staff_first_name || '-' || staff_last_name || ' ('|| store_name || ')' AS staff_name,
    ROUND(SUM(total_item_sold_staff), 2) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  GROUP BY year, staff_name

)
SELECT
  year,
  staff_name,
  total_sales
FROM (
  SELECT
    *,
    RANK() OVER (PARTITION BY year ORDER BY total_sales DESC) AS rank_sales
  FROM sales_staffs_stores
)
WHERE rank_sales <= 3 
ORDER BY year, total_sales
    );
  
[0m10:57:09.009524 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:734e400e-fc3c-461e-a585-e915d9fe600b&page=queryresults
[0m10:57:09.010766 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_products_brands_monthly"
[0m10:57:09.011999 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_products_brands_monthly (compile): 10:57:06.881357 => 10:57:09.011609
[0m10:57:09.012617 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_products_brands_monthly
[0m10:57:09.151723 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.mrt_products_brands_monthly"
[0m10:57:09.152701 [debug] [Thread-4 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`products_brands_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **best-selling brands** per month over 3 years.\r\n\r\nIt provides a comprehensive view of each brand, allowing for easy analysis of brands performance."""
    )
    as (
      ------------------------------------------

------------------------------------------


------------------------------------------
SELECT *
FROM (

  SELECT
    yearmonth AS month,
    brand_name as Brand,    
    ROUND(SUM(total_item_discount_sold), 2 ) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily`
  GROUP BY month, brand

)
PIVOT (

  SUM(total_sales) AS sales
  FOR month IN ( '2016-01','2016-02','2016-03','2016-04','2016-05','2016-06','2016-07','2016-08','2016-09','2016-10','2016-11','2016-12','2017-01','2017-02','2017-03','2017-04','2017-05','2017-06','2017-07','2017-08','2017-09','2017-10','2017-11','2017-12','2018-01','2018-02','2018-03','2018-04','2018-06','2018-07','2018-08','2018-09','2018-10','2018-11','2018-12' )

)
ORDER BY Brand
------------------------------------------
    );
  
[0m10:57:09.838401 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:95f6ff05-a71a-4553-b775-9ad2bf7db95b&page=queryresults
[0m10:57:09.839488 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_staff_sales_monthly"
[0m10:57:09.840703 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (compile): 10:57:07.218387 => 10:57:09.840253
[0m10:57:09.841551 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_staff_sales_monthly
[0m10:57:09.978054 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.mrt_staff_sales_monthly"
[0m10:57:09.979025 [debug] [Thread-1 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`staffs_sales_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **best-seller** per month over 3 years.\r\n\r\nIt provides a comprehensive view of each seller, allowing for easy analysis of sellers performance."""
    )
    as (
      ------------------------------------------

------------------------------------------


------------------------------------------
SELECT *
FROM (

  SELECT
    staff_first_name || '-' || staff_last_name AS staff_name,
    yearmonth AS month,
    ROUND(SUM(total_item_sold_staff), 2 ) AS total_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  GROUP BY month, staff_name

)
PIVOT (

  SUM(total_items) AS sales
  FOR month IN ( '2016-01','2016-02','2016-03','2016-04','2016-05','2016-06','2016-07','2016-08','2016-09','2016-10','2016-11','2016-12','2017-01','2017-02','2017-03','2017-04','2017-05','2017-06','2017-07','2017-08','2017-09','2017-10','2017-11','2017-12','2018-01','2018-02','2018-03','2018-04','2018-06','2018-07','2018-08','2018-09','2018-10','2018-11','2018-12' )

)
ORDER BY staff_name
------------------------------------------
    );
  
[0m10:57:10.464507 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:c48297c0-58f5-4836-a9c5-2f7eb99fda03&page=queryresults
[0m10:57:10.789620 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (execute): 10:57:07.157008 => 10:57:10.789218
[0m10:57:10.791027 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc02bb440>]}
[0m10:57:10.792465 [info ] [Thread-2 (]: 23 of 24 OK created sql table model dbt_bike_gold.ranking_sales_staffs_yearly_top3_report  [[32mCREATE TABLE (9.0 rows, 185.9 KiB processed)[0m in 3.65s]
[0m10:57:10.794252 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_staff_ranking_yearly
[0m10:57:11.710509 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:14764a7e-2b47-4e8f-af3f-3b221a0132d8&page=queryresults
[0m10:57:12.018409 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_products_brands_monthly (execute): 10:57:09.012980 => 10:57:12.018097
[0m10:57:12.019522 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc360ed80>]}
[0m10:57:12.020484 [info ] [Thread-4 (]: 22 of 24 OK created sql table model dbt_bike_gold.products_brands_monthly_report  [[32mCREATE TABLE (9.0 rows, 217.4 KiB processed)[0m in 5.14s]
[0m10:57:12.021851 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_products_brands_monthly
[0m10:57:15.531106 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:4e1701de-2fa8-4184-99fe-08a83af48298&page=queryresults
[0m10:57:15.973037 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (execute): 10:57:09.841887 => 10:57:15.972690
[0m10:57:15.974122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc33e81a0>]}
[0m10:57:16.190860 [info ] [Thread-1 (]: 24 of 24 OK created sql table model dbt_bike_gold.staffs_sales_monthly_report .. [[32mCREATE TABLE (6.0 rows, 185.8 KiB processed)[0m in 8.76s]
[0m10:57:16.192247 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_staff_sales_monthly
[0m10:57:32.026261 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:b261d554-bd79-4e0b-bf05-e4861c4ec224&page=queryresults
[0m10:57:32.333378 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (execute): 10:57:00.467263 => 10:57:32.332828
[0m10:57:32.334653 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620064-92b9-4c91-88af-b9ce7febcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcc0250fe0>]}
[0m10:57:32.335544 [info ] [Thread-3 (]: 18 of 24 OK created sql table model dbt_bike_gold.sales_seasons_yearly_report .. [[32mCREATE TABLE (9.0 rows, 215.1 KiB processed)[0m in 31.91s]
[0m10:57:32.337148 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_sales_seasons_yearly
[0m10:57:32.343474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:32.344432 [debug] [MainThread]: Connection 'model.local_bike.mrt_sales_seasons_yearly' was properly closed.
[0m10:57:32.345340 [debug] [MainThread]: Connection 'model.local_bike.mrt_products_brands_monthly' was properly closed.
[0m10:57:32.345926 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_ranking_yearly' was properly closed.
[0m10:57:32.346576 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_sales_monthly' was properly closed.
[0m10:57:32.347262 [info ] [MainThread]: 
[0m10:57:32.348186 [info ] [MainThread]: Finished running 14 view models, 10 table models in 0 hours 0 minutes and 39.40 seconds (39.40s).
[0m10:57:32.358908 [debug] [MainThread]: Command end result
[0m10:57:32.390999 [info ] [MainThread]: 
[0m10:57:32.391831 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:57:32.392912 [info ] [MainThread]: 
[0m10:57:32.394408 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 TOTAL=24
[0m10:57:32.397487 [debug] [MainThread]: Command `dbt run` succeeded at 10:57:32.396718 after 43.02 seconds
[0m10:57:32.398804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcdc42e960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcdf24ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fcdb570e30>]}
[0m10:57:32.399747 [debug] [MainThread]: Flushing usage events
[0m10:57:39.421188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec437e3380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec43778860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec437e2ab0>]}


============================== 10:57:39.427258 | 380cf60d-5de2-48a5-872b-01c128356b57 ==============================
[0m10:57:39.427258 [info ] [MainThread]: Running with dbt=1.5.0
[0m10:57:39.428304 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'partial_parse': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'debug': 'False', 'warn_error': 'None', 'profiles_dir': '/root/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/usr/app/dbt/logs', 'log_format': 'default', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True', 'fail_fast': 'False'}
[0m10:57:41.058768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '380cf60d-5de2-48a5-872b-01c128356b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec30109f40>]}
[0m10:57:41.082485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '380cf60d-5de2-48a5-872b-01c128356b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec2b987170>]}
[0m10:57:41.133154 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m10:57:41.212713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:57:41.213320 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:57:41.223654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '380cf60d-5de2-48a5-872b-01c128356b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec301097f0>]}
[0m10:57:41.245575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '380cf60d-5de2-48a5-872b-01c128356b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec2b4e24b0>]}
[0m10:57:41.246390 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m10:57:41.247241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '380cf60d-5de2-48a5-872b-01c128356b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec2bcb3980>]}
[0m10:57:41.250495 [info ] [MainThread]: 
[0m10:57:41.252158 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:57:41.255493 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m10:57:41.256383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:41.257528 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m10:57:41.259636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:41.259094 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m10:57:41.260966 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m10:57:41.305677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:41.348687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:41.707509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '380cf60d-5de2-48a5-872b-01c128356b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec2b4e0b60>]}
[0m10:57:41.709331 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:57:41.710234 [info ] [MainThread]: 
[0m10:57:41.720789 [debug] [Thread-1 (]: Began running node test.local_bike.assert_total_order_amount_is_positive
[0m10:57:41.721791 [info ] [Thread-1 (]: 1 of 1 START test assert_total_order_amount_is_positive ........................ [RUN]
[0m10:57:41.723642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now test.local_bike.assert_total_order_amount_is_positive)
[0m10:57:41.724419 [debug] [Thread-1 (]: Began compiling node test.local_bike.assert_total_order_amount_is_positive
[0m10:57:41.730735 [debug] [Thread-1 (]: Writing injected SQL for node "test.local_bike.assert_total_order_amount_is_positive"
[0m10:57:41.731830 [debug] [Thread-1 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (compile): 10:57:41.724925 => 10:57:41.731433
[0m10:57:41.732406 [debug] [Thread-1 (]: Began executing node test.local_bike.assert_total_order_amount_is_positive
[0m10:57:41.762708 [debug] [Thread-1 (]: Writing runtime sql for node "test.local_bike.assert_total_order_amount_is_positive"
[0m10:57:41.763712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:41.766559 [debug] [Thread-1 (]: On test.local_bike.assert_total_order_amount_is_positive: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "test.local_bike.assert_total_order_amount_is_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Refunds have a negative amount, so the total amount should always be >= 0.
-- Therefore return records where total_amount < 0 to make the test fail
select
    order_id,
    sum(total_item_discount_sold) as total_amount  
from `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
group by 1
having total_amount < 0
      
    ) dbt_internal_test
[0m10:57:42.667904 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:cb756570-3e44-4f1f-add0-bd4ef2a9777e&page=queryresults
[0m10:57:42.670748 [debug] [Thread-1 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (execute): 10:57:41.732730 => 10:57:42.670170
[0m10:57:42.672463 [info ] [Thread-1 (]: 1 of 1 PASS assert_total_order_amount_is_positive .............................. [[32mPASS[0m in 0.95s]
[0m10:57:42.674460 [debug] [Thread-1 (]: Finished running node test.local_bike.assert_total_order_amount_is_positive
[0m10:57:42.679729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:42.680390 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_bronze' was properly closed.
[0m10:57:42.680841 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_seeds' was properly closed.
[0m10:57:42.681173 [debug] [MainThread]: Connection 'test.local_bike.assert_total_order_amount_is_positive' was properly closed.
[0m10:57:42.681477 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_silver' was properly closed.
[0m10:57:42.681970 [info ] [MainThread]: 
[0m10:57:42.682921 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m10:57:42.687246 [debug] [MainThread]: Command end result
[0m10:57:42.736660 [info ] [MainThread]: 
[0m10:57:42.738041 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:57:42.739029 [info ] [MainThread]: 
[0m10:57:42.740408 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:57:42.742033 [debug] [MainThread]: Command `dbt test` succeeded at 10:57:42.741680 after 3.33 seconds
[0m10:57:42.742868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec437363f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec438bbbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec44c77da0>]}
[0m10:57:42.743690 [debug] [MainThread]: Flushing usage events
[0m10:57:49.129074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7735af8c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7735a68170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7735a75070>]}


============================== 10:57:49.135402 | ee9a458a-994a-4c0a-8e40-67c6ad5985eb ==============================
[0m10:57:49.135402 [info ] [MainThread]: Running with dbt=1.5.0
[0m10:57:49.136434 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'printer_width': '80', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'version_check': 'True', 'quiet': 'False', 'no_print': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'introspect': 'True', 'log_format': 'default'}
[0m10:57:50.833874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee9a458a-994a-4c0a-8e40-67c6ad5985eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c773591da30>]}
[0m10:57:50.857638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee9a458a-994a-4c0a-8e40-67c6ad5985eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c771ddfa4b0>]}
[0m10:57:50.909632 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m10:57:50.991374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:57:50.991966 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:57:51.002578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee9a458a-994a-4c0a-8e40-67c6ad5985eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c771e106960>]}
[0m10:57:51.009240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee9a458a-994a-4c0a-8e40-67c6ad5985eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c771d92be30>]}
[0m10:57:51.010396 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m10:57:51.011305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee9a458a-994a-4c0a-8e40-67c6ad5985eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c771e12c500>]}
[0m10:57:51.015628 [info ] [MainThread]: 
[0m10:57:51.017683 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:57:51.025837 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m10:57:51.029028 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m10:57:51.030647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:51.032066 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m10:57:51.033686 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m10:57:51.077848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:51.035767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:51.034408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:51.476829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee9a458a-994a-4c0a-8e40-67c6ad5985eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c771d92bad0>]}
[0m10:57:51.478466 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:57:51.479265 [info ] [MainThread]: 
[0m10:57:51.489453 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_brands
[0m10:57:51.491044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.stg_src_local_bike_brands)
[0m10:57:51.491926 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_brands
[0m10:57:51.492913 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_categories
[0m10:57:51.504586 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.stg_src_local_bike_categories)
[0m10:57:51.499057 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_customers
[0m10:57:51.505499 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_categories
[0m10:57:51.502369 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_brands"
[0m10:57:51.503169 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_order_items
[0m10:57:51.507311 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.stg_src_local_bike_customers)
[0m10:57:51.513431 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.stg_src_local_bike_order_items)
[0m10:57:51.517630 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_customers
[0m10:57:51.528180 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_categories"
[0m10:57:51.528896 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_order_items
[0m10:57:51.533760 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_customers"
[0m10:57:51.534949 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (compile): 10:57:51.493398 => 10:57:51.534468
[0m10:57:51.542379 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_order_items"
[0m10:57:51.543627 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_brands
[0m10:57:51.544743 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (compile): 10:57:51.507814 => 10:57:51.544333
[0m10:57:51.545779 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (execute): 10:57:51.545368 => 10:57:51.545407
[0m10:57:51.546437 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_categories
[0m10:57:51.547329 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (compile): 10:57:51.535427 => 10:57:51.547001
[0m10:57:51.548341 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (compile): 10:57:51.529437 => 10:57:51.547642
[0m10:57:51.550074 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_brands
[0m10:57:51.550902 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (execute): 10:57:51.550503 => 10:57:51.550530
[0m10:57:51.551495 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_order_items
[0m10:57:51.552101 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_customers
[0m10:57:51.553089 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_orders
[0m10:57:51.554787 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_categories
[0m10:57:51.555538 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (execute): 10:57:51.555192 => 10:57:51.555213
[0m10:57:51.556272 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (execute): 10:57:51.555961 => 10:57:51.555979
[0m10:57:51.557261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_brands, now model.local_bike.stg_src_local_bike_orders)
[0m10:57:51.557984 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_products
[0m10:57:51.559484 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_order_items
[0m10:57:51.560850 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_customers
[0m10:57:51.561370 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_orders
[0m10:57:51.562666 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_categories, now model.local_bike.stg_src_local_bike_products)
[0m10:57:51.563320 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_staffs
[0m10:57:51.564090 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_stocks
[0m10:57:51.571330 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_orders"
[0m10:57:51.572012 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_products
[0m10:57:51.573129 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_order_items, now model.local_bike.stg_src_local_bike_staffs)
[0m10:57:51.574137 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_customers, now model.local_bike.stg_src_local_bike_stocks)
[0m10:57:51.578943 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_products"
[0m10:57:51.579785 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_staffs
[0m10:57:51.580480 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_stocks
[0m10:57:51.585931 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_staffs"
[0m10:57:51.587210 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (compile): 10:57:51.564662 => 10:57:51.586386
[0m10:57:51.588063 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_products (compile): 10:57:51.574704 => 10:57:51.587704
[0m10:57:51.592963 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stocks"
[0m10:57:51.593913 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_orders
[0m10:57:51.594818 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_products
[0m10:57:51.595924 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (execute): 10:57:51.595496 => 10:57:51.595522
[0m10:57:51.596778 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_products (execute): 10:57:51.596399 => 10:57:51.596420
[0m10:57:51.597472 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (compile): 10:57:51.581280 => 10:57:51.597161
[0m10:57:51.598137 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (compile): 10:57:51.588553 => 10:57:51.597784
[0m10:57:51.599572 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_orders
[0m10:57:51.600972 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_products
[0m10:57:51.601523 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_staffs
[0m10:57:51.602089 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_stocks
[0m10:57:51.602775 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_stores
[0m10:57:51.603578 [debug] [Thread-2 (]: Began running node seed.local_bike.map
[0m10:57:51.604450 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (execute): 10:57:51.604118 => 10:57:51.604135
[0m10:57:51.605261 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (execute): 10:57:51.604939 => 10:57:51.604959
[0m10:57:51.606213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_orders, now model.local_bike.stg_src_local_bike_stores)
[0m10:57:51.607178 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_products, now seed.local_bike.map)
[0m10:57:51.608997 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_staffs
[0m10:57:51.610432 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_stocks
[0m10:57:51.611155 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_stores
[0m10:57:51.611819 [debug] [Thread-2 (]: Began compiling node seed.local_bike.map
[0m10:57:51.612543 [debug] [Thread-4 (]: Began running node seed.local_bike.seasons
[0m10:57:51.613838 [debug] [Thread-3 (]: Began running node test.local_bike.assert_total_order_amount_is_positive
[0m10:57:51.619481 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stores"
[0m10:57:51.626098 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_staffs, now seed.local_bike.seasons)
[0m10:57:51.626802 [debug] [Thread-2 (]: Timing info for seed.local_bike.map (compile): 10:57:51.620158 => 10:57:51.625043
[0m10:57:51.627819 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stocks, now test.local_bike.assert_total_order_amount_is_positive)
[0m10:57:51.629908 [debug] [Thread-3 (]: Began compiling node test.local_bike.assert_total_order_amount_is_positive
[0m10:57:51.628556 [debug] [Thread-4 (]: Began compiling node seed.local_bike.seasons
[0m10:57:51.629223 [debug] [Thread-2 (]: Began executing node seed.local_bike.map
[0m10:57:51.634587 [debug] [Thread-3 (]: Writing injected SQL for node "test.local_bike.assert_total_order_amount_is_positive"
[0m10:57:51.637925 [debug] [Thread-4 (]: Timing info for seed.local_bike.seasons (compile): 10:57:51.635180 => 10:57:51.637514
[0m10:57:51.638903 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_stores (compile): 10:57:51.614566 => 10:57:51.638442
[0m10:57:51.641354 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_stores
[0m10:57:51.639864 [debug] [Thread-2 (]: Timing info for seed.local_bike.map (execute): 10:57:51.639474 => 10:57:51.639499
[0m10:57:51.640645 [debug] [Thread-4 (]: Began executing node seed.local_bike.seasons
[0m10:57:51.642058 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_stores (execute): 10:57:51.641722 => 10:57:51.641741
[0m10:57:51.642766 [debug] [Thread-3 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (compile): 10:57:51.630239 => 10:57:51.642346
[0m10:57:51.645668 [debug] [Thread-4 (]: Timing info for seed.local_bike.seasons (execute): 10:57:51.645197 => 10:57:51.645216
[0m10:57:51.644731 [debug] [Thread-2 (]: Finished running node seed.local_bike.map
[0m10:57:51.651836 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_product_daily
[0m10:57:51.647849 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_stores
[0m10:57:51.650471 [debug] [Thread-4 (]: Finished running node seed.local_bike.seasons
[0m10:57:51.652928 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.local_bike.map, now model.local_bike.int_src_local_bike_product_daily)
[0m10:57:51.648706 [debug] [Thread-3 (]: Began executing node test.local_bike.assert_total_order_amount_is_positive
[0m10:57:51.653758 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m10:57:51.654720 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_product_daily
[0m10:57:51.655424 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_store_daily
[0m10:57:51.656043 [debug] [Thread-3 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (execute): 10:57:51.655743 => 10:57:51.655763
[0m10:57:51.656998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stores, now model.local_bike.int_src_local_bike_staff_hierarchy)
[0m10:57:51.664633 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_product_daily"
[0m10:57:51.665736 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.local_bike.seasons, now model.local_bike.int_src_local_bike_store_daily)
[0m10:57:51.667236 [debug] [Thread-3 (]: Finished running node test.local_bike.assert_total_order_amount_is_positive
[0m10:57:51.668044 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_staff_hierarchy
[0m10:57:51.668914 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_store_daily
[0m10:57:51.669817 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_store_shipped_order
[0m10:57:51.676111 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (compile): 10:57:51.657392 => 10:57:51.675692
[0m10:57:51.676524 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m10:57:51.683896 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_daily"
[0m10:57:51.684976 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.local_bike.assert_total_order_amount_is_positive, now model.local_bike.int_src_local_bike_store_shipped_order)
[0m10:57:51.685676 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_product_daily
[0m10:57:51.688278 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (execute): 10:57:51.687941 => 10:57:51.687962
[0m10:57:51.687467 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (compile): 10:57:51.677015 => 10:57:51.687107
[0m10:57:51.686492 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_store_shipped_order
[0m10:57:51.689577 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_product_daily
[0m10:57:51.690257 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_store_daily
[0m10:57:51.696360 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (compile): 10:57:51.670433 => 10:57:51.695879
[0m10:57:51.699176 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m10:57:51.700585 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (execute): 10:57:51.700112 => 10:57:51.700139
[0m10:57:51.702936 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_store_daily
[0m10:57:51.701299 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_staff_hierarchy
[0m10:57:51.704382 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (execute): 10:57:51.704041 => 10:57:51.704056
[0m10:57:51.705753 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m10:57:51.706333 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_order_shipped_aborted_montly
[0m10:57:51.706838 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_order_shipped_montly
[0m10:57:51.707405 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_products_ranking_yearly_top3
[0m10:57:51.708022 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (compile): 10:57:51.690678 => 10:57:51.707728
[0m10:57:51.709241 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_product_daily, now model.local_bike.mrt_order_shipped_aborted_montly)
[0m10:57:51.710285 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_daily, now model.local_bike.mrt_order_shipped_montly)
[0m10:57:51.711237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_hierarchy, now model.local_bike.mrt_products_ranking_yearly_top3)
[0m10:57:51.711843 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_store_shipped_order
[0m10:57:51.712373 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_order_shipped_aborted_montly
[0m10:57:51.712924 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_order_shipped_montly
[0m10:57:51.713488 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_products_ranking_yearly_top3
[0m10:57:51.714205 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (execute): 10:57:51.713874 => 10:57:51.713897
[0m10:57:51.720117 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m10:57:51.725405 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_montly"
[0m10:57:51.733495 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m10:57:51.735063 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_store_shipped_order
[0m10:57:51.736456 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_order_shipped_montly (compile): 10:57:51.720668 => 10:57:51.736069
[0m10:57:51.737231 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_sales_seasons_yearly
[0m10:57:51.738168 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (compile): 10:57:51.725933 => 10:57:51.737822
[0m10:57:51.738786 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_order_shipped_montly
[0m10:57:51.739679 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (compile): 10:57:51.714539 => 10:57:51.739104
[0m10:57:51.740874 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_shipped_order, now model.local_bike.mrt_sales_seasons_yearly)
[0m10:57:51.741716 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_products_ranking_yearly_top3
[0m10:57:51.742488 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_order_shipped_montly (execute): 10:57:51.742133 => 10:57:51.742159
[0m10:57:51.743068 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_order_shipped_aborted_montly
[0m10:57:51.743612 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_sales_seasons_yearly
[0m10:57:51.744362 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (execute): 10:57:51.744024 => 10:57:51.744054
[0m10:57:51.745742 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_order_shipped_montly
[0m10:57:51.746439 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (execute): 10:57:51.746114 => 10:57:51.746137
[0m10:57:51.753237 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_products_ranking_yearly_top3
[0m10:57:51.751719 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_sales_seasons_yearly"
[0m10:57:51.754176 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_stores_items_monthly
[0m10:57:51.755726 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_order_shipped_aborted_montly
[0m10:57:51.756407 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_stores_ranking_yearly
[0m10:57:51.759411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_products_ranking_yearly_top3, now model.local_bike.mrt_stores_ranking_yearly)
[0m10:57:51.760144 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_stores_ranking_yearly
[0m10:57:51.757679 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_montly, now model.local_bike.mrt_stores_items_monthly)
[0m10:57:51.766413 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_stores_items_monthly
[0m10:57:51.758403 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_stores_sales_monthly
[0m10:57:51.767516 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_stores_ranking_yearly"
[0m10:57:51.774141 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_aborted_montly, now model.local_bike.mrt_stores_sales_monthly)
[0m10:57:51.776872 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_stores_items_monthly"
[0m10:57:51.777841 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (compile): 10:57:51.746826 => 10:57:51.777428
[0m10:57:51.778621 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_stores_sales_monthly
[0m10:57:51.779484 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_sales_seasons_yearly
[0m10:57:51.788137 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (execute): 10:57:51.787750 => 10:57:51.787770
[0m10:57:51.780208 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (compile): 10:57:51.760476 => 10:57:51.779851
[0m10:57:51.787150 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_stores_sales_monthly"
[0m10:57:51.789540 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_sales_seasons_yearly
[0m10:57:51.790228 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_stores_ranking_yearly
[0m10:57:51.791412 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_staff_daily
[0m10:57:51.792174 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_items_monthly (compile): 10:57:51.768154 => 10:57:51.791843
[0m10:57:51.792994 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (execute): 10:57:51.792580 => 10:57:51.792619
[0m10:57:51.794759 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_sales_seasons_yearly, now model.local_bike.int_src_local_bike_staff_daily)
[0m10:57:51.795905 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (compile): 10:57:51.780651 => 10:57:51.795499
[0m10:57:51.796449 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_stores_items_monthly
[0m10:57:51.797988 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_stores_ranking_yearly
[0m10:57:51.798710 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_staff_daily
[0m10:57:51.799342 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_stores_sales_monthly
[0m10:57:51.800074 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_items_monthly (execute): 10:57:51.799730 => 10:57:51.799751
[0m10:57:51.808540 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_daily"
[0m10:57:51.809635 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (execute): 10:57:51.809072 => 10:57:51.809098
[0m10:57:51.811676 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_stores_items_monthly
[0m10:57:51.813464 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_stores_sales_monthly
[0m10:57:51.814746 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (compile): 10:57:51.800788 => 10:57:51.814379
[0m10:57:51.815256 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_staff_daily
[0m10:57:51.815828 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (execute): 10:57:51.815535 => 10:57:51.815549
[0m10:57:51.817026 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_staff_daily
[0m10:57:51.818409 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_products_brands_monthly
[0m10:57:51.819007 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_staff_ranking_yearly
[0m10:57:51.819488 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_staff_sales_monthly
[0m10:57:51.820435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_ranking_yearly, now model.local_bike.mrt_products_brands_monthly)
[0m10:57:51.821423 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_items_monthly, now model.local_bike.mrt_staff_ranking_yearly)
[0m10:57:51.822358 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_sales_monthly, now model.local_bike.mrt_staff_sales_monthly)
[0m10:57:51.822947 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_products_brands_monthly
[0m10:57:51.823463 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_staff_ranking_yearly
[0m10:57:51.823984 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_staff_sales_monthly
[0m10:57:51.839845 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_staff_ranking_yearly"
[0m10:57:51.857449 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:51.857894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:51.860723 [debug] [Thread-1 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m10:57:51.903962 [debug] [Thread-2 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m10:57:51.944099 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (compile): 10:57:51.835118 => 10:57:51.943577
[0m10:57:51.945299 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_staff_ranking_yearly
[0m10:57:51.946823 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (execute): 10:57:51.946150 => 10:57:51.946176
[0m10:57:51.948834 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_staff_ranking_yearly
[0m10:57:52.938078 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:ff4fcd85-d61d-498d-ae25-60b527bd4eae&page=queryresults
[0m10:57:52.939150 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_staff_sales_monthly"
[0m10:57:52.940099 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (compile): 10:57:51.850638 => 10:57:52.939747
[0m10:57:52.940610 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_staff_sales_monthly
[0m10:57:52.941200 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (execute): 10:57:52.940907 => 10:57:52.940923
[0m10:57:52.942463 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_staff_sales_monthly
[0m10:57:52.963052 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:949ebb27-0186-4652-8fb0-8de8cbd7b86f&page=queryresults
[0m10:57:52.964144 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_products_brands_monthly"
[0m10:57:52.965101 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_products_brands_monthly (compile): 10:57:51.824333 => 10:57:52.964757
[0m10:57:52.965670 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_products_brands_monthly
[0m10:57:52.966263 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_products_brands_monthly (execute): 10:57:52.965974 => 10:57:52.965990
[0m10:57:52.967517 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_products_brands_monthly
[0m10:57:52.969702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:52.970253 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_ranking_yearly' was properly closed.
[0m10:57:52.970558 [debug] [MainThread]: Connection 'model.local_bike.mrt_products_brands_monthly' was properly closed.
[0m10:57:52.970904 [debug] [MainThread]: Connection 'model.local_bike.int_src_local_bike_staff_daily' was properly closed.
[0m10:57:52.971185 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_sales_monthly' was properly closed.
[0m10:57:52.978189 [debug] [MainThread]: Command end result
[0m10:57:53.016679 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m10:57:53.017145 [info ] [MainThread]: Building catalog
[0m10:57:53.025008 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:53.577733 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m10:57:53.584891 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m10:57:53.597876 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m10:57:53.606893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:53.766235 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m10:57:53.779088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:53.787576 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_gold`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_gold'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m10:57:53.780728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:53.799876 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_seeds`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_seeds'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m10:57:53.842471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:53.894125 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_bronze`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_bronze'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m10:57:53.941899 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_silver`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_silver'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m10:57:55.502833 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:7608ef29-38be-4e11-8879-dfdb57ed68ed&page=queryresults
[0m10:57:55.527148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:55.543297 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`src_local_bike`.__TABLES__
        where (upper(dataset_id) = upper('src_local_bike'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m10:57:55.589911 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:5f1353d8-cd48-402a-9200-a3028b2141b3&page=queryresults
[0m10:57:55.596438 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:b8196761-5d43-4bf4-8919-31bdd644da80&page=queryresults
[0m10:57:55.694576 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:bcb02285-c216-4b53-afb4-9cc2d1a66fc8&page=queryresults
[0m10:57:57.218902 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:5019fd5b-c961-4393-9ee3-6bdd262db672&page=queryresults
[0m10:57:57.433451 [info ] [MainThread]: Catalog written to /usr/app/dbt/target/catalog.json
[0m10:57:57.436765 [debug] [MainThread]: Command `dbt docs generate` succeeded at 10:57:57.435836 after 8.32 seconds
[0m10:57:57.437966 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m10:57:57.438919 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m10:57:57.440055 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m10:57:57.440932 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m10:57:57.441526 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m10:57:57.442388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7735a68170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c77368f78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c773591c8f0>]}
[0m10:57:57.443112 [debug] [MainThread]: Flushing usage events
[0m11:03:28.654296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751243d2b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7512437bab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7512437bae40>]}


============================== 11:03:28.660729 | c5515bd2-3138-4a2f-b866-efa12364b693 ==============================
[0m11:03:28.660729 [info ] [MainThread]: Running with dbt=1.5.0
[0m11:03:28.661856 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'log_path': '/usr/app/dbt/logs', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'write_json': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'target_path': 'None', 'printer_width': '80', 'version_check': 'True', 'static_parser': 'True', 'debug': 'False', 'partial_parse': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'profiles_dir': '/root/.dbt', 'use_colors': 'True'}
[0m11:03:30.180786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5515bd2-3138-4a2f-b866-efa12364b693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751243952270>]}
[0m11:03:30.204738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5515bd2-3138-4a2f-b866-efa12364b693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7512437d7560>]}
[0m11:03:30.254197 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m11:03:30.341097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:03:30.341659 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:03:30.352493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5515bd2-3138-4a2f-b866-efa12364b693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75122ba9e2d0>]}
[0m11:03:30.374686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5515bd2-3138-4a2f-b866-efa12364b693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75122b6b3e00>]}
[0m11:03:30.375646 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m11:03:30.376428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5515bd2-3138-4a2f-b866-efa12364b693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75122b6b3f50>]}
[0m11:03:30.382169 [info ] [MainThread]: 
[0m11:03:30.384291 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:03:30.387037 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m11:03:30.388738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:30.912916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_seeds)
[0m11:03:30.913834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:30.914997 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m11:03:30.916433 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m11:03:30.917543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:30.916981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:30.921564 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m11:03:31.003713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:31.356398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5515bd2-3138-4a2f-b866-efa12364b693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75123169b410>]}
[0m11:03:31.357635 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:03:31.358278 [info ] [MainThread]: 
[0m11:03:31.367289 [debug] [Thread-1 (]: Began running node seed.local_bike.map
[0m11:03:31.368125 [debug] [Thread-2 (]: Began running node seed.local_bike.seasons
[0m11:03:31.368933 [info ] [Thread-1 (]: 1 of 2 START seed file dbt_bike_seeds.map ...................................... [RUN]
[0m11:03:31.371557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now seed.local_bike.map)
[0m11:03:31.369966 [info ] [Thread-2 (]: 2 of 2 START seed file dbt_bike_seeds.seasons .................................. [RUN]
[0m11:03:31.373128 [debug] [Thread-1 (]: Began compiling node seed.local_bike.map
[0m11:03:31.374940 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now seed.local_bike.seasons)
[0m11:03:31.376445 [debug] [Thread-1 (]: Timing info for seed.local_bike.map (compile): 11:03:31.375782 => 11:03:31.375799
[0m11:03:31.377150 [debug] [Thread-2 (]: Began compiling node seed.local_bike.seasons
[0m11:03:31.377807 [debug] [Thread-1 (]: Began executing node seed.local_bike.map
[0m11:03:31.378557 [debug] [Thread-2 (]: Timing info for seed.local_bike.seasons (compile): 11:03:31.378203 => 11:03:31.378215
[0m11:03:31.389781 [debug] [Thread-2 (]: Began executing node seed.local_bike.seasons
[0m11:03:31.440696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:31.443103 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:03:34.623087 [debug] [Thread-2 (]: On seed.local_bike.seasons: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "seed.local_bike.seasons"} */

    alter table `databird-473015`.`dbt_bike_seeds`.`seasons` set OPTIONS()
  
[0m11:03:34.667109 [debug] [Thread-1 (]: On seed.local_bike.map: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "seed.local_bike.map"} */

    alter table `databird-473015`.`dbt_bike_seeds`.`map` set OPTIONS()
  
[0m11:03:35.219445 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:3be90419-71e6-49ec-9cc5-a42e6cdc38ee&page=queryresults
[0m11:03:35.230422 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.local_bike.map"
[0m11:03:35.233839 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:3cc7fd7e-256d-474e-998f-11840d02a902&page=queryresults
[0m11:03:35.235431 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.local_bike.seasons"
[0m11:03:35.288959 [debug] [Thread-1 (]: Timing info for seed.local_bike.map (execute): 11:03:31.379015 => 11:03:35.288412
[0m11:03:35.289925 [debug] [Thread-2 (]: Timing info for seed.local_bike.seasons (execute): 11:03:31.395465 => 11:03:35.286406
[0m11:03:35.291363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5515bd2-3138-4a2f-b866-efa12364b693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75122b7968a0>]}
[0m11:03:35.292917 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5515bd2-3138-4a2f-b866-efa12364b693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75122b7969f0>]}
[0m11:03:35.294008 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file dbt_bike_seeds.map .................................. [[32mINSERT 3[0m in 3.92s]
[0m11:03:35.295387 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file dbt_bike_seeds.seasons .............................. [[32mINSERT 12[0m in 3.92s]
[0m11:03:35.301378 [debug] [Thread-1 (]: Finished running node seed.local_bike.map
[0m11:03:35.304812 [debug] [Thread-2 (]: Finished running node seed.local_bike.seasons
[0m11:03:35.311523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:35.312249 [debug] [MainThread]: Connection 'seed.local_bike.seasons' was properly closed.
[0m11:03:35.312583 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_bronze' was properly closed.
[0m11:03:35.313098 [debug] [MainThread]: Connection 'seed.local_bike.map' was properly closed.
[0m11:03:35.313387 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_silver' was properly closed.
[0m11:03:35.313851 [info ] [MainThread]: 
[0m11:03:35.314638 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 4.93 seconds (4.93s).
[0m11:03:35.316498 [debug] [MainThread]: Command end result
[0m11:03:35.340257 [info ] [MainThread]: 
[0m11:03:35.341531 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:03:35.344128 [info ] [MainThread]: 
[0m11:03:35.345501 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:03:35.347653 [debug] [MainThread]: Command `dbt seed` succeeded at 11:03:35.347057 after 6.70 seconds
[0m11:03:35.349402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751243d00b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751243752900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7512439c6390>]}
[0m11:03:35.350847 [debug] [MainThread]: Flushing usage events
[0m11:03:42.305479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c7cffe3200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c7d0030860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c7d0596f90>]}


============================== 11:03:42.314345 | 9e9a53b1-3971-477f-a30a-8b2db21234a1 ==============================
[0m11:03:42.314345 [info ] [MainThread]: Running with dbt=1.5.0
[0m11:03:42.315535 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'static_parser': 'True', 'printer_width': '80', 'warn_error': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'partial_parse': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/app/dbt/logs', 'log_cache_events': 'False', 'quiet': 'False', 'write_json': 'True', 'use_colors': 'True', 'no_print': 'None', 'cache_selected_only': 'False'}
[0m11:03:42.415870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e9a53b1-3971-477f-a30a-8b2db21234a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c7cfffbbf0>]}
[0m11:03:42.417579 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xkp1rzvm'
[0m11:03:42.420834 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:03:42.535301 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:03:42.539007 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m11:03:42.594935 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m11:03:42.602322 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:03:42.658644 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:03:42.668067 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m11:03:42.722257 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m11:03:42.725147 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m11:03:42.726117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9e9a53b1-3971-477f-a30a-8b2db21234a1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c7cfe1e2a0>]}
[0m11:03:42.747172 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m11:03:44.877816 [info ] [MainThread]: Installed from version 0.10.5
[0m11:03:44.878485 [info ] [MainThread]: Up to date!
[0m11:03:44.879436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9e9a53b1-3971-477f-a30a-8b2db21234a1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c7cfe5ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c7cfe5f050>]}
[0m11:03:44.880519 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:03:45.097661 [info ] [MainThread]: Installed from version 1.3.2
[0m11:03:45.098439 [info ] [MainThread]: Up to date!
[0m11:03:45.100520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9e9a53b1-3971-477f-a30a-8b2db21234a1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c7cfe5ee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c7cfe5f050>]}
[0m11:03:45.101366 [info ] [MainThread]: Installing calogica/dbt_date
[0m11:03:45.248483 [info ] [MainThread]: Installed from version 0.10.1
[0m11:03:45.249169 [info ] [MainThread]: Up to date!
[0m11:03:45.250259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9e9a53b1-3971-477f-a30a-8b2db21234a1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c7d0c20aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c7cfe1c3b0>]}
[0m11:03:45.254268 [debug] [MainThread]: Command `dbt deps` succeeded at 11:03:45.253865 after 2.97 seconds
[0m11:03:45.255162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c7d0596e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c7d3c6aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c7d0ec1670>]}
[0m11:03:45.256493 [debug] [MainThread]: Flushing usage events
[0m11:03:51.730573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd34ff4170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd34fdaff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd34ff67b0>]}


============================== 11:03:51.736398 | 7a382c43-391e-4ce4-86d6-0151cb0f5be0 ==============================
[0m11:03:51.736398 [info ] [MainThread]: Running with dbt=1.5.0
[0m11:03:51.737906 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'target_path': 'None', 'no_print': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/usr/app/dbt/logs', 'static_parser': 'True', 'version_check': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80'}
[0m11:03:53.277793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd34f2fda0>]}
[0m11:03:53.307269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd2133b1a0>]}
[0m11:03:53.361209 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m11:03:53.443695 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:03:53.444278 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:03:53.454846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd21383140>]}
[0m11:03:53.477951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd20e7bf20>]}
[0m11:03:53.478970 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m11:03:53.480047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd22bdbe60>]}
[0m11:03:53.487100 [info ] [MainThread]: 
[0m11:03:53.489871 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:03:53.496415 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m11:03:53.498808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:53.498201 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m11:03:53.500745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:53.502145 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015'
[0m11:03:53.504054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:54.225356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_seeds)
[0m11:03:54.228199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:54.227379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_gold)
[0m11:03:54.231548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:54.236790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_databird-473015, now list_databird-473015_dbt_bike_bronze)
[0m11:03:54.237534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:54.321295 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m11:03:54.321916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:54.733492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd2155a0c0>]}
[0m11:03:54.734782 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:03:54.735478 [info ] [MainThread]: 
[0m11:03:54.744067 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_brands
[0m11:03:54.745149 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_categories
[0m11:03:54.745931 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_customers
[0m11:03:54.746515 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_order_items
[0m11:03:54.747447 [info ] [Thread-1 (]: 1 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_brands ......... [RUN]
[0m11:03:54.748837 [info ] [Thread-2 (]: 2 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_categories ..... [RUN]
[0m11:03:54.750164 [info ] [Thread-3 (]: 3 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_customers ...... [RUN]
[0m11:03:54.751954 [info ] [Thread-4 (]: 4 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_order_items .... [RUN]
[0m11:03:54.754917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.stg_src_local_bike_brands)
[0m11:03:54.757152 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.stg_src_local_bike_categories)
[0m11:03:54.758395 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.stg_src_local_bike_customers)
[0m11:03:54.759457 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.stg_src_local_bike_order_items)
[0m11:03:54.760141 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_brands
[0m11:03:54.760864 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_categories
[0m11:03:54.761435 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_customers
[0m11:03:54.761992 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_order_items
[0m11:03:54.767886 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_brands"
[0m11:03:54.773460 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_categories"
[0m11:03:54.778752 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_customers"
[0m11:03:54.789232 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (compile): 11:03:54.768494 => 11:03:54.788560
[0m11:03:54.789983 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_categories
[0m11:03:54.792568 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (compile): 11:03:54.774126 => 11:03:54.792117
[0m11:03:54.806437 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_customers
[0m11:03:54.819446 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (compile): 11:03:54.762367 => 11:03:54.818992
[0m11:03:54.853305 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_brands
[0m11:03:54.899194 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_order_items"
[0m11:03:54.932707 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_customers"
[0m11:03:54.937849 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_categories"
[0m11:03:54.938728 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_brands"
[0m11:03:54.940467 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:03:54.941697 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (compile): 11:03:54.779480 => 11:03:54.941059
[0m11:03:54.942327 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:03:54.943361 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_order_items
[0m11:03:54.944012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:54.946242 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_categories: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_categories"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_categories`
  OPTIONS(
      description="""Product categories such as road, mountain, and electric bikes."""
    )
  as select
        category_id as category_id,
        INITCAP(category_name) as category_name
from `databird-473015`.`src_local_bike`.`categories`;


[0m11:03:54.953093 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_order_items"
[0m11:03:54.955307 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_customers: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_customers"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_customers`
  OPTIONS(
      description="""Customer informations."""
    )
  as select
    customer_id as customer_id,
    INITCAP(first_name) as customer_first_name,
    INITCAP(last_name) as customer_last_name,
    phone as customer_phone,
    email as customer_email,
    INITCAP(street) as customer_street,
    INITCAP(city) as customer_city,
    UPPER(state) as customer_state,
    zip_code as customer_zip_code
from `databird-473015`.`src_local_bike`.`customers`;


[0m11:03:54.997699 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_brands: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_brands"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
  OPTIONS(
      description="""Bike brands sold by Local Bike."""
    )
  as select
        brand_id as brand_id,
        INITCAP(brand_name) as brand_name
from `databird-473015`.`src_local_bike`.`brands`;


[0m11:03:55.080816 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:03:55.085182 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_order_items: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_order_items"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
  OPTIONS(
      description="""Detailed order line items with pricing and discounts."""
    )
  as SELECT
  order_id as order_id,
  item_id AS item_id,
  product_id as product_id,
  quantity as quantity,
  list_price as list_price,
  discount as discount,
  
    list_price * quantity * ( 1 - discount )
 AS total_item_discount_sold
FROM `databird-473015`.`src_local_bike`.`order_items`;


[0m11:03:55.760381 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:ea4d2628-3ed0-4999-819c-4eddf02ae8c5&page=queryresults
[0m11:03:55.807261 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:079849bb-56bc-4f36-928f-53466ecd08d8&page=queryresults
[0m11:03:55.814093 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:c5d7093b-7009-4a3d-a6ae-75a82748bea7&page=queryresults
[0m11:03:55.831270 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:ee1bc78c-ac23-4375-8f32-afd205fb8976&page=queryresults
[0m11:03:56.105322 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (execute): 11:03:54.853994 => 11:03:56.104981
[0m11:03:56.106662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd20fa2390>]}
[0m11:03:56.108099 [info ] [Thread-1 (]: 1 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_brands .... [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m11:03:56.109566 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_brands
[0m11:03:56.111557 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (execute): 11:03:54.794743 => 11:03:56.111238
[0m11:03:56.112443 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_orders
[0m11:03:56.114030 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd23c731a0>]}
[0m11:03:56.115397 [info ] [Thread-1 (]: 5 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_orders ......... [RUN]
[0m11:03:56.117509 [info ] [Thread-2 (]: 2 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_categories  [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m11:03:56.119562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_brands, now model.local_bike.stg_src_local_bike_orders)
[0m11:03:56.121770 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_categories
[0m11:03:56.122703 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_orders
[0m11:03:56.124180 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_products
[0m11:03:56.132271 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_orders"
[0m11:03:56.133150 [info ] [Thread-2 (]: 6 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_products ....... [RUN]
[0m11:03:56.134671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_categories, now model.local_bike.stg_src_local_bike_products)
[0m11:03:56.135355 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_products
[0m11:03:56.144064 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_products"
[0m11:03:56.145368 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (compile): 11:03:56.124997 => 11:03:56.144946
[0m11:03:56.146051 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_orders
[0m11:03:56.151229 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_orders"
[0m11:03:56.152030 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_products (compile): 11:03:56.136273 => 11:03:56.151675
[0m11:03:56.152841 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_products
[0m11:03:56.163043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:56.171871 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_orders: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_orders"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`
  OPTIONS(
      description="""Order headers with key dates and statuses"""
    )
  as select
    order_id as order_id,
    customer_id as customer_id,
    order_status as order_status,
    CAST(order_date as date) as order_date,
    CAST(required_date as date) as required_date,
    CAST(shipped_date as date) as shipped_date,
    store_id as store_id,
    staff_id as staff_id,
    
    CASE
        WHEN EXTRACT(MONTH FROM order_date) IN (12, 1, 2) THEN 'Winter'
        WHEN EXTRACT(MONTH FROM order_date) IN (3, 4, 5) THEN 'Spring'
        WHEN EXTRACT(MONTH FROM order_date) IN (6, 7, 8) THEN 'Summer'
        WHEN EXTRACT(MONTH FROM order_date) IN (9, 10, 11) THEN 'Autumn'
    END
 AS season_name
from `databird-473015`.`src_local_bike`.`orders`;


[0m11:03:56.175329 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_products"
[0m11:03:56.218242 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (execute): 11:03:54.947472 => 11:03:56.217911
[0m11:03:56.222743 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (execute): 11:03:54.819921 => 11:03:56.222381
[0m11:03:56.224499 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd20fa2780>]}
[0m11:03:56.225866 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:03:56.227645 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd20fa2930>]}
[0m11:03:56.228980 [info ] [Thread-4 (]: 4 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_order_items  [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m11:03:56.239130 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_order_items
[0m11:03:56.235586 [debug] [Thread-2 (]: On model.local_bike.stg_src_local_bike_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_products"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_products`
  OPTIONS(
      description="""Products sold, linked to brands and categories."""
    )
  as select
        product_id as product_id,
        INITCAP(product_name) as product_name,
        brand_id as brand_id,
        category_id as category_id,
        model_year as model_year,
        coalesce(list_price,0) as list_price
from `databird-473015`.`src_local_bike`.`products`;


[0m11:03:56.237376 [info ] [Thread-3 (]: 3 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_customers . [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m11:03:56.241674 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_staffs
[0m11:03:56.289999 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_customers
[0m11:03:56.291486 [info ] [Thread-4 (]: 7 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_staffs ......... [RUN]
[0m11:03:56.293732 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_stocks
[0m11:03:56.295417 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_order_items, now model.local_bike.stg_src_local_bike_staffs)
[0m11:03:56.299894 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_staffs
[0m11:03:56.298086 [info ] [Thread-3 (]: 8 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_stocks ......... [RUN]
[0m11:03:56.309327 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_customers, now model.local_bike.stg_src_local_bike_stocks)
[0m11:03:56.310299 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_stocks
[0m11:03:56.313312 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_staffs"
[0m11:03:56.321232 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stocks"
[0m11:03:56.323517 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (compile): 11:03:56.314008 => 11:03:56.323005
[0m11:03:56.324337 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_stocks
[0m11:03:56.332330 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_stocks"
[0m11:03:56.333787 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (compile): 11:03:56.301289 => 11:03:56.333152
[0m11:03:56.334917 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:03:56.337128 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_staffs
[0m11:03:56.345390 [debug] [Thread-3 (]: On model.local_bike.stg_src_local_bike_stocks: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_stocks"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stocks`
  OPTIONS(
      description="""Stock of products and availability."""
    )
  as select
    store_id   as store_id,
    product_id as product_id,
    quantity   as stock_quantity
from `databird-473015`.`src_local_bike`.`stocks`;


[0m11:03:56.385319 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_staffs"
[0m11:03:56.386874 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:03:56.395723 [debug] [Thread-4 (]: On model.local_bike.stg_src_local_bike_staffs: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_staffs"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs`
  OPTIONS(
      description="""Sales and management staff working in Local Bike stores."""
    )
  as select
    CAST(staff_id AS int) as staff_id,
    INITCAP(first_name) as staff_first_name,
    INITCAP(last_name) as staff_last_name,
    phone as staff_phone,
    email as staff_email,
    active as staff_active,
    store_id as store_id,
    CAST(manager_id AS int)  as manager_id
from `databird-473015`.`src_local_bike`.`staffs`;


[0m11:03:56.970861 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:df8fc9a1-5e7c-4bf4-bc2c-9d28e5aa84b5&page=queryresults
[0m11:03:56.978146 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:3da3ae54-3521-4afb-b586-f0e0272c3b77&page=queryresults
[0m11:03:57.002456 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:7b887010-20d9-4067-9c8c-a2ff253c3631&page=queryresults
[0m11:03:57.094346 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:a0ca3e5e-b82c-4cc6-bf17-3a4976db28a9&page=queryresults
[0m11:03:57.302000 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (execute): 11:03:56.146505 => 11:03:57.301617
[0m11:03:57.303426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd211ca870>]}
[0m11:03:57.304710 [info ] [Thread-1 (]: 5 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_orders .... [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m11:03:57.306306 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_orders
[0m11:03:57.307869 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_stores
[0m11:03:57.309052 [info ] [Thread-1 (]: 9 of 24 START sql view model dbt_bike_bronze.stg_src_local_bike_stores ......... [RUN]
[0m11:03:57.311211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_orders, now model.local_bike.stg_src_local_bike_stores)
[0m11:03:57.312213 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_stores
[0m11:03:57.321580 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stores"
[0m11:03:57.326088 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_products (execute): 11:03:56.153230 => 11:03:57.325579
[0m11:03:57.327648 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd20fa1850>]}
[0m11:03:57.328534 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_stores (compile): 11:03:57.313376 => 11:03:57.328155
[0m11:03:57.329561 [info ] [Thread-2 (]: 6 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_products .. [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m11:03:57.330793 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_stores
[0m11:03:57.332776 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_products
[0m11:03:57.347160 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_product_daily
[0m11:03:57.358390 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.stg_src_local_bike_stores"
[0m11:03:57.354843 [info ] [Thread-2 (]: 10 of 24 START sql view model dbt_bike_silver.int_src_local_bike_product_daily . [RUN]
[0m11:03:57.361241 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_products, now model.local_bike.int_src_local_bike_product_daily)
[0m11:03:57.362220 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_product_daily
[0m11:03:57.371092 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_product_daily"
[0m11:03:57.372230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:57.375472 [debug] [Thread-1 (]: On model.local_bike.stg_src_local_bike_stores: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.stg_src_local_bike_stores"} */


  create or replace view `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`
  OPTIONS(
      description="""Store locations in California, New York, and Texas."""
    )
  as select
    store_id as store_id,
    INITCAP(store_name) as store_name,
    phone as store_phone,
    email as store_email,
    street as store_street,
    INITCAP(city) as store_city,
    UPPER(state) as store_state,
    zip_code as store_zip_code
from `databird-473015`.`src_local_bike`.`stores`;


[0m11:03:57.376732 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (compile): 11:03:57.362702 => 11:03:57.376206
[0m11:03:57.420869 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_product_daily
[0m11:03:57.422863 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (execute): 11:03:56.338347 => 11:03:57.422477
[0m11:03:57.429729 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd21076750>]}
[0m11:03:57.431681 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_product_daily"
[0m11:03:57.438138 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (execute): 11:03:56.326732 => 11:03:57.437150
[0m11:03:57.432823 [info ] [Thread-4 (]: 7 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_staffs .... [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m11:03:57.439930 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:03:57.441907 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd20f7bd40>]}
[0m11:03:57.443413 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_staffs
[0m11:03:57.447871 [info ] [Thread-3 (]: 8 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_stocks .... [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m11:03:57.450207 [debug] [Thread-2 (]: On model.local_bike.int_src_local_bike_product_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_product_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily`
  OPTIONS(
      description="""This model provides an aggregated view of product items. It enriches the products data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each product.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Product Informations**: Enriches the product with user-specific data, such as brand and category.\r\n\r\nIt provides a comprehensive view of each product, allowing for easy analysis of product performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH order_items AS (
  SELECT 
        order_id as order_id,
        item_id as item_id,
        product_id as product_id,
        quantity as quantity,
        list_price as list_price,
        discount as discount,
        ROUND((discount * 100),2) as discount_percent,
        ROUND(total_item_discount_sold, 2) as total_item_discount_sold 
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
),
------------------------------------------
orders_date AS (
  SELECT 
        order_id, 
        CAST(order_date as date) as order_date,
        store_id,
        season_name,
        EXTRACT(YEAR FROM order_date) as yeardate,
        EXTRACT(YEAR FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`
),
------------------------------------------
products AS (
  SELECT 
        product_id as product_id,
        product_name as product_name,
        brand_id as brand_id,
        category_id as category_id,
        model_year as product_model_year,
        ROUND(list_price,2) as list_price
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_products`
),
------------------------------------------
brands AS (
  SELECT 
        brand_id as brand_id,
        brand_name as brand_name
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_brands`
),
------------------------------------------
categories AS (
  SELECT 
        category_id as category_id,
        category_name as category_name
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_categories`
)
------------------------------------------
SELECT
  o.order_id,
  o.store_id,
  o.order_date,
  o.yeardate,
  o.monthday,
  o.yearmonth,
  o.month_2digits,
  o.month_name,
  o.month_abbrev,
  o.week_number,
  o.season_name,
  p.product_id,
  p.product_name,
  b.brand_name,
  c.category_name,
  oi.quantity,
  oi.list_price,
  oi.discount,
  oi.discount_percent,
  SUM(oi.total_item_discount_sold) as total_item_discount_sold,
  COUNT(*) as total_items
FROM orders_date as o
LEFT JOIN order_items as oi ON o.order_id = oi.order_id
LEFT JOIN products as p ON oi.product_id = p.product_id
LEFT JOIN brands as b ON p.brand_id = b.brand_id
LEFT JOIN categories as c ON p.category_id = c.category_id
GROUP BY 
  o.order_id,
  o.store_id,
  o.order_date,
  o.yeardate,
  o.monthday,
  o.yearmonth,
  o.month_2digits,
  o.month_name,
  o.month_abbrev,
  o.week_number,
  o.season_name, 
  p.product_id,
  p.product_name,
  b.brand_name,
  c.category_name,
  oi.quantity,
  oi.list_price,
  oi.discount,
  oi.discount_percent
ORDER BY o.yeardate, o.week_number, o.order_id;


[0m11:03:57.454992 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m11:03:57.453462 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_stocks
[0m11:03:57.496069 [info ] [Thread-4 (]: 11 of 24 START sql view model dbt_bike_silver.int_src_local_bike_staff_hierarchy  [RUN]
[0m11:03:57.500400 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_staffs, now model.local_bike.int_src_local_bike_staff_hierarchy)
[0m11:03:57.503143 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_staff_hierarchy
[0m11:03:57.512645 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m11:03:57.514545 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (compile): 11:03:57.503744 => 11:03:57.513900
[0m11:03:57.515478 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_staff_hierarchy
[0m11:03:57.529542 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m11:03:57.531547 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:03:57.534655 [debug] [Thread-4 (]: On model.local_bike.int_src_local_bike_staff_hierarchy: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_hierarchy"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy`
  OPTIONS(
      description="""This model provides an hirarchical view of employees. It enriches the store data with the following data:\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each employe.."""
    )
  as ------------------------------------------
  WITH RECURSIVE staff_hierarchy AS (

  -- Niveau 0 : managers racine
  SELECT
    m.staff_id,
    m.staff_first_name,
    m.staff_last_name,
    m.manager_id,
    m.store_id,
    m.staff_first_name || ' ' || m.staff_last_name AS path,
    0 AS level
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs` m
  WHERE m.manager_id IS NULL

  UNION ALL

  -- Niveaux suivants : rattacher les subordonnés
  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,    
    CONCAT(h.path, ' → ', s.staff_first_name, ' ', s.staff_last_name) AS path,
    h.level + 1 AS level
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_staffs` s
  JOIN staff_hierarchy as h ON s.manager_id = h.staff_id
  
)
------------------------------------------
SELECT 
     * 
FROM staff_hierarchy
ORDER BY path, level;


[0m11:03:58.147255 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:31752b11-2d2c-43ad-b0a1-f92fba54756f&page=queryresults
[0m11:03:58.277095 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:87c42273-e3e0-4fda-a418-b7ec7eee8b1a&page=queryresults
[0m11:03:58.302716 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:eb41ccc0-5c2a-46d1-904e-d35a17062c49&page=queryresults
[0m11:03:58.496815 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_stores (execute): 11:03:57.333461 => 11:03:58.496463
[0m11:03:58.497944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd2121a2d0>]}
[0m11:03:58.498847 [info ] [Thread-1 (]: 9 of 24 OK created sql view model dbt_bike_bronze.stg_src_local_bike_stores .... [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m11:03:58.500206 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_stores
[0m11:03:58.501958 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_store_daily
[0m11:03:58.502799 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_store_shipped_order
[0m11:03:58.503579 [info ] [Thread-3 (]: 12 of 24 START sql view model dbt_bike_silver.int_src_local_bike_store_daily ... [RUN]
[0m11:03:58.506938 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stocks, now model.local_bike.int_src_local_bike_store_daily)
[0m11:03:58.505007 [info ] [Thread-1 (]: 13 of 24 START sql view model dbt_bike_silver.int_src_local_bike_store_shipped_order  [RUN]
[0m11:03:58.509815 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_store_daily
[0m11:03:58.511241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stores, now model.local_bike.int_src_local_bike_store_shipped_order)
[0m11:03:58.517739 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_store_shipped_order
[0m11:03:58.521635 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_daily"
[0m11:03:58.530324 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m11:03:58.531744 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (compile): 11:03:58.511823 => 11:03:58.531264
[0m11:03:58.532515 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (compile): 11:03:58.522214 => 11:03:58.532166
[0m11:03:58.533390 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_store_daily
[0m11:03:58.534133 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_store_shipped_order
[0m11:03:58.546386 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m11:03:58.552903 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_store_daily"
[0m11:03:58.554394 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:03:58.555449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:58.559878 [debug] [Thread-3 (]: On model.local_bike.int_src_local_bike_store_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  OPTIONS(
      description="""This model provides an aggregated view of stores. It enriches the store data with the following metrics:\r\n- **Total Order Amount**: The sum of all order items for each store.\r\n- **Total Items**: The quantity of items in the store.\r\n- **Total Distinct Items**: The count of distinct product types in the order.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_date AS (

  SELECT 
        order_id, 
        order_date,
        shipped_date,
        required_date,
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    o.shipped_date,
    o.required_date,    
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.shipped_date,
    ls.required_date,     
    ls.order_id,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date,ls.shipped_date,ls.required_date, ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m11:03:58.562689 [debug] [Thread-1 (]: On model.local_bike.int_src_local_bike_store_shipped_order: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_store_shipped_order"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_shipped_order`
  OPTIONS(
      description="""This model provides the list of order required, shipped and aborted per month over 3 years.\r\n\r\nIt provides a comprehensive view of each order, allowing for easy analysis of order performance."""
    )
  as ------------------------------------------

------------------------------------------
WITH orders_shipped_date AS (

  SELECT 
        order_id, 
        order_date,
        required_date,
        shipped_date, 
        store_id,
        season_name,
        EXTRACT(YEAR  FROM order_date) as yeardate,
        EXTRACT(YEAR  FROM order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') AS yearmonth,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM order_date) AS STRING), 2, '0') AS monthday,
        LPAD(CAST( EXTRACT(MONTH FROM order_date) AS STRING), 2, '0') as month_2digits,
        FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_name,
        FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR  FROM order_date), '-', EXTRACT(MONTH FROM order_date), '-01'))) AS month_abbrev,
        LPAD(CAST(EXTRACT(ISOWEEK FROM order_date) AS STRING), 2, '0') AS week_number
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders`

),
------------------------------------------
items_sold AS (

  SELECT 
        order_id, 
        quantity, 
        total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

),
------------------------------------------
line_sales AS (

  SELECT
    o.order_date,
    required_date,
    shipped_date,
    o.order_id,
    o.yeardate,
    o.monthday,
    o.season_name,
    o.yearmonth,
    o.month_2digits,
    o.month_name,
    o.month_abbrev,
    o.week_number,
    o.store_id,
    m.store_latitude,
    m.store_longitude,
    i.total_item_discount_sold AS net_amount
  FROM orders_shipped_date o
  LEFT JOIN items_sold as i on o.order_id = i.order_id
  LEFT JOIN map as m on o.store_id = m.store_id

)
------------------------------------------ 
SELECT
    ls.order_date,
    ls.order_id,
    ls.shipped_date ,
    ls.required_date ,
    ls.yeardate,
    ls.monthday,
    ls.season_name,
    ls.yearmonth,
    ls.month_2digits,
    ls.month_name,
    ls.month_abbrev,
    ls.week_number,
    ls.store_id,
    s.store_name,
    ls.store_latitude,
    ls.store_longitude,    
    s.store_city,
    s.store_state,
    COUNT(DISTINCT ls.store_id || '_' || ls.order_date) AS nb_order_day,
    ROUND( SUM(ls.net_amount), 2) AS total_sales_amount,
    COUNT(*) AS total_items
FROM line_sales ls
LEFT JOIN stores as s on s.store_id = ls.store_id
GROUP BY ls.order_date, ls.shipped_date, ls.required_date,ls.order_id, ls.yeardate, ls.yearmonth, ls.week_number, ls.month_2digits, ls.month_name, ls.monthday, 
         ls.season_name,ls.month_abbrev,ls.store_id, s.store_name, s.store_city, s.store_state, ls.store_latitude, ls.store_longitude
ORDER BY ls.yeardate, ls.week_number, ls.store_id;


[0m11:03:58.645308 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (execute): 11:03:57.516107 => 11:03:58.644974
[0m11:03:58.646575 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd20609340>]}
[0m11:03:58.649068 [info ] [Thread-4 (]: 11 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_staff_hierarchy  [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m11:03:58.650570 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m11:03:58.660297 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (execute): 11:03:57.423581 => 11:03:58.657565
[0m11:03:58.664279 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd206095b0>]}
[0m11:03:58.668511 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_staff_daily
[0m11:03:58.667401 [info ] [Thread-2 (]: 10 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_product_daily  [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m11:03:58.673939 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_product_daily
[0m11:03:58.670248 [info ] [Thread-4 (]: 14 of 24 START sql view model dbt_bike_silver.int_src_local_bike_staff_daily ... [RUN]
[0m11:03:58.677889 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_hierarchy, now model.local_bike.int_src_local_bike_staff_daily)
[0m11:03:58.681116 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_staff_daily
[0m11:03:58.832834 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_daily"
[0m11:03:58.834365 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (compile): 11:03:58.682482 => 11:03:58.833929
[0m11:03:58.835175 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_staff_daily
[0m11:03:58.840359 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.int_src_local_bike_staff_daily"
[0m11:03:58.844656 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:03:58.849861 [debug] [Thread-4 (]: On model.local_bike.int_src_local_bike_staff_daily: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.int_src_local_bike_staff_daily"} */


  create or replace view `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  OPTIONS(
      description="""This model provides an aggregated view of staffs and stores. It enriches the store and staff data with the following metrics:\r\n- **Total item Amount**: The sum of all order items for each employe.\r\n- **Store Informations**: Enriches the store with user-specific data, such as city and state.\r\n- **Employee Informations**: Provides a hierarchical view of employees with user-specific data, such as store_id.\r\n\r\nIt provides a comprehensive view of each store and staffs, allowing for easy analysis of store performance, employee performance and geographic."""
    )
  as ------------------------------------------

------------------------------------------
WITH staff_list AS (

  SELECT
    s.staff_id,
    s.staff_first_name,
    s.staff_last_name,
    s.manager_id,
    s.store_id,
    s.path,
    s.level
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_hierarchy` s

),
------------------------------------------
sales_by_employee AS (

  SELECT
    o.order_date as order_date,
    o.season_name,
    EXTRACT(YEAR FROM o.order_date) as yeardate,
    EXTRACT(YEAR FROM o.order_date) || '-' || LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') AS yearmonth,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') || '-' || LPAD(CAST( EXTRACT(DAY FROM o.order_date) AS STRING), 2, '0') AS monthday,
    LPAD(CAST( EXTRACT(MONTH FROM o.order_date) AS STRING), 2, '0') as month_2digits,
    FORMAT_DATE('%B', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_name,
    FORMAT_DATE('%b', DATE(CONCAT(EXTRACT(YEAR FROM o.order_date), '-', EXTRACT(MONTH FROM o.order_date), '-01'))) AS month_abbrev,
    LPAD(CAST(EXTRACT(ISOWEEK FROM o.order_date) AS STRING), 2, '0') AS week_number,
    o.staff_id,
    oi.total_item_discount_sold as total_item_discount_sold
  FROM `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_orders` as o
  LEFT JOIN `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items` as oi ON o.order_id = oi.order_id

),
------------------------------------------
stores AS (

  SELECT store_id,
         store_name,
         store_city, 
         store_state
  FROM  `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_stores`

),
------------------------------------------
map AS (

  SELECT  
         store_id,
         city, 
         state,
         latitude as store_latitude,
         longitude as store_longitude
  FROM  `databird-473015`.`dbt_bike_seeds`.`map`

)
------------------------------------------
SELECT 
    em.order_date,
    em.yeardate,
    em.monthday,
    em.yearmonth,
    em.month_2digits,
    em.month_name,
    em.month_abbrev,
    em.week_number,
    em.season_name,
    st.store_name,
    m.store_latitude,
    m.store_longitude,    
    st.store_city,
    st.store_state,    
    ROUND(em.total_item_discount_sold, 2) as total_item_sold_staff,
    s.*
FROM sales_by_employee as em 
JOIN staff_list as s ON em.staff_id = s.staff_id
LEFT JOIN map as m on s.store_id = m.store_id
LEFT JOIN stores as st on m.store_id = st.store_id
ORDER BY em.order_date;


[0m11:03:59.576373 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:a096694d-0b6e-42c6-9486-242068804929&page=queryresults
[0m11:03:59.609309 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:22e1877f-20b1-4114-af09-23c33256f904&page=queryresults
[0m11:03:59.660837 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:5d3da397-29ce-4ce2-97b6-19fde5dbd445&page=queryresults
[0m11:03:59.910652 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (execute): 11:03:58.534562 => 11:03:59.910095
[0m11:03:59.912550 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd20622f90>]}
[0m11:03:59.914033 [info ] [Thread-3 (]: 12 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_store_daily  [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m11:03:59.916262 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_store_daily
[0m11:03:59.919918 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_order_shipped_aborted_montly
[0m11:03:59.922116 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_order_shipped_montly
[0m11:03:59.921107 [info ] [Thread-2 (]: 15 of 24 START sql table model dbt_bike_gold.orders_shipped_aborted_monthly_report  [RUN]
[0m11:03:59.928013 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_product_daily, now model.local_bike.mrt_order_shipped_aborted_montly)
[0m11:03:59.929809 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_order_shipped_aborted_montly
[0m11:03:59.923066 [info ] [Thread-3 (]: 16 of 24 START sql table model dbt_bike_gold.orders_shipped_monthly_report ..... [RUN]
[0m11:03:59.937965 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_daily, now model.local_bike.mrt_order_shipped_montly)
[0m11:03:59.943610 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m11:03:59.944549 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_order_shipped_montly
[0m11:03:59.951282 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_montly"
[0m11:03:59.952693 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (compile): 11:03:59.932031 => 11:03:59.952209
[0m11:03:59.953453 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_order_shipped_aborted_montly
[0m11:03:59.954271 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_order_shipped_montly (compile): 11:03:59.945261 => 11:03:59.953911
[0m11:03:59.960392 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_order_shipped_montly
[0m11:03:59.984733 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:03:59.993832 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:04:00.089457 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (execute): 11:03:58.835609 => 11:04:00.089014
[0m11:04:00.093655 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd37cb7cb0>]}
[0m11:04:00.100296 [info ] [Thread-4 (]: 14 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_staff_daily  [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m11:04:00.110188 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_staff_daily
[0m11:04:00.114860 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_products_ranking_yearly_top3
[0m11:04:00.118318 [info ] [Thread-4 (]: 17 of 24 START sql table model dbt_bike_gold.products_stores_ranking_yearly_report  [RUN]
[0m11:04:00.123714 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_daily, now model.local_bike.mrt_products_ranking_yearly_top3)
[0m11:04:00.125178 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_products_ranking_yearly_top3
[0m11:04:00.137468 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m11:04:00.140768 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (compile): 11:04:00.125935 => 11:04:00.139966
[0m11:04:00.141855 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_products_ranking_yearly_top3
[0m11:04:00.159954 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:04:00.396566 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.mrt_order_shipped_montly"
[0m11:04:00.399390 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m11:04:00.401298 [debug] [Thread-3 (]: On model.local_bike.mrt_order_shipped_montly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_order_shipped_montly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`orders_shipped_monthly_report`
    
    

    OPTIONS(
      description="""This model provides an aggregated view of the orders sent. It enriches the order data with the following metrics:\r\n- **nb_order_shipped**: The quantity of orders shipped.\r\n- **total_sales**: The cost of orders shipped.\r\n- **Order Informations**: Enriches the product with user-specific data, such as store name.\r\n\r\nIt provides a comprehensive view the aborted order, allowing for easy analysis of order performance."""
    )
    as (
      ------------------------------------------

------------------------------------------

WITH total_orders AS (

  SELECT
    yearmonth AS month,
    COUNT(order_date) AS nb_order_shipped,
    ROUND(SUM(total_sales_amount),2) as total_sales,
    store_name
  FROM  `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  WHERE shipped_date is not null
  GROUP BY month,store_name

)
------------------------------------------
SELECT *
FROM total_orders
------------------------------------------
    );
  
[0m11:04:00.404126 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m11:04:00.407961 [debug] [Thread-2 (]: On model.local_bike.mrt_order_shipped_aborted_montly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_order_shipped_aborted_montly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`orders_shipped_aborted_monthly_report`
    
    

    OPTIONS(
      description="""This model provides an aggregated view of the canceled orders. It enriches the order data with the following metrics:\r\n- **nb_shipped_aborted**: The quantity of order aborted.\r\n- **total_aborted_sales**: The cost of aborted orders.\r\n- **Order Informations**: Enriches the product with user-specific data, such as store name.\r\n\r\nIt provides a comprehensive view the aborted order, allowing for easy analysis of order performance."""
    )
    as (
      ------------------------------------------

------------------------------------------

WITH total_aborted_orders AS (

  SELECT
    yearmonth AS month,
    COUNTIF(shipped_date IS NULL) AS nb_shipped_aborted,
    ROUND(SUM(total_sales_amount),2) as total_aborted_sales,
    store_name
  FROM  `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  WHERE shipped_date is null
  GROUP BY month,store_name

)
------------------------------------------
SELECT *
FROM total_aborted_orders
------------------------------------------
    );
  
[0m11:04:00.409570 [debug] [Thread-4 (]: On model.local_bike.mrt_products_ranking_yearly_top3: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_ranking_yearly_top3"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`products_stores_ranking_yearly_report`
    
    

    OPTIONS(
      description="""This model provides the top 3 **best-selling products** per year over 3 years.\r\n\r\nIt provides a comprehensive view of each product, allowing for easy analysis of products performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH product_sales AS (
  SELECT
    p.yeardate AS year,
    s.store_name AS store,
    p.product_name,
    p.brand_name,
    ROUND(SUM(total_item_discount_sold), 2) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily` AS p
  LEFT JOIN `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`AS s
    ON p.order_id = s.order_id 
   AND p.store_id = s.store_id
  GROUP BY year,store,product_name,brand_name
)
------------------------------------------
SELECT
  year,
  store,
  product_name,
  brand_name,
  total_sales
FROM (
  SELECT
    *,
    RANK() OVER ( PARTITION BY year, store ORDER BY total_sales DESC ) AS rank_product
  FROM product_sales
)
WHERE rank_product <= 3
ORDER BY year, store
------------------------------------------
    );
  
[0m11:04:00.540928 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (execute): 11:03:58.541662 => 11:04:00.540535
[0m11:04:00.542240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd20ee9f40>]}
[0m11:04:00.543228 [info ] [Thread-1 (]: 13 of 24 OK created sql view model dbt_bike_silver.int_src_local_bike_store_shipped_order  [[32mCREATE VIEW (0 processed)[0m in 2.03s]
[0m11:04:00.544578 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_store_shipped_order
[0m11:04:00.546819 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_sales_seasons_yearly
[0m11:04:00.548012 [info ] [Thread-1 (]: 18 of 24 START sql table model dbt_bike_gold.sales_seasons_yearly_report ....... [RUN]
[0m11:04:00.549958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_shipped_order, now model.local_bike.mrt_sales_seasons_yearly)
[0m11:04:00.551410 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_sales_seasons_yearly
[0m11:04:00.559898 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_sales_seasons_yearly"
[0m11:04:00.561459 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (compile): 11:04:00.551987 => 11:04:00.560818
[0m11:04:00.562321 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_sales_seasons_yearly
[0m11:04:00.567274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:00.778653 [debug] [Thread-1 (]: Writing runtime sql for node "model.local_bike.mrt_sales_seasons_yearly"
[0m11:04:00.779793 [debug] [Thread-1 (]: On model.local_bike.mrt_sales_seasons_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_sales_seasons_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`sales_seasons_yearly_report`
    
    

    OPTIONS(
      description="""This model provides the **top-performing store by season** and per year over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH sales_stores_seasons AS (

  SELECT
    yeardate AS year,
    store_name AS store,
    season_name,
    ROUND(SUM(total_sales_amount), 2) AS sales_amount
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year,store,season_name

)

SELECT *
FROM sales_stores_seasons
PIVOT (
  SUM(sales_amount) AS sales
  FOR season_name IN ('Winter','Spring','Summer','Autumn')
)
ORDER BY year, store
------------------------------------------
    );
  
[0m11:04:02.877711 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:3644fc96-a7b9-4bc1-8607-416e466f6486&page=queryresults
[0m11:04:03.038839 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:0e4e32e3-7650-4e37-a209-94f1d16bd066&page=queryresults
[0m11:04:03.216053 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_order_shipped_montly (execute): 11:03:59.966211 => 11:04:03.215678
[0m11:04:03.217368 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd20587fb0>]}
[0m11:04:03.218383 [info ] [Thread-3 (]: 16 of 24 OK created sql table model dbt_bike_gold.orders_shipped_monthly_report  [[32mCREATE TABLE (81.0 rows, 215.1 KiB processed)[0m in 3.28s]
[0m11:04:03.219939 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_order_shipped_montly
[0m11:04:03.220930 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_stores_items_monthly
[0m11:04:03.221663 [info ] [Thread-3 (]: 19 of 24 START sql table model dbt_bike_gold.items_stores_monthly_report ....... [RUN]
[0m11:04:03.223126 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_montly, now model.local_bike.mrt_stores_items_monthly)
[0m11:04:03.224183 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_stores_items_monthly
[0m11:04:03.232926 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_stores_items_monthly"
[0m11:04:03.234340 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_stores_items_monthly (compile): 11:04:03.224681 => 11:04:03.233816
[0m11:04:03.234997 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_stores_items_monthly
[0m11:04:03.239366 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:04:03.332168 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (execute): 11:03:59.954635 => 11:04:03.331507
[0m11:04:03.334187 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd20561130>]}
[0m11:04:03.335679 [info ] [Thread-2 (]: 15 of 24 OK created sql table model dbt_bike_gold.orders_shipped_aborted_monthly_report  [[32mCREATE TABLE (38.0 rows, 215.1 KiB processed)[0m in 3.41s]
[0m11:04:03.339178 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_order_shipped_aborted_montly
[0m11:04:03.343573 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_stores_ranking_yearly
[0m11:04:03.344847 [info ] [Thread-2 (]: 20 of 24 START sql table model dbt_bike_gold.stores_ranking_yearly_report ...... [RUN]
[0m11:04:03.350889 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_aborted_montly, now model.local_bike.mrt_stores_ranking_yearly)
[0m11:04:03.353200 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_stores_ranking_yearly
[0m11:04:03.360879 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_stores_ranking_yearly"
[0m11:04:03.362529 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (compile): 11:04:03.354475 => 11:04:03.362017
[0m11:04:03.363425 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_stores_ranking_yearly
[0m11:04:03.371120 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:04:03.470817 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.mrt_stores_items_monthly"
[0m11:04:03.472292 [debug] [Thread-3 (]: On model.local_bike.mrt_stores_items_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_items_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`items_stores_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **total number of items sold** per store over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT *
FROM (

  SELECT
    yeardate AS year,
    month_2digits as month,
    store_name,
    COUNT(total_items) AS nb_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year, month, store_name

)
PIVOT (

  SUM(nb_items) AS total_items
  FOR store_name IN ('Santa Cruz Bikes','Baldwin Bikes','Rowlett Bikes')

)
ORDER BY year, month
------------------------------------------
    );
  
[0m11:04:03.517279 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:4156f248-7deb-4f5d-a46a-f6cade3ec536&page=queryresults
[0m11:04:03.584327 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_stores_ranking_yearly"
[0m11:04:03.585543 [debug] [Thread-2 (]: On model.local_bike.mrt_stores_ranking_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_ranking_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`stores_ranking_yearly_report`
    
    

    OPTIONS(
      description="""This model provides **the ranking of best stores** over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT
  yeardate AS year_date,
  store_name,
  store_latitude,
  store_longitude,
  ROUND(SUM(total_sales_amount), 2) AS total_sales,
  RANK() OVER (PARTITION BY yeardate ORDER BY SUM(total_sales_amount) DESC) AS store_rank
FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
GROUP BY yeardate, store_name,store_latitude,store_longitude
ORDER BY yeardate, store_rank
------------------------------------------
    );
  
[0m11:04:03.826019 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (execute): 11:04:00.142268 => 11:04:03.825635
[0m11:04:03.827386 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd2059fb60>]}
[0m11:04:03.828427 [info ] [Thread-4 (]: 17 of 24 OK created sql table model dbt_bike_gold.products_stores_ranking_yearly_report  [[32mCREATE TABLE (27.0 rows, 270.5 KiB processed)[0m in 3.71s]
[0m11:04:03.830037 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_products_ranking_yearly_top3
[0m11:04:03.831079 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_stores_sales_monthly
[0m11:04:03.832337 [info ] [Thread-4 (]: 21 of 24 START sql table model dbt_bike_gold.sales_stores_monthly_report ....... [RUN]
[0m11:04:03.834189 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_products_ranking_yearly_top3, now model.local_bike.mrt_stores_sales_monthly)
[0m11:04:03.835057 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_stores_sales_monthly
[0m11:04:03.843858 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_stores_sales_monthly"
[0m11:04:03.845303 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (compile): 11:04:03.835515 => 11:04:03.844764
[0m11:04:03.846012 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_stores_sales_monthly
[0m11:04:03.850352 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:04:04.081416 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.mrt_stores_sales_monthly"
[0m11:04:04.082836 [debug] [Thread-4 (]: On model.local_bike.mrt_stores_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_stores_sales_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`sales_stores_monthly_report`
    
    

    OPTIONS(
      description="""This model provides **top sales by store** over 3 years.\r\n\r\nIt provides a comprehensive view of each store, allowing for easy analysis of store performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
SELECT *
FROM (

  SELECT
    yeardate AS year,
    month_2digits as month,
    store_name,
    ROUND(SUM(total_sales_amount), 2) AS sales_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_store_daily`
  GROUP BY year, month, store_name

)
PIVOT (

  SUM(sales_items) AS total_sales
  FOR store_name IN ('Santa Cruz Bikes','Baldwin Bikes','Rowlett Bikes')

)
ORDER BY year, month
------------------------------------------
    );
  
[0m11:04:06.003123 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:c8dcc208-c629-4241-8fbd-4dd6c4f806d1&page=queryresults
[0m11:04:06.406421 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:b8882b14-fdeb-4b41-be98-532b04cc29d0&page=queryresults
[0m11:04:06.411843 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_stores_items_monthly (execute): 11:04:03.235328 => 11:04:06.411502
[0m11:04:06.412986 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd205932f0>]}
[0m11:04:06.413878 [info ] [Thread-3 (]: 19 of 24 OK created sql table model dbt_bike_gold.items_stores_monthly_report .. [[32mCREATE TABLE (35.0 rows, 104.5 KiB processed)[0m in 3.19s]
[0m11:04:06.415546 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_stores_items_monthly
[0m11:04:06.416546 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_products_brands_monthly
[0m11:04:06.417801 [info ] [Thread-3 (]: 22 of 24 START sql table model dbt_bike_gold.products_brands_monthly_report .... [RUN]
[0m11:04:06.420532 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_items_monthly, now model.local_bike.mrt_products_brands_monthly)
[0m11:04:06.421539 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_products_brands_monthly
[0m11:04:06.436492 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:04:06.439218 [debug] [Thread-3 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m11:04:06.656391 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:8be81dd1-38f0-4dc6-93c0-8c92d8d84df9&page=queryresults
[0m11:04:06.711029 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (execute): 11:04:03.846333 => 11:04:06.710715
[0m11:04:06.712172 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd36defcb0>]}
[0m11:04:06.713164 [info ] [Thread-4 (]: 21 of 24 OK created sql table model dbt_bike_gold.sales_stores_monthly_report .. [[32mCREATE TABLE (35.0 rows, 215.1 KiB processed)[0m in 2.88s]
[0m11:04:06.715109 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_stores_sales_monthly
[0m11:04:06.716053 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_staff_ranking_yearly
[0m11:04:06.717085 [info ] [Thread-4 (]: 23 of 24 START sql table model dbt_bike_gold.ranking_sales_staffs_yearly_top3_report  [RUN]
[0m11:04:06.718674 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_sales_monthly, now model.local_bike.mrt_staff_ranking_yearly)
[0m11:04:06.719413 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_staff_ranking_yearly
[0m11:04:06.726652 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_staff_ranking_yearly"
[0m11:04:06.727809 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (compile): 11:04:06.719936 => 11:04:06.727352
[0m11:04:06.728356 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_staff_ranking_yearly
[0m11:04:06.732165 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:04:06.940982 [debug] [Thread-4 (]: Writing runtime sql for node "model.local_bike.mrt_staff_ranking_yearly"
[0m11:04:06.942015 [debug] [Thread-4 (]: On model.local_bike.mrt_staff_ranking_yearly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_ranking_yearly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`ranking_sales_staffs_yearly_top3_report`
    
    

    OPTIONS(
      description="""This model provides **Top seller** per store and per year over 3 years.\r\n\r\nIt provides a comprehensive view of each seller, allowing for easy analysis of seller performance."""
    )
    as (
      ------------------------------------------

------------------------------------------
WITH sales_staffs_stores AS (

  SELECT
    yeardate AS year,
    staff_first_name || '-' || staff_last_name || ' ('|| store_name || ')' AS staff_name,
    ROUND(SUM(total_item_sold_staff), 2) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  GROUP BY year, staff_name

)
SELECT
  year,
  staff_name,
  total_sales
FROM (
  SELECT
    *,
    RANK() OVER (PARTITION BY year ORDER BY total_sales DESC) AS rank_sales
  FROM sales_staffs_stores
)
WHERE rank_sales <= 3 
ORDER BY year, total_sales
    );
  
[0m11:04:07.087516 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (execute): 11:04:03.363788 => 11:04:07.087197
[0m11:04:07.089108 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd20440ec0>]}
[0m11:04:07.090461 [info ] [Thread-2 (]: 20 of 24 OK created sql table model dbt_bike_gold.stores_ranking_yearly_report . [[32mCREATE TABLE (9.0 rows, 215.1 KiB processed)[0m in 3.74s]
[0m11:04:07.092105 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_stores_ranking_yearly
[0m11:04:07.093127 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_staff_sales_monthly
[0m11:04:07.094715 [info ] [Thread-2 (]: 24 of 24 START sql table model dbt_bike_gold.staffs_sales_monthly_report ....... [RUN]
[0m11:04:07.097136 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_ranking_yearly, now model.local_bike.mrt_staff_sales_monthly)
[0m11:04:07.098249 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_staff_sales_monthly
[0m11:04:07.110061 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:04:07.115068 [debug] [Thread-2 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m11:04:09.087821 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:c250c219-b9e3-4a76-9ad8-e3e1d65c4eb1&page=queryresults
[0m11:04:09.089302 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_products_brands_monthly"
[0m11:04:09.090565 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_products_brands_monthly (compile): 11:04:06.422013 => 11:04:09.090085
[0m11:04:09.091225 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_products_brands_monthly
[0m11:04:09.197611 [debug] [Thread-3 (]: Writing runtime sql for node "model.local_bike.mrt_products_brands_monthly"
[0m11:04:09.198795 [debug] [Thread-3 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`products_brands_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **best-selling brands** per month over 3 years.\r\n\r\nIt provides a comprehensive view of each brand, allowing for easy analysis of brands performance."""
    )
    as (
      ------------------------------------------

------------------------------------------


------------------------------------------
SELECT *
FROM (

  SELECT
    yearmonth AS month,
    brand_name as Brand,    
    ROUND(SUM(total_item_discount_sold), 2 ) AS total_sales
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_product_daily`
  GROUP BY month, brand

)
PIVOT (

  SUM(total_sales) AS sales
  FOR month IN ( '2016-01','2016-02','2016-03','2016-04','2016-05','2016-06','2016-07','2016-08','2016-09','2016-10','2016-11','2016-12','2017-01','2017-02','2017-03','2017-04','2017-05','2017-06','2017-07','2017-08','2017-09','2017-10','2017-11','2017-12','2018-01','2018-02','2018-03','2018-04','2018-06','2018-07','2018-08','2018-09','2018-10','2018-11','2018-12' )

)
ORDER BY Brand
------------------------------------------
    );
  
[0m11:04:09.644320 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:ad7f7cde-68ad-460b-9969-771add70fef7&page=queryresults
[0m11:04:09.646422 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_staff_sales_monthly"
[0m11:04:09.647954 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (compile): 11:04:07.098928 => 11:04:09.647413
[0m11:04:09.648694 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_staff_sales_monthly
[0m11:04:09.758413 [debug] [Thread-2 (]: Writing runtime sql for node "model.local_bike.mrt_staff_sales_monthly"
[0m11:04:09.759663 [debug] [Thread-2 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

  
    

    create or replace table `databird-473015`.`dbt_bike_gold`.`staffs_sales_monthly_report`
    
    

    OPTIONS(
      description="""This model provides the **best-seller** per month over 3 years.\r\n\r\nIt provides a comprehensive view of each seller, allowing for easy analysis of sellers performance."""
    )
    as (
      ------------------------------------------

------------------------------------------


------------------------------------------
SELECT *
FROM (

  SELECT
    staff_first_name || '-' || staff_last_name AS staff_name,
    yearmonth AS month,
    ROUND(SUM(total_item_sold_staff), 2 ) AS total_items
  FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
  GROUP BY month, staff_name

)
PIVOT (

  SUM(total_items) AS sales
  FOR month IN ( '2016-01','2016-02','2016-03','2016-04','2016-05','2016-06','2016-07','2016-08','2016-09','2016-10','2016-11','2016-12','2017-01','2017-02','2017-03','2017-04','2017-05','2017-06','2017-07','2017-08','2017-09','2017-10','2017-11','2017-12','2018-01','2018-02','2018-03','2018-04','2018-06','2018-07','2018-08','2018-09','2018-10','2018-11','2018-12' )

)
ORDER BY staff_name
------------------------------------------
    );
  
[0m11:04:10.643072 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:7d7fa757-112b-484e-8081-7cb8816ae7ba&page=queryresults
[0m11:04:11.140704 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (execute): 11:04:06.728664 => 11:04:11.140350
[0m11:04:11.141861 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd206086b0>]}
[0m11:04:11.142846 [info ] [Thread-4 (]: 23 of 24 OK created sql table model dbt_bike_gold.ranking_sales_staffs_yearly_top3_report  [[32mCREATE TABLE (9.0 rows, 185.9 KiB processed)[0m in 4.42s]
[0m11:04:11.145585 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_staff_ranking_yearly
[0m11:04:11.670820 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:e23881dc-c035-4cdc-acc1-75e23fe8e314&page=queryresults
[0m11:04:12.013451 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_products_brands_monthly (execute): 11:04:09.091509 => 11:04:12.013096
[0m11:04:12.014891 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd20593c80>]}
[0m11:04:12.015998 [info ] [Thread-3 (]: 22 of 24 OK created sql table model dbt_bike_gold.products_brands_monthly_report  [[32mCREATE TABLE (9.0 rows, 217.4 KiB processed)[0m in 5.60s]
[0m11:04:12.017991 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_products_brands_monthly
[0m11:04:13.957718 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:ad06c7e6-7e92-4831-9e3e-bd110ce18d1c&page=queryresults
[0m11:04:14.268714 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (execute): 11:04:09.649371 => 11:04:14.268339
[0m11:04:14.270132 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd20440260>]}
[0m11:04:14.485318 [info ] [Thread-2 (]: 24 of 24 OK created sql table model dbt_bike_gold.staffs_sales_monthly_report .. [[32mCREATE TABLE (6.0 rows, 185.8 KiB processed)[0m in 7.17s]
[0m11:04:14.487045 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_staff_sales_monthly
[0m11:04:15.484099 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:73d7b84d-421c-47db-b0f7-d3b1c3a482bf&page=queryresults
[0m11:04:15.809367 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (execute): 11:04:00.562726 => 11:04:15.809044
[0m11:04:15.810626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a382c43-391e-4ce4-86d6-0151cb0f5be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd2060c0e0>]}
[0m11:04:15.811534 [info ] [Thread-1 (]: 18 of 24 OK created sql table model dbt_bike_gold.sales_seasons_yearly_report .. [[32mCREATE TABLE (9.0 rows, 215.1 KiB processed)[0m in 15.26s]
[0m11:04:15.812977 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_sales_seasons_yearly
[0m11:04:15.817335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:15.817923 [debug] [MainThread]: Connection 'model.local_bike.mrt_sales_seasons_yearly' was properly closed.
[0m11:04:15.818250 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_sales_monthly' was properly closed.
[0m11:04:15.818902 [debug] [MainThread]: Connection 'model.local_bike.mrt_products_brands_monthly' was properly closed.
[0m11:04:15.819247 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_ranking_yearly' was properly closed.
[0m11:04:15.819997 [info ] [MainThread]: 
[0m11:04:15.820710 [info ] [MainThread]: Finished running 14 view models, 10 table models in 0 hours 0 minutes and 22.33 seconds (22.33s).
[0m11:04:15.830222 [debug] [MainThread]: Command end result
[0m11:04:15.861973 [info ] [MainThread]: 
[0m11:04:15.862860 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:04:15.863649 [info ] [MainThread]: 
[0m11:04:15.864459 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 TOTAL=24
[0m11:04:15.865732 [debug] [MainThread]: Command `dbt run` succeeded at 11:04:15.865426 after 24.15 seconds
[0m11:04:15.866409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd35c3f920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd38cb2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd38a59010>]}
[0m11:04:15.867122 [debug] [MainThread]: Flushing usage events
[0m11:04:22.434812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b3321bb260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b33210fce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b3328d75f0>]}


============================== 11:04:22.440669 | 37b4f811-2250-4857-a7ba-3f360563e473 ==============================
[0m11:04:22.440669 [info ] [MainThread]: Running with dbt=1.5.0
[0m11:04:22.442142 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/usr/app/dbt/logs', 'log_format': 'default', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'no_print': 'None', 'fail_fast': 'False', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/root/.dbt', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'introspect': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'quiet': 'False'}
[0m11:04:24.002195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37b4f811-2250-4857-a7ba-3f360563e473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b335e7ea50>]}
[0m11:04:24.026684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37b4f811-2250-4857-a7ba-3f360563e473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b31a70f5c0>]}
[0m11:04:24.078071 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m11:04:24.162281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:04:24.162884 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:04:24.174463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37b4f811-2250-4857-a7ba-3f360563e473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b31aa702f0>]}
[0m11:04:24.200813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37b4f811-2250-4857-a7ba-3f360563e473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b31a43ff50>]}
[0m11:04:24.202518 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m11:04:24.203871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37b4f811-2250-4857-a7ba-3f360563e473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b31ae1daf0>]}
[0m11:04:24.210774 [info ] [MainThread]: 
[0m11:04:24.212737 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:04:24.217389 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m11:04:24.219123 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m11:04:24.219992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:24.221191 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m11:04:24.222051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:24.223643 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m11:04:24.224835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:24.265824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:24.758074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37b4f811-2250-4857-a7ba-3f360563e473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b31be0de50>]}
[0m11:04:24.759332 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:04:24.760196 [info ] [MainThread]: 
[0m11:04:24.767718 [debug] [Thread-1 (]: Began running node test.local_bike.assert_total_order_amount_is_positive
[0m11:04:24.768524 [info ] [Thread-1 (]: 1 of 1 START test assert_total_order_amount_is_positive ........................ [RUN]
[0m11:04:24.770217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now test.local_bike.assert_total_order_amount_is_positive)
[0m11:04:24.770935 [debug] [Thread-1 (]: Began compiling node test.local_bike.assert_total_order_amount_is_positive
[0m11:04:24.779495 [debug] [Thread-1 (]: Writing injected SQL for node "test.local_bike.assert_total_order_amount_is_positive"
[0m11:04:24.780671 [debug] [Thread-1 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (compile): 11:04:24.771387 => 11:04:24.780251
[0m11:04:24.781247 [debug] [Thread-1 (]: Began executing node test.local_bike.assert_total_order_amount_is_positive
[0m11:04:24.818030 [debug] [Thread-1 (]: Writing runtime sql for node "test.local_bike.assert_total_order_amount_is_positive"
[0m11:04:24.819096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:24.821369 [debug] [Thread-1 (]: On test.local_bike.assert_total_order_amount_is_positive: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "test.local_bike.assert_total_order_amount_is_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Refunds have a negative amount, so the total amount should always be >= 0.
-- Therefore return records where total_amount < 0 to make the test fail
select
    order_id,
    sum(total_item_discount_sold) as total_amount  
from `databird-473015`.`dbt_bike_bronze`.`stg_src_local_bike_order_items`
group by 1
having total_amount < 0
      
    ) dbt_internal_test
[0m11:04:25.678394 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:f638944f-e434-4663-95ec-a69d0c11013b&page=queryresults
[0m11:04:25.681343 [debug] [Thread-1 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (execute): 11:04:24.781556 => 11:04:25.680781
[0m11:04:25.683044 [info ] [Thread-1 (]: 1 of 1 PASS assert_total_order_amount_is_positive .............................. [[32mPASS[0m in 0.91s]
[0m11:04:25.684855 [debug] [Thread-1 (]: Finished running node test.local_bike.assert_total_order_amount_is_positive
[0m11:04:25.692371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:25.693243 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_seeds' was properly closed.
[0m11:04:25.693854 [debug] [MainThread]: Connection 'test.local_bike.assert_total_order_amount_is_positive' was properly closed.
[0m11:04:25.694335 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_gold' was properly closed.
[0m11:04:25.694809 [debug] [MainThread]: Connection 'list_databird-473015_dbt_bike_silver' was properly closed.
[0m11:04:25.695272 [info ] [MainThread]: 
[0m11:04:25.695970 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m11:04:25.697582 [debug] [MainThread]: Command end result
[0m11:04:25.757363 [info ] [MainThread]: 
[0m11:04:25.758481 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:04:25.759307 [info ] [MainThread]: 
[0m11:04:25.760533 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:04:25.761815 [debug] [MainThread]: Command `dbt test` succeeded at 11:04:25.761505 after 3.34 seconds
[0m11:04:25.762574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b3328d75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b3321baed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b3321bbfe0>]}
[0m11:04:25.763831 [debug] [MainThread]: Flushing usage events
[0m11:04:32.605293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6ae1bb740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6ae334fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6ae3cb2c0>]}


============================== 11:04:32.611556 | 7b13e25e-c096-49eb-ab5f-bc175efb0745 ==============================
[0m11:04:32.611556 [info ] [MainThread]: Running with dbt=1.5.0
[0m11:04:32.612731 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'debug': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'profiles_dir': '/root/.dbt', 'quiet': 'False', 'use_colors': 'True', 'introspect': 'True', 'log_format': 'default'}
[0m11:04:34.107626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b13e25e-c096-49eb-ab5f-bc175efb0745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6ae1fcbf0>]}
[0m11:04:34.131947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b13e25e-c096-49eb-ab5f-bc175efb0745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e696cd0d10>]}
[0m11:04:34.188826 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m11:04:34.303437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:04:34.304093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:04:34.316072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b13e25e-c096-49eb-ab5f-bc175efb0745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6965d8800>]}
[0m11:04:34.321382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b13e25e-c096-49eb-ab5f-bc175efb0745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6967167e0>]}
[0m11:04:34.322165 [info ] [MainThread]: Found 24 models, 1 test, 0 snapshots, 0 analyses, 744 macros, 0 operations, 2 seed files, 9 sources, 0 exposures, 0 metrics, 0 groups
[0m11:04:34.322983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b13e25e-c096-49eb-ab5f-bc175efb0745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e69659d070>]}
[0m11:04:34.329703 [info ] [MainThread]: 
[0m11:04:34.331716 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:04:34.335195 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_gold'
[0m11:04:34.337565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:34.337028 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_seeds'
[0m11:04:34.338582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:34.339820 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_silver'
[0m11:04:34.341329 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_databird-473015_dbt_bike_bronze'
[0m11:04:34.423186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:34.424946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:34.779812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b13e25e-c096-49eb-ab5f-bc175efb0745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e69654aea0>]}
[0m11:04:34.781006 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:04:34.781866 [info ] [MainThread]: 
[0m11:04:34.791996 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_brands
[0m11:04:34.793051 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_categories
[0m11:04:34.794330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_gold, now model.local_bike.stg_src_local_bike_brands)
[0m11:04:34.795419 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_customers
[0m11:04:34.796192 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_order_items
[0m11:04:34.797345 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_silver, now model.local_bike.stg_src_local_bike_categories)
[0m11:04:34.797989 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_brands
[0m11:04:34.798989 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_seeds, now model.local_bike.stg_src_local_bike_customers)
[0m11:04:34.800301 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_databird-473015_dbt_bike_bronze, now model.local_bike.stg_src_local_bike_order_items)
[0m11:04:34.801115 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_categories
[0m11:04:34.807088 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_customers
[0m11:04:34.807622 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_brands"
[0m11:04:34.808259 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_order_items
[0m11:04:34.817954 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_customers"
[0m11:04:34.836112 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_order_items"
[0m11:04:34.846263 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_categories"
[0m11:04:34.847924 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (compile): 11:04:34.801586 => 11:04:34.847430
[0m11:04:34.850005 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_brands
[0m11:04:34.850748 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_brands (execute): 11:04:34.850372 => 11:04:34.850402
[0m11:04:34.849262 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (compile): 11:04:34.813405 => 11:04:34.848788
[0m11:04:34.852275 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_brands
[0m11:04:34.854349 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_orders
[0m11:04:34.853585 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_customers
[0m11:04:34.852970 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (compile): 11:04:34.825485 => 11:04:34.852636
[0m11:04:34.855524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_brands, now model.local_bike.stg_src_local_bike_orders)
[0m11:04:34.856392 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_customers (execute): 11:04:34.856052 => 11:04:34.856077
[0m11:04:34.857096 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (compile): 11:04:34.808701 => 11:04:34.856789
[0m11:04:34.857617 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_order_items
[0m11:04:34.858158 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_orders
[0m11:04:34.859570 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_customers
[0m11:04:34.860131 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_categories
[0m11:04:34.860849 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_order_items (execute): 11:04:34.860490 => 11:04:34.860510
[0m11:04:34.867222 [debug] [Thread-3 (]: Began running node model.local_bike.stg_src_local_bike_products
[0m11:04:34.869322 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_orders"
[0m11:04:34.870458 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_categories (execute): 11:04:34.870064 => 11:04:34.870082
[0m11:04:34.872050 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_order_items
[0m11:04:34.873168 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_customers, now model.local_bike.stg_src_local_bike_products)
[0m11:04:34.876685 [debug] [Thread-3 (]: Began compiling node model.local_bike.stg_src_local_bike_products
[0m11:04:34.875561 [debug] [Thread-4 (]: Began running node model.local_bike.stg_src_local_bike_staffs
[0m11:04:34.874793 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_categories
[0m11:04:34.877420 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (compile): 11:04:34.861193 => 11:04:34.877035
[0m11:04:34.882327 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_products"
[0m11:04:34.883551 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_order_items, now model.local_bike.stg_src_local_bike_staffs)
[0m11:04:34.885933 [debug] [Thread-4 (]: Began compiling node model.local_bike.stg_src_local_bike_staffs
[0m11:04:34.884422 [debug] [Thread-2 (]: Began running node model.local_bike.stg_src_local_bike_stocks
[0m11:04:34.885217 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_orders
[0m11:04:34.893352 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_orders (execute): 11:04:34.892943 => 11:04:34.892968
[0m11:04:34.892336 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_categories, now model.local_bike.stg_src_local_bike_stocks)
[0m11:04:34.891047 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_staffs"
[0m11:04:34.894373 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_products (compile): 11:04:34.877773 => 11:04:34.893731
[0m11:04:34.896385 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_orders
[0m11:04:34.897064 [debug] [Thread-2 (]: Began compiling node model.local_bike.stg_src_local_bike_stocks
[0m11:04:34.897817 [debug] [Thread-3 (]: Began executing node model.local_bike.stg_src_local_bike_products
[0m11:04:34.898579 [debug] [Thread-1 (]: Began running node model.local_bike.stg_src_local_bike_stores
[0m11:04:34.904016 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stocks"
[0m11:04:34.905178 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (compile): 11:04:34.886277 => 11:04:34.904734
[0m11:04:34.906152 [debug] [Thread-3 (]: Timing info for model.local_bike.stg_src_local_bike_products (execute): 11:04:34.905724 => 11:04:34.905749
[0m11:04:34.907322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_orders, now model.local_bike.stg_src_local_bike_stores)
[0m11:04:34.910470 [debug] [Thread-1 (]: Began compiling node model.local_bike.stg_src_local_bike_stores
[0m11:04:34.909799 [debug] [Thread-3 (]: Finished running node model.local_bike.stg_src_local_bike_products
[0m11:04:34.908182 [debug] [Thread-4 (]: Began executing node model.local_bike.stg_src_local_bike_staffs
[0m11:04:34.911275 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (compile): 11:04:34.899402 => 11:04:34.910865
[0m11:04:34.916061 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.stg_src_local_bike_stores"
[0m11:04:34.916996 [debug] [Thread-3 (]: Began running node seed.local_bike.map
[0m11:04:34.918029 [debug] [Thread-4 (]: Timing info for model.local_bike.stg_src_local_bike_staffs (execute): 11:04:34.917651 => 11:04:34.917669
[0m11:04:34.919125 [debug] [Thread-2 (]: Began executing node model.local_bike.stg_src_local_bike_stocks
[0m11:04:34.923235 [debug] [Thread-2 (]: Timing info for model.local_bike.stg_src_local_bike_stocks (execute): 11:04:34.922813 => 11:04:34.922830
[0m11:04:34.920533 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_products, now seed.local_bike.map)
[0m11:04:34.922251 [debug] [Thread-4 (]: Finished running node model.local_bike.stg_src_local_bike_staffs
[0m11:04:34.924687 [debug] [Thread-2 (]: Finished running node model.local_bike.stg_src_local_bike_stocks
[0m11:04:34.925328 [debug] [Thread-3 (]: Began compiling node seed.local_bike.map
[0m11:04:34.926095 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_stores (compile): 11:04:34.911627 => 11:04:34.925722
[0m11:04:34.927525 [debug] [Thread-4 (]: Began running node seed.local_bike.seasons
[0m11:04:34.928357 [debug] [Thread-2 (]: Began running node test.local_bike.assert_total_order_amount_is_positive
[0m11:04:34.935222 [debug] [Thread-3 (]: Timing info for seed.local_bike.map (compile): 11:04:34.929730 => 11:04:34.934447
[0m11:04:34.936550 [debug] [Thread-1 (]: Began executing node model.local_bike.stg_src_local_bike_stores
[0m11:04:34.938120 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_staffs, now seed.local_bike.seasons)
[0m11:04:34.939413 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stocks, now test.local_bike.assert_total_order_amount_is_positive)
[0m11:04:34.940121 [debug] [Thread-3 (]: Began executing node seed.local_bike.map
[0m11:04:34.940930 [debug] [Thread-1 (]: Timing info for model.local_bike.stg_src_local_bike_stores (execute): 11:04:34.940538 => 11:04:34.940558
[0m11:04:34.941486 [debug] [Thread-4 (]: Began compiling node seed.local_bike.seasons
[0m11:04:34.942065 [debug] [Thread-2 (]: Began compiling node test.local_bike.assert_total_order_amount_is_positive
[0m11:04:34.942922 [debug] [Thread-3 (]: Timing info for seed.local_bike.map (execute): 11:04:34.942458 => 11:04:34.942480
[0m11:04:34.944348 [debug] [Thread-1 (]: Finished running node model.local_bike.stg_src_local_bike_stores
[0m11:04:34.947640 [debug] [Thread-4 (]: Timing info for seed.local_bike.seasons (compile): 11:04:34.944716 => 11:04:34.947187
[0m11:04:34.954930 [debug] [Thread-2 (]: Writing injected SQL for node "test.local_bike.assert_total_order_amount_is_positive"
[0m11:04:34.956524 [debug] [Thread-3 (]: Finished running node seed.local_bike.map
[0m11:04:34.957314 [debug] [Thread-1 (]: Began running node model.local_bike.int_src_local_bike_product_daily
[0m11:04:34.958042 [debug] [Thread-4 (]: Began executing node seed.local_bike.seasons
[0m11:04:34.960956 [debug] [Thread-4 (]: Timing info for seed.local_bike.seasons (execute): 11:04:34.960582 => 11:04:34.960630
[0m11:04:34.958840 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m11:04:34.962274 [debug] [Thread-4 (]: Finished running node seed.local_bike.seasons
[0m11:04:34.959908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.stg_src_local_bike_stores, now model.local_bike.int_src_local_bike_product_daily)
[0m11:04:34.962910 [debug] [Thread-2 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (compile): 11:04:34.948115 => 11:04:34.962570
[0m11:04:34.964064 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.local_bike.map, now model.local_bike.int_src_local_bike_staff_hierarchy)
[0m11:04:34.964843 [debug] [Thread-4 (]: Began running node model.local_bike.int_src_local_bike_store_daily
[0m11:04:34.965502 [debug] [Thread-1 (]: Began compiling node model.local_bike.int_src_local_bike_product_daily
[0m11:04:34.966082 [debug] [Thread-2 (]: Began executing node test.local_bike.assert_total_order_amount_is_positive
[0m11:04:34.966620 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_staff_hierarchy
[0m11:04:34.967567 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.local_bike.seasons, now model.local_bike.int_src_local_bike_store_daily)
[0m11:04:34.975275 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_product_daily"
[0m11:04:34.976212 [debug] [Thread-2 (]: Timing info for test.local_bike.assert_total_order_amount_is_positive (execute): 11:04:34.975826 => 11:04:34.975849
[0m11:04:34.981168 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_hierarchy"
[0m11:04:34.981995 [debug] [Thread-4 (]: Began compiling node model.local_bike.int_src_local_bike_store_daily
[0m11:04:34.983683 [debug] [Thread-2 (]: Finished running node test.local_bike.assert_total_order_amount_is_positive
[0m11:04:34.991284 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_daily"
[0m11:04:34.993115 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (compile): 11:04:34.976656 => 11:04:34.992512
[0m11:04:34.996543 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_staff_hierarchy
[0m11:04:34.997855 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (compile): 11:04:34.984397 => 11:04:34.997329
[0m11:04:34.999142 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_staff_hierarchy (execute): 11:04:34.998415 => 11:04:34.998437
[0m11:04:34.995365 [debug] [Thread-2 (]: Began running node model.local_bike.int_src_local_bike_store_shipped_order
[0m11:04:34.994260 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (compile): 11:04:34.967970 => 11:04:34.993758
[0m11:04:34.999907 [debug] [Thread-4 (]: Began executing node model.local_bike.int_src_local_bike_store_daily
[0m11:04:35.002372 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_staff_hierarchy
[0m11:04:35.003912 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.local_bike.assert_total_order_amount_is_positive, now model.local_bike.int_src_local_bike_store_shipped_order)
[0m11:04:35.004816 [debug] [Thread-1 (]: Began executing node model.local_bike.int_src_local_bike_product_daily
[0m11:04:35.008090 [debug] [Thread-1 (]: Timing info for model.local_bike.int_src_local_bike_product_daily (execute): 11:04:35.007586 => 11:04:35.007631
[0m11:04:35.007088 [debug] [Thread-2 (]: Began compiling node model.local_bike.int_src_local_bike_store_shipped_order
[0m11:04:35.005898 [debug] [Thread-4 (]: Timing info for model.local_bike.int_src_local_bike_store_daily (execute): 11:04:35.005356 => 11:04:35.005378
[0m11:04:35.010122 [debug] [Thread-1 (]: Finished running node model.local_bike.int_src_local_bike_product_daily
[0m11:04:35.017779 [debug] [Thread-4 (]: Finished running node model.local_bike.int_src_local_bike_store_daily
[0m11:04:35.018851 [debug] [Thread-3 (]: Began running node model.local_bike.int_src_local_bike_staff_daily
[0m11:04:35.027023 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_hierarchy, now model.local_bike.int_src_local_bike_staff_daily)
[0m11:04:35.025051 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_store_shipped_order"
[0m11:04:35.030625 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (compile): 11:04:35.010667 => 11:04:35.030056
[0m11:04:35.029173 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_order_shipped_aborted_montly
[0m11:04:35.027972 [debug] [Thread-3 (]: Began compiling node model.local_bike.int_src_local_bike_staff_daily
[0m11:04:35.031366 [debug] [Thread-2 (]: Began executing node model.local_bike.int_src_local_bike_store_shipped_order
[0m11:04:35.041694 [debug] [Thread-2 (]: Timing info for model.local_bike.int_src_local_bike_store_shipped_order (execute): 11:04:35.040944 => 11:04:35.040978
[0m11:04:35.032194 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_order_shipped_montly
[0m11:04:35.033677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_product_daily, now model.local_bike.mrt_order_shipped_aborted_montly)
[0m11:04:35.043731 [debug] [Thread-2 (]: Finished running node model.local_bike.int_src_local_bike_store_shipped_order
[0m11:04:35.047118 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.int_src_local_bike_staff_daily"
[0m11:04:35.048291 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_daily, now model.local_bike.mrt_order_shipped_montly)
[0m11:04:35.049007 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_order_shipped_aborted_montly
[0m11:04:35.049829 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_products_ranking_yearly_top3
[0m11:04:35.050739 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_order_shipped_montly
[0m11:04:35.056136 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_aborted_montly"
[0m11:04:35.057692 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_store_shipped_order, now model.local_bike.mrt_products_ranking_yearly_top3)
[0m11:04:35.065124 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_products_ranking_yearly_top3
[0m11:04:35.064006 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_order_shipped_montly"
[0m11:04:35.058560 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (compile): 11:04:35.034219 => 11:04:35.058179
[0m11:04:35.071761 [debug] [Thread-3 (]: Began executing node model.local_bike.int_src_local_bike_staff_daily
[0m11:04:35.072498 [debug] [Thread-3 (]: Timing info for model.local_bike.int_src_local_bike_staff_daily (execute): 11:04:35.072157 => 11:04:35.072174
[0m11:04:35.070569 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_products_ranking_yearly_top3"
[0m11:04:35.073932 [debug] [Thread-3 (]: Finished running node model.local_bike.int_src_local_bike_staff_daily
[0m11:04:35.075407 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_sales_seasons_yearly
[0m11:04:35.076781 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.int_src_local_bike_staff_daily, now model.local_bike.mrt_sales_seasons_yearly)
[0m11:04:35.077640 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_order_shipped_montly (compile): 11:04:35.059085 => 11:04:35.077238
[0m11:04:35.078344 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_sales_seasons_yearly
[0m11:04:35.079156 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (compile): 11:04:35.051275 => 11:04:35.078826
[0m11:04:35.079770 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_order_shipped_montly
[0m11:04:35.087682 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_sales_seasons_yearly"
[0m11:04:35.088532 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (compile): 11:04:35.065530 => 11:04:35.088160
[0m11:04:35.089271 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_order_shipped_aborted_montly
[0m11:04:35.091862 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_order_shipped_aborted_montly (execute): 11:04:35.091278 => 11:04:35.091294
[0m11:04:35.090085 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_order_shipped_montly (execute): 11:04:35.089737 => 11:04:35.089759
[0m11:04:35.090820 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_products_ranking_yearly_top3
[0m11:04:35.093372 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_order_shipped_aborted_montly
[0m11:04:35.095107 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_order_shipped_montly
[0m11:04:35.095865 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (compile): 11:04:35.080257 => 11:04:35.095504
[0m11:04:35.096527 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_products_ranking_yearly_top3 (execute): 11:04:35.096202 => 11:04:35.096222
[0m11:04:35.097490 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_stores_items_monthly
[0m11:04:35.098409 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_stores_ranking_yearly
[0m11:04:35.099119 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_sales_seasons_yearly
[0m11:04:35.100576 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_products_ranking_yearly_top3
[0m11:04:35.101558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_aborted_montly, now model.local_bike.mrt_stores_items_monthly)
[0m11:04:35.102542 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_order_shipped_montly, now model.local_bike.mrt_stores_ranking_yearly)
[0m11:04:35.103313 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_sales_seasons_yearly (execute): 11:04:35.102971 => 11:04:35.102990
[0m11:04:35.103968 [debug] [Thread-2 (]: Began running node model.local_bike.mrt_stores_sales_monthly
[0m11:04:35.104626 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_stores_items_monthly
[0m11:04:35.105156 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_stores_ranking_yearly
[0m11:04:35.106510 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_sales_seasons_yearly
[0m11:04:35.107486 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_products_ranking_yearly_top3, now model.local_bike.mrt_stores_sales_monthly)
[0m11:04:35.114661 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_stores_items_monthly"
[0m11:04:35.121033 [debug] [Thread-3 (]: Began running node model.local_bike.mrt_products_brands_monthly
[0m11:04:35.121848 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_stores_ranking_yearly"
[0m11:04:35.125067 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (compile): 11:04:35.115268 => 11:04:35.124699
[0m11:04:35.123926 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_sales_seasons_yearly, now model.local_bike.mrt_products_brands_monthly)
[0m11:04:35.122711 [debug] [Thread-2 (]: Began compiling node model.local_bike.mrt_stores_sales_monthly
[0m11:04:35.125827 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_items_monthly (compile): 11:04:35.107924 => 11:04:35.125403
[0m11:04:35.126707 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_stores_ranking_yearly
[0m11:04:35.127473 [debug] [Thread-3 (]: Began compiling node model.local_bike.mrt_products_brands_monthly
[0m11:04:35.134886 [debug] [Thread-2 (]: Writing injected SQL for node "model.local_bike.mrt_stores_sales_monthly"
[0m11:04:35.135644 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_stores_items_monthly
[0m11:04:35.136539 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_stores_ranking_yearly (execute): 11:04:35.136150 => 11:04:35.136174
[0m11:04:35.148864 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_stores_items_monthly (execute): 11:04:35.148147 => 11:04:35.148178
[0m11:04:35.151181 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_stores_ranking_yearly
[0m11:04:35.157380 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (compile): 11:04:35.127986 => 11:04:35.156875
[0m11:04:35.165033 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_stores_items_monthly
[0m11:04:35.165889 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:04:35.166709 [debug] [Thread-4 (]: Began running node model.local_bike.mrt_staff_ranking_yearly
[0m11:04:35.167436 [debug] [Thread-2 (]: Began executing node model.local_bike.mrt_stores_sales_monthly
[0m11:04:35.168150 [debug] [Thread-1 (]: Began running node model.local_bike.mrt_staff_sales_monthly
[0m11:04:35.169387 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_ranking_yearly, now model.local_bike.mrt_staff_ranking_yearly)
[0m11:04:35.170248 [debug] [Thread-2 (]: Timing info for model.local_bike.mrt_stores_sales_monthly (execute): 11:04:35.169903 => 11:04:35.169920
[0m11:04:35.172244 [debug] [Thread-3 (]: On model.local_bike.mrt_products_brands_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_products_brands_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m11:04:35.173348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.local_bike.mrt_stores_items_monthly, now model.local_bike.mrt_staff_sales_monthly)
[0m11:04:35.224419 [debug] [Thread-1 (]: Began compiling node model.local_bike.mrt_staff_sales_monthly
[0m11:04:35.175373 [debug] [Thread-2 (]: Finished running node model.local_bike.mrt_stores_sales_monthly
[0m11:04:35.173973 [debug] [Thread-4 (]: Began compiling node model.local_bike.mrt_staff_ranking_yearly
[0m11:04:35.234323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:35.239914 [debug] [Thread-4 (]: Writing injected SQL for node "model.local_bike.mrt_staff_ranking_yearly"
[0m11:04:35.244133 [debug] [Thread-1 (]: On model.local_bike.mrt_staff_sales_monthly: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "node_id": "model.local_bike.mrt_staff_sales_monthly"} */

    
        SELECT DISTINCT yearmonth as ym
        FROM `databird-473015`.`dbt_bike_silver`.`int_src_local_bike_staff_daily`
        ORDER BY ym
    
  
[0m11:04:35.245560 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (compile): 11:04:35.235108 => 11:04:35.245129
[0m11:04:35.287779 [debug] [Thread-4 (]: Began executing node model.local_bike.mrt_staff_ranking_yearly
[0m11:04:35.291617 [debug] [Thread-4 (]: Timing info for model.local_bike.mrt_staff_ranking_yearly (execute): 11:04:35.290742 => 11:04:35.290775
[0m11:04:35.294410 [debug] [Thread-4 (]: Finished running node model.local_bike.mrt_staff_ranking_yearly
[0m11:04:36.203297 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:cbb657fa-4d55-4179-997f-f2c53633fe84&page=queryresults
[0m11:04:36.205723 [debug] [Thread-1 (]: Writing injected SQL for node "model.local_bike.mrt_staff_sales_monthly"
[0m11:04:36.207508 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (compile): 11:04:35.225139 => 11:04:36.206829
[0m11:04:36.208494 [debug] [Thread-1 (]: Began executing node model.local_bike.mrt_staff_sales_monthly
[0m11:04:36.209514 [debug] [Thread-1 (]: Timing info for model.local_bike.mrt_staff_sales_monthly (execute): 11:04:36.209010 => 11:04:36.209035
[0m11:04:36.211774 [debug] [Thread-1 (]: Finished running node model.local_bike.mrt_staff_sales_monthly
[0m11:04:36.338043 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:d6a33c13-708d-46d6-a86c-3a27b1672b69&page=queryresults
[0m11:04:36.339487 [debug] [Thread-3 (]: Writing injected SQL for node "model.local_bike.mrt_products_brands_monthly"
[0m11:04:36.340625 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_products_brands_monthly (compile): 11:04:35.136999 => 11:04:36.340236
[0m11:04:36.341226 [debug] [Thread-3 (]: Began executing node model.local_bike.mrt_products_brands_monthly
[0m11:04:36.341861 [debug] [Thread-3 (]: Timing info for model.local_bike.mrt_products_brands_monthly (execute): 11:04:36.341528 => 11:04:36.341547
[0m11:04:36.343428 [debug] [Thread-3 (]: Finished running node model.local_bike.mrt_products_brands_monthly
[0m11:04:36.346442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:36.347011 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_sales_monthly' was properly closed.
[0m11:04:36.347328 [debug] [MainThread]: Connection 'model.local_bike.mrt_products_brands_monthly' was properly closed.
[0m11:04:36.347704 [debug] [MainThread]: Connection 'model.local_bike.mrt_stores_sales_monthly' was properly closed.
[0m11:04:36.348190 [debug] [MainThread]: Connection 'model.local_bike.mrt_staff_ranking_yearly' was properly closed.
[0m11:04:36.354082 [debug] [MainThread]: Command end result
[0m11:04:36.393153 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m11:04:36.393769 [info ] [MainThread]: Building catalog
[0m11:04:36.399739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:04:36.893512 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m11:04:36.901178 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m11:04:36.910820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:36.915548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:36.917146 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m11:04:36.919477 [debug] [ThreadPool]: Acquiring new bigquery connection 'databird-473015.information_schema'
[0m11:04:36.923173 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_silver`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_silver'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_silver`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m11:04:36.926796 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_gold`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_gold'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_gold`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m11:04:36.931511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:36.935932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:37.020373 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_bronze`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_bronze'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_bronze`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m11:04:37.064027 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`dbt_bike_seeds`.__TABLES__
        where (upper(dataset_id) = upper('dbt_bike_seeds'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`dbt_bike_seeds`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m11:04:38.858544 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:b081767d-9d20-4e3f-8dfb-b7a0a4d56ab8&page=queryresults
[0m11:04:38.871155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:04:38.875405 [debug] [ThreadPool]: On databird-473015.information_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "local_bike", "target_name": "dev", "connection_name": "databird-473015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `databird-473015`.`src_local_bike`.__TABLES__
        where (upper(dataset_id) = upper('src_local_bike'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `databird-473015`.`src_local_bike`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m11:04:39.163276 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:c0163742-f998-414b-acb5-28757dc81c88&page=queryresults
[0m11:04:39.217790 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:aeaffcf5-1033-43dd-b5fb-4e77ff6ac185&page=queryresults
[0m11:04:39.243081 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:7f314691-6ed2-481e-b33c-3004a0a28c5d&page=queryresults
[0m11:04:40.988839 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=databird-473015&j=bq:US:4d5c5359-5aa7-4200-8fb2-1b805abba3ba&page=queryresults
[0m11:04:41.190995 [info ] [MainThread]: Catalog written to /usr/app/dbt/target/catalog.json
[0m11:04:41.194064 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:04:41.193418 after 8.60 seconds
[0m11:04:41.195056 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:04:41.195694 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m11:04:41.196194 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m11:04:41.196657 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m11:04:41.197556 [debug] [MainThread]: Connection 'databird-473015.information_schema' was properly closed.
[0m11:04:41.198314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6b0142270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6ae1bb740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6aef5c680>]}
[0m11:04:41.199064 [debug] [MainThread]: Flushing usage events
